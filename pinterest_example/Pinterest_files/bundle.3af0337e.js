function printStackTrace(a){a=a||{guess:!0};var b=a.e||null,c=!!a.guess,d=new printStackTrace.implementation,e=d.run(b);return c?d.guessAnonymousFunctions(e):e}function createMethod(a){return function(){throw new Error('The "'+a+"\" method is not available on the playback technology's API")}}var goog={require:function(){},provide:function(a){for(var b=window,c=a.split(/\./),d=0;d<c.length;d++){var e=c[d];void 0===b[e]&&(b[e]={}),b=b[e]}}};!function(a,b){function c(a){var b=a.length,c=kb.type(a);return kb.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"===typeof b&&b>0&&b-1 in a)}function d(a){var b=zb[a]={};return kb.each(a.match(mb)||[],function(a,c){b[c]=!0}),b}function e(a,c,d,e){if(kb.acceptData(a)){var f,g,h=kb.expando,i=a.nodeType,j=i?kb.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||d!==b||"string"!==typeof c)return k||(k=i?a[h]=bb.pop()||kb.guid++:h),j[k]||(j[k]=i?{}:{toJSON:kb.noop}),("object"===typeof c||"function"===typeof c)&&(e?j[k]=kb.extend(j[k],c):j[k].data=kb.extend(j[k].data,c)),g=j[k],e||(g.data||(g.data={}),g=g.data),d!==b&&(g[kb.camelCase(c)]=d),"string"===typeof c?(f=g[c],null==f&&(f=g[kb.camelCase(c)])):f=g,f}}function f(a,b,c){if(kb.acceptData(a)){var d,e,f=a.nodeType,g=f?kb.cache:a,i=f?a[kb.expando]:kb.expando;if(g[i]){if(b&&(d=c?g[i]:g[i].data)){kb.isArray(b)?b=b.concat(kb.map(b,kb.camelCase)):b in d?b=[b]:(b=kb.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;for(;e--;)delete d[b[e]];if(c?!h(d):!kb.isEmptyObject(d))return}(c||(delete g[i].data,h(g[i])))&&(f?kb.cleanData([a],!0):kb.support.deleteExpando||g!=g.window?delete g[i]:g[i]=null)}}}function g(a,c,d){if(d===b&&1===a.nodeType){var e="data-"+c.replace(Bb,"-$1").toLowerCase();if(d=a.getAttribute(e),"string"===typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:Ab.test(d)?kb.parseJSON(d):d}catch(f){}kb.data(a,c,d)}else d=b}return d}function h(a){var b;for(b in a)if(("data"!==b||!kb.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function i(){return!0}function j(){return!1}function k(){try{return Y.activeElement}catch(a){}}function l(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function m(a,b,c){if(kb.isFunction(b))return kb.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return kb.grep(a,function(a){return a===b!==c});if("string"===typeof b){if(Qb.test(b))return kb.filter(b,a,c);b=kb.filter(b,a)}return kb.grep(a,function(a){return kb.inArray(a,b)>=0!==c})}function n(a){var b=Ub.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function o(a,b){return kb.nodeName(a,"table")&&kb.nodeName(1===b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function p(a){return a.type=(null!==kb.find.attr(a,"type"))+"/"+a.type,a}function q(a){var b=ec.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function r(a,b){for(var c,d=0;null!=(c=a[d]);d++)kb._data(c,"globalEval",!b||kb._data(b[d],"globalEval"))}function s(a,b){if(1===b.nodeType&&kb.hasData(a)){var c,d,e,f=kb._data(a),g=kb._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;d<e;d++)kb.event.add(b,c,h[c][d])}g.data&&(g.data=kb.extend({},g.data))}}function t(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!kb.support.noCloneEvent&&b[kb.expando]){e=kb._data(b);for(d in e.events)kb.removeEvent(b,d,e.handle);b.removeAttribute(kb.expando)}"script"===c&&b.text!==a.text?(p(b).text=a.text,q(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),kb.support.html5Clone&&a.innerHTML&&!kb.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&bc.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}function u(a,c){var d,e,f=0,g=typeof a.getElementsByTagName!==W?a.getElementsByTagName(c||"*"):typeof a.querySelectorAll!==W?a.querySelectorAll(c||"*"):b;if(!g)for(g=[],d=a.childNodes||a;null!=(e=d[f]);f++)!c||kb.nodeName(e,c)?g.push(e):kb.merge(g,u(e,c));return c===b||c&&kb.nodeName(a,c)?kb.merge([a],g):g}function v(a){bc.test(a.type)&&(a.defaultChecked=a.checked)}function w(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=yc.length;e--;)if(b=yc[e]+c,b in a)return b;return d}function x(a,b){return a=b||a,"none"===kb.css(a,"display")||!kb.contains(a.ownerDocument,a)}function y(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=kb._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&x(d)&&(f[g]=kb._data(d,"olddisplay",C(d.nodeName)))):f[g]||(e=x(d),(c&&"none"!==c||!e)&&kb._data(d,"olddisplay",e?c:kb.css(d,"display"))));for(g=0;g<h;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function z(a,b,c){var d=rc.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function A(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=kb.css(a,c+xc[f],!0,e)),d?("content"===c&&(g-=kb.css(a,"padding"+xc[f],!0,e)),"margin"!==c&&(g-=kb.css(a,"border"+xc[f]+"Width",!0,e))):(g+=kb.css(a,"padding"+xc[f],!0,e),"padding"!==c&&(g+=kb.css(a,"border"+xc[f]+"Width",!0,e)));return g}function B(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=kc(a),g=kb.support.boxSizing&&"border-box"===kb.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(e=lc(a,b,f),(e<0||null==e)&&(e=a.style[b]),sc.test(e))return e;d=g&&(kb.support.boxSizingReliable||e===a.style[b]),e=parseFloat(e)||0}return e+A(a,b,c||(g?"border":"content"),d,f)+"px"}function C(a){var b=Y,c=uc[a];return c||(c=D(a,b),"none"!==c&&c||(jc=(jc||kb("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(jc[0].contentWindow||jc[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=D(a,b),jc.detach()),uc[a]=c),c}function D(a,b){var c=kb(b.createElement(a)).appendTo(b.body),d=kb.css(c[0],"display");return c.remove(),d}function E(a,b,c,d){var e;if(kb.isArray(b))kb.each(b,function(b,e){c||Ac.test(a)?d(a,e):E(a+"["+("object"===typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==kb.type(b))d(a,b);else for(e in b)E(a+"["+e+"]",b[e],c,d)}function F(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(mb)||[];if(kb.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function G(a,b,c,d){function e(h){var i;return f[h]=!0,kb.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!==typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===Rc;return e(b.dataTypes[0])||!f["*"]&&e("*")}function H(a,c){var d,e,f=kb.ajaxSettings.flatOptions||{};for(e in c)c[e]!==b&&((f[e]?a:d||(d={}))[e]=c[e]);return d&&kb.extend(!0,a,d),a}function I(a,c,d){for(var e,f,g,h,i=a.contents,j=a.dataTypes;"*"===j[0];)j.shift(),f===b&&(f=a.mimeType||c.getResponseHeader("Content-Type"));if(f)for(h in i)if(i[h]&&i[h].test(f)){j.unshift(h);break}if(j[0]in d)g=j[0];else{for(h in d){if(!j[0]||a.converters[h+" "+j[0]]){g=h;break}e||(e=h)}g=g||e}return g?(g!==j[0]&&j.unshift(g),d[g]):void 0}function J(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function K(){try{return new a.XMLHttpRequest}catch(b){}}function L(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function M(){return setTimeout(function(){$c=b}),$c=kb.now()}function N(a,b,c){for(var d,e=(ed[b]||[]).concat(ed["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function O(a,b,c){var d,e,f=0,g=dd.length,h=kb.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$c||M(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:kb.extend({},b),opts:kb.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$c||M(),duration:c.duration,tweens:[],createTween:function(b,c){var d=kb.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(P(k,j.opts.specialEasing);f<g;f++)if(d=dd[f].call(j,a,k,j.opts))return d;return kb.map(k,N,j),kb.isFunction(j.opts.start)&&j.opts.start.call(a,j),kb.fx.timer(kb.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function P(a,b){var c,d,e,f,g;for(c in a)if(d=kb.camelCase(c),e=b[d],f=a[c],kb.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=kb.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Q(a,b,c){var d,e,f,g,h,i,j=this,k={},l=a.style,m=a.nodeType&&x(a),n=kb._data(a,"fxshow");c.queue||(h=kb._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,j.always(function(){j.always(function(){h.unqueued--,kb.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[l.overflow,l.overflowX,l.overflowY],"inline"===kb.css(a,"display")&&"none"===kb.css(a,"float")&&(kb.support.inlineBlockNeedsLayout&&"inline"!==C(a.nodeName)?l.zoom=1:l.display="inline-block")),c.overflow&&(l.overflow="hidden",kb.support.shrinkWrapBlocks||j.always(function(){l.overflow=c.overflow[0],l.overflowX=c.overflow[1],l.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],ad.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(m?"hide":"show"))continue;k[d]=n&&n[d]||kb.style(a,d)}if(!kb.isEmptyObject(k)){n?"hidden"in n&&(m=n.hidden):n=kb._data(a,"fxshow",{}),f&&(n.hidden=!m),m?kb(a).show():j.done(function(){kb(a).hide()}),j.done(function(){var b;kb._removeData(a,"fxshow");for(b in k)kb.style(a,b,k[b])});for(d in k)g=N(m?n[d]:0,d,j),d in n||(n[d]=g.start,m&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function R(a,b,c,d,e){return new R.prototype.init(a,b,c,d,e)}function S(a,b){var c,d={height:a},e=0;for(b=b?1:0;e<4;e+=2-b)c=xc[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function T(a){return kb.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var U,V,W=typeof b,X=a.location,Y=a.document,Z=Y.documentElement,$=a.jQuery,_=a.$,ab={},bb=[],cb="1.10.2",db=bb.concat,eb=bb.push,fb=bb.slice,gb=bb.indexOf,hb=ab.toString,ib=ab.hasOwnProperty,jb=cb.trim,kb=function(a,b){return new kb.fn.init(a,b,V)},lb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,mb=/\S+/g,nb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ob=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,pb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,qb=/^[\],:{}\s]*$/,rb=/(?:^|:|,)(?:\s*\[)+/g,sb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,tb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,ub=/^-ms-/,vb=/-([\da-z])/gi,wb=function(a,b){return b.toUpperCase()},xb=function(a){(Y.addEventListener||"load"===a.type||"complete"===Y.readyState)&&(yb(),kb.ready())},yb=function(){Y.addEventListener?(Y.removeEventListener("DOMContentLoaded",xb,!1),a.removeEventListener("load",xb,!1)):(Y.detachEvent("onreadystatechange",xb),a.detachEvent("onload",xb))};kb.fn=kb.prototype={jquery:cb,constructor:kb,init:function(a,c,d){var e,f;if(!a)return this;if("string"===typeof a){if(e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:ob.exec(a),!e||!e[1]&&c)return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a);if(e[1]){if(c=c instanceof kb?c[0]:c,kb.merge(this,kb.parseHTML(e[1],c&&c.nodeType?c.ownerDocument||c:Y,!0)),pb.test(e[1])&&kb.isPlainObject(c))for(e in c)kb.isFunction(this[e])?this[e](c[e]):this.attr(e,c[e]);return this}if(f=Y.getElementById(e[2]),f&&f.parentNode){if(f.id!==e[2])return d.find(a);this.length=1,this[0]=f}return this.context=Y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):kb.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),kb.makeArray(a,this))},selector:"",length:0,toArray:function(){return fb.call(this)},get:function(a){return null==a?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a){var b=kb.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return kb.each(this,a,b)},ready:function(a){return kb.ready.promise().done(a),this},slice:function(){return this.pushStack(fb.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},map:function(a){return this.pushStack(kb.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:eb,sort:[].sort,splice:[].splice},kb.fn.init.prototype=kb.fn,kb.extend=kb.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"===typeof h&&(k=h,h=arguments[1]||{},i=2),"object"===typeof h||kb.isFunction(h)||(h={}),j===i&&(h=this,--i);i<j;i++)if(null!=(f=arguments[i]))for(e in f)a=h[e],d=f[e],h!==d&&(k&&d&&(kb.isPlainObject(d)||(c=kb.isArray(d)))?(c?(c=!1,g=a&&kb.isArray(a)?a:[]):g=a&&kb.isPlainObject(a)?a:{},h[e]=kb.extend(k,g,d)):d!==b&&(h[e]=d));return h},kb.extend({expando:"jQuery"+(cb+Math.random()).replace(/\D/g,""),noConflict:function(b){return a.$===kb&&(a.$=_),b&&a.jQuery===kb&&(a.jQuery=$),kb},isReady:!1,readyWait:1,holdReady:function(a){a?kb.readyWait++:kb.ready(!0)},ready:function(a){if(a===!0?!--kb.readyWait:!kb.isReady){if(!Y.body)return setTimeout(kb.ready);kb.isReady=!0,a!==!0&&--kb.readyWait>0||(U.resolveWith(Y,[kb]),kb.fn.trigger&&kb(Y).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===kb.type(a)},isArray:Array.isArray||function(a){return"array"===kb.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):"object"===typeof a||"function"===typeof a?ab[hb.call(a)]||"object":typeof a},isPlainObject:function(a){var c;if(!a||"object"!==kb.type(a)||a.nodeType||kb.isWindow(a))return!1;try{if(a.constructor&&!ib.call(a,"constructor")&&!ib.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}if(kb.support.ownLast)for(c in a)return ib.call(a,c);for(c in a);return c===b||ib.call(a,c)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=!1),b=b||Y;var d=pb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=kb.buildFragment([a],b,e),e&&kb(e).remove(),kb.merge([],d.childNodes))},parseJSON:function(b){return a.JSON&&a.JSON.parse?a.JSON.parse(b):null===b?b:"string"===typeof b&&(b=kb.trim(b),b&&qb.test(b.replace(sb,"@").replace(tb,"]").replace(rb,"")))?new Function("return "+b)():void kb.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||"string"!==typeof c)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return d&&d.documentElement&&!d.getElementsByTagName("parsererror").length||kb.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&kb.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(ub,"ms-").replace(vb,wb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;f<g&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;f<g&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:jb&&!jb.call("﻿ ")?function(a){return null==a?"":jb.call(a)}:function(a){return null==a?"":(a+"").replace(nb,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?kb.merge(d,"string"===typeof a?[a]:a):eb.call(d,a)),d},inArray:function(a,b,c){var d;if(b){if(gb)return gb.call(b,a,c);for(d=b.length,c=c?c<0?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"===typeof d)for(;f<d;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;f<g;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;f<g;f++)e=b(a[f],f,d),null!=e&&(i[i.length]=e);else for(f in a)e=b(a[f],f,d),null!=e&&(i[i.length]=e);return db.apply([],i)},guid:1,proxy:function(a,c){var d,e,f;return"string"===typeof c&&(f=a[c],c=a,a=f),kb.isFunction(a)?(d=fb.call(arguments,2),e=function(){return a.apply(c||this,d.concat(fb.call(arguments)))},e.guid=a.guid=a.guid||kb.guid++,e):b},access:function(a,c,d,e,f,g,h){var i=0,j=a.length,k=null==d;if("object"===kb.type(d)){f=!0;for(i in d)kb.access(a,c,i,d[i],!0,g,h)}else if(e!==b&&(f=!0,kb.isFunction(e)||(h=!0),k&&(h?(c.call(a,e),c=null):(k=c,c=function(a,b,c){return k.call(kb(a),c)})),c))for(;i<j;i++)c(a[i],d,h?e:e.call(a[i],i,c(a[i],d)));return f?a:k?c.call(a):j?c(a[0],d):g},now:function(){return(new Date).getTime()},swap:function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e}}),kb.ready.promise=function(b){if(!U)if(U=kb.Deferred(),"complete"===Y.readyState)setTimeout(kb.ready);else if(Y.addEventListener)Y.addEventListener("DOMContentLoaded",xb,!1),a.addEventListener("load",xb,!1);else{Y.attachEvent("onreadystatechange",xb),a.attachEvent("onload",xb);var c=!1;try{c=null==a.frameElement&&Y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!kb.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}yb(),kb.ready()}}()}return U.promise(b)},kb.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){ab["[object "+b+"]"]=b.toLowerCase()}),V=kb(Y),function(a,b){function c(a,b,c,d){var e,f,g,h,i,j,k,l,o,p;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!==typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=tb.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return ab.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&x.getElementsByClassName&&b.getElementsByClassName)return ab.apply(c,b.getElementsByClassName(g)),c}if(x.qsa&&(!J||!J.test(a))){if(l=k=N,o=b,p=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=m(a),(k=b.getAttribute("id"))?l=k.replace(wb,"\\$&"):b.setAttribute("id",l),l="[id='"+l+"'] ",i=j.length;i--;)j[i]=l+n(j[i]);o=nb.test(a)&&b.parentNode||b,p=j.join(",")}if(p)try{return ab.apply(c,o.querySelectorAll(p)),c}catch(q){}finally{k||b.removeAttribute("id")}}}return v(a.replace(jb,"$1"),b,c,d)}function d(){function a(c,d){return b.push(c+=" ")>z.cacheLength&&delete a[b.shift()],a[c]=d}var b=[];return a}function e(a){return a[N]=!0,a}function f(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function g(a,b){for(var c=a.split("|"),d=a.length;d--;)z.attrHandle[c[d]]=b}function h(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||X)-(~a.sourceIndex||X);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function i(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function j(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function k(a){return e(function(b){return b=+b,e(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function l(){}function m(a,b){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=z.preFilter;h;){(!d||(e=lb.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=mb.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(jb," ")}),h=h.slice(d.length));for(g in z.filter)!(e=rb[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return b?h.length:h?c.error(a):S(a,i).slice(0)}function n(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function o(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=P+" "+f;if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(j=b[N]||(b[N]={}),(i=j[d])&&i[0]===k){if((h=i[1])===!0||h===y)return h===!0}else if(i=j[d]=[k],i[1]=a(b,c,g)||y,i[1]===!0)return!0}}function p(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,d,f,g){return d&&!d[N]&&(d=r(d)),f&&!f[N]&&(f=r(f,g)),e(function(e,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=e||u(b||"*",h.nodeType?[h]:h,[]),r=!a||!e&&b?p:q(p,m,a,h,i),s=c?f||(e?a:o||d)?[]:g:r;if(c&&c(r,s,h,i),d)for(j=q(s,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(e){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?cb.call(e,l):m[k])>-1&&(e[j]=!(g[j]=l))}}else s=q(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):ab.apply(g,s)})}function s(a){for(var b,c,d,e=a.length,f=z.relative[a[0].type],g=f||z.relative[" "],h=f?1:0,i=o(function(a){return a===b},g,!0),j=o(function(a){return cb.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==D)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];h<e;h++)if(c=z.relative[a[h].type])k=[o(p(k),c)];else{if(c=z.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;d<e&&!z.relative[a[d].type];d++);return r(h>1&&p(k),h>1&&n(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(jb,"$1"),c,h<d&&s(a.slice(h,d)),d<e&&s(a=a.slice(d)),d<e&&n(a))}k.push(c)}return p(k)}function t(a,b){var d=0,f=b.length>0,g=a.length>0,h=function(e,h,i,j,k){var l,m,n,o=[],p=0,r="0",s=e&&[],t=null!=k,u=D,v=e||g&&z.find.TAG("*",k&&h.parentNode||h),w=P+=null==u?1:Math.random()||.1;for(t&&(D=h!==G&&h,y=d);null!=(l=v[r]);r++){if(g&&l){for(m=0;n=a[m++];)if(n(l,h,i)){j.push(l);break}t&&(P=w,y=++d)}f&&((l=!n&&l)&&p--,e&&s.push(l))}if(p+=r,f&&r!==p){for(m=0;n=b[m++];)n(s,o,h,i);if(e){if(p>0)for(;r--;)s[r]||o[r]||(o[r]=$.call(j));o=q(o)}ab.apply(j,o),t&&!e&&o.length>0&&p+b.length>1&&c.uniqueSort(j)}return t&&(P=w,D=u),s};return f?e(h):h}function u(a,b,d){for(var e=0,f=b.length;e<f;e++)c(a,b[e],d);return d}function v(a,b,c,d){var e,f,g,h,i,j=m(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&x.getById&&9===b.nodeType&&I&&z.relative[f[1].type]){if(b=(z.find.ID(g.matches[0].replace(xb,yb),b)||[])[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=rb.needsContext.test(a)?0:f.length;e--&&(g=f[e],!z.relative[h=g.type]);)if((i=z.find[h])&&(d=i(g.matches[0].replace(xb,yb),nb.test(f[0].type)&&b.parentNode||b))){if(f.splice(e,1),a=d.length&&n(f),!a)return ab.apply(c,d),c;break}}return C(a,j)(d,b,!I,c,nb.test(a)),c}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=d(),S=d(),T=d(),U=!1,V=function(a,b){return a===b?(U=!0,0):0},W=typeof b,X=1<<31,Y={}.hasOwnProperty,Z=[],$=Z.pop,_=Z.push,ab=Z.push,bb=Z.slice,cb=Z.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},db="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",eb="[\\x20\\t\\r\\n\\f]",fb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",gb=fb.replace("w","w#"),hb="\\["+eb+"*("+fb+")"+eb+"*(?:([*^$|!~]?=)"+eb+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+gb+")|)|)"+eb+"*\\]",ib=":("+fb+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+hb.replace(3,8)+")*)|.*)\\)|)",jb=new RegExp("^"+eb+"+|((?:^|[^\\\\])(?:\\\\.)*)"+eb+"+$","g"),lb=new RegExp("^"+eb+"*,"+eb+"*"),mb=new RegExp("^"+eb+"*([>+~]|"+eb+")"+eb+"*"),nb=new RegExp(eb+"*[+~]"),ob=new RegExp("="+eb+"*([^\\]'\"]*)"+eb+"*\\]","g"),pb=new RegExp(ib),qb=new RegExp("^"+gb+"$"),rb={ID:new RegExp("^#("+fb+")"),CLASS:new RegExp("^\\.("+fb+")"),TAG:new RegExp("^("+fb.replace("w","w*")+")"),ATTR:new RegExp("^"+hb),PSEUDO:new RegExp("^"+ib),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+eb+"*(even|odd|(([+-]|)(\\d*)n|)"+eb+"*(?:([+-]|)"+eb+"*(\\d+)|))"+eb+"*\\)|)","i"),bool:new RegExp("^(?:"+db+")$","i"),needsContext:new RegExp("^"+eb+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+eb+"*((?:-\\d)?\\d*)"+eb+"*\\)|)(?=[^-]|$)","i")},sb=/^[^{]+\{\s*\[native \w/,tb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ub=/^(?:input|select|textarea|button)$/i,vb=/^h\d$/i,wb=/'|\\/g,xb=new RegExp("\\\\([\\da-f]{1,6}"+eb+"?|("+eb+")|.)","ig"),yb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{ab.apply(Z=bb.call(O.childNodes),O.childNodes),Z[O.childNodes.length].nodeType}catch(zb){ab={apply:Z.length?function(a,b){_.apply(a,bb.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}B=c.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},x=c.support={},F=c.setDocument=function(a){var b=a?a.ownerDocument||a:O,c=b.defaultView;return b!==G&&9===b.nodeType&&b.documentElement?(G=b,H=b.documentElement,I=!B(b),c&&c.attachEvent&&c!==c.top&&c.attachEvent("onbeforeunload",function(){F()}),x.attributes=f(function(a){return a.className="i",!a.getAttribute("className")}),x.getElementsByTagName=f(function(a){return a.appendChild(b.createComment("")),!a.getElementsByTagName("*").length}),x.getElementsByClassName=f(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),x.getById=f(function(a){return H.appendChild(a).id=N,!b.getElementsByName||!b.getElementsByName(N).length}),x.getById?(z.find.ID=function(a,b){if(typeof b.getElementById!==W&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},z.filter.ID=function(a){var b=a.replace(xb,yb);return function(a){return a.getAttribute("id")===b}}):(delete z.find.ID,z.filter.ID=function(a){var b=a.replace(xb,yb);return function(a){var c=typeof a.getAttributeNode!==W&&a.getAttributeNode("id");return c&&c.value===b}}),z.find.TAG=x.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==W?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},z.find.CLASS=x.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==W&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(x.qsa=sb.test(b.querySelectorAll))&&(f(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||J.push("\\["+eb+"*(?:value|"+db+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),f(function(a){var c=b.createElement("input");c.setAttribute("type","hidden"),a.appendChild(c).setAttribute("t",""),a.querySelectorAll("[t^='']").length&&J.push("[*^$]="+eb+"*(?:''|\"\")"),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(x.matchesSelector=sb.test(L=H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&f(function(a){x.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",ib)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),M=sb.test(H.contains)||H.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},V=H.compareDocumentPosition?function(a,c){if(a===c)return U=!0,0;var d=c.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(c);return d?1&d||!x.sortDetached&&c.compareDocumentPosition(a)===d?a===b||M(O,a)?-1:c===b||M(O,c)?1:E?cb.call(E,a)-cb.call(E,c):0:4&d?-1:1:a.compareDocumentPosition?-1:1}:function(a,c){var d,e=0,f=a.parentNode,g=c.parentNode,i=[a],j=[c];if(a===c)return U=!0,0;if(!f||!g)return a===b?-1:c===b?1:f?-1:g?1:E?cb.call(E,a)-cb.call(E,c):0;if(f===g)return h(a,c);for(d=a;d=d.parentNode;)i.unshift(d);for(d=c;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?h(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},b):G},c.matches=function(a,b){return c(a,null,null,b)},c.matchesSelector=function(a,b){if((a.ownerDocument||a)!==G&&F(a),b=b.replace(ob,"='$1']"),x.matchesSelector&&I&&(!K||!K.test(b))&&(!J||!J.test(b)))try{var d=L.call(a,b);if(d||x.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return c(b,G,null,[a]).length>0},c.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},c.attr=function(a,c){(a.ownerDocument||a)!==G&&F(a);var d=z.attrHandle[c.toLowerCase()],e=d&&Y.call(z.attrHandle,c.toLowerCase())?d(a,c,!I):b;return e===b?x.attributes||!I?a.getAttribute(c):(e=a.getAttributeNode(c))&&e.specified?e.value:null:e},c.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},c.uniqueSort=function(a){var b,c=[],d=0,e=0;if(U=!x.detectDuplicates,E=!x.sortStable&&a.slice(0),a.sort(V),U){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return a},A=c.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=A(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d];d++)c+=A(b);return c},z=c.selectors={cacheLength:50,createPseudo:e,match:rb,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(xb,yb),a[3]=(a[4]||a[5]||"").replace(xb,yb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||c.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&c.error(a[0]),a},PSEUDO:function(a){var c,d=!a[5]&&a[2];return rb.CHILD.test(a[0])?null:(a[3]&&a[4]!==b?a[2]=a[4]:d&&pb.test(d)&&(c=m(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length)&&(a[0]=a[0].slice(0,c),a[2]=d.slice(0,c)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(xb,yb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+eb+")"+a+"("+eb+"|$)"))&&R(a,function(a){return b.test("string"===typeof a.className&&a.className||typeof a.getAttribute!==W&&a.getAttribute("class")||"")
})},ATTR:function(a,b,d){return function(e){var f=c.attr(e,a);return null==f?"!="===b:b?(f+="","="===b?f===d:"!="===b?f!==d:"^="===b?d&&0===f.indexOf(d):"*="===b?d&&f.indexOf(d)>-1:"$="===b?d&&f.slice(-d.length)===d:"~="===b?(" "+f+" ").indexOf(d)>-1:"|="===b?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var d,f=z.pseudos[a]||z.setFilters[a.toLowerCase()]||c.error("unsupported pseudo: "+a);return f[N]?f(b):f.length>1?(d=[a,a,"",b],z.setFilters.hasOwnProperty(a.toLowerCase())?e(function(a,c){for(var d,e=f(a,b),g=e.length;g--;)d=cb.call(a,e[g]),a[d]=!(c[d]=e[g])}):function(a){return f(a,0,d)}):f}},pseudos:{not:e(function(a){var b=[],c=[],d=C(a.replace(jb,"$1"));return d[N]?e(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:e(function(a){return function(b){return c(a,b).length>0}}),contains:e(function(a){return function(b){return(b.textContent||b.innerText||A(b)).indexOf(a)>-1}}),lang:e(function(a){return qb.test(a||"")||c.error("unsupported lang: "+a),a=a.replace(xb,yb).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeName>"@"||3===a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!z.pseudos.empty(a)},header:function(a){return vb.test(a.nodeName)},input:function(a){return ub.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:k(function(){return[0]}),last:k(function(a,b){return[b-1]}),eq:k(function(a,b,c){return[c<0?c+b:c]}),even:k(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:k(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:k(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:k(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},z.pseudos.nth=z.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})z.pseudos[w]=i(w);for(w in{submit:!0,reset:!0})z.pseudos[w]=j(w);l.prototype=z.filters=z.pseudos,z.setFilters=new l,C=c.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=m(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d))}return f},x.sortStable=N.split("").sort(V).join("")===N,x.detectDuplicates=U,F(),x.sortDetached=f(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),f(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||g("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),x.attributes&&f(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||g("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),f(function(a){return null==a.getAttribute("disabled")})||g(db,function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&d.specified?d.value:a[b]===!0?b.toLowerCase():null}),kb.find=c,kb.expr=c.selectors,kb.expr[":"]=kb.expr.pseudos,kb.unique=c.uniqueSort,kb.text=c.getText,kb.isXMLDoc=c.isXML,kb.contains=c.contains}(a);var zb={};kb.Callbacks=function(a){a="string"===typeof a?zb[a]||d(a):kb.extend({},a);var c,e,f,g,h,i,j=[],k=!a.once&&[],l=function(b){for(e=a.memory&&b,f=!0,h=i||0,i=0,g=j.length,c=!0;j&&h<g;h++)if(j[h].apply(b[0],b[1])===!1&&a.stopOnFalse){e=!1;break}c=!1,j&&(k?k.length&&l(k.shift()):e?j=[]:m.disable())},m={add:function(){if(j){var b=j.length;!function d(b){kb.each(b,function(b,c){var e=kb.type(c);"function"===e?a.unique&&m.has(c)||j.push(c):c&&c.length&&"string"!==e&&d(c)})}(arguments),c?g=j.length:e&&(i=b,l(e))}return this},remove:function(){return j&&kb.each(arguments,function(a,b){for(var d;(d=kb.inArray(b,j,d))>-1;)j.splice(d,1),c&&(d<=g&&g--,d<=h&&h--)}),this},has:function(a){return a?kb.inArray(a,j)>-1:!(!j||!j.length)},empty:function(){return j=[],g=0,this},disable:function(){return j=k=e=b,this},disabled:function(){return!j},lock:function(){return k=b,e||m.disable(),this},locked:function(){return!k},fireWith:function(a,b){return!j||f&&!k||(b=b||[],b=[a,b.slice?b.slice():b],c?k.push(b):l(b)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!f}};return m},kb.extend({Deferred:function(a){var b=[["resolve","done",kb.Callbacks("once memory"),"resolved"],["reject","fail",kb.Callbacks("once memory"),"rejected"],["notify","progress",kb.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return kb.Deferred(function(c){kb.each(b,function(b,f){var g=f[0],h=kb.isFunction(a[b])&&a[b];e[f[1]](function(){var a=h&&h.apply(this,arguments);a&&kb.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[g+"With"](this===d?c.promise():this,h?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?kb.extend(a,d):d}},e={};return d.pipe=d.then,kb.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=fb.call(arguments),g=f.length,h=1!==g||a&&kb.isFunction(a.promise)?g:0,i=1===h?a:kb.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?fb.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);e<g;e++)f[e]&&kb.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}}),kb.support=function(b){var c,d,e,f,g,h,i,j,k,l=Y.createElement("div");if(l.setAttribute("className","t"),l.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=l.getElementsByTagName("*")||[],d=l.getElementsByTagName("a")[0],!d||!d.style||!c.length)return b;f=Y.createElement("select"),h=f.appendChild(Y.createElement("option")),e=l.getElementsByTagName("input")[0],d.style.cssText="top:1px;float:left;opacity:.5",b.getSetAttribute="t"!==l.className,b.leadingWhitespace=3===l.firstChild.nodeType,b.tbody=!l.getElementsByTagName("tbody").length,b.htmlSerialize=!!l.getElementsByTagName("link").length,b.style=/top/.test(d.getAttribute("style")),b.hrefNormalized="/a"===d.getAttribute("href"),b.opacity=/^0.5/.test(d.style.opacity),b.cssFloat=!!d.style.cssFloat,b.checkOn=!!e.value,b.optSelected=h.selected,b.enctype=!!Y.createElement("form").enctype,b.html5Clone="<:nav></:nav>"!==Y.createElement("nav").cloneNode(!0).outerHTML,b.inlineBlockNeedsLayout=!1,b.shrinkWrapBlocks=!1,b.pixelPosition=!1,b.deleteExpando=!0,b.noCloneEvent=!0,b.reliableMarginRight=!0,b.boxSizingReliable=!0,e.checked=!0,b.noCloneChecked=e.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!h.disabled;try{delete l.test}catch(m){b.deleteExpando=!1}e=Y.createElement("input"),e.setAttribute("value",""),b.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),b.radioValue="t"===e.value,e.setAttribute("checked","t"),e.setAttribute("name","t"),g=Y.createDocumentFragment(),g.appendChild(e),b.appendChecked=e.checked,b.checkClone=g.cloneNode(!0).cloneNode(!0).lastChild.checked,l.attachEvent&&(l.attachEvent("onclick",function(){b.noCloneEvent=!1}),l.cloneNode(!0).click());for(k in{submit:!0,change:!0,focusin:!0})l.setAttribute(i="on"+k,"t"),b[k+"Bubbles"]=i in a||l.attributes[i].expando===!1;l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===l.style.backgroundClip;for(k in kb(b))break;return b.ownLast="0"!==k,kb(function(){var c,d,e,f="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",g=Y.getElementsByTagName("body")[0];g&&(c=Y.createElement("div"),c.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",g.appendChild(c).appendChild(l),l.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=l.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",j=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",b.reliableHiddenOffsets=j&&0===e[0].offsetHeight,l.innerHTML="",l.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",kb.swap(g,null!=g.style.zoom?{zoom:1}:{},function(){b.boxSizing=4===l.offsetWidth}),a.getComputedStyle&&(b.pixelPosition="1%"!==(a.getComputedStyle(l,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(l,null)||{width:"4px"}).width,d=l.appendChild(Y.createElement("div")),d.style.cssText=l.style.cssText=f,d.style.marginRight=d.style.width="0",l.style.width="1px",b.reliableMarginRight=!parseFloat((a.getComputedStyle(d,null)||{}).marginRight)),typeof l.style.zoom!==W&&(l.innerHTML="",l.style.cssText=f+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=3===l.offsetWidth,l.style.display="block",l.innerHTML="<div></div>",l.firstChild.style.width="5px",b.shrinkWrapBlocks=3!==l.offsetWidth,b.inlineBlockNeedsLayout&&(g.style.zoom=1)),g.removeChild(c),c=l=e=d=null)}),c=f=g=h=d=e=null,b}({});var Ab=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Bb=/([A-Z])/g;kb.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?kb.cache[a[kb.expando]]:a[kb.expando],!!a&&!h(a)},data:function(a,b,c){return e(a,b,c)},removeData:function(a,b){return f(a,b)},_data:function(a,b,c){return e(a,b,c,!0)},_removeData:function(a,b){return f(a,b,!0)},acceptData:function(a){if(a.nodeType&&1!==a.nodeType&&9!==a.nodeType)return!1;var b=a.nodeName&&kb.noData[a.nodeName.toLowerCase()];return!b||b!==!0&&a.getAttribute("classid")===b}}),kb.fn.extend({data:function(a,c){var d,e,f=null,h=0,i=this[0];if(a===b){if(this.length&&(f=kb.data(i),1===i.nodeType&&!kb._data(i,"parsedAttrs"))){for(d=i.attributes;h<d.length;h++)e=d[h].name,0===e.indexOf("data-")&&(e=kb.camelCase(e.slice(5)),g(i,e,f[e]));kb._data(i,"parsedAttrs",!0)}return f}return"object"===typeof a?this.each(function(){kb.data(this,a)}):arguments.length>1?this.each(function(){kb.data(this,a,c)}):i?g(i,a,kb.data(i,a)):null},removeData:function(a){return this.each(function(){kb.removeData(this,a)})}}),kb.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=kb._data(a,b),c&&(!d||kb.isArray(c)?d=kb._data(a,b,kb.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=kb.queue(a,b),d=c.length,e=c.shift(),f=kb._queueHooks(a,b),g=function(){kb.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return kb._data(a,c)||kb._data(a,c,{empty:kb.Callbacks("once memory").add(function(){kb._removeData(a,b+"queue"),kb._removeData(a,c)})})}}),kb.fn.extend({queue:function(a,c){var d=2;return"string"!==typeof a&&(c=a,a="fx",d--),arguments.length<d?kb.queue(this[0],a):c===b?this:this.each(function(){var b=kb.queue(this,a,c);kb._queueHooks(this,a),"fx"===a&&"inprogress"!==b[0]&&kb.dequeue(this,a)})},dequeue:function(a){return this.each(function(){kb.dequeue(this,a)})},delay:function(a,b){return a=kb.fx?kb.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=kb.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};for("string"!==typeof a&&(c=a,a=b),a=a||"fx";h--;)d=kb._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var Cb,Db,Eb=/[\t\r\n\f]/g,Fb=/\r/g,Gb=/^(?:input|select|textarea|button|object)$/i,Hb=/^(?:a|area)$/i,Ib=/^(?:checked|selected)$/i,Jb=kb.support.getSetAttribute,Kb=kb.support.input;kb.fn.extend({attr:function(a,b){return kb.access(this,kb.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){kb.removeAttr(this,a)})},prop:function(a,b){return kb.access(this,kb.prop,a,b,arguments.length>1)},removeProp:function(a){return a=kb.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g=0,h=this.length,i="string"===typeof a&&a;if(kb.isFunction(a))return this.each(function(b){kb(this).addClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(mb)||[];g<h;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Eb," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");c.className=kb.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this.length,i=0===arguments.length||"string"===typeof a&&a;if(kb.isFunction(a))return this.each(function(b){kb(this).removeClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(mb)||[];g<h;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Eb," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");c.className=a?kb.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"===typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(kb.isFunction(a)?function(c){kb(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=kb(this),f=a.match(mb)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===W||"boolean"===c)&&(this.className&&kb._data(this,"__className__",this.className),this.className=this.className||a===!1?"":kb._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;c<d;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(Eb," ").indexOf(b)>=0)return!0;return!1},val:function(a){var c,d,e,f=this[0];{if(arguments.length)return e=kb.isFunction(a),this.each(function(c){var f;1===this.nodeType&&(f=e?a.call(this,c,kb(this).val()):a,null==f?f="":"number"===typeof f?f+="":kb.isArray(f)&&(f=kb.map(f,function(a){return null==a?"":a+""})),d=kb.valHooks[this.type]||kb.valHooks[this.nodeName.toLowerCase()],d&&"set"in d&&d.set(this,f,"value")!==b||(this.value=f))});if(f)return d=kb.valHooks[f.type]||kb.valHooks[f.nodeName.toLowerCase()],d&&"get"in d&&(c=d.get(f,"value"))!==b?c:(c=f.value,"string"===typeof c?c.replace(Fb,""):null==c?"":c)}}}),kb.extend({valHooks:{option:{get:function(a){var b=kb.find.attr(a,"value");return null!=b?b:a.text}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&(kb.support.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!kb.nodeName(c.parentNode,"optgroup"))){if(b=kb(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=kb.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=kb.inArray(kb(d).val(),f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}},attr:function(a,c,d){var e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return typeof a.getAttribute===W?kb.prop(a,c,d):(1===g&&kb.isXMLDoc(a)||(c=c.toLowerCase(),e=kb.attrHooks[c]||(kb.expr.match.bool.test(c)?Db:Cb)),d===b?e&&"get"in e&&null!==(f=e.get(a,c))?f:(f=kb.find.attr(a,c),null==f?b:f):null!==d?e&&"set"in e&&(f=e.set(a,d,c))!==b?f:(a.setAttribute(c,d+""),d):void kb.removeAttr(a,c))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(mb);if(f&&1===a.nodeType)for(;c=f[e++];)d=kb.propFix[c]||c,kb.expr.match.bool.test(c)?Kb&&Jb||!Ib.test(c)?a[d]=!1:a[kb.camelCase("default-"+c)]=a[d]=!1:kb.attr(a,c,""),a.removeAttribute(Jb?c:d)},attrHooks:{type:{set:function(a,b){if(!kb.support.radioValue&&"radio"===b&&kb.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h)return g=1!==h||!kb.isXMLDoc(a),g&&(c=kb.propFix[c]||c,f=kb.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]},propHooks:{tabIndex:{get:function(a){var b=kb.find.attr(a,"tabindex");return b?parseInt(b,10):Gb.test(a.nodeName)||Hb.test(a.nodeName)&&a.href?0:-1}}}}),Db={set:function(a,b,c){return b===!1?kb.removeAttr(a,c):Kb&&Jb||!Ib.test(c)?a.setAttribute(!Jb&&kb.propFix[c]||c,c):a[kb.camelCase("default-"+c)]=a[c]=!0,c}},kb.each(kb.expr.match.bool.source.match(/\w+/g),function(a,c){var d=kb.expr.attrHandle[c]||kb.find.attr;kb.expr.attrHandle[c]=Kb&&Jb||!Ib.test(c)?function(a,c,e){var f=kb.expr.attrHandle[c],g=e?b:(kb.expr.attrHandle[c]=b)!=d(a,c,e)?c.toLowerCase():null;return kb.expr.attrHandle[c]=f,g}:function(a,c,d){return d?b:a[kb.camelCase("default-"+c)]?c.toLowerCase():null}}),Kb&&Jb||(kb.attrHooks.value={set:function(a,b,c){return kb.nodeName(a,"input")?void(a.defaultValue=b):Cb&&Cb.set(a,b,c)}}),Jb||(Cb={set:function(a,c,d){var e=a.getAttributeNode(d);return e||a.setAttributeNode(e=a.ownerDocument.createAttribute(d)),e.value=c+="","value"===d||c===a.getAttribute(d)?c:b}},kb.expr.attrHandle.id=kb.expr.attrHandle.name=kb.expr.attrHandle.coords=function(a,c,d){var e;return d?b:(e=a.getAttributeNode(c))&&""!==e.value?e.value:null},kb.valHooks.button={get:function(a,c){var d=a.getAttributeNode(c);return d&&d.specified?d.value:b},set:Cb.set},kb.attrHooks.contenteditable={set:function(a,b,c){Cb.set(a,""===b?!1:b,c)}},kb.each(["width","height"],function(a,b){kb.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),kb.support.hrefNormalized||kb.each(["href","src"],function(a,b){kb.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),kb.support.style||(kb.attrHooks.style={get:function(a){return a.style.cssText||b},set:function(a,b){return a.style.cssText=b+""}}),kb.support.optSelected||(kb.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),kb.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){kb.propFix[this.toLowerCase()]=this}),kb.support.enctype||(kb.propFix.enctype="encoding"),kb.each(["radio","checkbox"],function(){kb.valHooks[this]={set:function(a,b){return kb.isArray(b)?a.checked=kb.inArray(kb(a).val(),b)>=0:void 0}},kb.support.checkOn||(kb.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var Lb=/^(?:input|select|textarea)$/i,Mb=/^key/,Nb=/^(?:mouse|contextmenu)|click/,Ob=/^(?:focusinfocus|focusoutblur)$/,Pb=/^([^.]*)(?:\.(.+)|)$/;kb.event={global:{},add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r=kb._data(a);if(r){for(d.handler&&(j=d,d=j.handler,f=j.selector),d.guid||(d.guid=kb.guid++),(h=r.events)||(h=r.events={}),(l=r.handle)||(l=r.handle=function(a){return typeof kb===W||a&&kb.event.triggered===a.type?b:kb.event.dispatch.apply(l.elem,arguments)},l.elem=a),c=(c||"").match(mb)||[""],i=c.length;i--;)g=Pb.exec(c[i])||[],o=q=g[1],p=(g[2]||"").split(".").sort(),o&&(k=kb.event.special[o]||{},o=(f?k.delegateType:k.bindType)||o,k=kb.event.special[o]||{},m=kb.extend({type:o,origType:q,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&kb.expr.match.needsContext.test(f),namespace:p.join(".")},j),(n=h[o])||(n=h[o]=[],n.delegateCount=0,k.setup&&k.setup.call(a,e,p,l)!==!1||(a.addEventListener?a.addEventListener(o,l,!1):a.attachEvent&&a.attachEvent("on"+o,l))),k.add&&(k.add.call(a,m),m.handler.guid||(m.handler.guid=d.guid)),f?n.splice(n.delegateCount++,0,m):n.push(m),kb.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=kb.hasData(a)&&kb._data(a);if(q&&(k=q.events)){for(b=(b||"").match(mb)||[""],j=b.length;j--;)if(h=Pb.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=kb.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||kb.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)kb.event.remove(a,n+b[j],c,d,!0);kb.isEmptyObject(k)&&(delete q.handle,kb._removeData(a,"events"))}},trigger:function(c,d,e,f){var g,h,i,j,k,l,m,n=[e||Y],o=ib.call(c,"type")?c.type:c,p=ib.call(c,"namespace")?c.namespace.split("."):[];if(i=l=e=e||Y,3!==e.nodeType&&8!==e.nodeType&&!Ob.test(o+kb.event.triggered)&&(o.indexOf(".")>=0&&(p=o.split("."),o=p.shift(),p.sort()),h=o.indexOf(":")<0&&"on"+o,c=c[kb.expando]?c:new kb.Event(o,"object"===typeof c&&c),c.isTrigger=f?2:3,c.namespace=p.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=b,c.target||(c.target=e),d=null==d?[c]:kb.makeArray(d,[c]),k=kb.event.special[o]||{},f||!k.trigger||k.trigger.apply(e,d)!==!1)){if(!f&&!k.noBubble&&!kb.isWindow(e)){for(j=k.delegateType||o,Ob.test(j+o)||(i=i.parentNode);i;i=i.parentNode)n.push(i),l=i;l===(e.ownerDocument||Y)&&n.push(l.defaultView||l.parentWindow||a)}for(m=0;(i=n[m++])&&!c.isPropagationStopped();)c.type=m>1?j:k.bindType||o,g=(kb._data(i,"events")||{})[c.type]&&kb._data(i,"handle"),g&&g.apply(i,d),g=h&&i[h],g&&kb.acceptData(i)&&g.apply&&g.apply(i,d)===!1&&c.preventDefault();if(c.type=o,!f&&!c.isDefaultPrevented()&&(!k._default||k._default.apply(n.pop(),d)===!1)&&kb.acceptData(e)&&h&&e[o]&&!kb.isWindow(e)){l=e[h],l&&(e[h]=null),kb.event.triggered=o;try{e[o]()}catch(q){}kb.event.triggered=b,l&&(e[h]=l)}return c.result}},dispatch:function(a){a=kb.event.fix(a);var c,d,e,f,g,h=[],i=fb.call(arguments),j=(kb._data(this,"events")||{})[a.type]||[],k=kb.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){for(h=kb.event.handlers.call(this,a,j),c=0;(f=h[c++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,g=0;(e=f.handlers[g++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,d=((kb.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),d!==b&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,c){var d,e,f,g,h=[],i=c.delegateCount,j=a.target;if(i&&j.nodeType&&(!a.button||"click"!==a.type))for(;j!=this;j=j.parentNode||this)if(1===j.nodeType&&(j.disabled!==!0||"click"!==a.type)){for(f=[],g=0;g<i;g++)e=c[g],d=e.selector+" ",f[d]===b&&(f[d]=e.needsContext?kb(d,this).index(j)>=0:kb.find(d,this,null,[j]).length),f[d]&&f.push(e);f.length&&h.push({elem:j,handlers:f})}return i<c.length&&h.push({elem:this,handlers:c.slice(i)}),h},fix:function(a){if(a[kb.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Nb.test(e)?this.mouseHooks:Mb.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new kb.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||Y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,g=c.button,h=c.fromElement;return null==a.pageX&&null!=c.clientX&&(e=a.target.ownerDocument||Y,f=e.documentElement,d=e.body,a.pageX=c.clientX+(f&&f.scrollLeft||d&&d.scrollLeft||0)-(f&&f.clientLeft||d&&d.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||d&&d.scrollTop||0)-(f&&f.clientTop||d&&d.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=h===a.target?c.toElement:h),a.which||g===b||(a.which=1&g?1:2&g?3:4&g?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==k()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===k()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return kb.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return kb.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){a.result!==b&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=kb.extend(new kb.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?kb.event.trigger(e,null,b):kb.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},kb.removeEvent=Y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===W&&(a[d]=null),a.detachEvent(d,c))},kb.Event=function(a,b){return this instanceof kb.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?i:j):this.type=a,b&&kb.extend(this,b),this.timeStamp=a&&a.timeStamp||kb.now(),void(this[kb.expando]=!0)):new kb.Event(a,b)},kb.Event.prototype={isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=i,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=i,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i,this.stopPropagation()}},kb.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){kb.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!kb.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),kb.support.submitBubbles||(kb.event.special.submit={setup:function(){return kb.nodeName(this,"form")?!1:void kb.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=kb.nodeName(c,"input")||kb.nodeName(c,"button")?c.form:b;d&&!kb._data(d,"submitBubbles")&&(kb.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),kb._data(d,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&kb.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return kb.nodeName(this,"form")?!1:void kb.event.remove(this,"._submit")}}),kb.support.changeBubbles||(kb.event.special.change={setup:function(){return Lb.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(kb.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),kb.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),kb.event.simulate("change",this,a,!0)})),!1):void kb.event.add(this,"beforeactivate._change",function(a){var b=a.target;Lb.test(b.nodeName)&&!kb._data(b,"changeBubbles")&&(kb.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||kb.event.simulate("change",this.parentNode,a,!0)}),kb._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return kb.event.remove(this,"._change"),!Lb.test(this.nodeName)}}),kb.support.focusinBubbles||kb.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){kb.event.simulate(b,a.target,kb.event.fix(a),!0)};kb.event.special[b]={setup:function(){0===c++&&Y.addEventListener(a,d,!0)},teardown:function(){0===--c&&Y.removeEventListener(a,d,!0)}}}),kb.fn.extend({on:function(a,c,d,e,f){var g,h;if("object"===typeof a){"string"!==typeof c&&(d=d||c,c=b);for(g in a)this.on(g,c,d,a[g],f);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"===typeof c?(e=d,d=b):(e=d,d=c,c=b)),e===!1)e=j;else if(!e)return this;return 1===f&&(h=e,e=function(a){return kb().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=kb.guid++)),this.each(function(){kb.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,kb(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"===typeof a){for(f in a)this.off(f,c,a[f]);return this}return(c===!1||"function"===typeof c)&&(d=c,c=b),d===!1&&(d=j),this.each(function(){kb.event.remove(this,a,d,c)})},trigger:function(a,b){return this.each(function(){kb.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?kb.event.trigger(a,b,c,!0):void 0}});var Qb=/^.[^:#\[\.,]*$/,Rb=/^(?:parents|prev(?:Until|All))/,Sb=kb.expr.match.needsContext,Tb={children:!0,contents:!0,next:!0,prev:!0};kb.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!==typeof a)return this.pushStack(kb(a).filter(function(){for(b=0;b<e;b++)if(kb.contains(d[b],this))return!0}));for(b=0;b<e;b++)kb.find(a,d[b],c);return c=this.pushStack(e>1?kb.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},has:function(a){var b,c=kb(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(kb.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(m(this,a||[],!0))},filter:function(a){return this.pushStack(m(this,a||[],!1))},is:function(a){return!!m(this,"string"===typeof a&&Sb.test(a)?kb(a):a||[],!1).length},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=Sb.test(a)||"string"!==typeof a?kb(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&kb.find.matchesSelector(c,a))){c=f.push(c);break}return this.pushStack(f.length>1?kb.unique(f):f)},index:function(a){return a?"string"===typeof a?kb.inArray(this[0],kb(a)):kb.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1
},add:function(a,b){var c="string"===typeof a?kb(a,b):kb.makeArray(a&&a.nodeType?[a]:a),d=kb.merge(this.get(),c);return this.pushStack(kb.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),kb.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return kb.dir(a,"parentNode")},parentsUntil:function(a,b,c){return kb.dir(a,"parentNode",c)},next:function(a){return l(a,"nextSibling")},prev:function(a){return l(a,"previousSibling")},nextAll:function(a){return kb.dir(a,"nextSibling")},prevAll:function(a){return kb.dir(a,"previousSibling")},nextUntil:function(a,b,c){return kb.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return kb.dir(a,"previousSibling",c)},siblings:function(a){return kb.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return kb.sibling(a.firstChild)},contents:function(a){return kb.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:kb.merge([],a.childNodes)}},function(a,b){kb.fn[a]=function(c,d){var e=kb.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"===typeof d&&(e=kb.filter(d,e)),this.length>1&&(Tb[a]||(e=kb.unique(e)),Rb.test(a)&&(e=e.reverse())),this.pushStack(e)}}),kb.extend({filter:function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?kb.find.matchesSelector(d,a)?[d]:[]:kb.find.matches(a,kb.grep(b,function(a){return 1===a.nodeType}))},dir:function(a,c,d){for(var e=[],f=a[c];f&&9!==f.nodeType&&(d===b||1!==f.nodeType||!kb(f).is(d));)1===f.nodeType&&e.push(f),f=f[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Ub="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Vb=/ jQuery\d+="(?:null|\d+)"/g,Wb=new RegExp("<(?:"+Ub+")[\\s/>]","i"),Xb=/^\s+/,Yb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Zb=/<([\w:]+)/,$b=/<tbody/i,_b=/<|&#?\w+;/,ac=/<(?:script|style|link)/i,bc=/^(?:checkbox|radio)$/i,cc=/checked\s*(?:[^=]|=\s*.checked.)/i,dc=/^$|\/(?:java|ecma)script/i,ec=/^true\/(.*)/,fc=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,gc={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:kb.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},hc=n(Y),ic=hc.appendChild(Y.createElement("div"));gc.optgroup=gc.option,gc.tbody=gc.tfoot=gc.colgroup=gc.caption=gc.thead,gc.th=gc.td,kb.fn.extend({text:function(a){return kb.access(this,function(a){return a===b?kb.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=o(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=o(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?kb.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||kb.cleanData(u(c)),c.parentNode&&(b&&kb.contains(c.ownerDocument,c)&&r(u(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&kb.cleanData(u(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&kb.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return kb.clone(this,a,b)})},html:function(a){return kb.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(Vb,""):b;if("string"===typeof a&&!ac.test(a)&&(kb.support.htmlSerialize||!Wb.test(a))&&(kb.support.leadingWhitespace||!Xb.test(a))&&!gc[(Zb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Yb,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},1===c.nodeType&&(kb.cleanData(u(c,!1)),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=kb.map(this,function(a){return[a.nextSibling,a.parentNode]}),b=0;return this.domManip(arguments,function(c){var d=a[b++],e=a[b++];e&&(d&&d.parentNode!==e&&(d=this.nextSibling),kb(this).remove(),e.insertBefore(c,d))},!0),b?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,c){a=db.apply([],a);var d,e,f,g,h,i,j=0,k=this.length,l=this,m=k-1,n=a[0],o=kb.isFunction(n);if(o||!(k<=1||"string"!==typeof n||kb.support.checkClone)&&cc.test(n))return this.each(function(d){var e=l.eq(d);o&&(a[0]=n.call(this,d,e.html())),e.domManip(a,b,c)});if(k&&(i=kb.buildFragment(a,this[0].ownerDocument,!1,!c&&this),d=i.firstChild,1===i.childNodes.length&&(i=d),d)){for(g=kb.map(u(i,"script"),p),f=g.length;j<k;j++)e=i,j!==m&&(e=kb.clone(e,!0,!0),f&&kb.merge(g,u(e,"script"))),b.call(this[j],e,j);if(f)for(h=g[g.length-1].ownerDocument,kb.map(g,q),j=0;j<f;j++)e=g[j],dc.test(e.type||"")&&!kb._data(e,"globalEval")&&kb.contains(h,e)&&(e.src?kb._evalUrl(e.src):kb.globalEval((e.text||e.textContent||e.innerHTML||"").replace(fc,"")));i=d=null}return this}}),kb.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){kb.fn[a]=function(a){for(var c,d=0,e=[],f=kb(a),g=f.length-1;d<=g;d++)c=d===g?this:this.clone(!0),kb(f[d])[b](c),eb.apply(e,c.get());return this.pushStack(e)}}),kb.extend({clone:function(a,b,c){var d,e,f,g,h,i=kb.contains(a.ownerDocument,a);if(kb.support.html5Clone||kb.isXMLDoc(a)||!Wb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ic.innerHTML=a.outerHTML,ic.removeChild(f=ic.firstChild)),(!kb.support.noCloneEvent||!kb.support.noCloneChecked)&&(1===a.nodeType||11===a.nodeType)&&!kb.isXMLDoc(a))for(d=u(f),h=u(a),g=0;null!=(e=h[g]);++g)d[g]&&t(e,d[g]);if(b)if(c)for(h=h||u(a),d=d||u(f),g=0;null!=(e=h[g]);g++)s(e,d[g]);else s(a,f);return d=u(f,"script"),d.length>0&&r(d,!i&&u(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,l=a.length,m=n(b),o=[],p=0;p<l;p++)if(f=a[p],f||0===f)if("object"===kb.type(f))kb.merge(o,f.nodeType?[f]:f);else if(_b.test(f)){for(h=h||m.appendChild(b.createElement("div")),i=(Zb.exec(f)||["",""])[1].toLowerCase(),k=gc[i]||gc._default,h.innerHTML=k[1]+f.replace(Yb,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!kb.support.leadingWhitespace&&Xb.test(f)&&o.push(b.createTextNode(Xb.exec(f)[0])),!kb.support.tbody)for(f="table"!==i||$b.test(f)?"<table>"!==k[1]||$b.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;e--;)kb.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(kb.merge(o,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=m.lastChild}else o.push(b.createTextNode(f));for(h&&m.removeChild(h),kb.support.appendChecked||kb.grep(u(o,"input"),v),p=0;f=o[p++];)if((!d||-1===kb.inArray(f,d))&&(g=kb.contains(f.ownerDocument,f),h=u(m.appendChild(f),"script"),g&&r(h),c))for(e=0;f=h[e++];)dc.test(f.type||"")&&c.push(f);return h=null,m},cleanData:function(a,b){for(var c,d,e,f,g=0,h=kb.expando,i=kb.cache,j=kb.support.deleteExpando,k=kb.event.special;null!=(c=a[g]);g++)if((b||kb.acceptData(c))&&(e=c[h],f=e&&i[e])){if(f.events)for(d in f.events)k[d]?kb.event.remove(c,d):kb.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==W?c.removeAttribute(h):c[h]=null,bb.push(e))}},_evalUrl:function(a){return kb.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),kb.fn.extend({wrapAll:function(a){if(kb.isFunction(a))return this.each(function(b){kb(this).wrapAll(a.call(this,b))});if(this[0]){var b=kb(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(kb.isFunction(a)?function(b){kb(this).wrapInner(a.call(this,b))}:function(){var b=kb(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=kb.isFunction(a);return this.each(function(c){kb(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){kb.nodeName(this,"body")||kb(this).replaceWith(this.childNodes)}).end()}});var jc,kc,lc,mc=/alpha\([^)]*\)/i,nc=/opacity\s*=\s*([^)]*)/,oc=/^(top|right|bottom|left)$/,pc=/^(none|table(?!-c[ea]).+)/,qc=/^margin/,rc=new RegExp("^("+lb+")(.*)$","i"),sc=new RegExp("^("+lb+")(?!px)[a-z%]+$","i"),tc=new RegExp("^([+-])=("+lb+")","i"),uc={BODY:"block"},vc={position:"absolute",visibility:"hidden",display:"block"},wc={letterSpacing:0,fontWeight:400},xc=["Top","Right","Bottom","Left"],yc=["Webkit","O","Moz","ms"];kb.fn.extend({css:function(a,c){return kb.access(this,function(a,c,d){var e,f,g={},h=0;if(kb.isArray(c)){for(f=kc(a),e=c.length;h<e;h++)g[c[h]]=kb.css(a,c[h],!1,f);return g}return d!==b?kb.style(a,c,d):kb.css(a,c)},a,c,arguments.length>1)},show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(a){return"boolean"===typeof a?a?this.show():this.hide():this.each(function(){x(this)?kb(this).show():kb(this).hide()})}}),kb.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=lc(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":kb.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,i=kb.camelCase(c),j=a.style;if(c=kb.cssProps[i]||(kb.cssProps[i]=w(j,i)),h=kb.cssHooks[c]||kb.cssHooks[i],d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];if(g=typeof d,"string"===g&&(f=tc.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(kb.css(a,c)),g="number"),!(null==d||"number"===g&&isNaN(d))&&("number"!==g||kb.cssNumber[i]||(d+="px"),kb.support.clearCloneStyle||""!==d||0!==c.indexOf("background")||(j[c]="inherit"),!h||!("set"in h)||(d=h.set(a,d,e))!==b))try{j[c]=d}catch(k){}}},css:function(a,c,d,e){var f,g,h,i=kb.camelCase(c);return c=kb.cssProps[i]||(kb.cssProps[i]=w(a.style,i)),h=kb.cssHooks[c]||kb.cssHooks[i],h&&"get"in h&&(g=h.get(a,!0,d)),g===b&&(g=lc(a,c,e)),"normal"===g&&c in wc&&(g=wc[c]),""===d||d?(f=parseFloat(g),d===!0||kb.isNumeric(f)?f||0:g):g}}),a.getComputedStyle?(kc=function(b){return a.getComputedStyle(b,null)},lc=function(a,c,d){var e,f,g,h=d||kc(a),i=h?h.getPropertyValue(c)||h[c]:b,j=a.style;return h&&(""!==i||kb.contains(a.ownerDocument,a)||(i=kb.style(a,c)),sc.test(i)&&qc.test(c)&&(e=j.width,f=j.minWidth,g=j.maxWidth,j.minWidth=j.maxWidth=j.width=i,i=h.width,j.width=e,j.minWidth=f,j.maxWidth=g)),i}):Y.documentElement.currentStyle&&(kc=function(a){return a.currentStyle},lc=function(a,c,d){var e,f,g,h=d||kc(a),i=h?h[c]:b,j=a.style;return null==i&&j&&j[c]&&(i=j[c]),sc.test(i)&&!oc.test(c)&&(e=j.left,f=a.runtimeStyle,g=f&&f.left,g&&(f.left=a.currentStyle.left),j.left="fontSize"===c?"1em":i,i=j.pixelLeft+"px",j.left=e,g&&(f.left=g)),""===i?"auto":i}),kb.each(["height","width"],function(a,b){kb.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&pc.test(kb.css(a,"display"))?kb.swap(a,vc,function(){return B(a,b,d)}):B(a,b,d):void 0},set:function(a,c,d){var e=d&&kc(a);return z(a,c,d?A(a,b,d,kb.support.boxSizing&&"border-box"===kb.css(a,"boxSizing",!1,e),e):0)}}}),kb.support.opacity||(kb.cssHooks.opacity={get:function(a,b){return nc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=kb.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===kb.trim(f.replace(mc,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=mc.test(f)?f.replace(mc,e):f+" "+e)}}),kb(function(){kb.support.reliableMarginRight||(kb.cssHooks.marginRight={get:function(a,b){return b?kb.swap(a,{display:"inline-block"},lc,[a,"marginRight"]):void 0}}),!kb.support.pixelPosition&&kb.fn.position&&kb.each(["top","left"],function(a,b){kb.cssHooks[b]={get:function(a,c){return c?(c=lc(a,b),sc.test(c)?kb(a).position()[b]+"px":c):void 0}}})}),kb.expr&&kb.expr.filters&&(kb.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!kb.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||kb.css(a,"display"))},kb.expr.filters.visible=function(a){return!kb.expr.filters.hidden(a)}),kb.each({margin:"",padding:"",border:"Width"},function(a,b){kb.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"===typeof c?c.split(" "):[c];d<4;d++)e[a+xc[d]+b]=f[d]||f[d-2]||f[0];return e}},qc.test(a)||(kb.cssHooks[a+b].set=z)});var zc=/%20/g,Ac=/\[\]$/,Bc=/\r?\n/g,Cc=/^(?:submit|button|image|reset|file)$/i,Dc=/^(?:input|select|textarea|keygen)/i;kb.fn.extend({serialize:function(){return kb.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=kb.prop(this,"elements");return a?kb.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!kb(this).is(":disabled")&&Dc.test(this.nodeName)&&!Cc.test(a)&&(this.checked||!bc.test(a))}).map(function(a,b){var c=kb(this).val();return null==c?null:kb.isArray(c)?kb.map(c,function(a){return{name:b.name,value:a.replace(Bc,"\r\n")}}):{name:b.name,value:c.replace(Bc,"\r\n")}}).get()}}),kb.param=function(a,c){var d,e=[],f=function(a,b){b=kb.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=kb.ajaxSettings&&kb.ajaxSettings.traditional),kb.isArray(a)||a.jquery&&!kb.isPlainObject(a))kb.each(a,function(){f(this.name,this.value)});else for(d in a)E(d,a[d],c,f);return e.join("&").replace(zc,"+")},kb.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){kb.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),kb.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var Ec,Fc,Gc=kb.now(),Hc=/\?/,Ic=/#.*$/,Jc=/([?&])_=[^&]*/,Kc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Lc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mc=/^(?:GET|HEAD)$/,Nc=/^\/\//,Oc=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Pc=kb.fn.load,Qc={},Rc={},Sc="*/".concat("*");try{Fc=X.href}catch(Tc){Fc=Y.createElement("a"),Fc.href="",Fc=Fc.href}Ec=Oc.exec(Fc.toLowerCase())||[],kb.fn.load=function(a,c,d){if("string"!==typeof a&&Pc)return Pc.apply(this,arguments);var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),kb.isFunction(c)?(d=c,c=b):c&&"object"===typeof c&&(g="POST"),h.length>0&&kb.ajax({url:a,type:g,dataType:"html",data:c}).done(function(a){f=arguments,h.html(e?kb("<div>").append(kb.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){h.each(d,f||[a.responseText,b,a])}),this},kb.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){kb.fn[b]=function(a){return this.on(b,a)}}),kb.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Fc,type:"GET",isLocal:Lc.test(Ec[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Sc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":kb.parseJSON,"text xml":kb.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?H(H(a,kb.ajaxSettings),b):H(kb.ajaxSettings,a)},ajaxPrefilter:F(Qc),ajaxTransport:F(Rc),ajax:function(a,c){function d(a,c,d,e){var f,l,s,t,v,x=c;2!==u&&(u=2,i&&clearTimeout(i),k=b,h=e||"",w.readyState=a>0?4:0,f=a>=200&&a<300||304===a,d&&(t=I(m,w,d)),t=J(m,t,w,f),f?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(kb.lastModified[g]=v),v=w.getResponseHeader("etag"),v&&(kb.etag[g]=v)),204===a||"HEAD"===m.type?x="nocontent":304===a?x="notmodified":(x=t.state,l=t.data,s=t.error,f=!s)):(s=x,(a||!x)&&(x="error",a<0&&(a=0))),w.status=a,w.statusText=(c||x)+"",f?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=b,j&&o.trigger(f?"ajaxSuccess":"ajaxError",[w,m,f?l:s]),q.fireWith(n,[w,x]),j&&(o.trigger("ajaxComplete",[w,m]),--kb.active||kb.event.trigger("ajaxStop")))}"object"===typeof a&&(c=a,a=b),c=c||{};var e,f,g,h,i,j,k,l,m=kb.ajaxSetup({},c),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?kb(n):kb.event,p=kb.Deferred(),q=kb.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!l)for(l={};b=Kc.exec(h);)l[b[1].toLowerCase()]=b[2];b=l[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?h:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(u<2)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){var b=a||v;return k&&k.abort(b),d(0,b),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||Fc)+"").replace(Ic,"").replace(Nc,Ec[1]+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=kb.trim(m.dataType||"*").toLowerCase().match(mb)||[""],null==m.crossDomain&&(e=Oc.exec(m.url.toLowerCase()),m.crossDomain=!(!e||e[1]===Ec[1]&&e[2]===Ec[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(Ec[3]||("http:"===Ec[1]?"80":"443")))),m.data&&m.processData&&"string"!==typeof m.data&&(m.data=kb.param(m.data,m.traditional)),G(Qc,m,c,w),2===u)return w;j=m.global,j&&0===kb.active++&&kb.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Mc.test(m.type),g=m.url,m.hasContent||(m.data&&(g=m.url+=(Hc.test(g)?"&":"?")+m.data,delete m.data),m.cache===!1&&(m.url=Jc.test(g)?g.replace(Jc,"$1_="+Gc++):g+(Hc.test(g)?"&":"?")+"_="+Gc++)),m.ifModified&&(kb.lastModified[g]&&w.setRequestHeader("If-Modified-Since",kb.lastModified[g]),kb.etag[g]&&w.setRequestHeader("If-None-Match",kb.etag[g])),(m.data&&m.hasContent&&m.contentType!==!1||c.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Sc+"; q=0.01":""):m.accepts["*"]);for(f in m.headers)w.setRequestHeader(f,m.headers[f]);if(m.beforeSend&&(m.beforeSend.call(n,w,m)===!1||2===u))return w.abort();v="abort";for(f in{success:1,error:1,complete:1})w[f](m[f]);if(k=G(Rc,m,c,w)){w.readyState=1,j&&o.trigger("ajaxSend",[w,m]),m.async&&m.timeout>0&&(i=setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,k.send(s,d)}catch(x){if(!(u<2))throw x;d(-1,x)}}else d(-1,"No Transport");return w},getJSON:function(a,b,c){return kb.get(a,b,c,"json")},getScript:function(a,c){return kb.get(a,b,c,"script")}}),kb.each(["get","post"],function(a,c){kb[c]=function(a,d,e,f){return kb.isFunction(d)&&(f=f||e,e=d,d=b),kb.ajax({url:a,type:c,dataType:f,data:d,success:e})}}),kb.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return kb.globalEval(a),a}}}),kb.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),kb.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=Y.head||kb("head")[0]||Y.documentElement;return{send:function(b,e){c=Y.createElement("script"),c.async=!0,a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,b){(b||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,c.parentNode&&c.parentNode.removeChild(c),c=null,b||e(200,"success"))},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(b,!0)}}}});var Uc=[],Vc=/(=)\?(?=&|$)|\?\?/;kb.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Uc.pop()||kb.expando+"_"+Gc++;return this[a]=!0,a}}),kb.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.jsonp!==!1&&(Vc.test(c.url)?"url":"string"===typeof c.data&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vc.test(c.data)&&"data");return i||"jsonp"===c.dataTypes[0]?(f=c.jsonpCallback=kb.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,i?c[i]=c[i].replace(Vc,"$1"+f):c.jsonp!==!1&&(c.url+=(Hc.test(c.url)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||kb.error(f+" was not called"),h[0]},c.dataTypes[0]="json",g=a[f],a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,Uc.push(f)),h&&kb.isFunction(g)&&g(h[0]),h=g=b}),"script"):void 0});var Wc,Xc,Yc=0,Zc=a.ActiveXObject&&function(){var a;for(a in Wc)Wc[a](b,!0)};kb.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&K()||L()}:K,Xc=kb.ajaxSettings.xhr(),kb.support.cors=!!Xc&&"withCredentials"in Xc,Xc=kb.support.ajax=!!Xc,Xc&&kb.ajaxTransport(function(c){if(!c.crossDomain||kb.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();if(c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async),c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l;try{if(d&&(e||4===i.readyState))if(d=b,g&&(i.onreadystatechange=kb.noop,Zc&&delete Wc[g]),e)4!==i.readyState&&i.abort();else{l={},h=i.status,j=i.getAllResponseHeaders(),"string"===typeof i.responseText&&(l.text=i.responseText);try{k=i.statusText}catch(m){k=""}h||!c.isLocal||c.crossDomain?1223===h&&(h=204):h=l.text?200:404}}catch(n){e||f(-1,n)}l&&f(h,k,l,j)},c.async?4===i.readyState?setTimeout(d):(g=++Yc,Zc&&(Wc||(Wc={},kb(a).unload(Zc)),Wc[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(b,!0)}}}});var $c,_c,ad=/^(?:toggle|show|hide)$/,bd=new RegExp("^(?:([+-])=|)("+lb+")([a-z%]*)$","i"),cd=/queueHooks$/,dd=[Q],ed={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bd.exec(b),f=e&&e[3]||(kb.cssNumber[a]?"":"px"),g=(kb.cssNumber[a]||"px"!==f&&+d)&&bd.exec(kb.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,kb.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};kb.Animation=kb.extend(O,{tweener:function(a,b){kb.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],ed[c]=ed[c]||[],ed[c].unshift(b)},prefilter:function(a,b){b?dd.unshift(a):dd.push(a)}}),kb.Tween=R,R.prototype={constructor:R,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(kb.cssNumber[c]?"":"px")},cur:function(){var a=R.propHooks[this.prop];return a&&a.get?a.get(this):R.propHooks._default.get(this)},run:function(a){var b,c=R.propHooks[this.prop];return this.pos=b=this.options.duration?kb.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):R.propHooks._default.set(this),this}},R.prototype.init.prototype=R.prototype,R.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=kb.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){kb.fx.step[a.prop]?kb.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[kb.cssProps[a.prop]]||kb.cssHooks[a.prop])?kb.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},R.propHooks.scrollTop=R.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},kb.each(["toggle","show","hide"],function(a,b){var c=kb.fn[b];kb.fn[b]=function(a,d,e){return null==a||"boolean"===typeof a?c.apply(this,arguments):this.animate(S(b,!0),a,d,e)}}),kb.fn.extend({fadeTo:function(a,b,c,d){return this.filter(x).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=kb.isEmptyObject(a),f=kb.speed(b,c,d),g=function(){var b=O(this,kb.extend({},a),f);(e||kb._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return"string"!==typeof a&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=kb.timers,g=kb._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&cd.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&kb.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=kb._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=kb.timers,g=d?d.length:0;for(c.finish=!0,kb.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),kb.each({slideDown:S("show"),slideUp:S("hide"),slideToggle:S("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){kb.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),kb.speed=function(a,b,c){var d=a&&"object"===typeof a?kb.extend({},a):{complete:c||!c&&b||kb.isFunction(a)&&a,duration:a,easing:c&&b||b&&!kb.isFunction(b)&&b};return d.duration=kb.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in kb.fx.speeds?kb.fx.speeds[d.duration]:kb.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){kb.isFunction(d.old)&&d.old.call(this),d.queue&&kb.dequeue(this,d.queue)},d},kb.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},kb.timers=[],kb.fx=R.prototype.init,kb.fx.tick=function(){var a,c=kb.timers,d=0;for($c=kb.now();d<c.length;d++)a=c[d],a()||c[d]!==a||c.splice(d--,1);c.length||kb.fx.stop(),$c=b},kb.fx.timer=function(a){a()&&kb.timers.push(a)&&kb.fx.start()},kb.fx.interval=13,kb.fx.start=function(){_c||(_c=setInterval(kb.fx.tick,kb.fx.interval))},kb.fx.stop=function(){clearInterval(_c),_c=null},kb.fx.speeds={slow:600,fast:200,_default:400},kb.fx.step={},kb.expr&&kb.expr.filters&&(kb.expr.filters.animated=function(a){return kb.grep(kb.timers,function(b){return a===b.elem}).length}),kb.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){kb.offset.setOffset(this,a,b)});var c,d,e={top:0,left:0},f=this[0],g=f&&f.ownerDocument;if(g)return c=g.documentElement,kb.contains(c,f)?(typeof f.getBoundingClientRect!==W&&(e=f.getBoundingClientRect()),d=T(g),{top:e.top+(d.pageYOffset||c.scrollTop)-(c.clientTop||0),left:e.left+(d.pageXOffset||c.scrollLeft)-(c.clientLeft||0)}):e},kb.offset={setOffset:function(a,b,c){var d=kb.css(a,"position");"static"===d&&(a.style.position="relative");var e,f,g=kb(a),h=g.offset(),i=kb.css(a,"top"),j=kb.css(a,"left"),k=("absolute"===d||"fixed"===d)&&kb.inArray("auto",[i,j])>-1,l={},m={};k?(m=g.position(),e=m.top,f=m.left):(e=parseFloat(i)||0,f=parseFloat(j)||0),kb.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(l.top=b.top-h.top+e),null!=b.left&&(l.left=b.left-h.left+f),"using"in b?b.using.call(a,l):g.css(l)}},kb.fn.extend({position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===kb.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),kb.nodeName(a[0],"html")||(c=a.offset()),c.top+=kb.css(a[0],"borderTopWidth",!0),c.left+=kb.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-kb.css(d,"marginTop",!0),left:b.left-c.left-kb.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Z;a&&!kb.nodeName(a,"html")&&"static"===kb.css(a,"position");)a=a.offsetParent;return a||Z})}}),kb.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);kb.fn[a]=function(e){return kb.access(this,function(a,e,f){var g=T(a);return f===b?g?c in g?g[c]:g.document.documentElement[e]:a[e]:void(g?g.scrollTo(d?kb(g).scrollLeft():f,d?f:kb(g).scrollTop()):a[e]=f)},a,e,arguments.length,null)}}),kb.each({Height:"height",Width:"width"},function(a,c){kb.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){kb.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!==typeof e),h=d||(e===!0||f===!0?"margin":"border");return kb.access(this,function(c,d,e){var f;return kb.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?kb.css(c,d,h):kb.style(c,d,e,h)},c,g?e:b,g,null)}})}),kb.fn.size=function(){return this.length},kb.fn.andSelf=kb.fn.addBack,"object"===typeof module&&module&&"object"===typeof module.exports?module.exports=kb:(a.jQuery=a.$=kb,"function"===typeof define&&define.amd&&define("jquery",[],function(){return kb}))}(window),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.4.3";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)
},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(x.isFunction(b)?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b){return x.isEmpty(b)?[]:x.filter(a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(b||x.identity);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;f<g;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return y(a,function(a){x.isArray(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(i.apply(d,arguments))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b),d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=c<0?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;d<e;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);e<d;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.bindAll=function(a){var b=h.call(arguments,1);return 0==b.length&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,j<=0?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},x.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a<=0?b():function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;c.push(a),d.push(b);var g=0,h=!0;if("[object Array]"==e){if(g=a.length,h=g==b.length)for(;g--&&(h=F(a[g],b[g],c,d)););}else{var i=a.constructor,k=b.constructor;if(i!==k&&!(x.isFunction(i)&&i instanceof i&&x.isFunction(k)&&k instanceof k))return!1;for(var l in a)if(x.has(a,l)&&(g++,!(h=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(h){for(l in b)if(x.has(b,l)&&!g--)break;h=!g}}return c.pop(),d.pop(),h};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!==typeof/./&&(x.isFunction=function(a){return"function"===typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(a),e=0;e<a;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+(0|Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return null;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=""+ ++I;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){c=x.defaults({},c,x.templateSettings);var d=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(L,function(a){return"\\"+K[a]}),c&&(f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(f+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),g&&(f+="';\n"+g+"\n__p+='"),e=h+b.length,b}),f+="';\n",c.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(c.variable||"obj","_",f)}catch(h){throw h.source=f,h}if(b)return g(b,x);var i=function(a){return g.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+f+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){{var a,b=this,c=b.Backbone,d=[],e=(d.push,d.slice);d.splice}a="undefined"!==typeof exports?exports:b.Backbone={},a.VERSION="1.1.0";var f=b._;f||"undefined"===typeof require||(f=require("underscore")),a.$=b.jQuery||b.Zepto||b.ender||b.$,a.noConflict=function(){return b.Backbone=c,this},a.emulateHTTP=!1,a.emulateJSON=!1;var g=a.Events={on:function(a,b,c){if(!i(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!i(this,"once",a,[b,c])||!b)return this;var d=this,e=f.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,g,h,j,k,l,m;if(!this._events||!i(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(h=a?[a]:f.keys(this._events),j=0,k=h.length;j<k;j++)if(a=h[j],g=this._events[a]){if(this._events[a]=d=[],b||c)for(l=0,m=g.length;l<m;l++)e=g[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=e.call(arguments,1);if(!i(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&j(c,b),d&&j(d,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!==typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var g in d)a=d[g],a.off(b,c,this),(e||f.isEmpty(a._events))&&delete this._listeningTo[g];return this}},h=/\s+/,i=function(a,b,c,d){if(!c)return!0;if("object"===typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(h.test(c)){for(var f=c.split(h),g=0,i=f.length;g<i;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},j=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},k={listenTo:"on",listenToOnce:"once"};f.each(k,function(a,b){g[b]=function(b,c,d){var e=this._listeningTo||(this._listeningTo={}),g=b._listenId||(b._listenId=f.uniqueId("l"));return e[g]=b,d||"object"!==typeof c||(d=this),b[a](c,d,this),this}}),g.bind=g.on,g.unbind=g.off,f.extend(a,g);var l=a.Model=function(a,b){var c=a||{};b||(b={}),this.cid=f.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(c=this.parse(c,b)||{}),c=f.defaults({},c,f.result(this,"defaults")),this.set(c,b),this.changed={},this.initialize.apply(this,arguments)};f.extend(l.prototype,g,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return f.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,g,h,i,j,k,l;if(null==a)return this;if("object"===typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),!this._validate(e,c))return!1;g=c.unset,i=c.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=f.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],f.isEqual(l[d],b)||h.push(d),f.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,g?delete l[d]:l[d]=b;if(!i){h.length&&(this._pending=!0);for(var m=0,n=h.length;m<n;m++)this.trigger("change:"+h[m],this,l[h[m]],c)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,f.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,f.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)f.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return f.clone(this._previousAttributes)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){return b.set(b.parse(d,a),a)?(c&&c(b,d,a),void b.trigger("sync",b,d,a)):!1},K(this,a),this.sync("read",this,a)},save:function(a,b,c){var d,e,g,h=this.attributes;if(null==a||"object"===typeof a?(d=a,c=b):(d={})[a]=b,c=f.extend({validate:!0},c),d&&!c.wait){if(!this.set(d,c))return!1}else if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=f.extend({},h,d)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=h;var b=i.parse(a,c);return c.wait&&(b=f.extend(d||{},b)),f.isObject(b)&&!i.set(b,c)?!1:(j&&j(i,a,c),void i.trigger("sync",i,a,c))},K(this,c),e=this.isNew()?"create":c.patch?"patch":"update","patch"===e&&(c.attrs=d),g=this.sync(e,this,c),d&&c.wait&&(this.attributes=h),g},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},this.isNew())return a.success(),!1;K(this,a);var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=f.result(this,"urlRoot")||f.result(this.collection,"url")||J();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},f.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,f.extend(b,{validationError:c})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];f.each(m,function(a){l.prototype[a]=function(){var b=e.call(arguments);return b.unshift(this.attributes),f[a].apply(f,b)}});var n=a.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,f.extend({silent:!0},b))},o={add:!0,remove:!0,merge:!0},p={add:!0,remove:!1};f.extend(n.prototype,g,{model:l,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return a.sync.apply(this,arguments)},add:function(a,b){return this.set(a,f.extend({merge:!1},b,p))},remove:function(a,b){var c=!f.isArray(a);a=c?[a]:f.clone(a),b||(b={});var d,e,g,h;for(d=0,e=a.length;d<e;d++)h=a[d]=this.get(a[d]),h&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h));return c?a[0]:a},set:function(a,b){b=f.defaults({},b,o),b.parse&&(a=this.parse(a,b));var c=!f.isArray(a);a=c?a?[a]:[]:f.clone(a);var d,e,g,h,i,j,k,m=b.at,n=this.model,p=this.comparator&&null==m&&b.sort!==!1,q=f.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!p&&u&&w?[]:!1;for(d=0,e=a.length;d<e;d++){if(i=a[d],g=i instanceof l?h=i:i[n.prototype.idAttribute],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),p&&!k&&j.hasChanged(q)&&(k=!0)),a[d]=j;else if(u){if(h=a[d]=this._prepareModel(i,b),!h)continue;r.push(h),h.on("all",this._onModelEvent,this),this._byId[h.cid]=h,null!=h.id&&(this._byId[h.id]=h)}x&&x.push(j||h)}if(w){for(d=0,e=this.length;d<e;++d)t[(h=this.models[d]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(p&&(k=!0),this.length+=r.length,null!=m)for(d=0,e=r.length;d<e;d++)this.models.splice(m+d,0,r[d]);else{x&&(this.models.length=0);var y=x||r;for(d=0,e=y.length;d<e;d++)this.models.push(y[d])}if(k&&this.sort({silent:!0}),!b.silent){for(d=0,e=r.length;d<e;d++)(h=r[d]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return c?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),a=this.add(a,f.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,f.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,f.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return e.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a.id]||this._byId[a.cid]||this._byId[a]},at:function(a){return this.models[a]},where:function(a,b){return f.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),f.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(f.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return f.invoke(this.models,"get",a)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},K(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?f.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof l)return a.collection||(a.collection=this),a;b=b?f.clone(b):{},b.collection=this;var c=new this.model(a,b);return c.validationError?(this.trigger("invalid",this,c.validationError,b),!1):c},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var q=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];f.each(q,function(a){n.prototype[a]=function(){var b=e.call(arguments);return b.unshift(this.models),f[a].apply(f,b)}});var r=["groupBy","countBy","sortBy"];f.each(r,function(a){n.prototype[a]=function(b,c){var d=f.isFunction(b)?b:function(a){return a.get(b)};return f[a](this.models,d,c)}});var s=a.View=function(a){this.cid=f.uniqueId("view"),a||(a={}),f.extend(this,f.pick(a,u)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},t=/^(\S+)\s*(.*)$/,u=["model","collection","el","id","attributes","className","tagName","events"];f.extend(s.prototype,g,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(b,c){return this.$el&&this.undelegateEvents(),this.$el=b instanceof a.$?b:a.$(b),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=f.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(f.isFunction(c)||(c=this[a[b]]),c){var d=b.match(t),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,""===g?this.$el.on(e,c):this.$el.on(e,g,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(f.result(this,"el"),!1);else{var b=f.extend({},f.result(this,"attributes"));this.id&&(b.id=f.result(this,"id")),this.className&&(b["class"]=f.result(this,"className"));var c=a.$("<"+f.result(this,"tagName")+">").attr(b);this.setElement(c,!1)}}}),a.sync=function(b,c,d){var e=w[b];f.defaults(d||(d={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var g={type:e,dataType:"json"};if(d.url||(g.url=f.result(c,"url")||J()),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(g.contentType="application/json",g.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){g.type="POST",d.emulateJSON&&(g.data._method=e);var h=d.beforeSend;d.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",e),h?h.apply(this,arguments):void 0}}"GET"===g.type||d.emulateJSON||(g.processData=!1),"PATCH"===g.type&&v&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=d.xhr=a.ajax(f.extend(g,d));return c.trigger("request",c,i,d),i};var v="undefined"!==typeof window&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var x=a.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,z=/(\(\?)?:\w+/g,A=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;f.extend(x.prototype,g,{initialize:function(){},route:function(b,c,d){f.isRegExp(b)||(b=this._routeToRegExp(b)),f.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return a.history.route(b,function(f){var g=e._extractParameters(b,f);d&&d.apply(e,g),e.trigger.apply(e,["route:"+c].concat(g)),e.trigger("route",c,g),a.history.trigger("route",e,c,g)}),this},navigate:function(b,c){return a.history.navigate(b,c),this},_bindRoutes:function(){if(this.routes){this.routes=f.result(this,"routes");for(var a,b=f.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(B,"\\$&").replace(y,"(?:$1)?").replace(z,function(a,b){return b?a:"([^/]+)"}).replace(A,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return f.map(c,function(a){return a?decodeURIComponent(a):null})}});var C=a.History=function(){this.handlers=[],f.bindAll(this,"checkUrl"),"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,F=/msie [\w.]+/,G=/\/$/,H=/[?#].*$/;C.started=!1,f.extend(C.prototype,g,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(G,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(D,"")},start:function(b){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=f.extend({root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var c=this.getFragment(),d=document.documentMode,e=F.exec(navigator.userAgent.toLowerCase())&&(!d||d<=7);this.root=("/"+this.root+"/").replace(E,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=c;var g=this.location,h=g.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&h&&g.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+g.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),C.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),void this.loadUrl())},loadUrl:function(a){return a=this.fragment=this.getFragment(a),f.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!C.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(H,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),a.history=new C;var I=function(a,b){var c,d=this;c=a&&f.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},f.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&f.extend(c.prototype,a),c.__super__=d.prototype,c};l.extend=n.extend=x.extend=s.extend=C.extend=I;var J=function(){throw new Error('A "url" property or function must be specified')},K=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}}.call(this),"undefined"!==typeof module&&module.exports&&(module.exports=printStackTrace),printStackTrace.implementation=function(){},printStackTrace.implementation.prototype={run:function(a,b){return a=a||this.createException(),b=b||this.mode(a),"other"===b?this.other(arguments.callee):this[b](a)},createException:function(){try{this.undef()}catch(a){return a}},mode:function(a){return a.arguments&&a.stack?"chrome":a.stack&&a.sourceURL?"safari":a.stack&&a.number?"ie":"string"===typeof a.message&&"undefined"!==typeof window&&window.opera?a.stacktrace?a.message.indexOf("\n")>-1&&a.message.split("\n").length>a.stacktrace.split("\n").length?"opera9":a.stack?a.stacktrace.indexOf("called from line")<0?"opera10b":"opera11":"opera10a":"opera9":a.stack?"firefox":"other"},instrumentFunction:function(a,b,c){a=a||window;var d=a[b];a[b]=function(){return c.call(this,printStackTrace().slice(4)),a[b]._instrumented.apply(this,arguments)},a[b]._instrumented=d},deinstrumentFunction:function(a,b){a[b].constructor===Function&&a[b]._instrumented&&a[b]._instrumented.constructor===Function&&(a[b]=a[b]._instrumented)},chrome:function(a){var b=(a.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");return b.pop(),b},safari:function(a){return a.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(a){var b=/^.*at (\w+) \(([^\)]+)\)$/gm;return a.stack.replace(/at Anonymous function /gm,"{anonymous}()@").replace(/^(?=\w+Error\:).*$\n/m,"").replace(b,"$1@$2").split("\n")
},firefox:function(a){return a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},opera11:function(a){for(var b="{anonymous}",c=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,d=a.stacktrace.split("\n"),e=[],f=0,g=d.length;f<g;f+=2){var h=c.exec(d[f]);if(h){var i=h[4]+":"+h[1]+":"+h[2],j=h[3]||"global code";j=j.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,b),e.push(j+"@"+i+" -- "+d[f+1].replace(/^\s+/,""))}}return e},opera10b:function(a){for(var b=/^(.*)@(.+):(\d+)$/,c=a.stacktrace.split("\n"),d=[],e=0,f=c.length;e<f;e++){var g=b.exec(c[e]);if(g){var h=g[1]?g[1]+"()":"global code";d.push(h+"@"+g[2]+":"+g[3])}}return d},opera10a:function(a){for(var b="{anonymous}",c=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,d=a.stacktrace.split("\n"),e=[],f=0,g=d.length;f<g;f+=2){var h=c.exec(d[f]);if(h){var i=h[3]||b;e.push(i+"()@"+h[2]+":"+h[1]+" -- "+d[f+1].replace(/^\s+/,""))}}return e},opera9:function(a){for(var b="{anonymous}",c=/Line (\d+).*script (?:in )?(\S+)/i,d=a.message.split("\n"),e=[],f=2,g=d.length;f<g;f+=2){var h=c.exec(d[f]);h&&e.push(b+"()@"+h[2]+":"+h[1]+" -- "+d[f+1].replace(/^\s+/,""))}return e},other:function(a){for(var b,c,d="{anonymous}",e=/function\s*([\w\-$]+)?\s*\(/i,f=[],g=10;a&&a.arguments&&f.length<g;)b=e.test(a.toString())?RegExp.$1||d:d,c=Array.prototype.slice.call(a.arguments||[]),f[f.length]=b+"("+this.stringifyArguments(c)+")",a=a.caller;return f},stringifyArguments:function(a){for(var b=[],c=Array.prototype.slice,d=0;d<a.length;++d){var e=a[d];void 0===e?b[d]="undefined":null===e?b[d]="null":e.constructor&&(e.constructor===Array?b[d]=e.length<3?"["+this.stringifyArguments(e)+"]":"["+this.stringifyArguments(c.call(e,0,1))+"..."+this.stringifyArguments(c.call(e,-1))+"]":e.constructor===Object?b[d]="#object":e.constructor===Function?b[d]="#function":e.constructor===String?b[d]='"'+e+'"':e.constructor===Number&&(b[d]=e))}return b.join(",")},sourceCache:{},ajax:function(a){var b=this.createXMLHTTPObject();if(b)try{return b.open("GET",a,!1),b.send(null),b.responseText}catch(c){}return""},createXMLHTTPObject:function(){for(var a,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0;c<b.length;c++)try{return a=b[c](),this.createXMLHTTPObject=b[c],a}catch(d){}},isSameDomain:function(a){return"undefined"!==typeof location&&-1!==a.indexOf(location.hostname)},getSource:function(a){return a in this.sourceCache||(this.sourceCache[a]=this.ajax(a).split("\n")),this.sourceCache[a]},guessAnonymousFunctions:function(a){for(var b=0;b<a.length;++b){var c=/\{anonymous\}\(.*\)@(.*)/,d=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,e=a[b],f=c.exec(e);if(f){var g=d.exec(f[1]);if(g){var h=g[1],i=g[2],j=g[3]||0;if(h&&this.isSameDomain(h)&&i){var k=this.guessAnonymousFunction(h,i,j);a[b]=e.replace("{anonymous}",k)}}}}return a},guessAnonymousFunction:function(a,b){var c;try{c=this.findFunctionName(this.getSource(a),b)}catch(d){c="getSource failed with url: "+a+", exception: "+d.toString()}return c},findFunctionName:function(a,b){for(var c,d,e,f=/function\s+([^(]*?)\s*\(([^)]*)\)/,g=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,h=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,i="",j=Math.min(b,20),k=0;k<j;++k)if(c=a[b-k-1],e=c.indexOf("//"),e>=0&&(c=c.substr(0,e)),c){if(i=c+i,d=g.exec(i),d&&d[1])return d[1];if(d=f.exec(i),d&&d[1])return d[1];if(d=h.exec(i),d&&d[1])return d[1]}return"(?)"}},Cookie={get:function(a){return tmp=document.cookie.match(new RegExp(a+"=.+?($|;)","g")),tmp&&tmp[0]?unescape(tmp[0].substring(a.length+1,tmp[0].length).replace(";",""))||null:null},set:function(a,b,c,d,e){return cookie=[a+"="+escape(b),"path="+(d&&""!=d?d:"/")],c=Cookie.hoursToExpireDate(c),c&&cookie.push("expires="+c),e&&cookie.push("secure"),document.cookie=cookie.join("; ")},unset:function(a,b){b=b&&"string"==typeof b?b:"",Cookie.get(a)&&Cookie.set(a,"",-100,b)},hoursToExpireDate:function(a){return isNaN(parseInt(a))?"":(now=new Date,now.setTime(now.getTime()+60*parseInt(a)*60*1e3),now.toGMTString())},test:function(){return Cookie.set("b49f729efde9b2578ea9f00563d06e57","true"),"true"==Cookie.get("b49f729efde9b2578ea9f00563d06e57")?(Cookie.unset("b49f729efde9b2578ea9f00563d06e57"),!0):!1},dump:function(){"undefined"!=typeof console&&console.log(document.cookie.split(";"))}},function(){!function(a){return a(window.jQuery)}(function(a){var b,c,d,e,f,g;return f=function(){function b(a){this.$inputor=a}return b.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],b.prototype.copy_inputor_css=function(){var b,c=this;return b={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},a.each(this.css_attr,function(a,d){return b[d]=c.$inputor.css(d)}),b},b.prototype.create=function(b){return this.$mirror=a("<div></div>"),this.$mirror.css(this.copy_inputor_css()),this.$mirror.html(b),this.$inputor.after(this.$mirror),this},b.prototype.get_flag_rect=function(){var a,b,c;return a=this.$mirror.find("span#flag"),b=a.position(),c={left:b.left,top:b.top,bottom:a.height()+b.top},this.$mirror.remove(),c},b}(),e={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13},c={data_refactor:function(b){return a.isArray(b)?a.map(b,function(b){return a.isPlainObject(b)||(b={name:b}),b}):b},matcher:function(a,b){var c,d,e;return e=new RegExp(a+"([A-Za-z0-9_+-]*)$|"+a+"([^\\x00-\\xff]*)$","gi"),c=e.exec(b),d=null,c&&(d=c[2]?c[2]:c[1]),d},filter:function(b,c,d){return a.map(c,function(c){var e;return e=a.isPlainObject(c)?c[d]:c,e.toLowerCase().indexOf(b)>=0?c:void 0})},remote_filter:function(b,c,d){return a.ajax(c,{data:b,success:function(a){return d(a)}})},sorter:function(a,b,c){var d,e,f,g,h;if(!a)return b.sort(function(a,b){return a[c].toLowerCase()>b[c].toLowerCase()});for(e=[],g=0,h=b.length;g<h;g++)d=b[g],f=d[c],d.order=f.toLowerCase().indexOf(a),e.push(d);return e.sort(function(a,b){return a.order-b.order})},tpl_eval:function(a,b){var c;try{return c=a.replace(/\$\{([^\}]*)\}/g,function(a,c){return b[c]})}catch(d){return""}},highlighter:function(a,b){return b?a.replace(new RegExp(">\\s*(\\w*)("+b.replace("+","\\+")+")(\\w*)\\s*<","ig"),function(a,b,c,d){return"> "+b+"<strong>"+c+"</strong>"+d+" <"}):a},selector:function(a){return a.length>0?this.replace_str(a.data("value")||""):void 0}},b=function(){function b(b){this.settings={},this.common_settings={},this.pos=0,this.flags=null,this.current_flag=null,this.query=null,this.$inputor=a(b),this.mirror=new f(this.$inputor),this.common_settings=a.extend({},a.fn.atwho["default"]),this.view=new g(this,this.$el),this.listen()}return b.prototype.listen=function(){var a=this;return this.$inputor.on("keyup.atwho",function(b){return a.on_keyup(b)}).on("keydown.atwho",function(b){return a.on_keydown(b)}).on("scroll.atwho",function(){return a.view.hide()}).on("blur.atwho",function(){return a.view.hide(a.get_opt("display_timeout"))})},b.prototype.reg=function(b,c){var d,e;return d={},d=a.isPlainObject(b)?this.common_settings=a.extend({},this.common_settings,b):this.settings[b]=this.settings[b]?a.extend({},this.settings[b],c):a.extend({},c),e=d.data,d.data=this.callbacks("data_refactor").call(this,e),this},b.prototype.trigger=function(a,b){return b||(b=[]),b.push(this),this.$inputor.trigger(""+a+".atwho",b)},b.prototype.data=function(){return this.get_opt("data")},b.prototype.callbacks=function(a){var b;return(b=this.get_opt("callbacks",{})[a])||(b=this.common_settings.callbacks[a]),b},b.prototype.get_opt=function(a,b){var c;try{return this.current_flag&&(c=this.settings[this.current_flag][a]),void 0===c&&(c=this.common_settings[a]),c=void 0===c?b:c}catch(d){return c=void 0===b?null:b}},b.prototype.rect=function(){var b,c,d,e,f,g,h,i,j,k;return b=this.$inputor,document.selection?(c=document.selection.createRange(),j=c.boundingLeft+b.scrollLeft(),k=c.boundingTop+a(window).scrollTop()+b.scrollTop(),e=k+c.boundingHeight,{top:k-2,left:j-2,bottom:e-2}):(f=function(a){return a.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},i=b.val().slice(0,this.pos-1),g="<span>"+f(i)+"</span>",g+="<span id='flag'>?</span>",h=b.offset(),d=this.mirror.create(g).get_flag_rect(),j=h.left+d.left-b.scrollLeft(),k=h.top-b.scrollTop(),e=k+d.bottom,k+=d.top,{top:k,left:j,bottom:e+2})},b.prototype.catch_query=function(){var b,c,d,e,f,g,h=this;return c=this.$inputor.val(),b=this.$inputor.caretPos(),g=c.slice(0,b),e=null,a.each(this.settings,function(a){return e=h.callbacks("matcher").call(h,a,g),null!=e?(h.current_flag=a,!1):void 0}),"string"===typeof e&&e.length<=20?(f=b-e.length,d=f+e.length,this.pos=f,e={text:e.toLowerCase(),head_pos:f,end_pos:d},this.trigger("matched",[this.current_flag,e.text])):this.view.hide(),this.query=e},b.prototype.replace_str=function(a){var b,c,d,e,f;return b=this.$inputor,d=b.val(),c=this.get_opt("display_flag")?0:this.current_flag.length,e=d.slice(0,(this.query.head_pos||0)-c),f=""+e+a+" "+d.slice(this.query.end_pos||0),b.val(f),b.caretPos(e.length+a.length+1),b.change()},b.prototype.on_keyup=function(b){switch(b.keyCode){case e.ESC:b.preventDefault(),this.view.hide();break;case e.DOWN:case e.UP:a.noop();break;default:this.look_up()}return b.stopPropagation()},b.prototype.on_keydown=function(b){if(this.view.visible()){switch(b.keyCode){case e.ESC:b.preventDefault(),this.view.hide();break;case e.UP:b.preventDefault(),this.view.prev();break;case e.DOWN:b.preventDefault(),this.view.next();break;case e.TAB:case e.ENTER:if(!this.view.visible())return;b.preventDefault(),this.view.choose();break;default:a.noop()}return b.stopPropagation()}},b.prototype.render_view=function(a){var b;return b=this.get_opt("search_key"),a=this.callbacks("sorter").call(this,this.query.text,a,b),a=a.splice(0,this.get_opt("limit")),this.view.render(a)},b.prototype.remote_call=function(b,c){var d,e;return d={q:c.text,limit:this.get_opt("limit")},e=function(a){return this.reg(this.current_flag,{data:a}),this.render_view(this.data())},e=a.proxy(e,this),this.callbacks("remote_filter").call(this,d,b,e)},b.prototype.look_up=function(){var b,c,d;return(c=this.catch_query())?(b=this.data(),d=this.get_opt("search_key"),"string"===typeof b?this.remote_call(b,c):(b=this.callbacks("filter").call(this,c.text,b,d))?this.render_view(b):this.view.hide(),a.noop()):!1},b}(),g=function(){function b(b){this.controller=b,this.id=this.controller.get_opt("view_id","at-view"),this.timeout_id=null,this.$el=a("#"+this.id),this.create_view()}return b.prototype.create_view=function(){var b,c,d=this;if(!this.exist())return c="<div id='"+this.id+"' class='at-view'><ul id='"+this.id+"-ul'></ul></div>",a("body").append(c),this.$el=a("#"+this.id),b=this.$el.find("ul"),b.on("mouseenter.view","li",function(c){return b.find(".cur").removeClass("cur"),a(c.currentTarget).addClass("cur")}).on("click",function(a){return a.stopPropagation(),a.preventDefault(),d.$el.data("_view").choose()})},b.prototype.exist=function(){return a("#"+this.id).length>0},b.prototype.visible=function(){return this.$el.is(":visible")},b.prototype.choose=function(){var a;return a=this.$el.find(".cur"),this.controller.callbacks("selector").call(this.controller,a),this.controller.trigger("choose",[a]),this.hide()},b.prototype.reposition=function(){var b,c;return c=this.controller.rect(),c.bottom+this.$el.height()-a(window).scrollTop()>a(window).height()&&(c.bottom=c.top-this.$el.height()),b={left:c.left,top:c.bottom},this.$el.offset(b),this.controller.trigger("reposition",[b])},b.prototype.next=function(){var b,c;return b=this.$el.find(".cur").removeClass("cur"),c=b.next(),c.length||(c=a(this.$el.find("li")[0])),c.addClass("cur")},b.prototype.prev=function(){var a,b;return a=this.$el.find(".cur").removeClass("cur"),b=a.prev(),b.length||(b=this.$el.find("li").last()),b.addClass("cur")},b.prototype.show=function(){return this.visible()||this.$el.show(),this.reposition()},b.prototype.hide=function(a){var b,c=this;return isNaN(a)?this.visible()?this.$el.hide():void 0:(b=function(){return c.hide()},clearTimeout(this.timeout_id),this.timeout_id=setTimeout(b,a))},b.prototype.clear=function(){return this.$el.find("ul").empty()},b.prototype.render=function(b){var c,e,f=this;return a.isArray(b)?b.length<=0?(this.hide(),!0):(this.clear(),this.$el.data("_view",this),c=this.$el.find("ul"),e=this.controller.get_opt("tpl",d),a.each(b,function(b,d){var g,h;return h=f.controller.callbacks("tpl_eval").call(f.controller,e,d),g=a(f.controller.callbacks("highlighter").call(f.controller,h,f.controller.query.text)),g.data("info",d),c.append(g)}),this.show(),c.find("li:eq(0)").addClass("cur")):!1},b}(),d="<li data-value='${name}'>${name}</li>",a.fn.atwho=function(c,d){return this.filter("textarea, input").each(function(){var e,f;return e=a(this),f=e.data("atwho"),f||e.data("atwho",f=new b(this)),f.reg(c,d)})},a.fn.atwho.Controller=b,a.fn.atwho.View=g,a.fn.atwho.Mirror=f,a.fn.atwho["default"]={data:null,search_key:"name",callbacks:c,limit:5,display_flag:!0,display_timeout:300,tpl:d}})}.call(this),function(){!function(a){return a(window.jQuery)}(function(a){var b,c;return b=function(a){var b,c,d,e,f,g,h,i;return document.selection?(g=document.selection.createRange(),f=0,g&&g.parentElement()===a&&(e=a.value.replace(/\r\n/g,"\n"),d=e.length,i=a.createTextRange(),i.moveToBookmark(g.getBookmark()),c=a.createTextRange(),c.collapse(!1),i.compareEndPoints("StartToEnd",c)>-1?h=b=d:(h=-i.moveStart("character",-d),b=-i.moveEnd("character",-d)))):h=a.selectionStart,h},c=function(a,b){var c;return document.selection?(c=a.createTextRange(),c.move("character",b),c.select()):a.setSelectionRange(b,b)},a.fn.caretPos=function(a){var d;return d=this[0],d.focus(),a?c(d,a):b(d)}})}.call(this);var window_lib=window.jQuery?jQuery:Zepto;!function(a){a.fn.passStrength=function(b,c,d,e){return this.each(function(){var f=a(this);a(f).unbind().bind("keyup blur",function(){if(null!==a(this).val()){var f=a.fn.teststrength(a(this).val(),e,d);f[2]?(b.attr("disabled","disabled"),b.addClass("disabled")):(b.removeAttr("disabled"),b.removeClass("disabled")),c.html(f[0]),c.removeClass(e.badPassStyle),c.removeClass(e.goodPassStyle),c.removeClass(e.strongPassStyle),c.addClass(f[1])}})})},a.fn.teststrength=function(b,c,d){var e=0;return b.length<6?[c.shortPassStr,c.badPassStyle,1]:c.userid.length>0&&b.toLowerCase()==c.userid.toLowerCase()?[c.samePasswordStr,c.badPassStyle,1]:a.inArray(b.toLowerCase(),d)>-1?[c.blackPassStr,c.badPassStyle,1]:(e+=2*b.length,e+=3*a.fn.uniqueCharacters(b),b.match(/(.*[0-9].*[0-9].*[0-9])/)&&(e+=15),b.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&(e+=15),b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(e+=10),b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)&&(e+=15),b.match(/([!,@,#,$,%,\^,&,*,?,_,~])/)&&b.match(/([0-9])/)&&(e+=15),b.match(/([!,@,#,$,%,\^,&,*,?,_,~])/)&&b.match(/([a-zA-Z])/)&&(e+=15),(b.match(/^[a-z]+$/)||b.match(/^[A-Z]+$/)||b.match(/^\d+$/))&&(e-=10),e<34?[c.badPassStr,c.badPassStyle,0]:e<68?[c.goodPassStr,c.goodPassStyle,0]:[c.strongPassStr,c.strongPassStyle,0])}}(window_lib),$.fn.uniqueCharacters=function(a){for(var b={},c=0,d=0;d<a.length;d++)a.charAt(d)in b||(b[a.charAt(d)]=!0,c++);return c},window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),function(){var a={};!function(){function b(a,c,d){var e=function(){};e.prototype=a.prototype;var f=new e,g=/xyz/.test(function(){})?/\bparent\b/:/.*/;d=d||{};for(var h in d){var i=d[h],j=f[h];f[h]="function"==typeof j&&"function"==typeof i&&g.test(i)?function(a,b){return function(){var c=this.parent;this.parent=b;var d=a.apply(this,arguments);return this.parent=c,d}}(i,j):i}f.typename=c;var k=function(){f.init&&f.init.apply(this,arguments)};return k.prototype=f,k.prototype.constructor=k,k.extend=function(a,c){return"object"==typeof a&&(c=a,a="anonymous"),b(k,a,c)},k}a.object=b(Object,"Object",{})}(),function(){var b=Array.prototype,c=Object.prototype,d={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},e=function(a){return d[a]},f=a.lib={};f.withPrettyErrors=function(a,b,c){try{return c()}catch(d){if(d.Update||(d=new f.TemplateError(d)),d.Update(a),!b){var e=d;d=new Error(e.message),d.name=e.name}throw d}},f.TemplateError=function(a,b,c){var d=this;return a instanceof Error?(d=a,a=a.name+": "+a.message):Error.captureStackTrace&&Error.captureStackTrace(d),d.name="Template render error",d.message=a,d.lineno=b,d.colno=c,d.firstUpdate=!0,d.Update=function(a){var b="("+(a||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?b+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(b+=" [Line "+this.lineno+"]")),b+="\n ",this.firstUpdate&&(b+=" "),this.message=b+(this.message||""),this.firstUpdate=!1,this},d},f.TemplateError.prototype=Error.prototype,f.escape=function(a){return a.replace(/[&"'<>]/g,e)},f.isFunction=function(a){return"[object Function]"==c.toString.call(a)},f.isArray=Array.isArray||function(a){return"[object Array]"==c.toString.call(a)},f.isString=function(a){return"[object String]"==c.toString.call(a)},f.isObject=function(a){return a===Object(a)},f.groupBy=function(a,b){for(var c={},d=f.isFunction(b)?b:function(a){return a[b]},e=0;e<a.length;e++){var g=a[e],h=d(g,e);(c[h]||(c[h]=[])).push(g)}return c},f.toArray=function(a){return Array.prototype.slice.call(a)},f.without=function(a){var b=[];if(!a)return b;for(var c=-1,d=a.length,e=f.toArray(arguments).slice(1);++c<d;)-1===e.indexOf(a[c])&&b.push(a[c]);return b},f.extend=function(a,b){for(var c in b)a[c]=b[c];return a},f.repeat=function(a,b){for(var c="",d=0;d<b;d++)c+=a;return c},f.each=function(a,c,d){if(null!=a)if(b.each&&a.each==b.each)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++)c.call(d,a[e],e,a)},f.map=function(a,c){var d=[];if(null==a)return d;if(b.map&&a.map===b.map)return a.map(c);for(var e=0;e<a.length;e++)d[d.length]=c(a[e],e);return a.length===+a.length&&(d.length=a.length),d},f.asyncParallel=function(a,b){for(var c=a.length,d=new Array(c),e=0,f=function(a){return function(f){d[a]=f,e+=1,e===c&&b(d)}},g=0;g<c;g++)a[g](f(g))},f.asyncIter=function(a,b,c){function d(){e++,e<a.length?b(a[e],e,d,c):c()}var e=-1;d()},f.asyncFor=function(a,b,c){function d(){h++;var f=e[h];h<g?b(f,a[f],h,g,d):c()}var e=f.keys(a),g=e.length,h=-1;d()},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){if(null==a)throw new TypeError;var c=Object(a),d=c.length>>>0;if(0===d)return-1;var e=0;if(arguments.length>2&&(e=Number(arguments[2]),e!=e?e=0:0!=e&&1/0!=e&&e!=-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e)))),e>=d)return-1;for(var f=e>=0?e:Math.max(d-Math.abs(e),0);f<d;f++)if(f in c&&c[f]===b)return f;return-1}),Array.prototype.map||(Array.prototype.map=function(){throw new Error("map is unimplemented for this js engine")}),f.keys=function(a){if(Object.prototype.keys)return a.keys();var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}}(),function(){function b(a,b,c){return function(){var f,g=e(arguments),h=d(arguments);if(g>a.length){f=Array.prototype.slice.call(arguments,0,a.length);for(var i=Array.prototype.slice.call(arguments,f.length,g),j=0;j<i.length;j++)j<b.length&&(h[b[j]]=i[j]);f.push(h)}else if(g<a.length){f=Array.prototype.slice.call(arguments,0,g);for(var j=g;j<a.length;j++){var k=a[j];f.push(h[k]),delete h[k]}f.push(h)}else f=arguments;return c.apply(this,f)}}function c(a){return a.__keywords=!0,a}function d(a){var b=a.length;if(b){var c=a[b-1];if(c&&c.hasOwnProperty("__keywords"))return c}return{}}function e(a){var b=a.length;if(0===b)return 0;var c=a[b-1];return c&&c.hasOwnProperty("__keywords")?b-1:b}function f(a){if("string"!=typeof a)return a;this.toString=function(){return a},this.length=a.length;for(var b=["charAt","charCodeAt","concat","contains","endsWith","fromCharCode","indexOf","lastIndexOf","length","localeCompare","match","quote","replace","search","slice","split","startsWith","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"],c=0;c<b.length;c++)this[b[c]]=h(a[b[c]])}function g(a,b){return a instanceof f?new f(b):b.toString()}function h(a){var b=typeof a;return"string"===b?new f(a):"function"!==b?a:function(){var b=a.apply(this,arguments);return"string"===typeof b?new f(b):b}}function i(a,b){return a=void 0!==a&&null!==a?a:"",b&&"string"===typeof a&&(a=p.escape(a)),a}function j(a,b){return a=a||{},"function"===typeof a[b]?function(){return a[b].apply(a,arguments)}:a[b]}function k(a,b,c){if(!a)throw new Error("Unable to call `"+b+"`, which is undefined or falsey");if("function"!==typeof a)throw new Error("Unable to call `"+b+"`, which is not a function");return a.apply(this,c)}function l(a,b,c){var d=b.lookup(c);return void 0!==d&&null!==d?d:a.lookup(c)}function m(a,b,c){return a.lineno?a:new p.TemplateError(a,b,c)}function n(a,b,c,d){if(p.isArray(a)){var e=a.length;p.asyncIter(a,function(a,d,f){switch(b){case 1:c(a,d,e,f);break;case 2:c(a[0],a[1],d,e,f);break;case 3:c(a[0],a[1],a[2],d,e,f);break;default:a.push(d,f),c.apply(this,a)}},d)}else p.asyncFor(a,function(a,b,d,e,f){c(a,b,d,e,f)},d)}function o(a,b,c,d){function e(a,b){h++,g[a]=b,h==f&&d(null,g.join(""))}var f,g,h=0;if(p.isArray(a))if(f=a.length,g=new Array(f),0==f)d(null,"");else for(var i=0;i<a.length;i++){var j=a[i];switch(b){case 1:c(j,i,f,e);break;case 2:c(j[0],j[1],i,f,e);break;case 3:c(j[0],j[1],j[2],i,f,e);break;default:j.push(i,e),c.apply(this,j)}}else{var k=p.keys(a);if(f=k.length,g=new Array(f),0==f)d(null,"");else for(var i=0;i<k.length;i++){var l=k[i];c(l,a[l],i,f,e)}}}var p=a.lib,q=a.object,r=q.extend({init:function(a){this.variables={},this.parent=a},set:function(a,b){for(var c=a.split("."),d=this.variables,e=0;e<c.length-1;e++){var f=c[e];d[f]||(d[f]={}),d=d[f]}d[c[c.length-1]]=b},get:function(a){var b=this.variables[a];return void 0!==b&&null!==b?b:null},lookup:function(a){var b=this.parent,c=this.variables[a];return void 0!==c&&null!==c?c:b&&b.lookup(a)},push:function(){return new r(this)},pop:function(){return this.parent}});a.runtime={Frame:r,makeMacro:b,makeKeywordArgs:c,numArgs:e,suppressValue:i,memberLookup:j,contextOrFrameLookup:l,callWrap:k,handleError:m,isArray:p.isArray,asyncEach:p.asyncEach,keys:p.keys,SafeString:f,copySafeness:g,markSafe:h,asyncEach:n,asyncAll:o}}(),function(){var b=a.object,c=a.lib,d=b.extend({on:function(a,b){this.listeners=this.listeners||{},this.listeners[a]=this.listeners[a]||[],this.listeners[a].push(b)},emit:function(a){var b=Array.prototype.slice.call(arguments,1);this.listeners&&this.listeners[a]&&c.each(this.listeners[a],function(a){a.apply(null,b)})}});a.loader=d}(),function(){var b=a.loader,c=b.extend({init:function(a,b){this.precompiled=window.nunjucksPrecompiled||{},this.baseURL=a||"",this.neverUpdate=b},getSource:function(a){if(this.precompiled[a])return{src:{type:"code",obj:this.precompiled[a]},path:a};var b=this.fetch(this.baseURL+"/"+a);return b?{src:b,path:a,noCache:this.neverUpdate}:null},fetch:function(a){var b,c,d=!0;return window.XMLHttpRequest?b=new XMLHttpRequest:window.ActiveXObject&&(b=new ActiveXObject("Microsoft.XMLHTTP")),b.onreadystatechange=function(){4==b.readyState&&200==b.status&&d&&(d=!1,c=b.responseText)},a+=(-1===a.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),b.open("GET",a,!1),b.send(),c}});a["web-loaders"]={WebLoader:c}}(),function(){a.loaders="undefined"===typeof window?a["node-loaders"]:a["web-loaders"]}(),function(){var b=a.lib,c=a.runtime,d={abs:function(a){return Math.abs(a)},batch:function(a,b,c){for(var d=[],e=[],f=0;f<a.length;f++)f%b===0&&e.length&&(d.push(e),e=[]),e.push(a[f]);if(e.length){if(c)for(var f=e.length;f<b;f++)e.push(c);d.push(e)}return d},capitalize:function(a){var b=a.toLowerCase();return c.copySafeness(a,b.charAt(0).toUpperCase()+b.slice(1))},center:function(a,d){if(d=d||80,a.length>=d)return a;var e=d-a.length,f=b.repeat(" ",e/2-e%2),g=b.repeat(" ",e/2);return c.copySafeness(a,f+a+g)},"default":function(a,b,c){var d=c?a:void 0!==a;return d?a:b},dictsort:function(a,c,d){if(!b.isObject(a))throw new b.TemplateError("dictsort filter: val must be an object");var e=[];for(var f in a)e.push([f,a[f]]);var g;if(void 0===d||"key"===d)g=0;else{if("value"!==d)throw new b.TemplateError("dictsort filter: You can only sort by either key or value");g=1}return e.sort(function(a,d){var e=a[g],f=d[g];return c||(b.isString(e)&&(e=e.toUpperCase()),b.isString(f)&&(f=f.toUpperCase())),e>f?1:e==f?0:-1}),e},escape:function(a){return"string"==typeof a||a instanceof c.SafeString?b.escape(a):a},safe:function(a){return c.markSafe(a)},first:function(a){return a[0]},groupby:function(a,c){return b.groupBy(a,c)},indent:function(a,d,e){d=d||4;for(var f="",g=a.split("\n"),h=b.repeat(" ",d),i=0;i<g.length;i++)f+=0!=i||e?h+g[i]+"\n":g[i]+"\n";return c.copySafeness(a,f)},join:function(a,c,d){return c=c||"",d&&(a=b.map(a,function(a){return a[d]})),a.join(c)},last:function(a){return a[a.length-1]},length:function(a){return a.length},list:function(a){if(b.isString(a))return a.split("");if(b.isObject(a)){var c=[];if(Object.keys)c=Object.keys(a);else for(var d in a)c.push(d);return b.map(c,function(b){return{key:b,value:a[b]}})}throw new b.TemplateError("list filter: type not iterable")},lower:function(a){return a.toLowerCase()},random:function(a){return a[Math.floor(Math.random()*a.length)]},replace:function(a,b,d,e){var f=a,g=f,h=1;for(f=f.replace(b,d);g!=f&&!(h>=e);)g=f,f=f.replace(b,d),h++;return c.copySafeness(a,f)},reverse:function(a){var e;return e=b.isString(a)?d.list(a):b.map(a,function(a){return a}),e.reverse(),b.isString(a)?c.copySafeness(a,e.join("")):e},round:function(a,b,c){b=b||0;var d,e=Math.pow(10,b);return d="ceil"==c?Math.ceil:"floor"==c?Math.floor:Math.round,d(a*e)/e},slice:function(a,b,c){for(var d=Math.floor(a.length/b),e=a.length%b,f=0,g=[],h=0;h<b;h++){var i=f+h*d;h<e&&f++;var j=f+(h+1)*d,k=a.slice(i,j);c&&h>=e&&k.push(c),g.push(k)}return g},sort:function(a,c,d,e){return a=b.map(a,function(a){return a}),a.sort(function(a,f){var g,h;return e?(g=a[e],h=f[e]):(g=a,h=f),!d&&b.isString(g)&&b.isString(h)&&(g=g.toLowerCase(),h=h.toLowerCase()),g<h?c?1:-1:g>h?c?-1:1:0}),a},string:function(a){return c.copySafeness(a,a)},title:function(a){for(var b=a.split(" "),e=0;e<b.length;e++)b[e]=d.capitalize(b[e]);return c.copySafeness(a,b.join(" "))},trim:function(a){return c.copySafeness(a,a.replace(/^\s*|\s*$/g,""))},truncate:function(a,b,d,e){var f=a;if(b=b||255,a.length<=b)return a;if(d)a=a.substring(0,b);else{var g=a.lastIndexOf(" ",b);-1===g&&(g=b),a=a.substring(0,g)}return a+=void 0!==e&&null!==e?e:"...",c.copySafeness(f,a)},upper:function(a){return a.toUpperCase()},urlencode:function(a){var c=encodeURIComponent;if(b.isString(a))return c(a);var d;if(b.isArray(a))d=a.map(function(a){return c(a[0])+"="+c(a[1])});else{d=[];for(var e in a)a.hasOwnProperty(e)&&d.push(c(e)+"="+c(a[e]))}return d.join("&")},wordcount:function(a){return a.match(/\w+/g).length},"float":function(a,b){var c=parseFloat(a);return isNaN(c)?b:c},"int":function(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}};d.d=d["default"],d.e=d.escape,a.filters=d}(),function(){function b(a){var b=-1,c=null;return{reset:function(){b=-1,c=null},next:function(){return b++,b>=a.length&&(b=0),c=a[b]}}}function c(a){a=a||",";var b=!0;return function(){var c=b?"":a;return b=!1,c}}var d={range:function(a,b,c){b?c||(c=1):(b=a,a=0,c=1);for(var d=[],e=a;e<b;e+=c)d.push(e);return d},cycler:function(){return b(Array.prototype.slice.call(arguments))},joiner:function(a){return c(a)}};a.globals=d}(),function(){var b=a.lib,c=a.object,d=a.lexer,e=a.compiler,f=a.filters,g=a.loaders,h=a.runtime,i=a.globals,j=h.Frame,k=c.extend({init:function(a,c){c=c||{},this.dev=!!c.dev,this.autoesc=!!c.autoescape,this.loaders=a?b.isArray(a)?a:[a]:g.FileSystemLoader?[new g.FileSystemLoader("views")]:[new g.WebLoader("/views")],this.initCache(),this.filters={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],c.tags&&d.setTags(c.tags);for(var e in f)this.addFilter(e,f[e])},initCache:function(){var a={};b.each(this.loaders,function(b){b.on("update",function(b){a[b]=null})}),this.cache=a},addExtension:function(a,b){b._name=a,this.extensions[a]=b,this.extensionsList.push(b)},getExtension:function(a){return this.extensions[a]},addFilter:function(a,b,c){var d=b;c&&this.asyncFilters.push(a),this.filters[a]=d},getFilter:function(a){if(!this.filters[a])throw new Error("filter not found: "+a);return this.filters[a]},getTemplate:function(a,c,d){if(a&&a.raw&&(a=a.raw),b.isFunction(c)&&(d=c,c=!1),"string"!==typeof a)throw new Error("template names must be a string: "+a);var e=this.cache[a];if(!e){var f;return b.asyncIter(this.loaders,function(b,c,d,e){function f(a){a?e(a):d()}b.async?b.getSource(a,function(a,b){if(a)throw a;f(b)}):f(b.getSource(a))},function(b){if(b){var e=new m(b.src,this,b.path,c);b.noCache||(this.cache[a]=e),d?d(null,e):f=e}else{var g=new Error("template not found: "+a);if(!d)throw g;d(g)}}.bind(this)),f}return c&&e.compile(),d?void d(null,e):e},express:function(a){function b(a){this.name=a,this.path=a}var c=this;b.prototype.render=function(a,b){c.render(this.name,a,b)},a.set("view",b)},render:function(a,c,d){b.isFunction(c)&&(d=c,c=null);var e=null;return this.getTemplate(a,function(a,b){if(a&&d)d(a);else{if(a)throw a;b.render(c,d||function(a,b){if(a)throw a;e=b})}}),e},renderString:function(a,b,c){var d=new m(a,this);return d.render(b,c)}}),l=c.extend({init:function(a,b){this.ctx=a,this.blocks={},this.exported=[];for(var c in b)this.addBlock(c,b[c])},lookup:function(a){return a in i&&!(a in this.ctx)?i[a]:this.ctx[a]},setVariable:function(a,b){this.ctx[a]=b},getVariables:function(){return this.ctx},addBlock:function(a,b){this.blocks[a]=this.blocks[a]||[],this.blocks[a].push(b)},getBlock:function(a){if(!this.blocks[a])throw new Error('unknown block "'+a+'"');return this.blocks[a][0]},getSuper:function(a,b,c,d,e,f){var g=(this.blocks[b]||[]).indexOf(c),h=this.blocks[b][g+1],i=this;if(-1==g||!h)throw new Error('no super block available for "'+b+'"');h(a,i,d,e,f)},addExport:function(a){this.exported.push(a)},getExported:function(){for(var a={},b=0;b<this.exported.length;b++){var c=this.exported[b];a[c]=this.ctx[c]}return a}}),m=c.extend({init:function(a,c,d,e){if(this.env=c||new k,b.isObject(a))switch(a.type){case"code":this.tmplProps=a.obj;break;case"string":this.tmplStr=a.obj}else{if(!b.isString(a))throw new Error("src must be a string or an object describing the source");this.tmplStr=a}this.path=d,e?b.withPrettyErrors(this.path,this.env.dev,this._compile.bind(this)):this.compiled=!1},render:function(a,c,d){return"function"===typeof a?(d=a,a={}):"function"===typeof c&&(d=c,c=null),b.withPrettyErrors(this.path,this.env.dev,function(){this.compile();var b=new l(a||{},this.blocks),e=null;return this.rootRenderFunc(this.env,b,c||new j,h,d||function(a,b){if(a)throw a;e=b}),e}.bind(this))},getExported:function(a){this.compile();var b=new l({},this.blocks);this.rootRenderFunc(this.env,b,new j,h,function(){a(null,b.getExported())})},compile:function(){this.compiled||this._compile()},_compile:function(){var a;if(this.tmplProps)a=this.tmplProps;else{var b=e.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path),c=new Function(b);a=c()}this.blocks=this._getBlocks(a),this.rootRenderFunc=a.root,this.compiled=!0},_getBlocks:function(a){var b={};for(var c in a)"b_"==c.slice(0,2)&&(b[c.slice(2)]=a[c]);return b}});a.environment={Environment:k,Template:m}}();var b,c=a.lib,d=a.environment,e=a.compiler,f=a.parser,g=a.lexer,h=a.runtime,i=(a.loader,a.loaders),j=a.precompile;b={},b.Environment=d.Environment,b.Template=d.Template,b.Loader=d.Loader,b.FileSystemLoader=i.FileSystemLoader,b.WebLoader=i.WebLoader,b.compiler=e,b.parser=f,b.lexer=g,b.runtime=h;
var k;b.configure=function(a,b){b=b||{},c.isObject(a)&&(b=a,a=null);var e=i.FileSystemLoader||i.WebLoader;return k=new d.Environment(new e(a,b.watch),b),b&&b.express&&k.express(b.express),k},b.render=function(a,c,d){return k||b.configure(),k.render(a,c,d)},b.renderString=function(a,c,d){return k||b.configure(),k.renderString(a,c,d)},j&&(b.precompile=j.precompile,b.precompileString=j.precompileString),b.require=function(b){return a[b]},"function"===typeof define&&define.amd?define(function(){return b}):window.nunjucks=b}(),function(){var a=nunjucks.require("runtime"),b=nunjucks.require("lib"),c=a.contextOrFrameLookup;a.contextOrFrameLookup=function(a,b,d){var e=c.apply(this,arguments);if(void 0===e)switch(d){case"True":return!0;case"False":return!1;case"None":return null;case"none":return null}return e};var d=a.memberLookup,e={pop:function(a){if(void 0===a)return this.pop();if(a>=this.length||a<0)throw new Error("KeyError");return this.splice(a,1)},remove:function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return this.splice(b,1);throw new Error("ValueError")},count:function(a){for(var b=0,c=0;c<this.length;c++)this[c]==a&&b++;return b},index:function(a){var b;if(-1==(b=this.indexOf(a)))throw new Error("ValueError");return b},find:function(a){return this.indexOf(a)},insert:function(a,b){return this.splice(a,0,b)},append:function(a){return this.push(a)}},f={items:function(){var a=[];for(var b in this)a.push([b,this[b]]);return a},values:function(){var a=[];for(var b in this)a.push(this[b]);return a},keys:function(){var a=[];for(var b in this)a.push(b);return a},get:function(a,b){var c=this[a];return void 0===c&&(c=b),c},has_key:function(a){return this.hasOwnProperty(a)},pop:function(a,b){var c=this[a];if(void 0===c&&void 0!==b)c=b;else{if(void 0===c)throw new Error("KeyError");delete this[a]}return c},popitem:function(){for(var a in this){var b=this[a];return delete this[a],[a,b]}throw new Error("KeyError")},setdefault:function(a,b){return a in this?this[a]:(void 0===b&&(b=null),this[a]=b)},update:function(a){for(var b in a)this[b]=a[b];return null}};f.iteritems=f.items,f.itervalues=f.values,f.iterkeys=f.keys,a.memberLookup=function(a,c){return a=a||{},b.isArray(a)&&e.hasOwnProperty(c)?function(){return e[c].apply(a,arguments)}:b.isObject(a)&&f.hasOwnProperty(c)?function(){return f[c].apply(a,arguments)}:d.apply(this,arguments)}}(),"object"!==typeof JSON&&(JSON={}),function(){"use strict";function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"===typeof i&&"function"===typeof i.toJSON&&(i=i.toJSON(a)),"function"===typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;c<f;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"===typeof rep)for(f=rep.length,c=0;c<f;c+=1)"string"===typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"===typeof c)for(d=0;d<c;d+=1)indent+=" ";else"string"===typeof c&&(indent=c);if(rep=b,b&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!==typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"===typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"===typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),window.Modernizr=function(a,b,c){function d(a){n.cssText=a}function e(a,b){return typeof a===b}var f,g,h,i="2.6.2",j={},k=b.documentElement,l="modernizr",m=b.createElement(l),n=m.style,o=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),p={},q=[],r=q.slice,s=function(a,c,d,e){var f,g,h,i,j=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))for(;d--;)h=b.createElement("div"),h.id=e?e[d]:l+(d+1),j.appendChild(h);return f=["&#173;",'<style id="s',l,'">',a,"</style>"].join(""),j.id=l,(m?j:n).innerHTML+=f,n.appendChild(j),m||(n.style.background="",n.style.overflow="hidden",i=k.style.overflow,k.style.overflow="hidden",k.appendChild(n)),g=c(j,a),m?j.parentNode.removeChild(j):(n.parentNode.removeChild(n),k.style.overflow=i),!!g},t={}.hasOwnProperty;h=e(t,"undefined")||e(t.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return t.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=r.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(r.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(r.call(arguments)))};return d}),p.touch=function(){var c;return"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:s(["@media (",o.join("touch-enabled),("),l,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=9===a.offsetTop}),c};for(var u in p)h(p,u)&&(g=u.toLowerCase(),j[g]=p[u](),q.push((j[g]?"":"no-")+g));return j.addTest=function(a,b){if("object"==typeof a)for(var d in a)h(a,d)&&j.addTest(d,a[d]);else{if(a=a.toLowerCase(),j[a]!==c)return j;b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(k.className+=" "+(b?"":"no-")+a),j[a]=b}return j},d(""),m=f=null,j._version=i,j._prefixes=o,j.testStyles=s,j}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==q.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=r.shift();s=1,a?a.t?o(function(){("c"==a.t?m.injectCss:m.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):s=0}function i(a,c,d,e,f,i,j){function k(b){if(!n&&g(l.readyState)&&(t.r=n=1,!s&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&o(function(){v.removeChild(l)},50);for(var d in A[c])A[c].hasOwnProperty(d)&&A[c][d].onload()}}var j=j||m.errorTimeout,l=b.createElement(a),n=0,q=0,t={t:d,s:c,e:f,a:i,x:j};1===A[c]&&(q=1,A[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,q)},r.splice(e,0,t),"img"!=a&&(q||2===A[c]?(v.insertBefore(l,u?null:p),o(k,j)):A[c].push(l))}function j(a,b,c,d,f){return s=0,b=b||"j",e(a)?i("c"==b?x:w,a,b,this.i++,c,d,f):(r.splice(this.i++,0,a),1==r.length&&h()),this}function k(){var a=m;return a.loader={load:j,i:0},a}var l,m,n=b.documentElement,o=a.setTimeout,p=b.getElementsByTagName("script")[0],q={}.toString,r=[],s=0,t="MozAppearance"in n.style,u=t&&!!b.createRange().compareNode,v=u?n:p.parentNode,n=a.opera&&"[object Opera]"==q.call(a.opera),n=!!b.attachEvent&&!n,w=t?"object":n?"script":"img",x=n?"script":w,y=Array.isArray||function(a){return"[object Array]"==q.call(a)},z=[],A={},B={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}};m=function(a){function b(a){var b,c,d,a=a.split("!"),e=z.length,f=a.pop(),g=a.length,f={url:f,origUrl:f,prefixes:a};for(c=0;c<g;c++)d=a[c].split("="),(b=B[d.shift()])&&(f=b(f,d));for(c=0;c<e;c++)f=z[c](f);return f}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(A[i.url]?i.noexec=!0:A[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),A[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}),g(a,l,b,0,j);else if(Object(a)===a)for(i in h=function(){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}(),a)a.hasOwnProperty(i)&&(!c&&!--h&&(d(l)?l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}:l[i]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),n()}}(m[i])),g(a[i],l,b,i,j))}else!c&&n()}var h,i,j=!!a.test,k=a.load||a.both,l=a.callback||f,m=l,n=a.complete||f;c(j?a.yep:a.nope,!!k),k&&c(k)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(y(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):y(j)?m(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},m.addPrefix=function(a,b){B[a]=b},m.addFilter=function(a){z.push(a)},m.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",l=function(){b.removeEventListener("DOMContentLoaded",l,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k,l,n=b.createElement("script"),e=e||m.errorTimeout;n.src=a;for(l in d)n.setAttribute(l,d[l]);c=j?h:c||f,n.onreadystatechange=n.onload=function(){!k&&g(n.readyState)&&(k=1,c(),n.onload=n.onreadystatechange=null)},o(function(){k||(k=1,c(1))},e),i?n.onload():p.parentNode.insertBefore(n,p)},a.yepnope.injectCss=function(a,c,d,e,g,i){var j,e=b.createElement("link"),c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(p.parentNode.insertBefore(e,p),o(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("fileinput",function(){var a=document.createElement("input");return a.type="file",!a.disabled});var qq=qq||{},qq=function(a){"use strict";return{hide:function(){return a.style.display="none",this},attach:function(b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c),function(){qq(a).detach(b,c)}},detach:function(b,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c),this},contains:function(b){return a==b?!0:a.contains?a.contains(b):!!(8&b.compareDocumentPosition(a))},insertBefore:function(b){return b.parentNode.insertBefore(a,b),this},remove:function(){return a.parentNode.removeChild(a),this},css:function(b){return null!=b.opacity&&"string"!=typeof a.style.opacity&&"undefined"!=typeof a.filters&&(b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"),qq.extend(a.style,b),this},hasClass:function(b){var c=new RegExp("(^| )"+b+"( |$)");return c.test(a.className)},addClass:function(b){return qq(a).hasClass(b)||(a.className+=" "+b),this},removeClass:function(b){var c=new RegExp("(^| )"+b+"( |$)");return a.className=a.className.replace(c," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(b){if(a.querySelectorAll)return a.querySelectorAll("."+b);for(var c=[],d=a.getElementsByTagName("*"),e=d.length,f=0;f<e;f++)qq(d[f]).hasClass(b)&&c.push(d[f]);return c},children:function(){for(var b=[],c=a.firstChild;c;)1==c.nodeType&&b.push(c),c=c.nextSibling;return b},setText:function(b){return a.innerText=b,a.textContent=b,this},clearText:function(){return qq(a).setText("")}}};qq.log=function(a,b){window.console&&(b&&"info"!==b?window.console[b]?window.console[b](a):window.console.log("<"+b+"> "+a):window.console.log(a))},qq.isObject=function(a){"use strict";return null!==a&&a&&"object"===typeof a&&a.constructor===Object},qq.extend=function(a,b,c){"use strict";var d;for(d in b)b.hasOwnProperty(d)&&(c&&qq.isObject(b[d])?(void 0===a[d]&&(a[d]={}),qq.extend(a[d],b[d],!0)):a[d]=b[d])},qq.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);c=c||0;var d=a.length;for(c<0&&(c+=d);c<d;c++)if(c in a&&a[c]===b)return c;return-1},qq.getUniqueId=function(){var a=0;return function(){return a++}}(),qq.ie=function(){return-1!=navigator.userAgent.indexOf("MSIE")},qq.ie10=function(){return-1!=navigator.userAgent.indexOf("MSIE 10")},qq.safari=function(){return void 0!=navigator.vendor&&-1!=navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!=navigator.vendor&&-1!=navigator.vendor.indexOf("Google")},qq.firefox=function(){return-1!=navigator.userAgent.indexOf("Mozilla")&&void 0!=navigator.vendor&&""==navigator.vendor},qq.windows=function(){return"Win32"==navigator.platform},qq.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},qq.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;var c=a.firstChild;return a.removeChild(c),c}}(),qq.obj2url=function(a,b,c){var d=[],e="&",f=function(a,c){var e=b?/\[\]$/.test(b)?b:b+"["+c+"]":c;"undefined"!=e&&"undefined"!=c&&d.push("object"===typeof a?qq.obj2url(a,e,!0):"[object Function]"===Object.prototype.toString.call(a)?encodeURIComponent(e)+"="+encodeURIComponent(a()):encodeURIComponent(e)+"="+encodeURIComponent(a))};if(!c&&b)e=/\?/.test(b)?/\?$/.test(b)?"":"&":"?",d.push(b),d.push(qq.obj2url(a));else if("[object Array]"===Object.prototype.toString.call(a)&&"undefined"!=typeof a)for(var g=0,h=a.length;g<h;++g)f(a[g],g);else if("undefined"!=typeof a&&null!==a&&"object"===typeof a)for(var g in a)f(a[g],g);else d.push(encodeURIComponent(b)+"="+encodeURIComponent(a));return b?d.join(e):d.join(e).replace(/^&/,"").replace(/%20/g,"+")},qq.DisposeSupport={_disposers:[],dispose:function(){for(var a;a=this._disposers.shift();)a()},addDisposer:function(a){this._disposers.push(a)},_attach:function(){this.addDisposer(qq(arguments[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))}},qq.UploadButton=function(a){this._options={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,a),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,qq(this._element).css({position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq(this._input).remove(),qq(this._element).removeClass(this._options.focusClass),this._input=this._createInput()},_createInput:function(){var a=document.createElement("input");this._options.multiple&&a.setAttribute("multiple","multiple"),this._options.acceptFiles&&a.setAttribute("accept",this._options.acceptFiles),a.setAttribute("type","file"),a.setAttribute("name",this._options.name),qq(a).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(a);var b=this;return this._attach(a,"change",function(){b._options.onChange(a)}),this._attach(a,"mouseover",function(){qq(b._element).addClass(b._options.hoverClass)}),this._attach(a,"mouseout",function(){qq(b._element).removeClass(b._options.hoverClass)}),this._attach(a,"focus",function(){qq(b._element).addClass(b._options.focusClass)}),this._attach(a,"blur",function(){qq(b._element).removeClass(b._options.focusClass)}),window.attachEvent&&a.setAttribute("tabIndex","-1"),a}},qq.FineUploaderBasic=function(a){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},customHeaders:{},forceMultipart:!1,inputName:"qqfile"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:!0},callbacks:{onSubmit:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidate:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"}},qq.extend(this._options,a,!0),this._wrapCallbacks(),qq.extend(this,qq.DisposeSupport),this._filesInProgress=0,this._storedFileIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FineUploaderBasic.prototype={log:function(a,b){!this._options.debug||b&&"info"!==b?b&&"info"!==b&&qq.log("[FineUploader] "+a,b):qq.log("[FineUploader] "+a)},setParams:function(a){this._options.request.params=a},getInProgress:function(){return this._filesInProgress},uploadStoredFiles:function(){"use strict";for(;this._storedFileIds.length;)this._filesInProgress++,this._handler.upload(this._storedFileIds.shift(),this._options.request.params)},clearStoredFiles:function(){this._storedFileIds=[]},retry:function(a){return this._onBeforeManualRetry(a)?(this._handler.retry(a),!0):!1},cancel:function(a){this._handler.cancel(a)},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._filesInProgress=0,this._storedFileIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._button.reset()},_createUploadButton:function(a){var b=this,c=new qq.UploadButton({element:a,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),acceptFiles:this._options.validation.acceptFiles,onChange:function(a){b._onInputChange(a)}});return this.addDisposer(function(){c.dispose()}),c},_createUploadHandler:function(){var a,b=this;a=qq.UploadHandlerXhr.isSupported()?"UploadHandlerXhr":"UploadHandlerForm";var c=new qq[a]({debug:this._options.debug,endpoint:this._options.request.endpoint,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,demoMode:this._options.demoMode,log:this.log,onProgress:function(a,c,d,e){b._onProgress(a,c,d,e),b._options.callbacks.onProgress(a,c,d,e)},onComplete:function(a,c,d,e){b._onComplete(a,c,d,e),b._options.callbacks.onComplete(a,c,d)},onCancel:function(a,c){b._onCancel(a,c),b._options.callbacks.onCancel(a,c)},onUpload:function(a,c,d){b._onUpload(a,c,d),b._options.callbacks.onUpload(a,c,d)},onAutoRetry:function(a,c,d,e){return b._preventRetries[a]=d[b._options.retry.preventRetryResponseProperty],b._shouldAutoRetry(a,c,d)?(b._maybeParseAndSendUploadError(a,c,d,e),b._options.callbacks.onAutoRetry(a,c,b._autoRetries[a]+1),b._onBeforeAutoRetry(a,c),b._retryTimeouts[a]=setTimeout(function(){b._onAutoRetry(a,c,d)},1e3*b._options.retry.autoAttemptDelay),!0):!1}});return c},_preventLeaveInProgress:function(){var a=this;this._attach(window,"beforeunload",function(b){if(a._filesInProgress){var b=b||window.event;return b.returnValue=a._options.messages.onLeave,a._options.messages.onLeave}})},_onSubmit:function(){this._options.autoUpload&&this._filesInProgress++},_onProgress:function(){},_onComplete:function(a,b,c,d){this._filesInProgress--,this._maybeParseAndSendUploadError(a,b,c,d)},_onCancel:function(a){clearTimeout(this._retryTimeouts[a]);var b=qq.indexOf(this._storedFileIds,a);this._options.autoUpload||b<0?this._filesInProgress--:this._options.autoUpload||this._storedFileIds.splice(b,1)},_onUpload:function(){},_onInputChange:function(a){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(a.files):this._validateFile(a)&&this._uploadFile(a),this._button.reset()},_onBeforeAutoRetry:function(a,b){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+b+"...")},_onAutoRetry:function(a,b){this.log("Retrying "+b+"..."),this._autoRetries[a]++,this._handler.retry(a)},_shouldAutoRetry:function(a){return!this._preventRetries[a]&&this._options.retry.enableAuto?(void 0===this._autoRetries[a]&&(this._autoRetries[a]=0),this._autoRetries[a]<this._options.retry.maxAutoAttempts):!1},_onBeforeManualRetry:function(a){if(this._preventRetries[a])return this.log("Retries are forbidden for id "+a,"warn"),!1;if(this._handler.isValid(a)){var b=this._handler.getName(a);return this._options.callbacks.onManualRetry(a,b)===!1?!1:(this.log("Retrying upload for '"+b+"' (id: "+a+")..."),this._filesInProgress++,!0)}return this.log("'"+a+"' is not a valid file ID","error"),!1},_maybeParseAndSendUploadError:function(a,b,c,d){if(!c.success)if(d&&200!==d.status&&!c.error)this._options.callbacks.onError(a,b,"XHR returned response code "+d.status);else{var e=c.error?c.error:"Upload failure reason unknown";this._options.callbacks.onError(a,b,e)}},_uploadFileList:function(a){var b,c,d;if(b=this._getValidationDescriptors(a),b.length>1&&(d=this._options.callbacks.onValidate(b)===!1),!d)if(a.length>0){for(c=0;c<a.length;c++)if(this._validateFile(a[c]))this._uploadFile(a[c]);else if(this._options.validation.stopOnFirstInvalidFile)return}else this._error("noFilesError","")},_uploadFile:function(a){var b=this._handler.add(a),c=this._handler.getName(b);this._options.callbacks.onSubmit(b,c)!==!1&&(this._onSubmit(b,c),this._options.autoUpload?this._handler.upload(b,this._options.request.params):this._storeFileForLater(b))},_storeFileForLater:function(a){this._storedFileIds.push(a)},_validateFile:function(a){var b,c,d;return b=this._getValidationDescriptor(a),c=b.name,d=b.size,this._options.callbacks.onValidate([b])===!1?!1:this._isAllowedExtension(c)?0===d?(this._error("emptyError",c),!1):d&&this._options.validation.sizeLimit&&d>this._options.validation.sizeLimit?(this._error("sizeError",c),!1):d&&d<this._options.validation.minSizeLimit?(this._error("minSizeError",c),!1):!0:(this._error("typeError",c),!1)},_error:function(a,b){function c(a,b){d=d.replace(a,b)}var d=this._options.messages[a],e=this._options.validation.allowedExtensions.join(", ");return c("{file}",this._formatFileName(b)),c("{extensions}",e),c("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit)),c("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit)),this._options.callbacks.onError(null,b,d),d},_formatFileName:function(a){return a.length>33&&(a=a.slice(0,19)+"..."+a.slice(-13)),a},_isAllowedExtension:function(a){var b=-1!==a.indexOf(".")?a.replace(/.*[.]/,"").toLowerCase():"",c=this._options.validation.allowedExtensions;if(!c.length)return!0;for(var d=0;d<c.length;d++)if(c[d].toLowerCase()==b)return!0;return!1},_formatSize:function(a){var b=-1;do a/=1024,b++;while(a>99);return Math.max(a,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]},_wrapCallbacks:function(){var a,b;a=this,b=function(b,c,d){try{return c.apply(a,d)}catch(e){a.log("Caught exception in '"+b+"' callback - "+e,"error")}};for(var c in this._options.callbacks)!function(){var d=a._options.callbacks[c];a._options.callbacks[c]=function(){return b(c,d,arguments)}}()},_parseFileName:function(a){var b;return b=a.value?a.value.replace(/.*(\/|\\)/,""):null!==a.fileName&&void 0!==a.fileName?a.fileName:a.name},_parseFileSize:function(a){var b;return a.value||(b=null!==a.fileSize&&void 0!==a.fileSize?a.fileSize:a.size),b},_getValidationDescriptor:function(a){var b,c,d;return d={},b=this._parseFileName(a),c=this._parseFileSize(a),d.name=b,c&&(d.size=c),d},_getValidationDescriptors:function(a){var b,c;for(c=[],b=0;b<a.length;b++)c.push(a[b]);return c}},qq.FineUploader=function(a){qq.FineUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:!0,disableDefaultDropzone:!1},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",failUpload:"Upload failed",dragZone:"Drop files here to upload",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+(this._options.dragAndDrop&&this._options.dragAndDrop.disableDefaultDropzone?"":'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>')+(this._options.button?"":'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>')+(this._options.listElement?"":'<ul class="qq-upload-list"></ul>')+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file"},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:!1},showMessage:function(a){alert(a)}},!0),qq.extend(this._options,a,!0),this._wrapCallbacks(),this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,""),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._setupDragDrop()},qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype),qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments),this._listElement.innerHTML=""},addExtraDropzone:function(a){this._setupExtraDropzone(a)},removeExtraDropzone:function(a){var b=this._options.dragAndDrop.extraDropzones;for(var c in b)if(b[c]===a)return this._options.dragAndDrop.extraDropzones.splice(c,1)},getItemByFileId:function(a){for(var b=this._listElement.firstChild;b;){if(b.qqFileId==a)return b;b=b.nextSibling}},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments),this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._options.button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._setupDragDrop()},_leaving_document_out:function(a){return(qq.chrome()||qq.safari()&&qq.windows())&&0==a.clientX&&0==a.clientY||qq.firefox()&&!a.relatedTarget},_storeFileForLater:function(a){qq.FineUploaderBasic.prototype._storeFileForLater.apply(this,arguments);var b=this.getItemByFileId(a);qq(this._find(b,"spinner")).hide()},_find:function(a,b){var c=qq(a).getByClass(this._options.classes[b])[0];if(!c)throw new Error("element not found "+b);return c},_setupExtraDropzone:function(a){this._options.dragAndDrop.extraDropzones.push(a),this._setupDropzone(a)},_setupDropzone:function(a){var b=this,c=new qq.UploadDropZone({element:a,onEnter:function(c){qq(a).addClass(b._classes.dropActive),c.stopPropagation()},onLeave:function(){},onLeaveNotDescendants:function(){qq(a).removeClass(b._classes.dropActive)},onDrop:function(c){b._options.dragAndDrop.hideDropzones&&qq(a).hide(),qq(a).removeClass(b._classes.dropActive),c.dataTransfer.files.length>1&&!b._options.multiple?b._error("tooManyFilesError",""):b._uploadFileList(c.dataTransfer.files)}});this.addDisposer(function(){c.dispose()}),this._options.dragAndDrop.hideDropzones&&qq(a).hide()},_setupDragDrop:function(){var a,b;a=this,this._options.dragAndDrop.disableDefaultDropzone||(b=this._find(this._element,"drop"),this._options.dragAndDrop.extraDropzones.push(b));var c,d=this._options.dragAndDrop.extraDropzones;for(c=0;c<d.length;c++)this._setupDropzone(d[c]);this._options.dragAndDrop.disableDefaultDropzone||qq.ie()&&!qq.ie10()||this._attach(document,"dragenter",function(){if(!qq(b).hasClass(a._classes.dropDisabled))for(b.style.display="block",c=0;c<d.length;c++)d[c].style.display="block"}),this._attach(document,"dragleave",function(b){if(a._options.dragAndDrop.hideDropzones&&qq.FineUploader.prototype._leaving_document_out(b))for(c=0;c<d.length;c++)qq(d[c]).hide()}),qq(document).attach("drop",function(b){if(a._options.dragAndDrop.hideDropzones)for(c=0;c<d.length;c++)qq(d[c]).hide();b.preventDefault()})},_onSubmit:function(a,b){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(a,b)},_onProgress:function(a,b,c,d){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var e,f,g,h,i,j;e=this.getItemByFileId(a),f=this._find(e,"progressBar"),h=Math.round(c/d*100),c===d?(i=this._find(e,"cancel"),qq(i).hide(),qq(f).hide(),qq(this._find(e,"statusText")).setText(this._options.text.waitingForResponse),g=this._formatSize(d)):(g=this._formatProgress(c,d),qq(f).css({display:"block"})),qq(f).css({width:h+"%"}),j=this._find(e,"size"),qq(j).css({display:"inline"}),qq(j).setText(g)},_onComplete:function(a,b,c){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var d=this.getItemByFileId(a);qq(this._find(d,"statusText")).clearText(),qq(d).removeClass(this._classes.retrying),qq(this._find(d,"progressBar")).hide(),(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported())&&qq(this._find(d,"cancel")).hide(),qq(this._find(d,"spinner")).hide(),c.success?(qq(d).addClass(this._classes.success),this._classes.successIcon&&(this._find(d,"finished").style.display="inline-block",qq(d).addClass(this._classes.successIcon))):(qq(d).addClass(this._classes.fail),this._classes.failIcon&&(this._find(d,"finished").style.display="inline-block",qq(d).addClass(this._classes.failIcon)),this._options.retry.showButton&&!this._preventRetries[a]&&qq(d).addClass(this._classes.retryable),this._controlFailureTextDisplay(d,c))
},_onUpload:function(a){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments);var b=this.getItemByFileId(a);this._showSpinner(b)},_onBeforeAutoRetry:function(a){var b,c,d,e,f,g;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments),b=this.getItemByFileId(a),c=this._find(b,"progressBar"),this._showCancelLink(b),c.style.width=0,qq(c).hide(),this._options.retry.showAutoRetryNote&&(d=this._find(b,"statusText"),e=this._autoRetries[a]+1,f=this._options.retry.maxAutoAttempts,g=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,e),g=g.replace(/\{maxAuto\}/g,f),qq(d).setText(g),1===e&&qq(b).addClass(this._classes.retrying))},_onBeforeManualRetry:function(a){if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){var b=this.getItemByFileId(a);return this._find(b,"progressBar").style.width=0,qq(b).removeClass(this._classes.fail),this._showSpinner(b),this._showCancelLink(b),!0}return!1},_addToList:function(a,b){var c=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()){var d=this._find(c,"cancel");qq(d).remove()}c.qqFileId=a;var e=this._find(c,"file");qq(e).setText(this._formatFileName(b)),qq(this._find(c,"size")).hide(),this._options.multiple||this._clearList(),this._listElement.appendChild(c)},_clearList:function(){this._listElement.innerHTML="",this.clearStoredFiles()},_bindCancelAndRetryEvents:function(){var a=this,b=this._listElement;this._attach(b,"click",function(b){b=b||window.event;var c=b.target||b.srcElement;if(qq(c).hasClass(a._classes.cancel)||qq(c).hasClass(a._classes.retry)){qq.preventDefault(b);for(var d=c.parentNode;void 0==d.qqFileId;)d=c=c.parentNode;qq(c).hasClass(a._classes.cancel)?(a.cancel(d.qqFileId),qq(d).remove()):(qq(d).removeClass(a._classes.retryable),a.retry(d.qqFileId))}})},_formatProgress:function(a,b){function c(a,b){d=d.replace(a,b)}var d=this._options.text.formatProgress;return c("{percent}",Math.round(a/b*100)),c("{total_size}",this._formatSize(b)),d},_controlFailureTextDisplay:function(a,b){var c,d,e,f,g;c=this._options.failedUploadTextDisplay.mode,d=this._options.failedUploadTextDisplay.maxChars,e=this._options.failedUploadTextDisplay.responseProperty,"custom"===c?(f=b[e],f?f.length>d&&(g=f.substring(0,d)+"..."):(f=this._options.text.failUpload,this.log("'"+e+"' is not a valid property on the server response.","warn")),qq(this._find(a,"statusText")).setText(g||f),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(a,f)):"default"===c?qq(this._find(a,"statusText")).setText(this._options.text.failUpload):"none"!==c&&this.log("failedUploadTextDisplay.mode value of '"+c+"' is not valid","warn")},_showTooltip:function(a,b){a.title=b},_showSpinner:function(a){var b=this._find(a,"spinner");b.style.display="inline-block"},_showCancelLink:function(a){if(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported()){var b=this._find(a,"cancel");b.style.display="inline"}},_error:function(){var a=qq.FineUploaderBasic.prototype._error.apply(this,arguments);this._options.showMessage(a)}}),qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}},qq.extend(this._options,a),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||qq.firefox()&&qq.windows()},_disableDropOutside:function(){qq.UploadDropZone.dropOutsideDisabled||(this._dragover_should_be_canceled?qq(document).attach("dragover",function(a){a.preventDefault()}):qq(document).attach("dragover",function(a){a.dataTransfer&&(a.dataTransfer.dropEffect="none",a.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var a=this;a._attach(a._element,"dragover",function(b){if(a._isValidFileDrag(b)){var c=qq.ie()?null:b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"==c||"linkMove"==c?"move":"copy",b.stopPropagation(),b.preventDefault()}}),a._attach(a._element,"dragenter",function(b){a._isValidFileDrag(b)&&a._options.onEnter(b)}),a._attach(a._element,"dragleave",function(b){if(a._isValidFileDrag(b)){a._options.onLeave(b);var c=document.elementFromPoint(b.clientX,b.clientY);qq(this).contains(c)||a._options.onLeaveNotDescendants(b)}}),a._attach(a._element,"drop",function(b){a._isValidFileDrag(b)&&(b.preventDefault(),a._options.onDrop(b))})},_isValidFileDrag:function(a){if(qq.ie()&&!qq.ie10())return!1;var b=a.dataTransfer,c=qq.safari(),d=qq.ie10()?!0:"none"!=b.effectAllowed;return b&&d&&(b.files||!c&&b.types.contains&&b.types.contains("Files"))}},qq.UploadHandlerAbstract=function(a){this._options={debug:!1,endpoint:"/upload.php",maxConnections:999,log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onAutoRetry:function(){}},qq.extend(this._options,a),this._queue=[],this._params=[],this.log=this._options.log},qq.UploadHandlerAbstract.prototype={add:function(){},upload:function(a,b){var c=this._queue.push(a),d={};qq.extend(d,b),this._params[a]=d,c<=this._options.maxConnections&&this._upload(a,this._params[a])},retry:function(a){var b=qq.indexOf(this._queue,a);b>=0?this._upload(a,this._params[a]):this.upload(a,this._params[a])},cancel:function(a){this.log("Cancelling "+a),this._cancel(a),this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++)this._cancel(this._queue[a]);this._queue=[]},getName:function(){},getSize:function(){},getQueue:function(){return this._queue},reset:function(){this.log("Resetting upload handler"),this._queue=[],this._params=[]},_upload:function(){},_cancel:function(){},_dequeue:function(a){var b=qq.indexOf(this._queue,a);this._queue.splice(b,1);var c=this._options.maxConnections;if(this._queue.length>=c&&b<c){var d=this._queue[c-1];this._upload(d,this._params[d])}},isValid:function(){}},qq.UploadHandlerForm=function(){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={},this._detach_load_events={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name",this._options.inputName);var b="qq-upload-handler-iframe"+qq.getUniqueId();return this._inputs[b]=a,a.parentNode&&qq(a).remove(),b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},isValid:function(a){return void 0!==this._inputs[a]},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments),this._inputs={},this._detach_load_events={}},_cancel:function(a){this._options.onCancel(a,this.getName(a)),delete this._inputs[a],delete this._detach_load_events[a];var b=document.getElementById(a);b&&(b.setAttribute("src","javascript:false;"),qq(b).remove())},_upload:function(a,b){this._options.onUpload(a,this.getName(a),!1);var c=this._inputs[a];if(!c)throw new Error("file with passed id was not added, or already uploaded or cancelled");var d=this.getName(a);b[this._options.inputName]=d;var e=this._createIframe(a),f=this._createForm(e,b);f.appendChild(c);var g=this;return this._attachLoadEvent(e,function(){g.log("iframe loaded");var b=g._getIframeContentJSON(e);setTimeout(function(){g._detach_load_events[a](),delete g._detach_load_events[a],qq(e).remove()},1),(b.success||!g._options.onAutoRetry(a,d,b))&&(g._options.onComplete(a,d,b),g._dequeue(a))}),this.log("Sending upload request for "+a),f.submit(),qq(f).remove(),a},_attachLoadEvent:function(a,b){var c=this;this._detach_load_events[a.id]=qq(a).attach("load",function(){if(c.log("Received response for "+a.id),a.parentNode){try{if(a.contentDocument&&a.contentDocument.body&&"false"==a.contentDocument.body.innerHTML)return}catch(d){c.log("Error when attempting to access iframe during handling of upload response ("+d+")","error")}b()}})},_getIframeContentJSON:function(iframe){try{var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response,innerHTML=doc.body.innerHTML;this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+innerHTML),innerHTML&&innerHTML.match(/^<pre/i)&&(innerHTML=doc.body.firstChild.firstChild.nodeValue),response=eval("("+innerHTML+")")}catch(error){this.log("Error when attempting to parse form upload response ("+error+")","error"),response={success:!1}}return response},_createIframe:function(a){var b=qq.toElement('<iframe src="javascript:false;" name="'+a+'" />');return b.setAttribute("id",a),b.style.display="none",document.body.appendChild(b),b},_createForm:function(a,b){var c=this._options.demoMode?"GET":"POST",d=qq.toElement('<form method="'+c+'" enctype="multipart/form-data"></form>'),e=qq.obj2url(b,this._options.endpoint);return d.setAttribute("action",e),d.setAttribute("target",a.name),d.style.display="none",document.body.appendChild(d),d}}),qq.UploadHandlerXhr=function(){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");return a.type="file","multiple"in a&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof(new XMLHttpRequest).upload},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File))throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)");return this._files.push(a)-1},getName:function(a){var b=this._files[a];return null!==b.fileName&&void 0!==b.fileName?b.fileName:b.name},getSize:function(a){var b=this._files[a];return null!=b.fileSize?b.fileSize:b.size},getLoaded:function(a){return this._loaded[a]||0},isValid:function(a){return void 0!==this._files[a]},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},_upload:function(a,b){this._options.onUpload(a,this.getName(a),!0);{var c=this._files[a],d=this.getName(a);this.getSize(a)}this._loaded[a]=0;var e=this._xhrs[a]=new XMLHttpRequest,f=this;e.upload.onprogress=function(b){b.lengthComputable&&(f._loaded[a]=b.loaded,f._options.onProgress(a,d,b.loaded,b.total))},e.onreadystatechange=function(){4==e.readyState&&f._onComplete(a,e)},b=b||{},b[this._options.inputName]=d;var g=qq.obj2url(b,this._options.endpoint),h=this._options.demoMode?"GET":"POST";if(e.open(h,g,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("X-File-Name",encodeURIComponent(d)),e.setRequestHeader("Cache-Control","no-cache"),this._options.forceMultipart){var i=new FormData;i.append(this._options.inputName,c),c=i}else e.setRequestHeader("Content-Type","application/octet-stream"),e.setRequestHeader("X-Mime-Type",c.type);for(key in this._options.customHeaders)e.setRequestHeader(key,this._options.customHeaders[key]);this.log("Sending upload request for "+a),e.send(c)},_onComplete:function(id,xhr){"use strict";if(this._files[id]){var name=this.getName(id),size=this.getSize(id),response;this._options.onProgress(id,name,size,size),this.log("xhr - server response received for "+id),this.log("responseText = "+xhr.responseText);try{response="function"===typeof JSON.parse?JSON.parse(xhr.responseText):eval("("+xhr.responseText+")")}catch(error){this.log("Error when attempting to parse xhr response text ("+error+")","error"),response={}}(200===xhr.status&&response.success||!this._options.onAutoRetry(id,name,response,xhr))&&(this._options.onComplete(id,name,response,xhr),this._xhrs[id]=null,this._dequeue(id))}},_cancel:function(a){this._options.onCancel(a,this.getName(a)),this._files[a]=null,this._xhrs[a]&&(this._xhrs[a].abort(),this._xhrs[a]=null)}}),function(){var a=qq.UploadHandlerForm.prototype._createForm;qq.UploadHandlerForm.prototype._createForm=function(){var b=a.apply(this,arguments),c=$('<input type="hidden" name="csrfmiddlewaretoken" value="'+P.csrf.getCSRFToken()+'">');return b.appendChild(c.get(0)),b}}(),function(a){function b(a){if(a in l.style)return a;var b=["Moz","Webkit","O","ms"],c=a.charAt(0).toUpperCase()+a.substr(1);if(a in l.style)return a;for(var d=0;d<b.length;++d){var e=b[d]+c;if(e in l.style)return e}}function c(){return l.style[m.transform]="",l.style[m.transform]="rotateY(90deg)",""!==l.style[m.transform]}function d(a){return"string"===typeof a&&this.parse(a),this}function e(a,b,c){b===!0?a.queue(c):b?a.queue(b,c):c()}function f(b){var c=[];return a.each(b,function(b){b=a.camelCase(b),b=a.transit.propertyMap[b]||a.cssProps[b]||b,b=i(b),m[b]&&(b=i(m[b])),-1===a.inArray(b,c)&&c.push(b)}),c}function g(b,c,d,e){var g=f(b);a.cssEase[d]&&(d=a.cssEase[d]);var h=""+k(c)+" "+d;parseInt(e,10)>0&&(h+=" "+k(e));var i=[];return a.each(g,function(a,b){i.push(b+" "+h)}),i.join(", ")}function h(b,c){c||(a.cssNumber[b]=!0),a.transit.propertyMap[b]=m.transform,a.cssHooks[b]={get:function(c){var d=a(c).css("transit:transform");return d.get(b)},set:function(c,d){var e=a(c).css("transit:transform");e.setFromString(b,d),a(c).css({"transit:transform":e})}}}function i(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function j(a,b){return"string"!==typeof a||a.match(/^[\-0-9\.]+$/)?""+a+b:a}function k(b){var c=b;return"string"!==typeof c||c.match(/^[\-0-9\.]+/)||(c=a.fx.speeds[c]||a.fx.speeds._default),j(c,"ms")}a.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var l=document.createElement("div"),m={},n=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;m.transition=b("transition"),m.transitionDelay=b("transitionDelay"),m.transform=b("transform"),m.transformOrigin=b("transformOrigin"),m.filter=b("Filter"),m.transform3d=c();var o={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},p=m.transitionEnd=o[m.transition]||null;for(var q in m)m.hasOwnProperty(q)&&"undefined"===typeof a.support[q]&&(a.support[q]=m[q]);l=null,a.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},a.cssHooks["transit:transform"]={get:function(b){return a(b).data("transform")||new d},set:function(b,c){var e=c;e instanceof d||(e=new d(e)),b.style[m.transform]="WebkitTransform"!==m.transform||n?e.toString():e.toString(!0),a(b).data("transform",e)}},a.cssHooks.transform={set:a.cssHooks["transit:transform"].set},a.cssHooks.filter={get:function(a){return a.style[m.filter]},set:function(a,b){a.style[m.filter]=b}},a.fn.jquery<"1.8"&&(a.cssHooks.transformOrigin={get:function(a){return a.style[m.transformOrigin]},set:function(a,b){a.style[m.transformOrigin]=b}},a.cssHooks.transition={get:function(a){return a.style[m.transition]},set:function(a,b){a.style[m.transition]=b}}),h("scale"),h("translate"),h("rotate"),h("rotateX"),h("rotateY"),h("rotate3d"),h("perspective"),h("skewX"),h("skewY"),h("x",!0),h("y",!0),d.prototype={setFromString:function(a,b){var c="string"===typeof b?b.split(","):b.constructor===Array?b:[b];c.unshift(a),d.prototype.set.apply(this,c)},set:function(a){var b=Array.prototype.slice.apply(arguments,[1]);this.setter[a]?this.setter[a].apply(this,b):this[a]=b.join(",")},get:function(a){return this.getter[a]?this.getter[a].apply(this):this[a]||0},setter:{rotate:function(a){this.rotate=j(a,"deg")},rotateX:function(a){this.rotateX=j(a,"deg")},rotateY:function(a){this.rotateY=j(a,"deg")},scale:function(a,b){void 0===b&&(b=a),this.scale=a+","+b},skewX:function(a){this.skewX=j(a,"deg")},skewY:function(a){this.skewY=j(a,"deg")},perspective:function(a){this.perspective=j(a,"px")},x:function(a){this.set("translate",a,null)},y:function(a){this.set("translate",null,a)},translate:function(a,b){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==a&&void 0!==a&&(this._translateX=j(a,"px")),null!==b&&void 0!==b&&(this._translateY=j(b,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var a=(this.scale||"1,1").split(",");return a[0]&&(a[0]=parseFloat(a[0])),a[1]&&(a[1]=parseFloat(a[1])),a[0]===a[1]?a[0]:a},rotate3d:function(){for(var a=(this.rotate3d||"0,0,0,0deg").split(","),b=0;b<=3;++b)a[b]&&(a[b]=parseFloat(a[b]));return a[3]&&(a[3]=j(a[3],"deg")),a}},parse:function(a){var b=this;a.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(a,c,d){b.setFromString(c,d)})},toString:function(a){var b=[];for(var c in this)if(this.hasOwnProperty(c)){if(!m.transform3d&&("rotateX"===c||"rotateY"===c||"perspective"===c||"transformOrigin"===c))continue;"_"!==c[0]&&b.push(a&&"scale"===c?c+"3d("+this[c]+",1)":a&&"translate"===c?c+"3d("+this[c]+",0)":c+"("+this[c]+")")}return b.join(" ")}},a.fn.transition=a.fn.transit=function(b,c,d,f){var h=this,i=0,j=!0,l=jQuery.extend(!0,{},b);"function"===typeof c&&(f=c,c=void 0),"object"===typeof c&&(d=c.easing,i=c.delay||0,j=c.queue||!0,f=c.complete,c=c.duration),"function"===typeof d&&(f=d,d=void 0),"undefined"!==typeof l.easing&&(d=l.easing,delete l.easing),"undefined"!==typeof l.duration&&(c=l.duration,delete l.duration),"undefined"!==typeof l.complete&&(f=l.complete,delete l.complete),"undefined"!==typeof l.queue&&(j=l.queue,delete l.queue),"undefined"!==typeof l.delay&&(i=l.delay,delete l.delay),"undefined"===typeof c&&(c=a.fx.speeds._default),"undefined"===typeof d&&(d=a.cssEase._default),c=k(c);var n=g(l,c,d,i),o=a.transit.enabled&&m.transition,q=o?parseInt(c,10)+parseInt(i,10):0;if(0===q){var r=function(a){h.css(l),f&&f.apply(h),a&&a()};return e(h,j,r),h}var s={},t=function(c){var d=!1,e=function(){d&&h.unbind(p,e),q>0&&h.each(function(){this.style[m.transition]=s[this]||null}),"function"===typeof f&&f.apply(h),"function"===typeof c&&c()};q>0&&p&&a.transit.useTransitionEnd?(d=!0,h.bind(p,e)):window.setTimeout(e,q),h.each(function(){q>0&&(this.style[m.transition]=n),a(this).css(b)})},u=function(a){this.offsetWidth=this.offsetWidth,t(a)};return e(h,j,u),this},a.transit.getTransitionValue=g}(jQuery),function(){$.fn.grid=function(b){var e;if("string"===typeof arguments[0]){var f=arguments;this.each(function(){var a=c[d(this)];a&&(e=a[b].apply(a,Array.prototype.slice.call(f,1)))})}else this.each(function(){b.container=this,c[d(this)]=new a(b)});return e||this};var a=function(a){if(this.options={$container:$(a.container),children:a.children,appendedChildren:[],gridSize:a.gridSize,gridGutter:a.gridGutter,setChildPosition:a.setChildPosition,unsetChildPosition:a.unsetChildPosition,setChildProperties:a.setChildProperties,unsetChildProperties:a.unsetChildProperties,maxRows:a.maxRows},this.options.children.length&&this.reflowContent(),a.onInitialized){var b=this;_.defer(function(){a.onInitialized.apply(b)})}};a.prototype.reflowContent=function(a){if(!a){var b=!(!this._columns||!this._columns.length);this._createColumns();for(var c,d=0;d<this.options.children.length;d++)c=this.options.children[d],b&&this._unpositionChild(c,d),this._positionChild(c,d)}if(this.options.appendedChildren.length){for(var d=0;d<this.options.appendedChildren.length;d++){var c=this.options.appendedChildren[d];this.options.children.push(c),this._positionChild(c,this.options.children.length)}this.options.appendedChildren=[]}var e=this.getContainerHeight();this.options.$container.css({height:e})},a.prototype.getContainerHeight=function(){var a=Math.max.apply(null,_.map(this._columns,function(a){return a.height}));return a},a.prototype.getFilledHeight=function(){var a=Math.min.apply(null,_.map(this._columns,function(a){return a.height}));return a},a.prototype._createColumns=function(){this.options.$container.css({width:"auto"});var a=this._computeColumnCount();this.options.$container.css({width:this._computeGridWidth(a)}),this._columns=[],this._currentColumn=0;for(var c=0;c<a;c++)this._columns[c]=new b(c,this)},a.prototype._computeColumnCount=function(){var a=this.options.$container.width(),b=Math.floor(a/(this.options.gridSize+this.options.gridGutter));return b},a.prototype._computeGridWidth=function(a){return a*(this.options.gridSize+this.options.gridGutter)},a.prototype.appendChild=function(a,b){if(b)this.options.appendedChildren.push(a);else{this._columns||this._createColumns(),this.options.children.push(a),this._positionChild(a,this.options.children.length);var c=this.getContainerHeight();this.options.$container.css({height:c})}},a.prototype._positionChild=function(a,b){if(this._columns&&this._columns.length&&(!this.options.maxRows||this._columns[this._currentColumn].filledRows!==this.options.maxRows)){var c,d=[[]],e=0,f=this._columns.length,g=this._columns[this._currentColumn].height,h=$.data(a,"grid-columns")||1,i=$.data(a,"grid-rows")||1;for(c=this._currentColumn;c<f+this._currentColumn;c++){var j=c%f;0===j&&(d[e]=[]),this._columns[j].height==g?(d[e].length<h&&d[e].push(this._columns[j]),d[e].length==h&&(e++,d[e]=[])):(d[e]=[this._columns[j]],g=this._columns[j].height)}var k=d[0];for(c=1;c<d.length;c++)d[c].length===h&&d[c][0].height<k[0].height&&(k=d[c]);if(k.length==h&&!(this.options.maxRows&&k[0].filledRows+i>this.options.maxRows)){for(var l=0;l<k.length;l++)k[l].addChild(a,0===l,b);this._setChildProperties(a,b),this._recalculateSmallestColumn()}}},a.prototype._unpositionChild=function(a){this.unsetChildPosition(a,i),this._unsetChildProperties(a,i)},a.prototype._setChildProperties=function(a,b){var c={width:this._getDimensionFromSize($.data(a,"grid-columns"))||1,height:this._getDimensionFromSize($.data(a,"grid-rows"))||1};this.options.setChildProperties?this.options.setChildProperties(a,c,b):$(a).css(c)},a.prototype._unsetChildProperties=function(a,b){this.options.unsetChildProperties?this.options.unsetChildProperties(a,b):$(a).css({width:"",height:""})},a.prototype.setChildPosition=function(a,b,c){this.options.setChildPosition?this.options.setChildPosition(a,b,c):a.css(b)},a.prototype.unsetChildPosition=function(a,b){this.options.unsetChildPosition?this.options.unsetChildPosition(a,b):a.css({left:"",top:""})},a.prototype._getDimensionFromSize=function(a){return a*this.options.gridSize+(a-1)*this.options.gridGutter},a.prototype._recalculateSmallestColumn=function(){var a=this;this._currentColumn=_.min(_.range(this._columns.length),function(b){return a._columns[b].height})},a.prototype.setOptions=function(a){_.each(a,function(a,b){this.options[b]=a},this)};var b=function(a,b){this.id=a,this.children=[],this.height=0,this.filledRows=0,this.grid=b};b.prototype.addChild=function(a,b,c){var d=this.grid.options;if(this.children.push(a),b){var e={left:this.id*(d.gridSize+d.gridGutter),top:this.height};this.grid.setChildPosition(a,e,c)}var f=$.data(a,"grid-rows")||1;this.filledRows=this.filledRows+f,this.height=this.filledRows*(d.gridSize+d.gridGutter)};var c={},d=function(a){var b=$(a),d=b.attr("grid-id");return void 0===d&&(d=_.size(c),b.attr("grid-id",d)),d}}(),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.ui.version||(a.extend(a.ui,{version:"1.10.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return"number"===typeof b?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!==typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}}))}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;h<i;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"===typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,this.each(h?function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}:function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"===typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];
if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!==typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"===typeof g?f[g]:g).apply(f,arguments):void 0}"string"!==typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"===typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"===typeof e&&(e={effect:e});var g,h=e?e===!0||"number"===typeof e?c:e.effect||c:b;e=e||{},"number"===typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"===typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){function b(a,b,c){return a>b&&a<b+c}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d?!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),e)?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(b,c,d){var e,f=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),f.containment&&this._setContainment(),f.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",f.cursor)),f.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",f.opacity)),f.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",f.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!f.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset();this.reverting=!0,a(this.helper).animate({left:e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l=d+j>h&&d+j<i&&b+k>f&&b+k<g;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?l:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(a){var c="x"===this.options.axis||b(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||b(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1):!1},_intersectsWithSides:function(a){var c=b(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=b(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&c||"up"===e&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c,d,e,f,g=[],h=[],i=this._connectWith();if(i&&b)for(c=i.length-1;c>=0;c--)for(e=a(i[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&h.push([a.isFunction(f.options.items)?f.options.items.call(f.element):a(f.options.items,f.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),f]);for(h.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),c=h.length-1;c>=0;c--)h[c][0].each(function(){g.push(this)});return a(g)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;c<b.length;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;d<j;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=a(document.createElement(b.currentItem[0].nodeName)).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return c||(d.style.visibility="hidden"),d},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(b){var c,d,e,f,g,h,i,j,k,l=null,m=null;for(c=this.containers.length-1;c>=0;c--)if(!a.contains(this.currentItem[0],this.containers[c].element[0]))if(this._intersectsWith(this.containers[c].containerCache)){if(l&&a.contains(this.containers[c].element[0],l.element[0]))continue;l=this.containers[c],m=c}else this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",b,this._uiHash(this)),this.containers[c].containerCache.over=0);if(l)if(1===this.containers.length)this.containers[m]._trigger("over",b,this._uiHash(this)),this.containers[m].containerCache.over=1;else{for(e=1e4,f=null,g=this.containers[m].floating?"left":"top",h=this.containers[m].floating?"width":"height",i=this.positionAbs[g]+this.offset.click[g],d=this.items.length-1;d>=0;d--)a.contains(this.containers[m].element[0],this.items[d].item[0])&&this.items[d].item[0]!==this.currentItem[0]&&(j=this.items[d].item.offset()[g],k=!1,Math.abs(j-i)>Math.abs(j+this.items[d][h]-i)&&(k=!0,j+=this.items[d][h]),Math.abs(j-i)<e&&(e=Math.abs(j-i),f=this.items[d],this.direction=k?"up":"down"));if(!f&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[m],f?this._rearrange(b,f,null,!0):this._rearrange(b,null,this.containers[m].element,!0),this._trigger("change",b,this._uiHash()),this.containers[m]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",b,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"===typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(b,c){this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)("auto"===this._storedCSS[d]||"static"===this._storedCSS[d])&&(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!c&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||c||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(c||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)c||e.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over=0);if(this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!c){for(this._trigger("beforeStop",b,this._uiHash()),d=0;d<e.length;d++)e[d].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!1}if(c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!c){for(d=0;d<e.length;d++)e[d].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(jQuery),function(a){var b=document.createElement("input"),c="oninput"in b&&(!("documentMode"in document)||document.documentMode>9),d=function(a){return"INPUT"===a.nodeName&&("text"===a.type||"password"===a.type)},e=null,f=null,g=null,h={get:function(){return g.get.call(this)},set:function(a){f=a,g.set.call(this,a)}},i=function(a){e=a,f=a.value,g=Object.getOwnPropertyDescriptor(a.constructor.prototype,"value"),Object.defineProperty(e,"value",h),e.attachEvent("onpropertychange",k)},j=function(){e&&(delete e.value,e.detachEvent("onpropertychange",k),e=null,f=null,g=null)},k=function(b){if("value"===b.propertyName){var c=b.srcElement.value;c!==f&&(f=c,a(e).trigger("textchange"))}};c?a(document).on("input",function(b){"TEXTAREA"!==b.target.nodeName&&a(b.target).trigger("textchange")}):a(document).on("focusin",function(a){d(a.target)&&(j(),i(a.target))}).on("focusout",function(){j()}).on("selectionchange keyup keydown",function(){e&&e.value!==f&&(f=e.value,a(e).trigger("textchange"))})}(jQuery),function(a){a.color={},a.color.make=function(b,c,d,e){var f={};return f.r=b||0,f.g=c||0,f.b=d||0,f.a=null!=e?e:1,f.add=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]+=b;return f.normalize()},f.scale=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]*=b;return f.normalize()},f.toString=function(){return f.a>=1?"rgb("+[f.r,f.g,f.b].join(",")+")":"rgba("+[f.r,f.g,f.b,f.a].join(",")+")"},f.normalize=function(){function a(a,b,c){return b<a?a:b>c?c:b}return f.r=a(0,parseInt(f.r),255),f.g=a(0,parseInt(f.g),255),f.b=a(0,parseInt(f.b),255),f.a=a(0,f.a,1),f},f.clone=function(){return a.color.make(f.r,f.b,f.g,f.a)},f.normalize()},a.color.extract=function(b,c){var d;do{if(d=b.css(c).toLowerCase(),""!=d&&"transparent"!=d)break;b=b.parent()}while(!a.nodeName(b.get(0),"body"));return"rgba(0, 0, 0, 0)"==d&&(d="transparent"),a.color.parse(d)},a.color.parse=function(c){var d,e=a.color.make;if(d=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10));if(d=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10),parseFloat(d[4]));if(d=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return e(2.55*parseFloat(d[1]),2.55*parseFloat(d[2]),2.55*parseFloat(d[3]));if(d=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(2.55*parseFloat(d[1]),2.55*parseFloat(d[2]),2.55*parseFloat(d[3]),parseFloat(d[4]));if(d=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return e(parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16));if(d=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return e(parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16));var f=a.trim(c).toLowerCase();return"transparent"==f?e(255,255,255,0):(d=b[f]||[0,0,0],e(d[0],d[1],d[2]))};var b={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}
}(jQuery),function(a){function b(b,d,e,f){function g(a,b){b=[ub].concat(b);for(var c=0;c<a.length;++c)a[c].apply(this,b)}function h(){for(var b=0;b<f.length;++b){var c=f[b];c.init(ub),c.options&&a.extend(!0,gb,c.options)}}function j(b){var c;for(a.extend(!0,gb,b),null==gb.xaxis.color&&(gb.xaxis.color=gb.grid.color),null==gb.yaxis.color&&(gb.yaxis.color=gb.grid.color),null==gb.xaxis.tickColor&&(gb.xaxis.tickColor=gb.grid.tickColor),null==gb.yaxis.tickColor&&(gb.yaxis.tickColor=gb.grid.tickColor),null==gb.grid.borderColor&&(gb.grid.borderColor=gb.grid.color),null==gb.grid.tickColor&&(gb.grid.tickColor=a.color.parse(gb.grid.color).scale("a",.22).toString()),c=0;c<Math.max(1,gb.xaxes.length);++c)gb.xaxes[c]=a.extend(!0,{},gb.xaxis,gb.xaxes[c]);for(c=0;c<Math.max(1,gb.yaxes.length);++c)gb.yaxes[c]=a.extend(!0,{},gb.yaxis,gb.yaxes[c]);for(gb.xaxis.noTicks&&null==gb.xaxis.ticks&&(gb.xaxis.ticks=gb.xaxis.noTicks),gb.yaxis.noTicks&&null==gb.yaxis.ticks&&(gb.yaxis.ticks=gb.yaxis.noTicks),gb.x2axis&&(gb.xaxes[1]=a.extend(!0,{},gb.xaxis,gb.x2axis),gb.xaxes[1].position="top"),gb.y2axis&&(gb.yaxes[1]=a.extend(!0,{},gb.yaxis,gb.y2axis),gb.yaxes[1].position="right"),gb.grid.coloredAreas&&(gb.grid.markings=gb.grid.coloredAreas),gb.grid.coloredAreasColor&&(gb.grid.markingsColor=gb.grid.coloredAreasColor),gb.lines&&a.extend(!0,gb.series.lines,gb.lines),gb.points&&a.extend(!0,gb.series.points,gb.points),gb.bars&&a.extend(!0,gb.series.bars,gb.bars),null!=gb.shadowSize&&(gb.series.shadowSize=gb.shadowSize),c=0;c<gb.xaxes.length;++c)q(mb,c+1).options=gb.xaxes[c];for(c=0;c<gb.yaxes.length;++c)q(nb,c+1).options=gb.yaxes[c];for(var d in tb)gb.hooks[d]&&gb.hooks[d].length&&(tb[d]=tb[d].concat(gb.hooks[d]));g(tb.processOptions,[gb])}function k(a){fb=l(a),r(),s()}function l(b){for(var c=[],d=0;d<b.length;++d){var e=a.extend(!0,{},gb.series);null!=b[d].data?(e.data=b[d].data,delete b[d].data,a.extend(!0,e,b[d]),b[d].data=e.data):e.data=b[d],c.push(e)}return c}function m(a,b){var c=a[b+"axis"];return"object"==typeof c&&(c=c.n),"number"!=typeof c&&(c=1),c}function n(){return a.grep(mb.concat(nb),function(a){return a})}function o(a){var b,c,d={};for(b=0;b<mb.length;++b)c=mb[b],c&&c.used&&(d["x"+c.n]=c.c2p(a.left));for(b=0;b<nb.length;++b)c=nb[b],c&&c.used&&(d["y"+c.n]=c.c2p(a.top));return void 0!==d.x1&&(d.x=d.x1),void 0!==d.y1&&(d.y=d.y1),d}function p(a){var b,c,d,e={};for(b=0;b<mb.length;++b)if(c=mb[b],c&&c.used&&(d="x"+c.n,null==a[d]&&1==c.n&&(d="x"),null!=a[d])){e.left=c.p2c(a[d]);break}for(b=0;b<nb.length;++b)if(c=nb[b],c&&c.used&&(d="y"+c.n,null==a[d]&&1==c.n&&(d="y"),null!=a[d])){e.top=c.p2c(a[d]);break}return e}function q(b,c){return b[c-1]||(b[c-1]={n:c,direction:b==mb?"x":"y",options:a.extend(!0,{},b==mb?gb.xaxis:gb.yaxis)}),b[c-1]}function r(){var b,c=fb.length,d=[],e=[];for(b=0;b<fb.length;++b){var f=fb[b].color;null!=f&&(--c,"number"==typeof f?e.push(f):d.push(a.color.parse(fb[b].color)))}for(b=0;b<e.length;++b)c=Math.max(c,e[b]+1);var g=[],h=0;for(b=0;g.length<c;){var i;i=gb.colors.length==b?a.color.make(100,100,100):a.color.parse(gb.colors[b]);var j=h%2==1?-1:1;i.scale("rgb",1+j*Math.ceil(h/2)*.2),g.push(i),++b,b>=gb.colors.length&&(b=0,++h)}var k,l=0;for(b=0;b<fb.length;++b){if(k=fb[b],null==k.color?(k.color=g[l].toString(),++l):"number"==typeof k.color&&(k.color=g[k.color].toString()),null==k.lines.show){var n,o=!0;for(n in k)if(k[n]&&k[n].show){o=!1;break}o&&(k.lines.show=!0)}k.xaxis=q(mb,m(k,"x")),k.yaxis=q(nb,m(k,"y"))}}function s(){function b(a,b,c){b<a.datamin&&b!=-q&&(a.datamin=b),c>a.datamax&&c!=q&&(a.datamax=c)}var c,d,e,f,h,i,j,k,l,m,o=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,q=Number.MAX_VALUE;for(a.each(n(),function(a,b){b.datamin=o,b.datamax=p,b.used=!1}),c=0;c<fb.length;++c)h=fb[c],h.datapoints={points:[]},g(tb.processRawData,[h,h.data,h.datapoints]);for(c=0;c<fb.length;++c){h=fb[c];var r=h.data,s=h.datapoints.format;if(s||(s=[],s.push({x:!0,number:!0,required:!0}),s.push({y:!0,number:!0,required:!0}),(h.bars.show||h.lines.show&&h.lines.fill)&&(s.push({y:!0,number:!0,required:!1,defaultValue:0}),h.bars.horizontal&&(delete s[s.length-1].y,s[s.length-1].x=!0)),h.datapoints.format=s),null==h.datapoints.pointsize)for(h.datapoints.pointsize=s.length,j=h.datapoints.pointsize,i=h.datapoints.points,insertSteps=h.lines.show&&h.lines.steps,h.xaxis.used=h.yaxis.used=!0,d=e=0;d<r.length;++d,e+=j){m=r[d];var t=null==m;if(!t)for(f=0;f<j;++f)k=m[f],l=s[f],l&&(l.number&&null!=k&&(k=+k,isNaN(k)?k=null:1/0==k?k=q:k==-1/0&&(k=-q)),null==k&&(l.required&&(t=!0),null!=l.defaultValue&&(k=l.defaultValue))),i[e+f]=k;if(t)for(f=0;f<j;++f)k=i[e+f],null!=k&&(l=s[f],l.x&&b(h.xaxis,k,k),l.y&&b(h.yaxis,k,k)),i[e+f]=null;else if(insertSteps&&e>0&&null!=i[e-j]&&i[e-j]!=i[e]&&i[e-j+1]!=i[e+1]){for(f=0;f<j;++f)i[e+j+f]=i[e+f];i[e+1]=i[e-j+1],e+=j}}}for(c=0;c<fb.length;++c)h=fb[c],g(tb.processDatapoints,[h,h.datapoints]);for(c=0;c<fb.length;++c){h=fb[c],i=h.datapoints.points,j=h.datapoints.pointsize;var u=o,v=o,w=p,x=p;for(d=0;d<i.length;d+=j)if(null!=i[d])for(f=0;f<j;++f)k=i[d+f],l=s[f],l&&k!=q&&k!=-q&&(l.x&&(k<u&&(u=k),k>w&&(w=k)),l.y&&(k<v&&(v=k),k>x&&(x=k)));if(h.bars.show){var y="left"==h.bars.align?0:-h.bars.barWidth/2;h.bars.horizontal?(v+=y,x+=y+h.bars.barWidth):(u+=y,w+=y+h.bars.barWidth)}b(h.xaxis,u,w),b(h.yaxis,v,x)}a.each(n(),function(a,b){b.datamin==o&&(b.datamin=null),b.datamax==p&&(b.datamax=null)})}function t(c,d){var e=document.createElement("canvas");return e.className=d,e.width=pb,e.height=qb,c||a(e).css({position:"absolute",left:0,top:0}),a(e).appendTo(b),e.getContext||(e=window.G_vmlCanvasManager.initElement(e)),e.getContext("2d").save(),e}function u(){if(pb=b.width(),qb=b.height(),pb<=0||qb<=0)throw"Invalid dimensions for plot, width = "+pb+", height = "+qb}function v(a){a.width!=pb&&(a.width=pb),a.height!=qb&&(a.height=qb);var b=a.getContext("2d");b.restore(),b.save()}function w(){var c,d=b.children("canvas.base"),e=b.children("canvas.overlay");0==d.length||0==e?(b.html(""),b.css({padding:0}),"static"==b.css("position")&&b.css("position","relative"),u(),hb=t(!0,"base"),ib=t(!1,"overlay"),c=!1):(hb=d.get(0),ib=e.get(0),c=!0),kb=hb.getContext("2d"),lb=ib.getContext("2d"),jb=a([ib,hb]),c&&(b.data("plot").shutdown(),ub.resize(),lb.clearRect(0,0,pb,qb),jb.unbind(),b.children().not([hb,ib]).remove()),b.data("plot",ub)}function x(){gb.grid.hoverable&&(jb.mousemove(V),jb.mouseleave(W)),gb.grid.clickable&&jb.click(X),g(tb.bindEvents,[jb])}function y(){wb&&clearTimeout(wb),jb.unbind("mousemove",V),jb.unbind("mouseleave",W),jb.unbind("click",X),g(tb.shutdown,[jb])}function z(a){function b(a){return a}var c,d,e=a.options.transform||b,f=a.options.inverseTransform;"x"==a.direction?(c=a.scale=rb/Math.abs(e(a.max)-e(a.min)),d=Math.min(e(a.max),e(a.min))):(c=a.scale=sb/Math.abs(e(a.max)-e(a.min)),c=-c,d=Math.max(e(a.max),e(a.min))),a.p2c=e==b?function(a){return(a-d)*c}:function(a){return(e(a)-d)*c},a.c2p=f?function(a){return f(d+a/c)}:function(a){return d+a/c}}function A(c){function d(d,e){return a('<div style="position:absolute;top:-10000px;'+e+'font-size:smaller"><div class="'+c.direction+"Axis "+c.direction+c.n+'Axis">'+d.join("")+"</div></div>").appendTo(b)}var e,f,g,h=c.options,i=c.ticks||[],j=[],k=h.labelWidth,l=h.labelHeight;if("x"==c.direction){if(null==k&&(k=Math.floor(pb/(i.length>0?i.length:1))),null==l){for(j=[],e=0;e<i.length;++e)f=i[e].label,f&&j.push('<div class="tickLabel" style="float:left;width:'+k+'px">'+f+"</div>");j.length>0&&(j.push('<div style="clear:left"></div>'),g=d(j,"width:10000px;"),l=g.height(),g.remove())}}else if(null==k||null==l){for(e=0;e<i.length;++e)f=i[e].label,f&&j.push('<div class="tickLabel">'+f+"</div>");j.length>0&&(g=d(j,""),null==k&&(k=g.children().width()),null==l&&(l=g.find("div.tickLabel").height()),g.remove())}null==k&&(k=0),null==l&&(l=0),c.labelWidth=k,c.labelHeight=l}function B(b){var c=b.labelWidth,d=b.labelHeight,e=b.options.position,f=b.options.tickLength,g=gb.grid.axisMargin,h=gb.grid.labelMargin,i="x"==b.direction?mb:nb,j=a.grep(i,function(a){return a&&a.options.position==e&&a.reserveSpace});a.inArray(b,j)==j.length-1&&(g=0),null==f&&(f="full");var k=a.grep(i,function(a){return a&&a.reserveSpace}),l=0==a.inArray(b,k);l||"full"!=f||(f=5),isNaN(+f)||(h+=+f),"x"==b.direction?(d+=h,"bottom"==e?(ob.bottom+=d-30,b.box={top:qb-ob.bottom,height:d}):b.box={top:ob.top+g,height:d}):(c+=h,"left"==e?b.box={left:ob.left+g,width:c}:(ob.right+=c+g,b.box={left:pb-ob.right,width:c})),b.position=e,b.tickLength=f,b.box.padding=h,b.innermost=l}function C(a){"x"==a.direction?(a.box.left=ob.left,a.box.width=rb):(a.box.top=ob.top,a.box.height=sb)}function D(){var b,c=n();if(a.each(c,function(a,b){b.show=b.options.show,null==b.show&&(b.show=b.used),b.reserveSpace=b.show||b.options.reserveSpace,E(b)}),allocatedAxes=a.grep(c,function(a){return a.reserveSpace}),ob.left=ob.right=ob.top=ob.bottom=0,gb.grid.show){for(a.each(allocatedAxes,function(a,b){F(b),G(b),H(b,b.ticks),A(b)}),b=allocatedAxes.length-1;b>=0;--b)B(allocatedAxes[b]);var d=gb.grid.minBorderMargin;if(null==d)for(d=0,b=0;b<fb.length;++b)d=Math.max(d,fb[b].points.radius+fb[b].points.lineWidth/2);for(var e in ob)ob[e]+=gb.grid.borderWidth,ob[e]=Math.max(d,ob[e])}rb=pb-ob.left-ob.right,sb=qb-ob.bottom-ob.top,a.each(c,function(a,b){z(b)}),gb.grid.show&&(a.each(allocatedAxes,function(a,b){C(b)}),M()),T()}function E(a){var b=a.options,c=+(null!=b.min?b.min:a.datamin),d=+(null!=b.max?b.max:a.datamax),e=d-c;if(0==e){var f=0==d?1:.01;null==b.min&&(c-=f),(null==b.max||null!=b.min)&&(d+=f)}else{var g=b.autoscaleMargin;null!=g&&(null==b.min&&(c-=e*g,c<0&&null!=a.datamin&&a.datamin>=0&&(c=0)),null==b.max&&(d+=e*g,d>0&&null!=a.datamax&&a.datamax<=0&&(d=0)))}a.min=c,a.max=d}function F(b){var d,e=b.options;d="number"==typeof e.ticks&&e.ticks>0?e.ticks:.3*Math.sqrt("x"==b.direction?pb:qb);var f,g,h,i,j,k,l,m=(b.max-b.min)/d;if("time"==e.mode){var n={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:525949.2*60*1e3},o=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],p=0;null!=e.minTickSize&&(p="number"==typeof e.tickSize?e.tickSize:e.minTickSize[0]*n[e.minTickSize[1]]);for(var j=0;j<o.length-1&&!(m<(o[j][0]*n[o[j][1]]+o[j+1][0]*n[o[j+1][1]])/2&&o[j][0]*n[o[j][1]]>=p);++j);f=o[j][0],h=o[j][1],"year"==h&&(k=Math.pow(10,Math.floor(Math.log(m/n.year)/Math.LN10)),l=m/n.year/k,f=l<1.5?1:l<3?2:l<7.5?5:10,f*=k),b.tickSize=e.tickSize||[f,h],g=function(a){var b=[],d=a.tickSize[0],e=a.tickSize[1],f=new Date(a.min),g=d*n[e];"second"==e&&f.setUTCSeconds(c(f.getUTCSeconds(),d)),"minute"==e&&f.setUTCMinutes(c(f.getUTCMinutes(),d)),"hour"==e&&f.setUTCHours(c(f.getUTCHours(),d)),"month"==e&&f.setUTCMonth(c(f.getUTCMonth(),d)),"year"==e&&f.setUTCFullYear(c(f.getUTCFullYear(),d)),f.setUTCMilliseconds(0),g>=n.minute&&f.setUTCSeconds(0),g>=n.hour&&f.setUTCMinutes(0),g>=n.day&&f.setUTCHours(0),g>=4*n.day&&f.setUTCDate(1),g>=n.year&&f.setUTCMonth(0);var h,i=0,j=Number.NaN;do if(h=j,j=f.getTime(),b.push(j),"month"==e)if(d<1){f.setUTCDate(1);var k=f.getTime();f.setUTCMonth(f.getUTCMonth()+1);var l=f.getTime();f.setTime(j+i*n.hour+(l-k)*d),i=f.getUTCHours(),f.setUTCHours(0)}else f.setUTCMonth(f.getUTCMonth()+d);else"year"==e?f.setUTCFullYear(f.getUTCFullYear()+d):f.setTime(j+g);while(j<a.max&&j!=h);return b},i=function(b,c){var d=new Date(b);if(null!=e.timeformat)return a.plot.formatDate(d,e.timeformat,e.monthNames);var f=c.tickSize[0]*n[c.tickSize[1]],g=c.max-c.min,h=e.twelveHourClock?" %p":"";return fmt=f<n.minute?"%h:%M:%S"+h:f<n.day?g<2*n.day?"%h:%M"+h:"%b %d %h:%M"+h:f<n.month?"%b %d":f<n.year?g<n.year?"%b":"%b %y":"%y",a.plot.formatDate(d,fmt,e.monthNames)}}else{var q=e.tickDecimals,r=-Math.floor(Math.log(m)/Math.LN10);null!=q&&r>q&&(r=q),k=Math.pow(10,-r),l=m/k,l<1.5?f=1:l<3?(f=2,l>2.25&&(null==q||r+1<=q)&&(f=2.5,++r)):f=l<7.5?5:10,f*=k,null!=e.minTickSize&&f<e.minTickSize&&(f=e.minTickSize),b.tickDecimals=Math.max(0,null!=q?q:r),b.tickSize=e.tickSize||f,g=function(a){var b,d=[],e=c(a.min,a.tickSize),f=0,g=Number.NaN;do b=g,g=e+f*a.tickSize,d.push(g),++f;while(g<a.max&&g!=b);return d},i=function(a,b){return a.toFixed(b.tickDecimals)}}if(null!=e.alignTicksWithAxis){var s=("x"==b.direction?mb:nb)[e.alignTicksWithAxis-1];if(s&&s.used&&s!=b){var t=g(b);if(t.length>0&&(null==e.min&&(b.min=Math.min(b.min,t[0])),null==e.max&&t.length>1&&(b.max=Math.max(b.max,t[t.length-1]))),g=function(a){var b,c,d=[];for(c=0;c<s.ticks.length;++c)b=(s.ticks[c].v-s.min)/(s.max-s.min),b=a.min+b*(a.max-a.min),d.push(b);return d},"time"!=b.mode&&null==e.tickDecimals){var u=Math.max(0,-Math.floor(Math.log(m)/Math.LN10)+1),v=g(b);v.length>1&&/\..*0$/.test((v[1]-v[0]).toFixed(u))||(b.tickDecimals=u)}}}b.tickGenerator=g,b.tickFormatter=a.isFunction(e.tickFormatter)?function(a,b){return""+e.tickFormatter(a,b)}:i}function G(b){var c=b.options.ticks,d=[];null==c||"number"==typeof c&&c>0?d=b.tickGenerator(b):c&&(d=a.isFunction(c)?c({min:b.min,max:b.max}):c);var e,f;for(b.ticks=[],e=0;e<d.length;++e){var g=null,h=d[e];"object"==typeof h?(f=+h[0],h.length>1&&(g=h[1])):f=+h,null==g&&(g=b.tickFormatter(f,b)),isNaN(f)||b.ticks.push({v:f,label:g})}}function H(a,b){a.options.autoscaleMargin&&b.length>0&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&b.length>1&&(a.max=Math.max(a.max,b[b.length-1].v)))}function I(){kb.clearRect(0,0,pb,qb);var a=gb.grid;a.show&&a.backgroundColor&&K(),a.show&&!a.aboveData&&L();for(var b=0;b<fb.length;++b)g(tb.drawSeries,[kb,fb[b]]),N(fb[b]);g(tb.draw,[kb]),a.show&&a.aboveData&&L()}function J(a,b){var c,d,e,f,g=n();for(i=0;i<g.length;++i)if(c=g[i],c.direction==b&&(f=b+c.n+"axis",a[f]||1!=c.n||(f=b+"axis"),a[f])){d=a[f].from,e=a[f].to;break}if(a[f]||(c="x"==b?mb[0]:nb[0],d=a[b+"1"],e=a[b+"2"]),null!=d&&null!=e&&d>e){var h=d;d=e,e=h}return{from:d,to:e,axis:c}}function K(){kb.save(),kb.translate(ob.left,ob.top),kb.fillStyle=eb(gb.grid.backgroundColor,sb,0,"rgba(255, 255, 255, 0)"),kb.fillRect(0,0,rb,sb),kb.restore()}function L(){var b;kb.save(),kb.translate(ob.left,ob.top);var c=gb.grid.markings;if(c){if(a.isFunction(c)){var d=ub.getAxes();d.xmin=d.xaxis.min,d.xmax=d.xaxis.max,d.ymin=d.yaxis.min,d.ymax=d.yaxis.max,c=c(d)}for(b=0;b<c.length;++b){var e=c[b],f=J(e,"x"),g=J(e,"y");null==f.from&&(f.from=f.axis.min),null==f.to&&(f.to=f.axis.max),null==g.from&&(g.from=g.axis.min),null==g.to&&(g.to=g.axis.max),f.to<f.axis.min||f.from>f.axis.max||g.to<g.axis.min||g.from>g.axis.max||(f.from=Math.max(f.from,f.axis.min),f.to=Math.min(f.to,f.axis.max),g.from=Math.max(g.from,g.axis.min),g.to=Math.min(g.to,g.axis.max),(f.from!=f.to||g.from!=g.to)&&(f.from=f.axis.p2c(f.from),f.to=f.axis.p2c(f.to),g.from=g.axis.p2c(g.from),g.to=g.axis.p2c(g.to),f.from==f.to||g.from==g.to?(kb.beginPath(),kb.strokeStyle=e.color||gb.grid.markingsColor,kb.lineWidth=e.lineWidth||gb.grid.markingsLineWidth,kb.moveTo(f.from,g.from),kb.lineTo(f.to,g.to),kb.stroke()):(kb.fillStyle=e.color||gb.grid.markingsColor,kb.fillRect(f.from,g.to,f.to-f.from,g.from-g.to))))}}for(var d=n(),h=gb.grid.borderWidth,i=0;i<d.length;++i){var j,k,l,m,o=d[i],p=o.box,q=o.tickLength;if(o.show&&0!=o.ticks.length){for(kb.strokeStyle=o.options.tickColor||a.color.parse(o.options.color).scale("a",.22).toString(),kb.lineWidth=1,"x"==o.direction?(j=0,k="full"==q?"top"==o.position?0:sb:p.top-ob.top+("top"==o.position?p.height:0)):(k=0,j="full"==q?"left"==o.position?0:rb:p.left-ob.left+("left"==o.position?p.width:0)),o.innermost||(kb.beginPath(),l=m=0,"x"==o.direction?l=rb:m=sb,1==kb.lineWidth&&(j=Math.floor(j)+.5,k=Math.floor(k)+.5),kb.moveTo(j,k),kb.lineTo(j+l,k+m),kb.stroke()),kb.beginPath(),b=0;b<o.ticks.length;++b){var r=o.ticks[b].v;if(l=m=0,!(r<o.min||r>o.max||"full"==q&&h>0&&(r==o.min||r==o.max))){if("x"==o.direction)j=o.p2c(r),m="full"==q?-sb:q,"top"==o.position&&(m=-m);else{if(k=o.p2c(r),k<10)continue;l="full"==q?-rb:q,"left"==o.position&&(l=-l)}1==kb.lineWidth&&("x"==o.direction?j=Math.floor(j)+.5:k=Math.floor(k)+.5),kb.moveTo(j,k),kb.lineTo(j+l,k+m)}}kb.stroke()}}h&&(kb.lineWidth=h,kb.strokeStyle=gb.grid.borderColor,kb.strokeRect(-h/2,-h/2,rb+h,sb+h)),kb.restore()}function M(){b.find(".tickLabels").remove();for(var a=['<div class="tickLabels" style="font-size:smaller">'],c=n(),d=0;d<c.length;++d){var e=c[d],f=e.box;if(e.show){a.push('<div class="'+e.direction+"Axis "+e.direction+e.n+'Axis" style="color:'+e.options.color+'">');for(var g=0;g<e.ticks.length;++g){var h=e.ticks[g];if(!(!h.label||h.v<e.min||h.v>e.max)){var i,j={};if("x"==e.direction)i="center",j.left=Math.round(ob.left+e.p2c(h.v)-e.labelWidth/2),"bottom"==e.position?j.top=f.top+f.padding-45:j.bottom=qb-(f.top+f.height-f.padding);else{if(j.top=Math.round(ob.top+e.p2c(h.v)-e.labelHeight/2),j.top<15)continue;"left"==e.position?(j.right=pb-(f.left+f.width-f.padding)-10,i="right"):(j.left=f.left+f.padding,i="left")}j.width=e.labelWidth;var k=["position:absolute","text-align:"+i];for(var l in j)k.push(l+":"+j[l]+"px");a.push('<div class="tickLabel" style="'+k.join(";")+'">'+h.label+"</div>")}}a.push("</div>")}}a.push("</div>"),b.append(a.join(""))}function N(a){a.lines.show&&O(a),a.bars.show&&R(a),a.points.show&&P(a)}function O(a){function b(a,b,c,d,e){var f=a.points,g=a.pointsize,h=null,i=null;kb.beginPath();for(var j=g;j<f.length;j+=g){var k=f[j-g],l=f[j-g+1],m=f[j],n=f[j+1];if(null!=k&&null!=m){if(l<=n&&l<e.min){if(n<e.min)continue;k=(e.min-l)/(n-l)*(m-k)+k,l=e.min}else if(n<=l&&n<e.min){if(l<e.min)continue;m=(e.min-l)/(n-l)*(m-k)+k,n=e.min}if(l>=n&&l>e.max){if(n>e.max)continue;k=(e.max-l)/(n-l)*(m-k)+k,l=e.max}else if(n>=l&&n>e.max){if(l>e.max)continue;m=(e.max-l)/(n-l)*(m-k)+k,n=e.max}if(k<=m&&k<d.min){if(m<d.min)continue;l=(d.min-k)/(m-k)*(n-l)+l,k=d.min}else if(m<=k&&m<d.min){if(k<d.min)continue;n=(d.min-k)/(m-k)*(n-l)+l,m=d.min}if(k>=m&&k>d.max){if(m>d.max)continue;l=(d.max-k)/(m-k)*(n-l)+l,k=d.max}else if(m>=k&&m>d.max){if(k>d.max)continue;n=(d.max-k)/(m-k)*(n-l)+l,m=d.max}(k!=h||l!=i)&&kb.moveTo(d.p2c(k)+b,e.p2c(l)+c),h=m,i=n,kb.lineTo(d.p2c(m)+b,e.p2c(n)+c)}}kb.stroke()}function c(a,b,c){for(var d=a.points,e=a.pointsize,f=Math.min(Math.max(0,c.min),c.max),g=0,h=!1,i=1,j=0,k=0;;){if(e>0&&g>d.length+e)break;g+=e;var l=d[g-e],m=d[g-e+i],n=d[g],o=d[g+i];if(h){if(e>0&&null!=l&&null==n){k=g,e=-e,i=2;continue}if(e<0&&g==j+e){kb.fill(),h=!1,e=-e,i=1,g=j=k+e;continue}}if(null!=l&&null!=n){if(l<=n&&l<b.min){if(n<b.min)continue;m=(b.min-l)/(n-l)*(o-m)+m,l=b.min}else if(n<=l&&n<b.min){if(l<b.min)continue;o=(b.min-l)/(n-l)*(o-m)+m,n=b.min}if(l>=n&&l>b.max){if(n>b.max)continue;m=(b.max-l)/(n-l)*(o-m)+m,l=b.max}else if(n>=l&&n>b.max){if(l>b.max)continue;o=(b.max-l)/(n-l)*(o-m)+m,n=b.max}if(h||(kb.beginPath(),kb.moveTo(b.p2c(l),c.p2c(f)),h=!0),m>=c.max&&o>=c.max)kb.lineTo(b.p2c(l),c.p2c(c.max)),kb.lineTo(b.p2c(n),c.p2c(c.max));else if(m<=c.min&&o<=c.min)kb.lineTo(b.p2c(l),c.p2c(c.min)),kb.lineTo(b.p2c(n),c.p2c(c.min));else{var p=l,q=n;m<=o&&m<c.min&&o>=c.min?(l=(c.min-m)/(o-m)*(n-l)+l,m=c.min):o<=m&&o<c.min&&m>=c.min&&(n=(c.min-m)/(o-m)*(n-l)+l,o=c.min),m>=o&&m>c.max&&o<=c.max?(l=(c.max-m)/(o-m)*(n-l)+l,m=c.max):o>=m&&o>c.max&&m<=c.max&&(n=(c.max-m)/(o-m)*(n-l)+l,o=c.max),l!=p&&kb.lineTo(b.p2c(p),c.p2c(m)),kb.lineTo(b.p2c(l),c.p2c(m)),kb.lineTo(b.p2c(n),c.p2c(o)),n!=q&&(kb.lineTo(b.p2c(n),c.p2c(o)),kb.lineTo(b.p2c(q),c.p2c(o)))}}}}kb.save(),kb.translate(ob.left,ob.top),kb.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(d>0&&e>0){kb.lineWidth=e,kb.strokeStyle="rgba(0,0,0,0.1)";var f=Math.PI/18;b(a.datapoints,Math.sin(f)*(d/2+e/2),Math.cos(f)*(d/2+e/2),a.xaxis,a.yaxis),kb.lineWidth=e/2,b(a.datapoints,Math.sin(f)*(d/2+e/4),Math.cos(f)*(d/2+e/4),a.xaxis,a.yaxis)}kb.lineWidth=d,kb.strokeStyle=a.color;var g=S(a.lines,a.color,0,sb);g&&(kb.fillStyle=g,c(a.datapoints,a.xaxis,a.yaxis)),d>0&&b(a.datapoints,0,0,a.xaxis,a.yaxis),kb.restore()}function P(a){function b(a,b,c,d,e,f,g,h){for(var i=a.points,j=a.pointsize,k=0;k<i.length;k+=j){var l=i[k],m=i[k+1];null==l||l<f.min||l>f.max||m<g.min||m>g.max||(kb.strokeStyle="rgb(249, 249, 249)",kb.beginPath(),l=f.p2c(l),m=g.p2c(m)+d,"circle"==h?kb.arc(l,m,b,0,e?Math.PI:2*Math.PI,!1):h(kb,l,m,b,e),kb.closePath(),c&&(kb.fillStyle=c,kb.fill()),kb.stroke())}}kb.save(),kb.translate(ob.left,ob.top);var c=a.points.lineWidth,d=a.shadowSize,e=a.points.radius,f=a.points.symbol;if(c>0&&d>0){var g=d/2;kb.lineWidth=g,kb.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,e,null,g+g/2,!0,a.xaxis,a.yaxis,f),kb.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,e,null,g/2,!0,a.xaxis,a.yaxis,f)}kb.lineWidth=c,kb.strokeStyle=a.color,b(a.datapoints,e,S(a.points,a.color),0,!1,a.xaxis,a.yaxis,f),kb.restore()}function Q(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,t,u;k?(t=r=s=!0,q=!1,m=c,n=a,p=b+d,o=b+e,n<m&&(u=n,n=m,m=u,q=!0,r=!1)):(q=r=s=!0,t=!1,m=a+d,n=a+e,o=c,p=b,p<o&&(u=p,p=o,o=u,t=!0,s=!1)),n<h.min||m>h.max||p<i.min||o>i.max||(m<h.min&&(m=h.min,q=!1),n>h.max&&(n=h.max,r=!1),o<i.min&&(o=i.min,t=!1),p>i.max&&(p=i.max,s=!1),m=h.p2c(m),o=i.p2c(o),n=h.p2c(n),p=i.p2c(p),g&&(j.beginPath(),j.moveTo(m,o),j.lineTo(m,p),j.lineTo(n,p),j.lineTo(n,o),j.fillStyle=g(o,p),j.fill()),l>0&&(q||r||s||t)&&(j.beginPath(),j.moveTo(m,o+f),q?j.lineTo(m,p+f):j.moveTo(m,p+f),s?j.lineTo(n,p+f):j.moveTo(n,p+f),r?j.lineTo(n,o+f):j.moveTo(n,o+f),t?j.lineTo(m,o+f):j.moveTo(m,o+f),j.stroke()))}function R(a){function b(b,c,d,e,f,g,h){for(var i=b.points,j=b.pointsize,k=0;k<i.length;k+=j)null!=i[k]&&Q(i[k],i[k+1],i[k+2],c,d,e,f,g,h,kb,a.bars.horizontal,a.bars.lineWidth)}kb.save(),kb.translate(ob.left,ob.top),kb.lineWidth=a.bars.lineWidth,kb.strokeStyle=a.color;var c="left"==a.bars.align?0:-a.bars.barWidth/2,d=a.bars.fill?function(b,c){return S(a.bars,a.color,b,c)}:null;b(a.datapoints,c,c+a.bars.barWidth,0,d,a.xaxis,a.yaxis),kb.restore()}function S(b,c,d,e){var f=b.fill;if(!f)return null;if(b.fillColor)return eb(b.fillColor,d,e,c);var g=a.color.parse(c);return g.a="number"==typeof f?f:.4,g.normalize(),g.toString()}function T(){if(b.find(".legend").remove(),gb.legend.show){for(var c,d,e=[],f=!1,g=gb.legend.labelFormatter,h=0;h<fb.length;++h)c=fb[h],d=c.label,d&&(h%gb.legend.noColumns==0&&(f&&e.push("</tr>"),e.push("<tr>"),f=!0),g&&(d=g(d,c)),e.push('<td class="legendColorBox" data-index="'+h+'"><div data-index="'+h+'" style="border:1px solid '+gb.legend.labelBoxBorderColor+';padding:1px"><div data-index="'+h+'" style="background:'+c.color+";border:5px solid "+c.color+'">&#x2713;</div></div></td><td class="legendLabel" data-index="'+h+'" style="color:'+c.color+'">'+d+"</td>"));if(f&&e.push("</tr>"),0!=e.length){var i='<table style="font-size:smaller;color:'+gb.grid.color+'">'+e.join("")+"</table>";if(null!=gb.legend.container)a(gb.legend.container).html(i);else{var j="",k=gb.legend.position,l=gb.legend.margin;null==l[0]&&(l=[l,l]),"n"==k.charAt(0)?j+="top:"+(l[1]+ob.top)+"px;":"s"==k.charAt(0)&&(j+="bottom:"+(l[1]+ob.bottom)+"px;"),"e"==k.charAt(1)?j+="right:0px;":"w"==k.charAt(1)&&(j+="left:"+(l[0]+ob.left)+"px;");var m=a('<div class="legend">'+i.replace('style="','style="position:absolute;'+j+";")+"</div>").appendTo(b);if(0!=gb.legend.backgroundOpacity){var n=gb.legend.backgroundColor;null==n&&(n=gb.grid.backgroundColor,n=n&&"string"==typeof n?a.color.parse(n):a.color.extract(m,"background-color"),n.a=1,n=n.toString());var o=m.children();a('<div style="position:absolute;width:'+o.width()+"px;height:"+o.height()+"px;"+j+"background-color:"+n+';"> </div>').prependTo(m).css("opacity",gb.legend.backgroundOpacity)}}}}}function U(a,b,c){var d,e,f=gb.grid.mouseActiveRadius,g=f*f+1,h=null;for(d=fb.length-1;d>=0;--d)if(c(fb[d])){var i=fb[d],j=i.xaxis,k=i.yaxis,l=i.datapoints.points,m=i.datapoints.pointsize,n=j.c2p(a),o=k.c2p(b),p=f/j.scale,q=f/k.scale;if(j.options.inverseTransform&&(p=Number.MAX_VALUE),k.options.inverseTransform&&(q=Number.MAX_VALUE),i.lines.show||i.points.show)for(e=0;e<l.length;e+=m){var r=l[e],s=l[e+1];if(null!=r&&!(r-n>p||r-n<-p||s-o>q||s-o<-q)){var t=Math.abs(j.p2c(r)-a),u=Math.abs(k.p2c(s)-b),v=t*t+u*u;v<g&&(g=v,h=[d,e/m])}}if(i.bars.show&&!h){var w="left"==i.bars.align?0:-i.bars.barWidth/2,x=w+i.bars.barWidth;for(e=0;e<l.length;e+=m){var r=l[e],s=l[e+1],y=l[e+2];null!=r&&(fb[d].bars.horizontal?n<=Math.max(y,r)&&n>=Math.min(y,r)&&o>=s+w&&o<=s+x:n>=r+w&&n<=r+x&&o>=Math.min(y,s)&&o<=Math.max(y,s))&&(h=[d,e/m])}}}return h?(d=h[0],e=h[1],m=fb[d].datapoints.pointsize,{datapoint:fb[d].datapoints.points.slice(e*m,(e+1)*m),dataIndex:e,series:fb[d],seriesIndex:d}):null}function V(a){gb.grid.hoverable&&Y("plothover",a,function(a){return 0!=a.hoverable})}function W(a){gb.grid.hoverable&&Y("plothover",a,function(){return!1})}function X(a){Y("plotclick",a,function(a){return 0!=a.clickable})}function Y(a,c,d){var e=jb.offset(),f=c.pageX-e.left-ob.left,g=c.pageY-e.top-ob.top,h=o({left:f,top:g});h.pageX=c.pageX,h.pageY=c.pageY;var i=U(f,g,d);if(i&&(i.pageX=parseInt(i.series.xaxis.p2c(i.datapoint[0])+e.left+ob.left),i.pageY=parseInt(i.series.yaxis.p2c(i.datapoint[1])+e.top+ob.top)),gb.grid.autoHighlight){for(var j=0;j<vb.length;++j){var k=vb[j];k.auto!=a||i&&k.series==i.series&&k.point[0]==i.datapoint[0]&&k.point[1]==i.datapoint[1]||ab(k.series,k.point)}i&&_(i.series,i.datapoint,a)}b.trigger(a,[h,i])}function Z(){wb||(wb=setTimeout($,30))}function $(){wb=null,lb.save(),lb.clearRect(0,0,pb,qb),lb.translate(ob.left,ob.top);var a,b;for(a=0;a<vb.length;++a)b=vb[a],b.series.bars.show?db(b.series,b.point):cb(b.series,b.point);lb.restore(),g(tb.drawOverlay,[lb])}function _(a,b,c){if("number"==typeof a&&(a=fb[a]),"number"==typeof b){var d=a.datapoints.pointsize;b=a.datapoints.points.slice(d*b,d*(b+1))}var e=bb(a,b);-1==e?(vb.push({series:a,point:b,auto:c}),Z()):c||(vb[e].auto=!1)}function ab(a,b){null==a&&null==b&&(vb=[],Z()),"number"==typeof a&&(a=fb[a]),"number"==typeof b&&(b=a.data[b]);var c=bb(a,b);-1!=c&&(vb.splice(c,1),Z())}function bb(a,b){for(var c=0;c<vb.length;++c){var d=vb[c];if(d.series==a&&d.point[0]==b[0]&&d.point[1]==b[1])return c}return-1}function cb(b,c){var d=c[0],e=c[1],f=b.xaxis,g=b.yaxis;if(!(d<f.min||d>f.max||e<g.min||e>g.max)){var h=b.points.radius+b.points.lineWidth/2;lb.lineWidth=h,lb.strokeStyle=a.color.parse(b.color).scale("a",.5).toString();var i=1.5*h,d=f.p2c(d),e=g.p2c(e);lb.beginPath(),"circle"==b.points.symbol?lb.arc(d,e,i,0,2*Math.PI,!1):b.points.symbol(lb,d,e,i,!1),lb.closePath(),lb.stroke()}}function db(b,c){lb.lineWidth=b.bars.lineWidth,lb.strokeStyle=a.color.parse(b.color).scale("a",.5).toString();var d=a.color.parse(b.color).scale("a",.5).toString(),e="left"==b.bars.align?0:-b.bars.barWidth/2;Q(c[0],c[1],c[2]||0,e,e+b.bars.barWidth,0,function(){return d},b.xaxis,b.yaxis,lb,b.bars.horizontal,b.bars.lineWidth)}function eb(b,c,d,e){if("string"==typeof b)return b;for(var f=kb.createLinearGradient(0,d,0,c),g=0,h=b.colors.length;g<h;++g){var i=b.colors[g];if("string"!=typeof i){var j=a.color.parse(e);null!=i.brightness&&(j=j.scale("rgb",i.brightness)),null!=i.opacity&&(j.a*=i.opacity),i=j.toString()}f.addColorStop(g/(h-1),i)}return f}var fb=[],gb={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:!1},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1},shadowSize:3},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},hooks:{}},hb=null,ib=null,jb=null,kb=null,lb=null,mb=[],nb=[],ob={left:0,right:0,top:0,bottom:0},pb=0,qb=0,rb=0,sb=0,tb={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},ub=this;ub.setData=k,ub.setupGrid=D,ub.draw=I,ub.getPlaceholder=function(){return b},ub.getCanvas=function(){return hb},ub.getPlotOffset=function(){return ob},ub.width=function(){return rb},ub.height=function(){return sb},ub.offset=function(){var a=jb.offset();return a.left+=ob.left,a.top+=ob.top,a},ub.getData=function(){return fb},ub.getAxes=function(){var b={};return a.each(mb.concat(nb),function(a,c){c&&(b[c.direction+(1!=c.n?c.n:"")+"axis"]=c)}),b},ub.getXAxes=function(){return mb},ub.getYAxes=function(){return nb},ub.c2p=o,ub.p2c=p,ub.getOptions=function(){return gb},ub.highlight=_,ub.unhighlight=ab,ub.triggerRedrawOverlay=Z,ub.pointOffset=function(a){return{left:parseInt(mb[m(a,"x")-1].p2c(+a.x)+ob.left),top:parseInt(nb[m(a,"y")-1].p2c(+a.y)+ob.top)}},ub.shutdown=y,ub.resize=function(){u(),v(hb),v(ib)},ub.hooks=tb,h(ub),j(e),w(),k(d),D(),I(),x();var vb=[],wb=null}function c(a,b){return b*Math.floor(a/b)}a.plot=function(c,d,e){var f=new b(a(c),d,e,a.plot.plugins);return f},a.plot.version="0.7",a.plot.plugins=[],a.plot.formatDate=function(a,b,c){var d=function(a){return a=""+a,1==a.length?"0"+a:a},e=[],f=!1,g=!1,h=a.getUTCHours(),i=h<12;null==c&&(c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),-1!=b.search(/%p|%P/)&&(h>12?h-=12:0==h&&(h=12));for(var j=0;j<b.length;++j){var k=b.charAt(j);if(f){switch(k){case"h":k=""+h;break;case"H":k=d(h);break;case"M":k=d(a.getUTCMinutes());break;case"S":k=d(a.getUTCSeconds());break;case"d":k=""+a.getUTCDate();break;case"m":k=""+(a.getUTCMonth()+1);break;case"y":k=""+a.getUTCFullYear();break;case"b":k=""+c[a.getUTCMonth()];break;case"p":k=i?"am":"pm";break;case"P":k=i?"AM":"PM";break;case"0":k="",g=!0}k&&g&&(k=d(k),g=!1),e.push(k),g||(f=!1)}else"%"==k?f=!0:e.push(k)}return e.join("")}}(jQuery),function(a){var b=function(){var b={years:"datepickerViewYears",months:"datepickerViewMonths",days:"datepickerViewDays"},c={wrapper:'<div class="datepicker"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table cellspacing="0" cellpadding="0"><tbody><tr></tr></tbody></table></div></div>',head:["<td>",'<table cellspacing="0" cellpadding="0">',"<thead>","<tr>",'<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="5" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"],space:'<td class="datepickerSpace"><div></div></td>',days:['<tbody class="datepickerDays">',"<tr>",'<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"],months:['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>","</tbody>"]},d={flat:!1,starts:1,prev:"&#9664;",next:"&#9654;",lastSel:!1,mode:"single",view:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",onRender:function(){return{}
},onChange:function(){return!0},onShow:function(){return!0},onBeforeShow:function(){return!0},onHide:function(){return!0},showWeeks:!1,locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekMin:"wk"}},e=function(b){var d,e,f,h,i,j,k,l,m,n=a(b).data("datepicker"),o=a(b),p=Math.floor(n.calendars/2),q=0;o.find("td>table tbody").remove();for(var r=0;r<n.calendars;r++){switch(d=new Date(n.current),d.addMonths(-p+r),m=o.find("table").eq(r+1),m[0].className){case"datepickerViewDays":f=g(d,"B, Y");break;case"datepickerViewMonths":f=d.getFullYear();break;case"datepickerViewYears":f=d.getFullYear()-6+" - "+(d.getFullYear()+5)}m.find("thead tr:first th:eq(1) span").text(f),f=d.getFullYear()-6,e={data:[],className:"datepickerYears"};for(var s=0;s<12;s++)e.data.push(f+s);l=tmpl(c.months.join(""),e),d.setDate(1),e={weeks:[],test:10},h=d.getMonth();var f=(d.getDay()-n.starts)%7;for(d.addDays(-(f+(f<0?7:0))),i=-1,q=0;q<42;){j=parseInt(q/7,10),k=q%7,e.weeks[j]||(i=d.getWeekNumber(),e.weeks[j]={week:i,days:[]}),e.weeks[j].days[k]={text:d.getDate(),classname:[]},h!=d.getMonth()&&e.weeks[j].days[k].classname.push("datepickerNotInMonth"),0==d.getDay()&&e.weeks[j].days[k].classname.push("datepickerSunday"),6==d.getDay()&&e.weeks[j].days[k].classname.push("datepickerSaturday");var t=n.onRender(d),u=d.valueOf();(t.selected||n.date==u||a.inArray(u,n.date)>-1||"range"==n.mode&&u>=n.date[0]&&u<=n.date[1])&&e.weeks[j].days[k].classname.push("datepickerSelected"),t.disabled&&e.weeks[j].days[k].classname.push("datepickerDisabled"),t.className&&e.weeks[j].days[k].classname.push(t.className),e.weeks[j].days[k].classname=e.weeks[j].days[k].classname.join(" "),q++,d.addDays(1)}l=tmpl(c.days.join(""),e)+l,e={data:n.locale.monthsShort,className:"datepickerMonths"},l=tmpl(c.months.join(""),e)+l,m.append(l)}},f=function(a,b){if(a.constructor==Date)return new Date(a);for(var c,d,e,f,g,h=a.split(/\W+/),i=b.split(/\W+/),j=new Date,k=0;k<h.length;k++)switch(i[k]){case"d":case"e":c=parseInt(h[k],10);break;case"m":d=parseInt(h[k],10)-1;break;case"Y":case"y":e=parseInt(h[k],10),e+=e>100?0:e<29?2e3:1900;break;case"H":case"I":case"k":case"l":f=parseInt(h[k],10);break;case"P":case"p":/pm/i.test(h[k])&&f<12?f+=12:/am/i.test(h[k])&&f>=12&&(f-=12);break;case"M":g=parseInt(h[k],10)}return new Date(void 0===e?j.getFullYear():e,void 0===d?j.getMonth():d,void 0===c?j.getDate():c,void 0===f?j.getHours():f,void 0===g?j.getMinutes():g,0)},g=function(a,b){var c=a.getMonth(),d=a.getDate(),e=a.getFullYear(),f=(a.getWeekNumber(),a.getDay()),g=a.getHours(),h=g>=12,i=h?g-12:g,j=a.getDayOfYear();0==i&&(i=12);for(var k,l=a.getMinutes(),m=a.getSeconds(),n=b.split(""),o=0;o<n.length;o++){switch(k=n[o],n[o]){case"a":k=a.getDayName();break;case"A":k=a.getDayName(!0);break;case"b":k=a.getMonthName();break;case"B":k=a.getMonthName(!0);break;case"C":k=1+Math.floor(e/100);break;case"d":k=d<10?"0"+d:d;break;case"e":k=d;break;case"H":k=g<10?"0"+g:g;break;case"I":k=i<10?"0"+i:i;break;case"j":k=j<100?j<10?"00"+j:"0"+j:j;break;case"k":k=g;break;case"l":k=i;break;case"m":k=c<9?"0"+(1+c):1+c;break;case"M":k=l<10?"0"+l:l;break;case"p":case"P":k=h?"PM":"AM";break;case"s":k=Math.floor(a.getTime()/1e3);break;case"S":k=m<10?"0"+m:m;break;case"u":k=f+1;break;case"w":k=f;break;case"y":k=(""+e).substr(2,2);break;case"Y":k=e}n[o]=k}return n.join("")},h=function(a){Date.prototype.tempDate||(Date.prototype.tempDate=null,Date.prototype.months=a.months,Date.prototype.monthsShort=a.monthsShort,Date.prototype.days=a.days,Date.prototype.daysShort=a.daysShort,Date.prototype.getMonthName=function(a){return this[a?"months":"monthsShort"][this.getUTCMonth()]},Date.prototype.getDayName=function(a){return this[a?"days":"daysShort"][this.getUTCDay()]},Date.prototype.addDays=function(a){this.setDate(this.getDate()+a),this.tempDate=this.getDate()},Date.prototype.addMonths=function(a){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setMonth(this.getMonth()+a),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.addYears=function(a){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setFullYear(this.getFullYear()+a),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.getMaxDays=function(){var a,b=new Date(Date.parse(this)),c=28;for(a=b.getMonth(),c=28;b.getMonth()==a;)c++,b.setDate(c);return c-1},Date.prototype.getFirstDay=function(){var a=new Date(Date.parse(this));return a.setDate(1),a.getDay()},Date.prototype.getWeekNumber=function(){var a=new Date(this);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var b=a.valueOf();return a.setMonth(0),a.setDate(4),Math.round((b-a.valueOf())/6048e5)+1},Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=new Date(this.getFullYear(),0,0,0,0,0),c=a-b;return Math.floor(c/24*60*60*1e3)})},i=function(b){var c=a(b).data("datepicker"),d=a("#"+c.id);if(!c.extraHeight){var e=a(b).find("div");c.extraHeight=e.get(0).offsetHeight+e.get(1).offsetHeight,c.extraWidth=e.get(2).offsetWidth+e.get(3).offsetWidth}var f=d.find("table:first").get(0),g=f.offsetWidth,h=f.offsetHeight;d.css({width:g+c.extraWidth+"px",height:h+c.extraHeight+"px"}).find("div.datepickerContainer").css({width:g+"px",height:h+"px"})},j=function(b){a(b.target).is("span")&&(b.target=b.target.parentNode);var c=a(b.target);if(c.is("a")){if(b.target.blur(),c.hasClass("datepickerDisabled"))return!1;var d=a(this).data("datepicker"),f=c.parent(),g=f.parent().parent().parent(),h=a("table",this).index(g.get(0))-1,i=new Date(d.current),j=!1,l=!1;if(f.is("th"))if(f.hasClass("datepickerWeek")&&"range"==d.mode&&!f.next().hasClass("datepickerDisabled")){var m=parseInt(f.next().text(),10);i.addMonths(h-Math.floor(d.calendars/2)),f.next().hasClass("datepickerNotInMonth")&&i.addMonths(m>15?-1:1),i.setDate(m),d.date[0]=i.setHours(0,0,0,0).valueOf(),i.setHours(23,59,59,0),i.addDays(6),d.date[1]=i.valueOf(),l=!0,j=!0,d.lastSel=!1}else{if(f.hasClass("datepickerMonth"))return!1;if(f.parent().parent().is("thead")){var n=new Date(d.current);switch(g.get(0).className){case"datepickerViewDays":n.addMonths(f.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewMonths":n.addYears(f.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewYears":n.addYears(f.hasClass("datepickerGoPrev")?-12:12)}d.onRender(n).disabled!==!0&&(d.current=n),l=!0}}else if(f.is("td")&&!f.hasClass("datepickerDisabled")){switch(g.get(0).className){case"datepickerViewMonths":d.current.setMonth(g.find("tbody.datepickerMonths td").index(f)),d.current.setFullYear(parseInt(g.find("thead th.datepickerMonth span").text(),10)),d.current.addMonths(Math.floor(d.calendars/2)-h),g.get(0).className="datepickerViewDays";break;case"datepickerViewYears":d.current.setFullYear(parseInt(c.text(),10)),g.get(0).className="datepickerViewMonths";break;default:var m=parseInt(c.text(),10);switch(i.addMonths(h-Math.floor(d.calendars/2)),f.hasClass("datepickerNotInMonth")&&i.addMonths(m>15?-1:1),i.setDate(m),d.mode){case"multiple":m=i.setHours(0,0,0,0).valueOf(),a.inArray(m,d.date)>-1?a.each(d.date,function(a,b){return b==m?(d.date.splice(a,1),!1):void 0}):d.date.push(m);break;case"range":d.lastSel||(d.date[0]=i.setHours(0,0,0,0).valueOf()),m=i.setHours(23,59,59,0).valueOf(),m<d.date[0]?(d.date[1]=d.date[0]+86399e3,d.date[0]=m-86399e3):d.date[1]=m,d.lastSel=!d.lastSel;break;default:d.date=i.valueOf()}}l=!0,j=!0}l&&e(this),j&&d.onChange.apply(this,k(d))}return!1},k=function(b){var c;return"single"==b.mode?(c=new Date(b.date),[g(c,b.format),c,b.el]):(c=[[],[],b.el],a.each(b.date,function(a,d){var e=new Date(d);c[0].push(g(e,b.format)),c[1].push(e)}),c)},l=function(){var a="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(a?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(a?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(a?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(a?document.documentElement.clientHeight:document.body.clientHeight)}},m=function(a,b,c){if(a==b)return!0;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(16&a.compareDocumentPosition(b));for(var d=b.parentNode;d&&d!=c;){if(d==a)return!0;d=d.parentNode}return!1},n=function(){var b=a("#"+a(this).data("datepickerId"));if(!b.is(":visible")){var c=b.get(0);e(c);var d=b.data("datepicker");d.onBeforeShow.apply(this,[b.get(0)]);{var f=a(this).offset(),g=l(),h=f.top,j=f.left;a.curCSS(c,"display")}switch(b.css({visibility:"hidden",display:"block"}),i(c),d.position){case"top":h-=c.offsetHeight;break;case"left":j-=c.offsetWidth;break;case"right":j+=this.offsetWidth;break;case"bottom":h+=this.offsetHeight}h+c.offsetHeight>g.t+g.h&&(h=f.top-c.offsetHeight),h<g.t&&(h=f.top+this.offsetHeight+c.offsetHeight),j+c.offsetWidth>g.l+g.w&&(j=f.left-c.offsetWidth),j<g.l&&(j=f.left+this.offsetWidth),b.css({visibility:"visible",display:"block",top:h+"px",left:j+"px"}),0!=d.onShow.apply(this,[b.get(0)])&&b.show(),a(document).bind("mousedown",{cal:b,trigger:this},o)}return!1},o=function(b){b.target==b.data.trigger||m(b.data.cal.get(0),b.target,b.data.cal.get(0))||(0!=b.data.cal.data("datepicker").onHide.apply(this,[b.data.cal.get(0)])&&b.data.cal.hide(),a(document).unbind("mousedown",o))};return{init:function(g){return g=a.extend({},d,g||{}),h(g.locale),g.calendars=Math.max(1,parseInt(g.calendars,10)||1),g.mode=/single|multiple|range/.test(g.mode)?g.mode:"single",this.each(function(){if(!a(this).data("datepicker")){if(g.el=this,g.date.constructor==String&&(g.date=f(g.date,g.format),g.date.setHours(0,0,0,0)),"single"!=g.mode)if(g.date.constructor!=Array)g.date=[g.date.valueOf()],"range"==g.mode&&g.date.push(new Date(g.date[0]).setHours(23,59,59,0).valueOf());else{for(var d=0;d<g.date.length;d++)g.date[d]=f(g.date[d],g.format).setHours(0,0,0,0).valueOf();"range"==g.mode&&(g.date[1]=new Date(g.date[1]).setHours(23,59,59,0).valueOf())}else g.date=g.date.valueOf();g.current=g.current?f(g.current,g.format):new Date,g.current.setDate(1),g.current.setHours(0,0,0,0);var h,k="datepicker_"+parseInt(1e3*Math.random());g.id=k,a(this).data("datepickerId",g.id);var l=a(c.wrapper).attr("id",k).bind("click",j).data("datepicker",g);g.className&&l.addClass(g.className);for(var m="",d=0;d<g.calendars;d++)h=g.starts,d>0&&(m+=c.space),m+=tmpl(c.head.join(""),{week:g.locale.weekMin,prev:g.prev,next:g.next,day1:g.locale.daysMin[h++%7],day2:g.locale.daysMin[h++%7],day3:g.locale.daysMin[h++%7],day4:g.locale.daysMin[h++%7],day5:g.locale.daysMin[h++%7],day6:g.locale.daysMin[h++%7],day7:g.locale.daysMin[h++%7]});l.find("tr:first").append(m).find("table").addClass(b[g.view]),e(l.get(0)),g.flat?(l.appendTo(this).show().css("position","relative"),i(l.get(0))):(l.appendTo(document.body),a(this).bind(g.eventName,n))}})},showPicker:function(){return this.each(function(){a(this).data("datepickerId")&&n.apply(this)})},hidePicker:function(){return this.each(function(){a(this).data("datepickerId")&&a("#"+a(this).data("datepickerId")).hide()})},setDate:function(b,c){return this.each(function(){if(a(this).data("datepickerId")){var d=a("#"+a(this).data("datepickerId")),g=d.data("datepicker");if(g.date=b,g.date.constructor==String&&(g.date=f(g.date,g.format),g.date.setHours(0,0,0,0)),"single"!=g.mode)if(g.date.constructor!=Array)g.date=[g.date.valueOf()],"range"==g.mode&&g.date.push(new Date(g.date[0]).setHours(23,59,59,0).valueOf());else{for(var h=0;h<g.date.length;h++)g.date[h]=f(g.date[h],g.format).setHours(0,0,0,0).valueOf();"range"==g.mode&&(g.date[1]=new Date(g.date[1]).setHours(23,59,59,0).valueOf())}else g.date=g.date.valueOf();c&&(g.current=new Date("single"!=g.mode?g.date[0]:g.date)),e(d.get(0))}})},getDate:function(b){return this.size()>0?k(a("#"+a(this).data("datepickerId")).data("datepicker"))[b?0:1]:void 0},clear:function(){return this.each(function(){if(a(this).data("datepickerId")){var b=a("#"+a(this).data("datepickerId")),c=b.data("datepicker");"single"!=c.mode&&(c.date=[],e(b.get(0)))}})},fixLayout:function(){return this.each(function(){if(a(this).data("datepickerId")){var b=a("#"+a(this).data("datepickerId")),c=b.data("datepicker");c.flat&&i(b.get(0))}})}}}();a.fn.extend({DatePicker:b.init,DatePickerHide:b.hidePicker,DatePickerShow:b.showPicker,DatePickerSetDate:b.setDate,DatePickerGetDate:b.getDate,DatePickerClear:b.clear,DatePickerLayout:b.fixLayout})}(jQuery),function(){var a={};this.tmpl=function b(c,d){var e=/\W/.test(c)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):a[c]=a[c]||b(document.getElementById(c).innerHTML);return d?e(d):e}}(),function(a){var b=window.EYE=function(){var b={init:[]};return{init:function(){a.each(b.init,function(a,b){b.call()})},extend:function(a){for(var b in a)void 0!=a[b]&&(this[b]=a[b])},register:function(a,c){b[c]||(b[c]=[]),b[c].push(a)}}}();a(b.init)}(jQuery),function(a){EYE.extend({getPosition:function(a,b){var c=0,d=0,e=a.style,f=!1;if(b&&"none"==jQuery.curCSS(a,"display")){var g=e.visibility,h=e.position;f=!0,e.visibility="hidden",e.display="block",e.position="absolute"}var i=a;if(i.getBoundingClientRect){var j=i.getBoundingClientRect();c=j.left+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)-2,d=j.top+Math.max(document.documentElement.scrollTop,document.body.scrollTop)-2}else{if(c=i.offsetLeft,d=i.offsetTop,i=i.offsetParent,a!=i)for(;i;)c+=i.offsetLeft,d+=i.offsetTop,i=i.offsetParent;for(i=a.parentNode;i&&"BODY"!=i.tagName.toUpperCase()&&"HTML"!=i.tagName.toUpperCase();)"inline"!=jQuery.curCSS(i,"display")&&(c-=i.scrollLeft,d-=i.scrollTop),i=i.parentNode}return 1==f&&(e.display="none",e.position=h,e.visibility=g),{x:c,y:d}},getSize:function(a){var b=parseInt(jQuery.curCSS(a,"width"),10),c=parseInt(jQuery.curCSS(a,"height"),10),d=0,e=0;if("none"!=jQuery.curCSS(a,"display"))d=a.offsetWidth,e=a.offsetHeight;else{var f=a.style,g=f.visibility,h=f.position;f.visibility="hidden",f.display="block",f.position="absolute",d=a.offsetWidth,e=a.offsetHeight,f.display="none",f.position=h,f.visibility=g}return{w:b,h:c,wb:d,hb:e}},getClient:function(a){var b,c;if(a)c=a.clientWidth,b=a.clientHeight;else{var d=document.documentElement;c=window.innerWidth||self.innerWidth||d&&d.clientWidth||document.body.clientWidth,b=window.innerHeight||self.innerHeight||d&&d.clientHeight||document.body.clientHeight}return{w:c,h:b}},getScroll:function(a){var b=0,c=0,d=0,e=0,f=0,g=0;return a&&"body"!=a.nodeName.toLowerCase()?(b=a.scrollTop,c=a.scrollLeft,d=a.scrollWidth,e=a.scrollHeight):(document.documentElement?(b=document.documentElement.scrollTop,c=document.documentElement.scrollLeft,d=document.documentElement.scrollWidth,e=document.documentElement.scrollHeight):document.body&&(b=document.body.scrollTop,c=document.body.scrollLeft,d=document.body.scrollWidth,e=document.body.scrollHeight),"undefined"!=typeof pageYOffset&&(b=pageYOffset,c=pageXOffset),f=self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,g=self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0),{t:b,l:c,w:d,h:e,iw:f,ih:g}},getMargins:function(a,b){var c=jQuery.curCSS(a,"marginTop")||"",d=jQuery.curCSS(a,"marginRight")||"",e=jQuery.curCSS(a,"marginBottom")||"",f=jQuery.curCSS(a,"marginLeft")||"";return b?{t:parseInt(c,10)||0,r:parseInt(d,10)||0,b:parseInt(e,10)||0,l:parseInt(f,10)}:{t:c,r:d,b:e,l:f}},getPadding:function(a,b){var c=jQuery.curCSS(a,"paddingTop")||"",d=jQuery.curCSS(a,"paddingRight")||"",e=jQuery.curCSS(a,"paddingBottom")||"",f=jQuery.curCSS(a,"paddingLeft")||"";return b?{t:parseInt(c,10)||0,r:parseInt(d,10)||0,b:parseInt(e,10)||0,l:parseInt(f,10)}:{t:c,r:d,b:e,l:f}},getBorder:function(a,b){var c=jQuery.curCSS(a,"borderTopWidth")||"",d=jQuery.curCSS(a,"borderRightWidth")||"",e=jQuery.curCSS(a,"borderBottomWidth")||"",f=jQuery.curCSS(a,"borderLeftWidth")||"";return b?{t:parseInt(c,10)||0,r:parseInt(d,10)||0,b:parseInt(e,10)||0,l:parseInt(f,10)||0}:{t:c,r:d,b:e,l:f}},traverseDOM:function(a,b){for(b(a),a=a.firstChild;a;)EYE.traverseDOM(a,b),a=a.nextSibling},getInnerWidth:function(a,b){var c=a.offsetWidth;return b?Math.max(a.scrollWidth,c)-c+a.clientWidth:a.clientWidth},getInnerHeight:function(a,b){var c=a.offsetHeight;return b?Math.max(a.scrollHeight,c)-c+a.clientHeight:a.clientHeight},getExtraWidth:function(b){return a.boxModel?(parseInt(a.curCSS(b,"paddingLeft"))||0)+(parseInt(a.curCSS(b,"paddingRight"))||0)+(parseInt(a.curCSS(b,"borderLeftWidth"))||0)+(parseInt(a.curCSS(b,"borderRightWidth"))||0):0},getExtraHeight:function(b){return a.boxModel?(parseInt(a.curCSS(b,"paddingTop"))||0)+(parseInt(a.curCSS(b,"paddingBottom"))||0)+(parseInt(a.curCSS(b,"borderTopWidth"))||0)+(parseInt(a.curCSS(b,"borderBottomWidth"))||0):0},isChildOf:function(b,c,d){if(b==c)return!0;if(!c||!c.nodeType||1!=c.nodeType)return!1;if(b.contains&&!a.browser.safari)return b.contains(c);if(b.compareDocumentPosition)return!!(16&b.compareDocumentPosition(c));for(var e=c.parentNode;e&&e!=d;){if(e==b)return!0;e=e.parentNode}return!1},centerEl:function(b,c){var d=EYE.getScroll(),e=EYE.getSize(b);c&&"vertically"!=c||a(b).css({top:d.t+(Math.min(d.h,d.ih)-e.hb)/2+"px"}),c&&"horizontally"!=c||a(b).css({left:d.l+(Math.min(d.w,d.iw)-e.wb)/2+"px"})}}),a.easing.easeout||(a.easing.easeout=function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c})}(jQuery),function(a){var b=function(){var b=window.location.hash.replace("#",""),d=a("ul.navigationTabs a").bind("click",c).filter("a[rel="+b+"]");0==d.size()&&(d=a("ul.navigationTabs a:first")),c.apply(d.get(0)),a("#date").DatePicker({flat:!0,date:"2008-07-31",current:"2008-07-31",calendars:1,starts:1,view:"years"});var e=new Date;e.addDays(-10);var f=new Date;f.addDays(-5),f.setHours(0,0,0,0),a("#date2").DatePicker({flat:!0,date:["2008-07-31","2008-07-28"],current:"2008-07-31",format:"Y-m-d",calendars:1,mode:"multiple",onRender:function(a){return{disabled:a.valueOf()<e.valueOf(),className:a.valueOf()==f.valueOf()?"datepickerSpecial":!1}},onChange:function(){},starts:0}),a("#clearSelection").bind("click",function(){return a("#date3").DatePickerClear(),!1}),a("#date3").DatePicker({flat:!0,date:["2009-12-28","2010-01-23"],current:"2010-01-01",calendars:3,mode:"range",starts:1}),a(".inputDate").DatePicker({format:"m/d/Y",date:a("#inputDate").val(),current:a("#inputDate").val(),starts:1,position:"right",onBeforeShow:function(){a("#inputDate").DatePickerSetDate(a("#inputDate").val(),!0)},onChange:function(b){a("#inputDate").val(b),a("#closeOnSelect input").is(":checked")&&a("#inputDate").DatePickerHide()}});var g=new Date;g.addDays(-4);var h=new Date;a("#widgetCalendar").DatePicker({flat:!0,format:"d B, Y",date:[new Date(g),new Date(h)],calendars:3,mode:"range",starts:1,onChange:function(b){a("#widgetField span").get(0).innerHTML=b.join(" &divide; ")}});var i=!1;a("#widgetField>a").bind("click",function(){return a("#widgetCalendar").stop().animate({height:i?0:a("#widgetCalendar div.datepicker").get(0).offsetHeight},500),i=!i,!1}),a("#widgetCalendar div.datepicker").css("position","absolute")},c=function(){var b=a("ul.navigationTabs a").removeClass("active").index(this);a(this).addClass("active").blur(),a("div.tab").hide().eq(b).show()};EYE.register(b,"init")}(jQuery),document.createElement("video"),document.createElement("audio"),document.createElement("track");var vjs=function(a,b,c){var d;if("string"===typeof a){if(0===a.indexOf("#")&&(a=a.slice(1)),vjs.players[a])return vjs.players[a];d=vjs.el(a)}else d=a;if(!d||!d.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return d.player||new vjs.Player(d,b,c)},videojs=vjs;window.videojs=window.vjs=vjs,vjs.CDN_VERSION="4.2",vjs.ACCESS_PROTOCOL="https:"==document.location.protocol?"https://":"http://",vjs.options={techOrder:["html5","flash"],html5:{},flash:{},width:300,height:150,defaultVolume:0,children:{mediaLoader:{},posterImage:{},textTrackDisplay:{},loadingSpinner:{},bigPlayButton:{},controlBar:{}},notSupportedMessage:'Sorry, no compatible source and playback technology were found for this video. Try using another browser like <a href="http://bit.ly/ccMUEC">Chrome</a> or download the latest <a href="http://adobe.ly/mwfN1">Adobe Flash Player</a>.'},"GENERATED_CDN_VSN"!==vjs.CDN_VERSION&&(videojs.options.flash.swf=vjs.ACCESS_PROTOCOL+"vjs.zencdn.net/"+vjs.CDN_VERSION+"/video-js.swf"),vjs.players={},vjs.CoreObject=vjs.CoreObject=function(){},vjs.CoreObject.extend=function(a){var b,c;a=a||{},b=a.init||a.init||this.prototype.init||this.prototype.init||function(){},c=function(){b.apply(this,arguments)},c.prototype=vjs.obj.create(this.prototype),c.prototype.constructor=c,c.extend=vjs.CoreObject.extend,c.create=vjs.CoreObject.create;for(var d in a)a.hasOwnProperty(d)&&(c.prototype[d]=a[d]);return c},vjs.CoreObject.create=function(){var a=vjs.obj.create(this.prototype);return this.apply(a,arguments),a},vjs.on=function(a,b,c){var d=vjs.getData(a);d.handlers||(d.handlers={}),d.handlers[b]||(d.handlers[b]=[]),c.guid||(c.guid=vjs.guid++),d.handlers[b].push(c),d.dispatcher||(d.disabled=!1,d.dispatcher=function(b){if(!d.disabled){b=vjs.fixEvent(b);var c=d.handlers[b.type];if(c)for(var e=c.slice(0),f=0,g=e.length;f<g&&!b.isImmediatePropagationStopped();f++)e[f].call(a,b)}}),1==d.handlers[b].length&&(document.addEventListener?a.addEventListener(b,d.dispatcher,!1):document.attachEvent&&a.attachEvent("on"+b,d.dispatcher))},vjs.off=function(a,b,c){if(vjs.hasData(a)){var d=vjs.getData(a);if(d.handlers){var e=function(b){d.handlers[b]=[],vjs.cleanUpEvents(a,b)};if(b){var f=d.handlers[b];if(f){if(!c)return void e(b);if(c.guid)for(var g=0;g<f.length;g++)f[g].guid===c.guid&&f.splice(g--,1);vjs.cleanUpEvents(a,b)}}else for(var h in d.handlers)e(h)}}},vjs.cleanUpEvents=function(a,b){var c=vjs.getData(a);0===c.handlers[b].length&&(delete c.handlers[b],document.removeEventListener?a.removeEventListener(b,c.dispatcher,!1):document.detachEvent&&a.detachEvent("on"+b,c.dispatcher)),vjs.isEmpty(c.handlers)&&(delete c.handlers,delete c.dispatcher,delete c.disabled),vjs.isEmpty(c)&&vjs.removeData(a)},vjs.fixEvent=function(a){function b(){return!0}function c(){return!1}if(!a||!a.isPropagationStopped){var d=a||window.event;a={};for(var e in d)"layerX"!==e&&"layerY"!==e&&(a[e]=d[e]);if(a.target||(a.target=a.srcElement||document),a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement,a.preventDefault=function(){d.preventDefault&&d.preventDefault(),a.returnValue=!1,a.isDefaultPrevented=b},a.isDefaultPrevented=c,a.stopPropagation=function(){d.stopPropagation&&d.stopPropagation(),a.cancelBubble=!0,a.isPropagationStopped=b},a.isPropagationStopped=c,a.stopImmediatePropagation=function(){d.stopImmediatePropagation&&d.stopImmediatePropagation(),a.isImmediatePropagationStopped=b,a.stopPropagation()},a.isImmediatePropagationStopped=c,null!=a.clientX){var f=document.documentElement,g=document.body;a.pageX=a.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=a.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)}a.which=a.charCode||a.keyCode,null!=a.button&&(a.button=1&a.button?0:4&a.button?1:2&a.button?2:0)}return a},vjs.trigger=function(a,b){var c=vjs.hasData(a)?vjs.getData(a):{},d=a.parentNode||a.ownerDocument;if("string"===typeof b&&(b={type:b,target:a}),b=vjs.fixEvent(b),c.dispatcher&&c.dispatcher.call(a,b),d&&!b.isPropagationStopped()&&b.bubbles!==!1)vjs.trigger(d,b);else if(!d&&!b.isDefaultPrevented()){var e=vjs.getData(b.target);b.target[b.type]&&(e.disabled=!0,"function"===typeof b.target[b.type]&&b.target[b.type](),e.disabled=!1)}return!b.isDefaultPrevented()},vjs.one=function(a,b,c){var d=function(){vjs.off(a,b,d),c.apply(this,arguments)};d.guid=c.guid=c.guid||vjs.guid++,vjs.on(a,b,d)};var hasOwnProp=Object.prototype.hasOwnProperty;vjs.createEl=function(a,b){var c,d;c=document.createElement(a||"div");for(d in b)hasOwnProp.call(b,d)&&(-1!==d.indexOf("aria-")||"role"==d?c.setAttribute(d,b[d]):c[d]=b[d]);return c},vjs.capitalize=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},vjs.obj={},vjs.obj.create=Object.create||function(a){function b(){}return b.prototype=a,new b},vjs.obj.each=function(a,b,c){for(var d in a)hasOwnProp.call(a,d)&&b.call(c||this,d,a[d])},vjs.obj.merge=function(a,b){if(!b)return a;for(var c in b)hasOwnProp.call(b,c)&&(a[c]=b[c]);return a},vjs.obj.deepMerge=function(a,b){var c,d,e;a=vjs.obj.copy(a);for(c in b)hasOwnProp.call(b,c)&&(d=a[c],e=b[c],a[c]=vjs.obj.isPlain(d)&&vjs.obj.isPlain(e)?vjs.obj.deepMerge(d,e):b[c]);return a},vjs.obj.copy=function(a){return vjs.obj.merge({},a)},vjs.obj.isPlain=function(a){return!!a&&"object"===typeof a&&"[object Object]"===a.toString()&&a.constructor===Object},vjs.bind=function(a,b,c){b.guid||(b.guid=vjs.guid++);var d=function(){return b.apply(a,arguments)};return d.guid=c?c+"_"+b.guid:b.guid,d},vjs.cache={},vjs.guid=1,vjs.expando="vdata"+(new Date).getTime(),vjs.getData=function(a){var b=a[vjs.expando];return b||(b=a[vjs.expando]=vjs.guid++,vjs.cache[b]={}),vjs.cache[b]},vjs.hasData=function(a){var b=a[vjs.expando];return!(!b||vjs.isEmpty(vjs.cache[b]))},vjs.removeData=function(a){var b=a[vjs.expando];if(b){delete vjs.cache[b];try{delete a[vjs.expando]}catch(c){a.removeAttribute?a.removeAttribute(vjs.expando):a[vjs.expando]=null}}},vjs.isEmpty=function(a){for(var b in a)if(null!==a[b])return!1;return!0},vjs.addClass=function(a,b){-1==(" "+a.className+" ").indexOf(" "+b+" ")&&(a.className=""===a.className?b:a.className+" "+b)},vjs.removeClass=function(a,b){var c,d;if(-1!=a.className.indexOf(b)){for(c=a.className.split(" "),d=c.length-1;d>=0;d--)c[d]===b&&c.splice(d,1);a.className=c.join(" ")}},vjs.TEST_VID=vjs.createEl("video"),vjs.USER_AGENT=navigator.userAgent,vjs.IS_IPHONE=/iPhone/i.test(vjs.USER_AGENT),vjs.IS_IPAD=/iPad/i.test(vjs.USER_AGENT),vjs.IS_IPOD=/iPod/i.test(vjs.USER_AGENT),vjs.IS_IOS=vjs.IS_IPHONE||vjs.IS_IPAD||vjs.IS_IPOD,vjs.IOS_VERSION=function(){var a=vjs.USER_AGENT.match(/OS (\d+)_/i);return a&&a[1]?a[1]:void 0}(),vjs.IS_ANDROID=/Android/i.test(vjs.USER_AGENT),vjs.ANDROID_VERSION=function(){var a,b,c=vjs.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);return c?(a=c[1]&&parseFloat(c[1]),b=c[2]&&parseFloat(c[2]),a&&b?parseFloat(c[1]+"."+c[2]):a?a:null):null}(),vjs.IS_OLD_ANDROID=vjs.IS_ANDROID&&/webkit/i.test(vjs.USER_AGENT)&&vjs.ANDROID_VERSION<2.3,vjs.IS_FIREFOX=/Firefox/i.test(vjs.USER_AGENT),vjs.IS_CHROME=/Chrome/i.test(vjs.USER_AGENT),vjs.TOUCH_ENABLED="ontouchstart"in window,vjs.getAttributeValues=function(a){var b,c,d,e,f;if(b={},c=",autoplay,controls,loop,muted,default,",a&&a.attributes&&a.attributes.length>0){d=a.attributes;for(var g=d.length-1;g>=0;g--)e=d[g].name,f=d[g].value,("boolean"===typeof a[e]||-1!==c.indexOf(","+e+","))&&(f=null!==f?!0:!1),b[e]=f}return b},vjs.getComputedDimension=function(a,b){var c="";return document.defaultView&&document.defaultView.getComputedStyle?c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b):a.currentStyle&&(c=a["client"+b.substr(0,1).toUpperCase()+b.substr(1)]+"px"),c},vjs.insertFirst=function(a,b){b.firstChild?b.insertBefore(a,b.firstChild):b.appendChild(a)},vjs.support={},vjs.el=function(a){return 0===a.indexOf("#")&&(a=a.slice(1)),document.getElementById(a)},vjs.formatTime=function(a,b){b=b||a;var c=Math.floor(a%60),d=Math.floor(a/60%60),e=Math.floor(a/3600),f=Math.floor(b/60%60),g=Math.floor(b/3600);return(isNaN(a)||1/0===a)&&(e=d=c="-"),e=e>0||g>0?e+":":"",d=((e||f>=10)&&d<10?"0"+d:d)+":",c=c<10?"0"+c:c,e+d+c},vjs.blockTextSelection=function(){document.body.focus(),document.onselectstart=function(){return!1}},vjs.unblockTextSelection=function(){document.onselectstart=function(){return!0}},vjs.trim=function(a){return(a+"").replace(/^\s+|\s+$/g,"")},vjs.round=function(a,b){return b||(b=0),Math.round(a*Math.pow(10,b))/Math.pow(10,b)},vjs.createTimeRange=function(a,b){return{length:1,start:function(){return a},end:function(){return b}}},vjs.get=function(a,b,c){var d,e;"undefined"===typeof XMLHttpRequest&&(window.XMLHttpRequest=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(b){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(c){}throw new Error("This browser does not support XMLHttpRequest.")}),e=new XMLHttpRequest;try{e.open("GET",a)}catch(f){c(f)}d=0===a.indexOf("file:")||0===window.location.href.indexOf("file:")&&-1===a.indexOf("http"),e.onreadystatechange=function(){4===e.readyState&&(200===e.status||d&&0===e.status?b(e.responseText):c&&c())};try{e.send()}catch(f){c&&c(f)}},vjs.setLocalStorage=function(a,b){try{var c=window.localStorage||!1;if(!c)return;c[a]=b}catch(d){22==d.code||1014==d.code?vjs.log("LocalStorage Full (VideoJS)",d):18==d.code?vjs.log("LocalStorage not allowed (VideoJS)",d):vjs.log("LocalStorage Error (VideoJS)",d)}},vjs.getAbsoluteURL=function(a){return a.match(/^https?:\/\//)||(a=vjs.createEl("div",{innerHTML:'<a href="'+a+'">x</a>'}).firstChild.href),a},vjs.log=function(){vjs.log.history=vjs.log.history||[],vjs.log.history.push(arguments),window.console&&window.console.log(Array.prototype.slice.call(arguments))},vjs.findPosition=function(a){var b,c,d,e,f,g,h,i,j;return a.getBoundingClientRect&&a.parentNode&&(b=a.getBoundingClientRect()),b?(c=document.documentElement,d=document.body,e=c.clientLeft||d.clientLeft||0,f=window.pageXOffset||d.scrollLeft,g=b.left+f-e,h=c.clientTop||d.clientTop||0,i=window.pageYOffset||d.scrollTop,j=b.top+i-h,{left:g,top:j}):{left:0,top:0}},vjs.Component=vjs.CoreObject.extend({init:function(a,b,c){this.player_=a,this.options_=vjs.obj.copy(this.options_),b=this.options(b),this.id_=b.id||(b.el&&b.el.id?b.el.id:a.id()+"_component_"+vjs.guid++),this.name_=b.name||null,this.el_=b.el||this.createEl(),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.initChildren(),this.ready(c)}}),vjs.Component.prototype.dispose=function(){if(this.trigger("dispose"),this.children_)for(var a=this.children_.length-1;a>=0;a--)this.children_[a].dispose&&this.children_[a].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),vjs.removeData(this.el_),this.el_=null},vjs.Component.prototype.player_,vjs.Component.prototype.player=function(){return this.player_},vjs.Component.prototype.options_,vjs.Component.prototype.options=function(a){return void 0===a?this.options_:this.options_=vjs.obj.deepMerge(this.options_,a)},vjs.Component.prototype.el_,vjs.Component.prototype.createEl=function(a,b){return vjs.createEl(a,b)},vjs.Component.prototype.el=function(){return this.el_},vjs.Component.prototype.contentEl_,vjs.Component.prototype.contentEl=function(){return this.contentEl_||this.el_},vjs.Component.prototype.id_,vjs.Component.prototype.id=function(){return this.id_},vjs.Component.prototype.name_,vjs.Component.prototype.name=function(){return this.name_},vjs.Component.prototype.children_,vjs.Component.prototype.children=function(){return this.children_},vjs.Component.prototype.childIndex_,vjs.Component.prototype.getChildById=function(a){return this.childIndex_[a]},vjs.Component.prototype.childNameIndex_,vjs.Component.prototype.getChild=function(a){return this.childNameIndex_[a]},vjs.Component.prototype.addChild=function(a,b){var c,d,e;return"string"===typeof a?(e=a,b=b||{},d=b.componentClass||vjs.capitalize(e),b.name=e,c=new window.videojs[d](this.player_||this,b)):c=a,this.children_.push(c),"function"===typeof c.id&&(this.childIndex_[c.id()]=c),e=e||c.name&&c.name(),e&&(this.childNameIndex_[e]=c),"function"===typeof c.el&&c.el()&&this.contentEl().appendChild(c.el()),c
},vjs.Component.prototype.removeChild=function(a){if("string"===typeof a&&(a=this.getChild(a)),a&&this.children_){for(var b=!1,c=this.children_.length-1;c>=0;c--)if(this.children_[c]===a){b=!0,this.children_.splice(c,1);break}if(b){this.childIndex_[a.id]=null,this.childNameIndex_[a.name]=null;var d=a.el();d&&d.parentNode===this.contentEl()&&this.contentEl().removeChild(a.el())}}},vjs.Component.prototype.initChildren=function(){var a=this.options_;if(a&&a.children){var b=this;vjs.obj.each(a.children,function(a,c){if(c!==!1){var d=function(){b[a]=b.addChild(a,c)};c.loadEvent||d()}})}},vjs.Component.prototype.buildCSSClass=function(){return""},vjs.Component.prototype.on=function(a,b){return vjs.on(this.el_,a,vjs.bind(this,b)),this},vjs.Component.prototype.off=function(a,b){return vjs.off(this.el_,a,b),this},vjs.Component.prototype.one=function(a,b){return vjs.one(this.el_,a,vjs.bind(this,b)),this},vjs.Component.prototype.trigger=function(a,b){return vjs.trigger(this.el_,a,b),this},vjs.Component.prototype.isReady_,vjs.Component.prototype.isReadyOnInitFinish_=!0,vjs.Component.prototype.readyQueue_,vjs.Component.prototype.ready=function(a){return a&&(this.isReady_?a.call(this):(void 0===this.readyQueue_&&(this.readyQueue_=[]),this.readyQueue_.push(a))),this},vjs.Component.prototype.triggerReady=function(){this.isReady_=!0;var a=this.readyQueue_;if(a&&a.length>0){for(var b=0,c=a.length;b<c;b++)a[b].call(this);this.readyQueue_=[],this.trigger("ready")}},vjs.Component.prototype.addClass=function(a){return vjs.addClass(this.el_,a),this},vjs.Component.prototype.removeClass=function(a){return vjs.removeClass(this.el_,a),this},vjs.Component.prototype.show=function(){return this.el_.style.display="block",this},vjs.Component.prototype.hide=function(){return this.el_.style.display="none",this},vjs.Component.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},vjs.Component.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},vjs.Component.prototype.disable=function(){this.hide(),this.show=function(){}},vjs.Component.prototype.width=function(a,b){return this.dimension("width",a,b)},vjs.Component.prototype.height=function(a,b){return this.dimension("height",a,b)},vjs.Component.prototype.dimensions=function(a,b){return this.width(a,!0).height(b)},vjs.Component.prototype.dimension=function(a,b,c){if(void 0!==b)return this.el_.style[a]=-1!==(""+b).indexOf("%")||-1!==(""+b).indexOf("px")?b:"auto"===b?"":b+"px",c||this.trigger("resize"),this;if(!this.el_)return 0;var d=this.el_.style[a],e=d.indexOf("px");return-1!==e?parseInt(d.slice(0,e),10):parseInt(this.el_["offset"+vjs.capitalize(a)],10)},vjs.Component.prototype.emitTapEvents=function(){var a,b,c,d;a=0,this.on("touchstart",function(){a=(new Date).getTime(),c=!0}),d=function(){c=!1},this.on("touchmove",d),this.on("touchleave",d),this.on("touchcancel",d),this.on("touchend",function(){c===!0&&(b=(new Date).getTime()-a,b<250&&this.trigger("tap"))})},vjs.Button=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b);var c=!1;this.on("touchstart",function(a){a.preventDefault(),c=!0}),this.on("touchmove",function(){c=!1});var d=this;this.on("touchend",function(a){c&&d.onClick(a),a.preventDefault()}),this.on("click",this.onClick),this.on("focus",this.onFocus),this.on("blur",this.onBlur)}}),vjs.Button.prototype.createEl=function(a,b){return b=vjs.obj.merge({className:this.buildCSSClass(),innerHTML:'<div class="vjs-control-content"><span class="vjs-control-text">'+(this.buttonText||"Need Text")+"</span></div>",role:"button","aria-live":"polite",tabIndex:0},b),vjs.Component.prototype.createEl.call(this,a,b)},vjs.Button.prototype.buildCSSClass=function(){return"vjs-control "+vjs.Component.prototype.buildCSSClass.call(this)},vjs.Button.prototype.onClick=function(){},vjs.Button.prototype.onFocus=function(){vjs.on(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Button.prototype.onKeyPress=function(a){(32==a.which||13==a.which)&&(a.preventDefault(),this.onClick())},vjs.Button.prototype.onBlur=function(){vjs.off(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.bar=this.getChild(this.options_.barName),this.handle=this.getChild(this.options_.handleName),a.on(this.playerEvent,vjs.bind(this,this.update)),this.on("mousedown",this.onMouseDown),this.on("touchstart",this.onMouseDown),this.on("focus",this.onFocus),this.on("blur",this.onBlur),this.on("click",this.onClick),this.player_.on("controlsvisible",vjs.bind(this,this.update)),a.ready(vjs.bind(this,this.update)),this.boundEvents={}}}),vjs.Slider.prototype.createEl=function(a,b){return b=b||{},b.className=b.className+" vjs-slider",b=vjs.obj.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},b),vjs.Component.prototype.createEl.call(this,a,b)},vjs.Slider.prototype.onMouseDown=function(a){a.preventDefault(),vjs.blockTextSelection(),this.boundEvents.move=vjs.bind(this,this.onMouseMove),this.boundEvents.end=vjs.bind(this,this.onMouseUp),vjs.on(document,"mousemove",this.boundEvents.move),vjs.on(document,"mouseup",this.boundEvents.end),vjs.on(document,"touchmove",this.boundEvents.move),vjs.on(document,"touchend",this.boundEvents.end),this.onMouseMove(a)},vjs.Slider.prototype.onMouseUp=function(){vjs.unblockTextSelection(),vjs.off(document,"mousemove",this.boundEvents.move,!1),vjs.off(document,"mouseup",this.boundEvents.end,!1),vjs.off(document,"touchmove",this.boundEvents.move,!1),vjs.off(document,"touchend",this.boundEvents.end,!1),this.update()},vjs.Slider.prototype.update=function(){if(this.el_){var a,b=this.getPercent(),c=this.handle,d=this.bar;if(isNaN(b)&&(b=0),a=b,c){var e=this.el_,f=e.offsetWidth,g=c.el().offsetWidth,h=g?g/f:0,i=1-h,j=b*i;a=j+h/2,c.el().style.left=vjs.round(100*j,2)+"%"}d.el().style.width=vjs.round(100*a,2)+"%"}},vjs.Slider.prototype.calculateDistance=function(a){var b,c,d,e,f,g,h,i,j;if(b=this.el_,c=vjs.findPosition(b),f=g=b.offsetWidth,h=this.handle,this.options_.vertical){if(e=c.top,j=a.changedTouches?a.changedTouches[0].pageY:a.pageY,h){var k=h.el().offsetHeight;e+=k/2,g-=k}return Math.max(0,Math.min(1,(e-j+g)/g))}if(d=c.left,i=a.changedTouches?a.changedTouches[0].pageX:a.pageX,h){var l=h.el().offsetWidth;d+=l/2,f-=l}return Math.max(0,Math.min(1,(i-d)/f))},vjs.Slider.prototype.onFocus=function(){vjs.on(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider.prototype.onKeyPress=function(a){37==a.which?(a.preventDefault(),this.stepBack()):39==a.which&&(a.preventDefault(),this.stepForward())},vjs.Slider.prototype.onBlur=function(){vjs.off(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider.prototype.onClick=function(a){a.stopImmediatePropagation(),a.preventDefault()},vjs.SliderHandle=vjs.Component.extend(),vjs.SliderHandle.prototype.defaultValue=0,vjs.SliderHandle.prototype.createEl=function(a,b){return b=b||{},b.className=b.className+" vjs-slider-handle",b=vjs.obj.merge({innerHTML:'<span class="vjs-control-text">'+this.defaultValue+"</span>"},b),vjs.Component.prototype.createEl.call(this,"div",b)},vjs.Menu=vjs.Component.extend(),vjs.Menu.prototype.addItem=function(a){this.addChild(a),a.on("click",vjs.bind(this,function(){this.unlockShowing()}))},vjs.Menu.prototype.createEl=function(){var a=this.options().contentElType||"ul";this.contentEl_=vjs.createEl(a,{className:"vjs-menu-content"});var b=vjs.Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return b.appendChild(this.contentEl_),vjs.on(b,"click",function(a){a.preventDefault(),a.stopImmediatePropagation()}),b},vjs.MenuItem=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),this.selected(b.selected)}}),vjs.MenuItem.prototype.createEl=function(a,b){return vjs.Button.prototype.createEl.call(this,"li",vjs.obj.merge({className:"vjs-menu-item",innerHTML:this.options_.label},b))},vjs.MenuItem.prototype.onClick=function(){this.selected(!0)},vjs.MenuItem.prototype.selected=function(a){a?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-selected",!0)):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-selected",!1))},vjs.MenuButton=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),this.menu=this.createMenu(),this.addChild(this.menu),this.items&&0===this.items.length&&this.hide(),this.on("keyup",this.onKeyPress),this.el_.setAttribute("aria-haspopup",!0),this.el_.setAttribute("role","button")}}),vjs.MenuButton.prototype.buttonPressed_=!1,vjs.MenuButton.prototype.createMenu=function(){var a=new vjs.Menu(this.player_);if(this.options().title&&a.el().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.kind_),tabindex:-1})),this.items=this.createItems(),this.items)for(var b=0;b<this.items.length;b++)a.addItem(this.items[b]);return a},vjs.MenuButton.prototype.createItems=function(){},vjs.MenuButton.prototype.buildCSSClass=function(){return this.className+" vjs-menu-button "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.MenuButton.prototype.onFocus=function(){},vjs.MenuButton.prototype.onBlur=function(){},vjs.MenuButton.prototype.onClick=function(){this.one("mouseout",vjs.bind(this,function(){this.menu.unlockShowing(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},vjs.MenuButton.prototype.onKeyPress=function(a){a.preventDefault(),32==a.which||13==a.which?this.buttonPressed_?this.unpressButton():this.pressButton():27==a.which&&this.buttonPressed_&&this.unpressButton()},vjs.MenuButton.prototype.pressButton=function(){this.buttonPressed_=!0,this.menu.lockShowing(),this.el_.setAttribute("aria-pressed",!0),this.items&&this.items.length>0&&this.items[0].el().focus()},vjs.MenuButton.prototype.unpressButton=function(){this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-pressed",!1)},vjs.Player=vjs.Component.extend({init:function(a,b,c){this.tag=a,b=vjs.obj.merge(this.getTagSettings(a),b),this.cache_={},this.poster_=b.poster,this.controls_=b.controls,a.controls=!1,vjs.Component.call(this,this,b,c),this.addClass(this.controls()?"vjs-controls-enabled":"vjs-controls-disabled"),this.one("play",function(a){var b={type:"firstplay",target:this.el_},c=vjs.trigger(this.el_,b);c||(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation())}),this.on("ended",this.onEnded),this.on("play",this.onPlay),this.on("firstplay",this.onFirstPlay),this.on("pause",this.onPause),this.on("progress",this.onProgress),this.on("durationchange",this.onDurationChange),this.on("error",this.onError),this.on("fullscreenchange",this.onFullscreenChange),vjs.players[this.id_]=this,b.plugins&&vjs.obj.each(b.plugins,function(a,b){this[a](b)},this),this.listenForUserActivity()}}),vjs.Player.prototype.options_=vjs.options,vjs.Player.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),vjs.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.stopTrackingProgress(),this.stopTrackingCurrentTime(),this.tech&&this.tech.dispose(),vjs.Component.prototype.dispose.call(this)},vjs.Player.prototype.getTagSettings=function(a){var b={sources:[],tracks:[]};if(vjs.obj.merge(b,vjs.getAttributeValues(a)),a.hasChildNodes()){var c,d,e,f,g;for(c=a.childNodes,f=0,g=c.length;f<g;f++)d=c[f],e=d.nodeName.toLowerCase(),"source"===e?b.sources.push(vjs.getAttributeValues(d)):"track"===e&&b.tracks.push(vjs.getAttributeValues(d))}return b},vjs.Player.prototype.createEl=function(){var a=this.el_=vjs.Component.prototype.createEl.call(this,"div"),b=this.tag;if(b.removeAttribute("width"),b.removeAttribute("height"),b.hasChildNodes()){var c,d,e,f,g,h;for(c=b.childNodes,d=c.length,h=[];d--;)f=c[d],g=f.nodeName.toLowerCase(),("source"===g||"track"===g)&&h.push(f);for(e=0;e<h.length;e++)b.removeChild(h[e])}return b.id=b.id||"vjs_video_"+vjs.guid++,a.id=b.id,a.className=b.className,b.id+="_html5_api",b.className="vjs-tech",b.player=a.player=this,this.addClass("vjs-paused"),this.width(this.options_.width,!0),this.height(this.options_.height,!0),b.parentNode&&b.parentNode.insertBefore(a,b),vjs.insertFirst(b,a),a},vjs.Player.prototype.loadTech=function(a,b){this.tech?this.unloadTech():"Html5"!==a&&this.tag&&(this.el_.removeChild(this.tag),this.tag.player=null,this.tag=null),this.techName=a,this.isReady_=!1;var c=function(){this.player_.triggerReady(),this.features.progressEvents||this.player_.manualProgressOn(),this.features.timeupdateEvents||this.player_.manualTimeUpdatesOn()},d=vjs.obj.merge({source:b,parentEl:this.el_},this.options_[a.toLowerCase()]);b&&(b.src==this.cache_.src&&this.cache_.currentTime>0&&(d.startTime=this.cache_.currentTime),this.cache_.src=b.src),this.tech=new window.videojs[a](this,d),this.tech.ready(c)},vjs.Player.prototype.unloadTech=function(){this.isReady_=!1,this.tech.dispose(),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),this.tech=!1},vjs.Player.prototype.manualProgressOn=function(){this.manualProgress=!0,this.trackProgress(),this.tech.one("progress",function(){this.features.progressEvents=!0,this.player_.manualProgressOff()})},vjs.Player.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress()},vjs.Player.prototype.trackProgress=function(){this.progressInterval=setInterval(vjs.bind(this,function(){this.cache_.bufferEnd<this.buffered().end(0)?this.trigger("progress"):1==this.bufferedPercent()&&(this.stopTrackingProgress(),this.trigger("progress"))}),500)},vjs.Player.prototype.stopTrackingProgress=function(){clearInterval(this.progressInterval)},vjs.Player.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime),this.tech.one("timeupdate",function(){this.features.timeupdateEvents=!0,this.player_.manualTimeUpdatesOff()})},vjs.Player.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},vjs.Player.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=setInterval(vjs.bind(this,function(){this.trigger("timeupdate")}),250)},vjs.Player.prototype.stopTrackingCurrentTime=function(){clearInterval(this.currentTimeInterval)},vjs.Player.prototype.onEnded=function(){this.options_.loop&&(this.currentTime(0),this.play())},vjs.Player.prototype.onPlay=function(){vjs.removeClass(this.el_,"vjs-paused"),vjs.addClass(this.el_,"vjs-playing")},vjs.Player.prototype.onFirstPlay=function(){this.options_.starttime&&this.currentTime(this.options_.starttime),this.addClass("vjs-has-started")},vjs.Player.prototype.onPause=function(){vjs.removeClass(this.el_,"vjs-playing"),vjs.addClass(this.el_,"vjs-paused")},vjs.Player.prototype.onProgress=function(){1==this.bufferedPercent()&&this.trigger("loadedalldata")},vjs.Player.prototype.onDurationChange=function(){this.duration(this.techGet("duration"))},vjs.Player.prototype.onError=function(a){vjs.log("Video Error",a)},vjs.Player.prototype.onFullscreenChange=function(){this.isFullScreen?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},vjs.Player.prototype.cache_,vjs.Player.prototype.getCache=function(){return this.cache_},vjs.Player.prototype.techCall=function(a,b){if(this.tech&&!this.tech.isReady_)this.tech.ready(function(){this[a](b)});else try{this.tech[a](b)}catch(c){throw vjs.log(c),c}},vjs.Player.prototype.techGet=function(a){if(this.tech&&this.tech.isReady_)try{return this.tech[a]()}catch(b){throw void 0===this.tech[a]?vjs.log("Video.js: "+a+" method not defined for "+this.techName+" playback technology.",b):"TypeError"==b.name?(vjs.log("Video.js: "+a+" unavailable on "+this.techName+" playback technology element.",b),this.tech.isReady_=!1):vjs.log(b),b}},vjs.Player.prototype.play=function(){return this.techCall("play"),this},vjs.Player.prototype.pause=function(){return this.techCall("pause"),this},vjs.Player.prototype.paused=function(){return this.techGet("paused")===!1?!1:!0},vjs.Player.prototype.currentTime=function(a){return void 0!==a?(this.cache_.lastSetCurrentTime=a,this.techCall("setCurrentTime",a),this.manualTimeUpdates&&this.trigger("timeupdate"),this):this.cache_.currentTime=this.techGet("currentTime")||0},vjs.Player.prototype.duration=function(a){return void 0!==a?(this.cache_.duration=parseFloat(a),this):this.cache_.duration},vjs.Player.prototype.remainingTime=function(){return this.duration()-this.currentTime()},vjs.Player.prototype.buffered=function(){var a=this.techGet("buffered"),b=0,c=a.length-1,d=this.cache_.bufferEnd=this.cache_.bufferEnd||0;return a&&c>=0&&a.end(c)!==d&&(d=a.end(c),this.cache_.bufferEnd=d),vjs.createTimeRange(b,d)},vjs.Player.prototype.bufferedPercent=function(){return this.duration()?this.buffered().end(0)/this.duration():0},vjs.Player.prototype.volume=function(a){var b;return void 0!==a?(b=Math.max(0,Math.min(1,parseFloat(a))),this.cache_.volume=b,this.techCall("setVolume",b),vjs.setLocalStorage("volume",b),this):(b=parseFloat(this.techGet("volume")),isNaN(b)?1:b)},vjs.Player.prototype.muted=function(a){return void 0!==a?(this.techCall("setMuted",a),this):this.techGet("muted")||!1},vjs.Player.prototype.supportsFullScreen=function(){return this.techGet("supportsFullScreen")||!1},vjs.Player.prototype.requestFullScreen=function(){var a=vjs.support.requestFullScreen;return this.isFullScreen=!0,a?(vjs.on(document,a.eventName,vjs.bind(this,function(){this.isFullScreen=document[a.isFullScreen],this.isFullScreen===!1&&vjs.off(document,a.eventName,arguments.callee),this.trigger("fullscreenchange")})),this.el_[a.requestFn]()):this.tech.supportsFullScreen()?this.techCall("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.cancelFullScreen=function(){var a=vjs.support.requestFullScreen;return this.isFullScreen=!1,a?document[a.cancelFn]():this.tech.supportsFullScreen()?this.techCall("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,vjs.on(document,"keydown",vjs.bind(this,this.fullWindowOnEscKey)),document.documentElement.style.overflow="hidden",vjs.addClass(document.body,"vjs-full-window"),this.trigger("enterFullWindow")},vjs.Player.prototype.fullWindowOnEscKey=function(a){27===a.keyCode&&(this.isFullScreen===!0?this.cancelFullScreen():this.exitFullWindow())},vjs.Player.prototype.exitFullWindow=function(){this.isFullWindow=!1,vjs.off(document,"keydown",this.fullWindowOnEscKey),document.documentElement.style.overflow=this.docOrigOverflow,vjs.removeClass(document.body,"vjs-full-window"),this.trigger("exitFullWindow")},vjs.Player.prototype.selectSource=function(a){for(var b=0,c=this.options_.techOrder;b<c.length;b++){var d=vjs.capitalize(c[b]),e=window.videojs[d];if(e.isSupported())for(var f=0,g=a;f<g.length;f++){var h=g[f];if(e.canPlaySource(h))return{source:h,tech:d}}}return!1},vjs.Player.prototype.src=function(a){if(a instanceof Array){var b,c=this.selectSource(a);c?(a=c.source,b=c.tech,b==this.techName?this.src(a):this.loadTech(b,a)):this.el_.appendChild(vjs.createEl("p",{innerHTML:this.options().notSupportedMessage}))}else a instanceof Object?this.src(window.videojs[this.techName].canPlaySource(a)?a.src:[a]):(this.cache_.src=a,this.isReady_?(this.techCall("src",a),"auto"==this.options_.preload&&this.load(),this.options_.autoplay&&this.play()):this.ready(function(){this.src(a)}));return this},vjs.Player.prototype.load=function(){return this.techCall("load"),this},vjs.Player.prototype.currentSrc=function(){return this.techGet("currentSrc")||this.cache_.src||""},vjs.Player.prototype.preload=function(a){return void 0!==a?(this.techCall("setPreload",a),this.options_.preload=a,this):this.techGet("preload")},vjs.Player.prototype.autoplay=function(a){return void 0!==a?(this.techCall("setAutoplay",a),this.options_.autoplay=a,this):this.techGet("autoplay",a)},vjs.Player.prototype.loop=function(a){return void 0!==a?(this.techCall("setLoop",a),this.options_.loop=a,this):this.techGet("loop")},vjs.Player.prototype.poster_,vjs.Player.prototype.poster=function(a){return void 0!==a&&(this.poster_=a),this.poster_},vjs.Player.prototype.controls_,vjs.Player.prototype.controls=function(a){return void 0!==a?(a=!!a,this.controls_!==a&&(this.controls_=a,a?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled")):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"))),this):this.controls_},vjs.Player.prototype.usingNativeControls_,vjs.Player.prototype.usingNativeControls=function(a){return void 0!==a?(a=!!a,this.usingNativeControls_!==a&&(this.usingNativeControls_=a,a?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):this.usingNativeControls_},vjs.Player.prototype.error=function(){return this.techGet("error")},vjs.Player.prototype.ended=function(){return this.techGet("ended")},vjs.Player.prototype.seeking=function(){return this.techGet("seeking")},vjs.Player.prototype.userActivity_=!0,vjs.Player.prototype.reportUserActivity=function(){this.userActivity_=!0},vjs.Player.prototype.userActive_=!0,vjs.Player.prototype.userActive=function(a){return void 0!==a?(a=!!a,a!==this.userActive_&&(this.userActive_=a,a?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech.one("mousemove",function(a){a.stopPropagation(),a.preventDefault()}),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},vjs.Player.prototype.listenForUserActivity=function(){var a,b,c,d,e,f;a=this.reportUserActivity,b=function(){a(),clearInterval(c),c=setInterval(vjs.bind(this,a),250)},d=function(){a(),clearInterval(c)},this.on("mousedown",b),this.on("mousemove",a),this.on("mouseup",d),this.on("keydown",a),this.on("keyup",a),this.on("touchstart",b),this.on("touchmove",a),this.on("touchend",d),this.on("touchcancel",d),e=setInterval(vjs.bind(this,function(){this.userActivity_&&(this.userActivity_=!1,this.userActive(!0),clearTimeout(f),f=setTimeout(vjs.bind(this,function(){this.userActivity_||this.userActive(!1)}),2e3))}),250),this.on("dispose",function(){clearInterval(e),clearTimeout(f)})},function(){var a,b,c;c=document.createElement("div"),b={},void 0!==c.cancelFullscreen?(b.requestFn="requestFullscreen",b.cancelFn="exitFullscreen",b.eventName="fullscreenchange",b.isFullScreen="fullScreen"):(document.mozCancelFullScreen?(a="moz",b.isFullScreen=a+"FullScreen"):(a="webkit",b.isFullScreen=a+"IsFullScreen"),c[a+"RequestFullScreen"]&&(b.requestFn=a+"RequestFullScreen",b.cancelFn=a+"CancelFullScreen"),b.eventName=a+"fullscreenchange"),document[b.cancelFn]&&(vjs.support.requestFullScreen=b)}(),vjs.ControlBar=vjs.Component.extend(),vjs.ControlBar.prototype.options_={loadEvent:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{}}},vjs.ControlBar.prototype.createEl=function(){return vjs.createEl("div",{className:"vjs-control-bar"})},vjs.PlayToggle=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),a.on("play",vjs.bind(this,this.onPlay)),a.on("pause",vjs.bind(this,this.onPause))}}),vjs.PlayToggle.prototype.buttonText="Play",vjs.PlayToggle.prototype.buildCSSClass=function(){return"vjs-play-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.PlayToggle.prototype.onClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},vjs.PlayToggle.prototype.onPlay=function(){vjs.removeClass(this.el_,"vjs-paused"),vjs.addClass(this.el_,"vjs-playing"),this.el_.children[0].children[0].innerHTML="Pause"},vjs.PlayToggle.prototype.onPause=function(){vjs.removeClass(this.el_,"vjs-playing"),vjs.addClass(this.el_,"vjs-paused"),this.el_.children[0].children[0].innerHTML="Play"},vjs.CurrentTimeDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),a.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.CurrentTimeDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.content=vjs.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00',"aria-live":"off"}),a.appendChild(vjs.createEl("div").appendChild(this.content)),a},vjs.CurrentTimeDisplay.prototype.updateContent=function(){var a=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.content.innerHTML='<span class="vjs-control-text">Current Time </span>'+vjs.formatTime(a,this.player_.duration())},vjs.DurationDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),a.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.DurationDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.content=vjs.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">Duration Time </span>0:00',"aria-live":"off"}),a.appendChild(vjs.createEl("div").appendChild(this.content)),a},vjs.DurationDisplay.prototype.updateContent=function(){var a=this.player_.duration();a&&(this.content.innerHTML='<span class="vjs-control-text">Duration Time </span>'+vjs.formatTime(a))},vjs.TimeDivider=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.TimeDivider.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},vjs.RemainingTimeDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),a.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.RemainingTimeDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.content=vjs.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">Remaining Time </span>-0:00',"aria-live":"off"}),a.appendChild(vjs.createEl("div").appendChild(this.content)),a},vjs.RemainingTimeDisplay.prototype.updateContent=function(){this.player_.duration()&&(this.content.innerHTML='<span class="vjs-control-text">Remaining Time </span>-'+vjs.formatTime(this.player_.remainingTime()))},vjs.FullscreenToggle=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b)}}),vjs.FullscreenToggle.prototype.buttonText="Fullscreen",vjs.FullscreenToggle.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.FullscreenToggle.prototype.onClick=function(){this.player_.isFullScreen?(this.player_.cancelFullScreen(),this.el_.children[0].children[0].innerHTML="Fullscreen"):(this.player_.requestFullScreen(),this.el_.children[0].children[0].innerHTML="Non-Fullscreen")},vjs.ProgressControl=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.ProgressControl.prototype.options_={children:{seekBar:{}}},vjs.ProgressControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},vjs.SeekBar=vjs.Slider.extend({init:function(a,b){vjs.Slider.call(this,a,b),a.on("timeupdate",vjs.bind(this,this.updateARIAAttributes)),a.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.SeekBar.prototype.options_={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"},vjs.SeekBar.prototype.playerEvent="timeupdate",vjs.SeekBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})},vjs.SeekBar.prototype.updateARIAAttributes=function(){var a=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",vjs.round(100*this.getPercent(),2)),this.el_.setAttribute("aria-valuetext",vjs.formatTime(a,this.player_.duration()))},vjs.SeekBar.prototype.getPercent=function(){var a;if("Flash"===this.player_.techName&&this.player_.seeking()){var b=this.player_.getCache();a=b.lastSetCurrentTime?b.lastSetCurrentTime:this.player_.currentTime()}else a=this.player_.currentTime();return a/this.player_.duration()},vjs.SeekBar.prototype.onMouseDown=function(a){vjs.Slider.prototype.onMouseDown.call(this,a),this.player_.scrubbing=!0,this.videoWasPlaying=!this.player_.paused(),this.player_.pause()},vjs.SeekBar.prototype.onMouseMove=function(a){var b=this.calculateDistance(a)*this.player_.duration();b==this.player_.duration()&&(b-=.1),this.player_.currentTime(b)},vjs.SeekBar.prototype.onMouseUp=function(a){vjs.Slider.prototype.onMouseUp.call(this,a),this.player_.scrubbing=!1,this.videoWasPlaying&&this.player_.play()},vjs.SeekBar.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},vjs.SeekBar.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},vjs.LoadProgressBar=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),a.on("progress",vjs.bind(this,this.update))}}),vjs.LoadProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text">Loaded: 0%</span>'})},vjs.LoadProgressBar.prototype.update=function(){this.el_.style&&(this.el_.style.width=vjs.round(100*this.player_.bufferedPercent(),2)+"%")},vjs.PlayProgressBar=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.PlayProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text">Progress: 0%</span>'})},vjs.SeekHandle=vjs.SliderHandle.extend(),vjs.SeekHandle.prototype.defaultValue="00:00",vjs.SeekHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-seek-handle"})},vjs.VolumeControl=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),a.tech&&a.tech.features&&a.tech.features.volumeControl===!1&&this.addClass("vjs-hidden"),a.on("loadstart",vjs.bind(this,function(){a.tech.features&&a.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}}),vjs.VolumeControl.prototype.options_={children:{volumeBar:{}}},vjs.VolumeControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},vjs.VolumeBar=vjs.Slider.extend({init:function(a,b){vjs.Slider.call(this,a,b),a.on("volumechange",vjs.bind(this,this.updateARIAAttributes)),a.ready(vjs.bind(this,this.updateARIAAttributes)),setTimeout(vjs.bind(this,this.update),0)}}),vjs.VolumeBar.prototype.updateARIAAttributes=function(){this.el_.setAttribute("aria-valuenow",vjs.round(100*this.player_.volume(),2)),this.el_.setAttribute("aria-valuetext",vjs.round(100*this.player_.volume(),2)+"%")},vjs.VolumeBar.prototype.options_={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"},vjs.VolumeBar.prototype.playerEvent="volumechange",vjs.VolumeBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})},vjs.VolumeBar.prototype.onMouseMove=function(a){this.player_.volume(this.calculateDistance(a))
},vjs.VolumeBar.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},vjs.VolumeBar.prototype.stepForward=function(){this.player_.volume(this.player_.volume()+.1)},vjs.VolumeBar.prototype.stepBack=function(){this.player_.volume(this.player_.volume()-.1)},vjs.VolumeLevel=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.VolumeLevel.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},vjs.VolumeHandle=vjs.SliderHandle.extend(),vjs.VolumeHandle.prototype.defaultValue="00:00",vjs.VolumeHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-volume-handle"})},vjs.MuteToggle=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),a.on("volumechange",vjs.bind(this,this.update)),a.tech&&a.tech.features&&a.tech.features.volumeControl===!1&&this.addClass("vjs-hidden"),a.on("loadstart",vjs.bind(this,function(){a.tech.features&&a.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}}),vjs.MuteToggle.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">Mute</span></div>'})},vjs.MuteToggle.prototype.onClick=function(){this.player_.muted(this.player_.muted()?!1:!0)},vjs.MuteToggle.prototype.update=function(){var a=this.player_.volume(),b=3;0===a||this.player_.muted()?b=0:a<.33?b=1:a<.67&&(b=2),this.player_.muted()?"Unmute"!=this.el_.children[0].children[0].innerHTML&&(this.el_.children[0].children[0].innerHTML="Unmute"):"Mute"!=this.el_.children[0].children[0].innerHTML&&(this.el_.children[0].children[0].innerHTML="Mute");for(var c=0;c<4;c++)vjs.removeClass(this.el_,"vjs-vol-"+c);vjs.addClass(this.el_,"vjs-vol-"+b)},vjs.VolumeMenuButton=vjs.MenuButton.extend({init:function(a,b){vjs.MenuButton.call(this,a,b),a.on("volumechange",vjs.bind(this,this.update)),a.tech&&a.tech.features&&a.tech.features.volumeControl===!1&&this.addClass("vjs-hidden"),a.on("loadstart",vjs.bind(this,function(){a.tech.features&&a.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})),this.addClass("vjs-menu-button")}}),vjs.VolumeMenuButton.prototype.createMenu=function(){var a=new vjs.Menu(this.player_,{contentElType:"div"}),b=new vjs.VolumeBar(this.player_,vjs.obj.merge({vertical:!0},this.options_.volumeBar));return a.addChild(b),a},vjs.VolumeMenuButton.prototype.onClick=function(){vjs.MuteToggle.prototype.onClick.call(this),vjs.MenuButton.prototype.onClick.call(this)},vjs.VolumeMenuButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">Mute</span></div>'})},vjs.VolumeMenuButton.prototype.update=vjs.MuteToggle.prototype.update,vjs.PosterImage=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),a.poster()&&a.controls()||this.hide(),a.on("play",vjs.bind(this,this.hide))}}),vjs.PosterImage.prototype.createEl=function(){var a=vjs.createEl("div",{className:"vjs-poster",tabIndex:-1}),b=this.player_.poster();return b&&("backgroundSize"in a.style?a.style.backgroundImage='url("'+b+'")':a.appendChild(vjs.createEl("img",{src:b}))),a},vjs.PosterImage.prototype.onClick=function(){this.player().controls()&&this.player_.play()},vjs.LoadingSpinner=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),a.on("canplay",vjs.bind(this,this.hide)),a.on("canplaythrough",vjs.bind(this,this.hide)),a.on("playing",vjs.bind(this,this.hide)),a.on("seeked",vjs.bind(this,this.hide)),a.on("seeking",vjs.bind(this,this.show)),a.on("seeked",vjs.bind(this,this.hide)),a.on("error",vjs.bind(this,this.show)),a.on("waiting",vjs.bind(this,this.show))}}),vjs.LoadingSpinner.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"})},vjs.BigPlayButton=vjs.Button.extend(),vjs.BigPlayButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:"<span></span>","aria-label":"play video"})},vjs.BigPlayButton.prototype.onClick=function(){this.player_.play()},vjs.MediaTechController=vjs.Component.extend({init:function(a,b,c){vjs.Component.call(this,a,b,c),this.initControlsListeners()}}),vjs.MediaTechController.prototype.initControlsListeners=function(){var a,b,c,d;b=this,a=this.player();var c=function(){a.controls()&&!a.usingNativeControls()&&b.addControlsListeners()};d=vjs.bind(b,b.removeControlsListeners),this.ready(c),a.on("controlsenabled",c),a.on("controlsdisabled",d)},vjs.MediaTechController.prototype.addControlsListeners=function(){var a,b;this.on("mousedown",this.onClick),this.on("touchstart",function(a){a.preventDefault(),a.stopPropagation(),b=this.player_.userActive()}),a=function(a){a.stopPropagation(),b&&this.player_.reportUserActivity()},this.on("touchmove",a),this.on("touchleave",a),this.on("touchcancel",a),this.on("touchend",a),this.emitTapEvents(),this.on("tap",this.onTap)},vjs.MediaTechController.prototype.removeControlsListeners=function(){this.off("tap"),this.off("touchstart"),this.off("touchmove"),this.off("touchleave"),this.off("touchcancel"),this.off("touchend"),this.off("click"),this.off("mousedown")},vjs.MediaTechController.prototype.onClick=function(a){0===a.button&&this.player().controls()&&(this.player().paused()?this.player().play():this.player().pause())},vjs.MediaTechController.prototype.onTap=function(){this.player().userActive(!this.player().userActive())},vjs.MediaTechController.prototype.features={volumeControl:!0,fullscreenResize:!1,progressEvents:!1,timeupdateEvents:!1},vjs.media={},vjs.media.ApiMethods="play,pause,paused,currentTime,setCurrentTime,duration,buffered,volume,setVolume,muted,setMuted,width,height,supportsFullScreen,enterFullScreen,src,load,currentSrc,preload,setPreload,autoplay,setAutoplay,loop,setLoop,error,networkState,readyState,seeking,initialTime,startOffsetTime,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks,defaultPlaybackRate,playbackRate,mediaGroup,controller,controls,defaultMuted".split(",");for(var i=vjs.media.ApiMethods.length-1;i>=0;i--){var methodName=vjs.media.ApiMethods[i];vjs.MediaTechController.prototype[vjs.media.ApiMethods[i]]=createMethod(methodName)}vjs.Html5=vjs.MediaTechController.extend({init:function(a,b,c){this.features.volumeControl=vjs.Html5.canControlVolume(),this.features.movingMediaElementInDOM=!vjs.IS_IOS,this.features.fullscreenResize=!0,vjs.MediaTechController.call(this,a,b,c);var d=b.source;d&&this.el_.currentSrc==d.src?a.trigger("loadstart"):d&&(this.el_.src=d.src),vjs.TOUCH_ENABLED&&a.options().nativeControlsForTouch!==!1&&this.useNativeControls(),a.ready(function(){this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play())}),this.setupTriggers(),this.triggerReady()}}),vjs.Html5.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Html5.prototype.createEl=function(){var a=this.player_,b=a.tag;b&&this.features.movingMediaElementInDOM!==!1||(b?(b.player=null,a.tag=null,a.el().removeChild(b),b=b.cloneNode(!1)):b=vjs.createEl("video",{id:a.id()+"_html5_api",className:"vjs-tech"}),b.player=a,vjs.insertFirst(b,a.el()));for(var c=["autoplay","preload","loop","muted"],d=c.length-1;d>=0;d--){var e=c[d];null!==a.options_[e]&&(b[e]=a.options_[e])}return b},vjs.Html5.prototype.setupTriggers=function(){for(var a=vjs.Html5.Events.length-1;a>=0;a--)vjs.on(this.el_,vjs.Html5.Events[a],vjs.bind(this.player_,this.eventHandler))},vjs.Html5.prototype.eventHandler=function(a){this.trigger(a),a.stopPropagation()},vjs.Html5.prototype.useNativeControls=function(){var a,b,c,d,e;a=this,b=this.player(),a.setControls(b.controls()),c=function(){a.setControls(!0)},d=function(){a.setControls(!1)},b.on("controlsenabled",c),b.on("controlsdisabled",d),e=function(){b.off("controlsenabled",c),b.off("controlsdisabled",d)},a.on("dispose",e),b.on("usingcustomcontrols",e),b.usingNativeControls(!0)},vjs.Html5.prototype.play=function(){this.el_.play()},vjs.Html5.prototype.pause=function(){this.el_.pause()},vjs.Html5.prototype.paused=function(){return this.el_.paused},vjs.Html5.prototype.currentTime=function(){return this.el_.currentTime},vjs.Html5.prototype.setCurrentTime=function(a){try{this.el_.currentTime=a}catch(b){vjs.log(b,"Video is not ready. (Video.js)")}},vjs.Html5.prototype.duration=function(){return this.el_.duration||0},vjs.Html5.prototype.buffered=function(){return this.el_.buffered},vjs.Html5.prototype.volume=function(){return this.el_.volume},vjs.Html5.prototype.setVolume=function(a){this.el_.volume=a},vjs.Html5.prototype.muted=function(){return this.el_.muted},vjs.Html5.prototype.setMuted=function(a){this.el_.muted=a},vjs.Html5.prototype.width=function(){return this.el_.offsetWidth},vjs.Html5.prototype.height=function(){return this.el_.offsetHeight},vjs.Html5.prototype.supportsFullScreen=function(){return"function"!=typeof this.el_.webkitEnterFullScreen||!/Android/.test(vjs.USER_AGENT)&&/Chrome|Mac OS X 10.5/.test(vjs.USER_AGENT)?!1:!0},vjs.Html5.prototype.enterFullScreen=function(){var a=this.el_;a.paused&&a.networkState<=a.HAVE_METADATA?(this.el_.play(),setTimeout(function(){a.pause(),a.webkitEnterFullScreen()},0)):a.webkitEnterFullScreen()},vjs.Html5.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},vjs.Html5.prototype.src=function(a){this.el_.src=a},vjs.Html5.prototype.load=function(){this.el_.load()},vjs.Html5.prototype.currentSrc=function(){return this.el_.currentSrc},vjs.Html5.prototype.preload=function(){return this.el_.preload},vjs.Html5.prototype.setPreload=function(a){this.el_.preload=a},vjs.Html5.prototype.autoplay=function(){return this.el_.autoplay},vjs.Html5.prototype.setAutoplay=function(a){this.el_.autoplay=a},vjs.Html5.prototype.controls=function(){return this.el_.controls},vjs.Html5.prototype.setControls=function(a){this.el_.controls=!!a},vjs.Html5.prototype.loop=function(){return this.el_.loop},vjs.Html5.prototype.setLoop=function(a){this.el_.loop=a},vjs.Html5.prototype.error=function(){return this.el_.error},vjs.Html5.prototype.seeking=function(){return this.el_.seeking},vjs.Html5.prototype.ended=function(){return this.el_.ended},vjs.Html5.prototype.defaultMuted=function(){return this.el_.defaultMuted},vjs.Html5.isSupported=function(){return!!vjs.TEST_VID.canPlayType},vjs.Html5.canPlaySource=function(a){try{return!!vjs.TEST_VID.canPlayType(a.type)}catch(b){return""}},vjs.Html5.canControlVolume=function(){var a=vjs.TEST_VID.volume;return vjs.TEST_VID.volume=a/2+.1,a!==vjs.TEST_VID.volume},vjs.Html5.Events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(","),vjs.IS_OLD_ANDROID&&(document.createElement("video").constructor.prototype.canPlayType=function(a){return a&&-1!=a.toLowerCase().indexOf("video/mp4")?"maybe":""}),vjs.Flash=vjs.MediaTechController.extend({init:function(a,b,c){vjs.MediaTechController.call(this,a,b,c);var d=b.source,e=b.parentEl,f=this.el_=vjs.createEl("div",{id:a.id()+"_temp_flash"}),g=a.id()+"_flash_api",h=a.options_,i=vjs.obj.merge({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:h.autoplay,preload:h.preload,loop:h.loop,muted:h.muted},b.flashVars),j=vjs.obj.merge({wmode:"opaque",bgcolor:"#000000"},b.params),k=vjs.obj.merge({id:g,name:g,"class":"vjs-tech"},b.attributes);if(d)if(d.type&&vjs.Flash.isStreamingType(d.type)){var l=vjs.Flash.streamToParts(d.src);i.rtmpConnection=encodeURIComponent(l.connection),i.rtmpStream=encodeURIComponent(l.stream)}else i.src=encodeURIComponent(vjs.getAbsoluteURL(d.src));if(vjs.insertFirst(f,e),b.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(b.startTime)}),b.iFrameMode!==!0||vjs.IS_FIREFOX)vjs.Flash.embed(b.swf,f,i,j,k);else{var m=vjs.createEl("iframe",{id:g+"_iframe",name:g+"_iframe",className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0});i.readyFunction="ready",i.eventProxyFunction="events",i.errorEventProxyFunction="errors",vjs.on(m,"load",vjs.bind(this,function(){var a,c=m.contentWindow;a=m.contentDocument?m.contentDocument:m.contentWindow.document,a.write(vjs.Flash.getEmbedCode(b.swf,i,j,k)),c.player=this.player_,c.ready=vjs.bind(this.player_,function(b){var c=a.getElementById(b),d=this,e=d.tech;e.el_=c,vjs.Flash.checkReady(e)}),c.events=vjs.bind(this.player_,function(a,b){var c=this;c&&"flash"===c.techName&&c.trigger(b)}),c.errors=vjs.bind(this.player_,function(a,b){vjs.log("Flash Error",b)})})),f.parentNode.replaceChild(m,f)}}}),vjs.Flash.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Flash.prototype.play=function(){this.el_.vjs_play()},vjs.Flash.prototype.pause=function(){this.el_.vjs_pause()},vjs.Flash.prototype.src=function(a){if(vjs.Flash.isStreamingSrc(a)?(a=vjs.Flash.streamToParts(a),this.setRtmpConnection(a.connection),this.setRtmpStream(a.stream)):(a=vjs.getAbsoluteURL(a),this.el_.vjs_src(a)),this.player_.autoplay()){var b=this;setTimeout(function(){b.play()},0)}},vjs.Flash.prototype.currentSrc=function(){var a=this.el_.vjs_getProperty("currentSrc");if(null==a){var b=this.rtmpConnection(),c=this.rtmpStream();b&&c&&(a=vjs.Flash.streamFromParts(b,c))}return a},vjs.Flash.prototype.load=function(){this.el_.vjs_load()},vjs.Flash.prototype.poster=function(){this.el_.vjs_getProperty("poster")},vjs.Flash.prototype.buffered=function(){return vjs.createTimeRange(0,this.el_.vjs_getProperty("buffered"))},vjs.Flash.prototype.supportsFullScreen=function(){return!1},vjs.Flash.prototype.enterFullScreen=function(){return!1};var api=vjs.Flash.prototype,readWrite="rtmpConnection,rtmpStream,preload,currentTime,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),readOnly="error,currentSrc,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks".split(","),createSetter=function(a){var b=a.charAt(0).toUpperCase()+a.slice(1);api["set"+b]=function(b){return this.el_.vjs_setProperty(a,b)}},createGetter=function(a){api[a]=function(){return this.el_.vjs_getProperty(a)}};if(function(){var a;for(a=0;a<readWrite.length;a++)createGetter(readWrite[a]),createSetter(readWrite[a]);for(a=0;a<readOnly.length;a++)createGetter(readOnly[a])}(),vjs.Flash.isSupported=function(){return vjs.Flash.version()[0]>=10},vjs.Flash.canPlaySource=function(a){return a.type in vjs.Flash.formats||a.type in vjs.Flash.streamingFormats?"maybe":void 0},vjs.Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},vjs.Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},vjs.Flash.onReady=function(a){var b=vjs.el(a),c=b.player||b.parentNode.player,d=c.tech;b.player=c,d.el_=b,vjs.Flash.checkReady(d)},vjs.Flash.checkReady=function(a){a.el().vjs_getProperty?a.triggerReady():setTimeout(function(){vjs.Flash.checkReady(a)},50)},vjs.Flash.onEvent=function(a,b){var c=vjs.el(a).player;c.trigger(b)},vjs.Flash.onError=function(a,b){var c=vjs.el(a).player;c.trigger("error"),vjs.log("Flash Error",b,a)},vjs.Flash.version=function(){var a="0,0,0";try{a=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(a=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(c){}}return a.split(",")},vjs.Flash.embed=function(a,b,c,d,e){var f=vjs.Flash.getEmbedCode(a,c,d,e),g=vjs.createEl("div",{innerHTML:f}).childNodes[0],h=b.parentNode;b.parentNode.replaceChild(g,b);var i=h.childNodes[0];return setTimeout(function(){i.style.display="block"},1e3),g},vjs.Flash.getEmbedCode=function(a,b,c,d){var e='<object type="application/x-shockwave-flash"',f="",g="",h="";return b&&vjs.obj.each(b,function(a,b){f+=a+"="+b+"&amp;"}),c=vjs.obj.merge({movie:a,flashvars:f,allowScriptAccess:"always",allowNetworking:"all"},c),vjs.obj.each(c,function(a,b){g+='<param name="'+a+'" value="'+b+'" />'}),d=vjs.obj.merge({data:a,width:"100%",height:"100%"},d),vjs.obj.each(d,function(a,b){h+=a+'="'+b+'" '}),e+h+">"+g+"</object>"},vjs.Flash.streamFromParts=function(a,b){return a+"&"+b},vjs.Flash.streamToParts=function(a){var b={connection:"",stream:""};if(!a)return b;var c,d=a.indexOf("&");return-1!==d?c=d+1:(d=c=a.lastIndexOf("/")+1,0===d&&(d=c=a.length)),b.connection=a.substring(0,d),b.stream=a.substring(c,a.length),b},vjs.Flash.isStreamingType=function(a){return a in vjs.Flash.streamingFormats},vjs.Flash.RTMP_RE=/^rtmp[set]?:\/\//i,vjs.Flash.isStreamingSrc=function(a){return vjs.Flash.RTMP_RE.test(a)},vjs.MediaLoader=vjs.Component.extend({init:function(a,b,c){if(vjs.Component.call(this,a,b,c),a.options_.sources&&0!==a.options_.sources.length)a.src(a.options_.sources);else for(var d=0,e=a.options_.techOrder;d<e.length;d++){var f=vjs.capitalize(e[d]),g=window.videojs[f];if(g&&g.isSupported()){a.loadTech(f);break}}}}),vjs.Player.prototype.textTracks_,vjs.Player.prototype.textTracks=function(){return this.textTracks_=this.textTracks_||[],this.textTracks_},vjs.Player.prototype.addTextTrack=function(a,b,c,d){var e=this.textTracks_=this.textTracks_||[];d=d||{},d.kind=a,d.label=b,d.language=c;var f=vjs.capitalize(a||"subtitles"),g=new window.videojs[f+"Track"](this,d);return e.push(g),g},vjs.Player.prototype.addTextTracks=function(a){for(var b,c=0;c<a.length;c++)b=a[c],this.addTextTrack(b.kind,b.label,b.language,b);return this},vjs.Player.prototype.showTextTrack=function(a,b){for(var c,d,e,f=this.textTracks_,g=0,h=f.length;g<h;g++)c=f[g],c.id()===a?(c.show(),d=c):b&&c.kind()==b&&c.mode()>0&&c.disable();return e=d?d.kind():b?b:!1,e&&this.trigger(e+"trackchange"),this},vjs.TextTrack=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.id_=b.id||"vjs_"+b.kind+"_"+b.language+"_"+vjs.guid++,this.src_=b.src,this.dflt_=b["default"]||b.dflt,this.title_=b.title,this.language_=b.srclang,this.label_=b.label,this.cues_=[],this.activeCues_=[],this.readyState_=0,this.mode_=0,this.player_.on("fullscreenchange",vjs.bind(this,this.adjustFontSize))}}),vjs.TextTrack.prototype.kind_,vjs.TextTrack.prototype.kind=function(){return this.kind_},vjs.TextTrack.prototype.src_,vjs.TextTrack.prototype.src=function(){return this.src_},vjs.TextTrack.prototype.dflt_,vjs.TextTrack.prototype.dflt=function(){return this.dflt_},vjs.TextTrack.prototype.title_,vjs.TextTrack.prototype.title=function(){return this.title_},vjs.TextTrack.prototype.language_,vjs.TextTrack.prototype.language=function(){return this.language_},vjs.TextTrack.prototype.label_,vjs.TextTrack.prototype.label=function(){return this.label_},vjs.TextTrack.prototype.cues_,vjs.TextTrack.prototype.cues=function(){return this.cues_},vjs.TextTrack.prototype.activeCues_,vjs.TextTrack.prototype.activeCues=function(){return this.activeCues_},vjs.TextTrack.prototype.readyState_,vjs.TextTrack.prototype.readyState=function(){return this.readyState_},vjs.TextTrack.prototype.mode_,vjs.TextTrack.prototype.mode=function(){return this.mode_},vjs.TextTrack.prototype.adjustFontSize=function(){this.el_.style.fontSize=this.player_.isFullScreen?screen.width/this.player_.width()*1.4*100+"%":""},vjs.TextTrack.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-"+this.kind_+" vjs-text-track"})},vjs.TextTrack.prototype.show=function(){this.activate(),this.mode_=2,vjs.Component.prototype.show.call(this)},vjs.TextTrack.prototype.hide=function(){this.activate(),this.mode_=1,vjs.Component.prototype.hide.call(this)},vjs.TextTrack.prototype.disable=function(){2==this.mode_&&this.hide(),this.deactivate(),this.mode_=0},vjs.TextTrack.prototype.activate=function(){0===this.readyState_&&this.load(),0===this.mode_&&(this.player_.on("timeupdate",vjs.bind(this,this.update,this.id_)),this.player_.on("ended",vjs.bind(this,this.reset,this.id_)),("captions"===this.kind_||"subtitles"===this.kind_)&&this.player_.getChild("textTrackDisplay").addChild(this))},vjs.TextTrack.prototype.deactivate=function(){this.player_.off("timeupdate",vjs.bind(this,this.update,this.id_)),this.player_.off("ended",vjs.bind(this,this.reset,this.id_)),this.reset(),this.player_.getChild("textTrackDisplay").removeChild(this)},vjs.TextTrack.prototype.load=function(){0===this.readyState_&&(this.readyState_=1,vjs.get(this.src_,vjs.bind(this,this.parseCues),vjs.bind(this,this.onError)))},vjs.TextTrack.prototype.onError=function(a){this.error=a,this.readyState_=3,this.trigger("error")},vjs.TextTrack.prototype.parseCues=function(a){for(var b,c,d,e,f=a.split("\n"),g="",h=1,i=f.length;h<i;h++)if(g=vjs.trim(f[h])){for(-1==g.indexOf("-->")?(e=g,g=vjs.trim(f[++h])):e=this.cues_.length,b={id:e,index:this.cues_.length},c=g.split(" --> "),b.startTime=this.parseCueTime(c[0]),b.endTime=this.parseCueTime(c[1]),d=[];f[++h]&&(g=vjs.trim(f[h]));)d.push(g);b.text=d.join("<br/>"),this.cues_.push(b)}this.readyState_=2,this.trigger("loaded")},vjs.TextTrack.prototype.parseCueTime=function(a){var b,c,d,e,f,g=a.split(":"),h=0;return 3==g.length?(b=g[0],c=g[1],d=g[2]):(b=0,c=g[0],d=g[1]),d=d.split(/\s+/),e=d.splice(0,1)[0],e=e.split(/\.|,/),f=parseFloat(e[1]),e=e[0],h+=3600*parseFloat(b),h+=60*parseFloat(c),h+=parseFloat(e),f&&(h+=f/1e3),h},vjs.TextTrack.prototype.update=function(){if(this.cues_.length>0){var a=this.player_.currentTime();if(void 0===this.prevChange||a<this.prevChange||this.nextChange<=a){var b,c,d,e,f=this.cues_,g=this.player_.duration(),h=0,i=!1,j=[];for(a>=this.nextChange||void 0===this.nextChange?e=void 0!==this.firstActiveIndex?this.firstActiveIndex:0:(i=!0,e=void 0!==this.lastActiveIndex?this.lastActiveIndex:f.length-1);;){if(d=f[e],d.endTime<=a)h=Math.max(h,d.endTime),d.active&&(d.active=!1);else if(a<d.startTime){if(g=Math.min(g,d.startTime),d.active&&(d.active=!1),!i)break}else i?(j.splice(0,0,d),void 0===c&&(c=e),b=e):(j.push(d),void 0===b&&(b=e),c=e),g=Math.min(g,d.endTime),h=Math.max(h,d.startTime),d.active=!0;if(i){if(0===e)break;e--}else{if(e===f.length-1)break;e++}}this.activeCues_=j,this.nextChange=g,this.prevChange=h,this.firstActiveIndex=b,this.lastActiveIndex=c,this.updateDisplay(),this.trigger("cuechange")}}},vjs.TextTrack.prototype.updateDisplay=function(){for(var a=this.activeCues_,b="",c=0,d=a.length;c<d;c++)b+='<span class="vjs-tt-cue">'+a[c].text+"</span>";this.el_.innerHTML=b},vjs.TextTrack.prototype.reset=function(){this.nextChange=0,this.prevChange=this.player_.duration(),this.firstActiveIndex=0,this.lastActiveIndex=0},vjs.CaptionsTrack=vjs.TextTrack.extend(),vjs.CaptionsTrack.prototype.kind_="captions",vjs.SubtitlesTrack=vjs.TextTrack.extend(),vjs.SubtitlesTrack.prototype.kind_="subtitles",vjs.ChaptersTrack=vjs.TextTrack.extend(),vjs.ChaptersTrack.prototype.kind_="chapters",vjs.TextTrackDisplay=vjs.Component.extend({init:function(a,b,c){vjs.Component.call(this,a,b,c),a.options_.tracks&&a.options_.tracks.length>0&&this.player_.addTextTracks(a.options_.tracks)}}),vjs.TextTrackDisplay.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"})},vjs.TextTrackMenuItem=vjs.MenuItem.extend({init:function(a,b){var c=this.track=b.track;b.label=c.label(),b.selected=c.dflt(),vjs.MenuItem.call(this,a,b),this.player_.on(c.kind()+"trackchange",vjs.bind(this,this.update))}}),vjs.TextTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player_.showTextTrack(this.track.id_,this.track.kind())},vjs.TextTrackMenuItem.prototype.update=function(){this.selected(2==this.track.mode())},vjs.OffTextTrackMenuItem=vjs.TextTrackMenuItem.extend({init:function(a,b){b.track={kind:function(){return b.kind},player:a,label:function(){return b.kind+" off"},dflt:function(){return!1},mode:function(){return!1}},vjs.TextTrackMenuItem.call(this,a,b),this.selected(!0)}}),vjs.OffTextTrackMenuItem.prototype.onClick=function(){vjs.TextTrackMenuItem.prototype.onClick.call(this),this.player_.showTextTrack(this.track.id_,this.track.kind())},vjs.OffTextTrackMenuItem.prototype.update=function(){for(var a,b=this.player_.textTracks(),c=0,d=b.length,e=!0;c<d;c++)a=b[c],a.kind()==this.track.kind()&&2==a.mode()&&(e=!1);this.selected(e)},vjs.TextTrackButton=vjs.MenuButton.extend({init:function(a,b){vjs.MenuButton.call(this,a,b),this.items.length<=1&&this.hide()}}),vjs.TextTrackButton.prototype.createItems=function(){var a,b=[];b.push(new vjs.OffTextTrackMenuItem(this.player_,{kind:this.kind_}));for(var c=0;c<this.player_.textTracks().length;c++)a=this.player_.textTracks()[c],a.kind()===this.kind_&&b.push(new vjs.TextTrackMenuItem(this.player_,{track:a}));return b},vjs.CaptionsButton=vjs.TextTrackButton.extend({init:function(a,b,c){vjs.TextTrackButton.call(this,a,b,c),this.el_.setAttribute("aria-label","Captions Menu")}}),vjs.CaptionsButton.prototype.kind_="captions",vjs.CaptionsButton.prototype.buttonText="Captions",vjs.CaptionsButton.prototype.className="vjs-captions-button",vjs.SubtitlesButton=vjs.TextTrackButton.extend({init:function(a,b,c){vjs.TextTrackButton.call(this,a,b,c),this.el_.setAttribute("aria-label","Subtitles Menu")}}),vjs.SubtitlesButton.prototype.kind_="subtitles",vjs.SubtitlesButton.prototype.buttonText="Subtitles",vjs.SubtitlesButton.prototype.className="vjs-subtitles-button",vjs.ChaptersButton=vjs.TextTrackButton.extend({init:function(a,b,c){vjs.TextTrackButton.call(this,a,b,c),this.el_.setAttribute("aria-label","Chapters Menu")}}),vjs.ChaptersButton.prototype.kind_="chapters",vjs.ChaptersButton.prototype.buttonText="Chapters",vjs.ChaptersButton.prototype.className="vjs-chapters-button",vjs.ChaptersButton.prototype.createItems=function(){for(var a,b=[],c=0;c<this.player_.textTracks().length;c++)a=this.player_.textTracks()[c],a.kind()===this.kind_&&b.push(new vjs.TextTrackMenuItem(this.player_,{track:a}));return b},vjs.ChaptersButton.prototype.createMenu=function(){for(var a,b,c=this.player_.textTracks(),d=0,e=c.length,f=this.items=[];d<e;d++)if(a=c[d],a.kind()==this.kind_&&a.dflt()){if(a.readyState()<2)return this.chaptersTrack=a,void a.on("loaded",vjs.bind(this,this.createMenu));b=a;break}var g=this.menu=new vjs.Menu(this.player_);if(g.el_.appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.kind_),tabindex:-1})),b){var h,i,j=b.cues_;for(d=0,e=j.length;d<e;d++)h=j[d],i=new vjs.ChaptersTrackMenuItem(this.player_,{track:b,cue:h}),f.push(i),g.addChild(i)}return this.items.length>0&&this.show(),g},vjs.ChaptersTrackMenuItem=vjs.MenuItem.extend({init:function(a,b){var c=this.track=b.track,d=this.cue=b.cue,e=a.currentTime();b.label=d.text,b.selected=d.startTime<=e&&e<d.endTime,vjs.MenuItem.call(this,a,b),c.on("cuechange",vjs.bind(this,this.update))}}),vjs.ChaptersTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},vjs.ChaptersTrackMenuItem.prototype.update=function(){var a=this.cue,b=this.player_.currentTime();this.selected(a.startTime<=b&&b<a.endTime)},vjs.obj.merge(vjs.ControlBar.prototype.options_.children,{subtitlesButton:{},captionsButton:{},chaptersButton:{}}),vjs.JSON,"undefined"!==typeof window.JSON&&"function"===window.JSON.parse)vjs.JSON=window.JSON;else{vjs.JSON={};var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;vjs.JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"===typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"===typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse(): invalid or malformed JSON data")}}vjs.autoSetup=function(){var a,b,c,d=document.getElementsByTagName("video");if(d&&d.length>0)for(var e=0,f=d.length;e<f;e++){if(b=d[e],!b||!b.getAttribute){vjs.autoSetupTimeout(1);break}void 0===b.player&&(a=b.getAttribute("data-setup"),null!==a&&(a=vjs.JSON.parse(a||"{}"),c=videojs(b,a)))}else vjs.windowLoaded||vjs.autoSetupTimeout(1)},vjs.autoSetupTimeout=function(a){setTimeout(vjs.autoSetup,a)},"complete"===document.readyState?vjs.windowLoaded=!0:vjs.one(window,"load",function(){vjs.windowLoaded=!0}),vjs.autoSetupTimeout(1),vjs.plugin=function(a,b){vjs.Player.prototype[a]=b},function(){goog.provide("P.CONST");var a={SHOW:0,BUBBLE:1,REMOVE:2},b={VIEWPORT_MIDDLE:1,ANCHORED:2,MANUAL:3};P.CONST.PIN_WIDTH=P.scout.CONST.PIN_WIDTH,P.CONST.PIN_MARGIN=P.scout.CONST.PIN_MARGIN,P.CONST.MIN_COLUMNS=P.scout.CONST.MIN_COLUMNS,P.CONST.MAX_COLUMNS=P.scout.CONST.MAX_COLUMNS,P.CONST.NOTIFICATIONS_POLL=45e3,P.CONST.UPDATES_MIN_POLL=45e3,P.CONST.UPDATES_MAX_POLL=9e5,P.CONST.SCROLL_TO_TOP_ANIMATION_TIME=300,P.CONST.BOARD_PRIVACY_SECRET="secret",P.CONST.ADD_PIN_TO_MAP_DIALOG_HIDDEN="addPinToMapDialogHidden",P.CONST.ADD_PIN_TO_MAP_DIALOG_SHOWN="addPinToMapDialogShown",P.CONST.ADD_HOVER_LISTENER_FOR_MAP_MARKER="addHoverListenerForMapMarker",P.CONST.REMOVE_HOVER_LISTENER_FOR_MAP_MARKER="removeHoverListenerForMapMarker",P.CONST.CLASS_BUTTON_HIGHLIGHTED="buttonHighlighted",P.CONST.CLASS_DROPDOWN_BUTTON_ACTIVE="active",P.CONST.CLASS_TYPEAHEAD_HIGHLIGHTED="highlighted",P.CONST.COOKIE_CSRF="csrftoken",P.CONST.COOKIE_EMAIL_ADDRESS_UPDATED="ues",P.CONST.COOKIE_FB_AUTO_LOGIN_DISABLED="fba",P.CONST.COOKIE_LOCAL_STORAGE="ls",P.CONST.COOKIE_SESSION_STORAGE="ss",P.CONST.COOKIE_SKIP_NUX="d_skip_nux",P.CONST.COOKIE_NAG_LANGUAGE="nl",P.CONST.COOKIE_USER_JUST_REGISTERED="ujr",P.CONST.COOKIE_FORCE_DESKTOP="r_m",P.CONST.COOKIE_SUPPRESS_NAG_DOWNLOAD="nd",P.CONST.COOKIE_OPEN_IN_APP="open_in_app",P.CONST.COOKIE_STAY_IN_BROWSER="stay_in_browser",P.CONST.COOKIE_VERSION_REFRESH="version_refresh",P.CONST.COOKIE_REGISTER_RESTRICT="r_r",P.CONST.COOKIE_PERSONALIZE_FROM_OFFSITE_BROWSING_COOKIE_NAME="_pinterest_pfob",P.CONST.USER_AGENT_PLATFORM_IOS="ios",P.CONST.USER_AGENT_PLATFORM_ANDROID="android",P.CONST.SESSION_FACEBOOK_ID="_fbid",P.CONST.SESSION_FACEBOOK_TOKEN="_fbt",P.CONST.SESSION_KEY_INVITE_FOLLOW="d_pif_invite",P.CONST.SESSION_TWITTER_ID="_twid",P.CONST.SESSION_TWITTER_TOKEN="_twit",P.CONST.SESSION_TWITTER_TOKEN_SECRET="_twisc",P.CONST.SESSION_TWITTER_FIRST_NAME="_twifn",P.CONST.SESSION_TWITTER_LAST_NAME="_twiln",P.CONST.SESSION_TWITTER_USERNAME="_twiun",P.CONST.SESSION_TWITTER_IMAGE_URL="_twiiu",P.CONST.SESSION_RAKUTEN_ID="_rakuid",P.CONST.SESSION_RAKUTEN_TOKEN="_rakut",P.CONST.SESSION_RAKUTEN_REFRESH_TOKEN="_rakurt",P.CONST.SESSION_RAKUTEN_FIRST_NAME="_rakufn",P.CONST.SESSION_RAKUTEN_EMAIL="_rakue",P.CONST.SESSION_RAKUTEN_GENDER="_rakug",P.CONST.SESSION_GPLUS_CODE="_gpc",P.CONST.SESSION_GPLUS_REDIRECT_URI="_gpuri",P.CONST.EVENT_ADD_PERMANENT_MARKER_TO_MAP_FROM_TYPEAHEAD="addPermanentMarkerToMapFromTypeahead",P.CONST.EVENT_BLUR="blur",P.CONST.EVENT_BOARD_CACHE_PIN_ID_TO_ADD_TO_MAP="boardCachePinIdToAddToMap",P.CONST.EVENT_BOARD_CREATE_USER_REMOVED="boardCreateUserRemoved",P.CONST.EVENT_BOARD_FOLLOW="boardFollowed",P.CONST.EVENT_BOARD_SELECTED="boardSelected",P.CONST.EVENT_BOARD_UNFOLLOW="boardUnfollowed",P.CONST.EVENT_BODY_COLUMN_CHANGE="bodyColumnChange",P.CONST.EVENT_BUTTON_CLICK="buttonClick",P.CONST.EVENT_CHANGE="change",P.CONST.EVENT_CITY_SELECTED="citySelected",P.CONST.EVENT_CLEAR_PLACEHOLDER_MARKER_HIGHLIGHT="clearPlaceholderMarkerHighlight",P.CONST.EVENT_CLOSE="close",P.CONST.EVENT_CONFIRM="confirm",P.CONST.EVENT_CONTENT_CHANGED="contentChanged",P.CONST.EVENT_DATA="data",P.CONST.EVENT_DATEPICKER_DATE_SELECTED="datePickerDateSelected",P.CONST.EVENT_DATEPICKER_RANGE_SELECTED="datePickerRangeSelected",P.CONST.EVENT_DESTROYED="destroyed",P.CONST.EVENT_DIMS_CHANGED="dimsChanged",P.CONST.EVENT_DISMISS="dismiss",P.CONST.EVENT_DROPDOWN_CONTAINER_HIDDEN="dropdownContainerHidden",P.CONST.EVENT_DROPDOWN_CONTAINER_SHOWN="dropdownContainerShown",P.CONST.EVENT_DROPDOWN_HIDE="dropdownHide",P.CONST.EVENT_DROPDOWN_HIDE_NOT_PROPAGATE="dropdownHideNotPropagate",P.CONST.EVENT_DROPDOWN_SHOW="dropdownShow",P.CONST.EVENT_ENTER_PRESSED="enterPressed",P.CONST.EVENT_ERROR="error",P.CONST.EVENT_ERROR_RESOLVED="errorResolved",P.CONST.EVENT_EXTERNAL_CLICK="externalLinkClicked",P.CONST.EVENT_FAST_FOLLOW_CATEGORY_SELECTED="followpageCategorySelected",P.CONST.EVENT_FAST_FOLLOW_SEARCH_QUERY_UPDATED="followpageSearchQueryUpdated",P.CONST.EVENT_FOCUS="focus",P.CONST.EVENT_HIDE_PLACE_FIELDS="hidePlaceFields",P.CONST.EVENT_HIGHLIGHT_PLACEHOLDER_MARKER="highlightPlaceholderMarker",P.CONST.EVENT_HOVERINTENT_ENTER_COMPLETE="mouseEnterComplete",P.CONST.EVENT_HOVERINTENT_ENTER_START="mouseEnterStart",P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE="mouseOutComplete",P.CONST.EVENT_HOVERINTENT_OUT_START="mouseOutStart",P.CONST.EVENT_INCREMENT_BUTTON_CREATE="incrementButtonCreate",P.CONST.EVENT_INCREMENT_BUTTON_DESTROY="incrementButtonDestroy",P.CONST.EVENT_INVITE_EMAIL="inviteEmail",P.CONST.EVENT_INVITE_USER="inviteUser",P.CONST.EVENT_ITEMS_END="itemsEnd",P.CONST.EVENT_ITEMS_REQUEST_START="itemsRequestStart",P.CONST.EVENT_ITEMS_REQUEST_SUCCESS="itemsRequestSuccess",P.CONST.EVENT_ITEM_HIGHLIGHTED="itemHighlighted",P.CONST.EVENT_ITEM_SELECTED="itemSelected",P.CONST.EVENT_LAZY_IMAGE_COMPLETE="lazyImageComplete",P.CONST.EVENT_MAP_DRAG_END="mapDragEnd",P.CONST.EVENT_MAP_POPUP_OPENED="mapPopupOpened",P.CONST.EVENT_MAP_READY="mapReady",P.CONST.EVENT_MAP_ZOOM_END="mapZoomEnd",P.CONST.EVENT_MODAL="modal",P.CONST.EVENT_NAVIGATE="navigate",P.CONST.EVENT_NEXT="next",P.CONST.EVENT_OPEN="open",P.CONST.EVENT_OPEN_IN_APP="openInApp",P.CONST.EVENT_PLACE_IMAGE_SELECTED="placeImageSelected",P.CONST.EVENT_PIN_CREATE="pinCreate",P.CONST.EVENT_PIN_CREATE_OPENED="pinCreateOpened",P.CONST.EVENT_PIN_DELETED="pinDeleted",P.CONST.EVENT_PIN_LIKED="pinLiked",P.CONST.EVENT_PIN_MOUSE_IN="pinMouseIn",P.CONST.EVENT_PIN_MOUSE_OUT="pinMouseOut",P.CONST.EVENT_PIN_PLACE_CLICK="pinPlaceClick",P.CONST.EVENT_PIN_UNLIKED="pinUnliked",P.CONST.EVENT_PIN_UPDATED="pinUpdated",P.CONST.EVENT_PINIT_BUTTON_CLICKED="pinItButtonClicked",P.CONST.EVENT_PLACE_SELECTED="placeSelected",P.CONST.EVENT_PREVIOUS="previous",P.CONST.EVENT_PROGRESS_COMPLETED="progressCompleted",P.CONST.EVENT_REMOVE_PLACEHOLDER_MARKER_TO_MAP_FROM_TYPEAHEAD="removePlaceholderMarkerToMapFromTypeahead",P.CONST.EVENT_REQUIRES_AUTHENTICATION="authenticationRequired",P.CONST.EVENT_RESET_SHOW_PIN_ON_MAP_BUTTON="resetShowPinOnMapButtonStates",P.CONST.EVENT_RESIZE="resize",P.CONST.EVENT_ROUTE_MATCHED="routeMatched",P.CONST.EVENT_ROUTE_NO_MATCH="routeNoMatch",P.CONST.EVENT_SCROLL_TO_TOP="scrollToTop",P.CONST.EVENT_SET_PLACEHOLDER_MARKERS="setPlaceholderMarkers",P.CONST.EVENT_STICKY_FIXED="stickyUpdate",P.CONST.EVENT_STICKY_NORMAL="stickyNormal",P.CONST.EVENT_SUBMIT_VALIDATED="submitValidated",P.CONST.EVENT_TOGGLE_MARKERS_TRANSLUCENT="toggleMarkersTransparent",P.CONST.EVENT_TUTORIAL_SHOW="showTutorial",P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED="typeaheadNoResultsReturned",P.CONST.EVENT_TYPEAHEAD_RENDER_DONE="typeaheadRenderDone",P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED="typeaheadResultsReturned",P.CONST.EVENT_TYPEAHEAD_SEARCH_START="typeaheadSearchStart",P.CONST.EVENT_TYPEAHEAD_SEARCH_WORLD="typeaheadSearchWorld",P.CONST.EVENT_UPLOAD_ERROR="uploadError",P.CONST.EVENT_UPLOAD_PROGRESS="uploadProgress",P.CONST.EVENT_UPLOAD_START="uploadStart",P.CONST.EVENT_UPLOAD_SUCCESS="uploadSuccess",P.CONST.EVENT_USER_CLICK="userClick",P.CONST.EVENT_USER_FOLLOW="userFollow",P.CONST.EVENT_USER_REGISTER="userRegister",P.CONST.FACEBOOK_LOGIN_SUCCESS="fbLoginSuccess",P.CONST.FACEBOOK_LOGIN_FAILURE="fbLoginFailure",P.CONST.GA_ACTION_CLICK="click",P.CONST.GA_ACTION_CLICK_CANCEL="click_cancel",P.CONST.GA_ACTION_CLICK_CLOSE="click_close",P.CONST.GA_ACTION_CLICK_CONFIRM="click_confirm",P.CONST.GA_ACTION_CLICK_SUBMIT="click_submit",P.CONST.GA_ACTION_ENTER_SUBMIT="enter_submit",P.CONST.GA_ACTION_ERROR="error",P.CONST.GA_ACTION_OPEN_MODAL="open_modal",P.CONST.GA_ACTION_SELECT_SUBMIT="select_submit",P.CONST.GA_ACTION_SUCCESS="success",P.CONST.GA_CATEGORY_PIN_DELETE="pin_delete",P.CONST.GA_CATEGORY_PIN_EDIT="pin_edit",P.CONST.IMAGE_SIZE_ORIG="orig",P.CONST.PLACEHOLDER_MARKER_POPUP_OPENED="placeholderMarkerPopupOpened",P.CONST.PUBSUB_CHANNEL_BREADCRUMBS="breadcrumbs",P.CONST.PUBSUB_CHANNEL_CURRENT_USER="currentUser",P.CONST.PUBSUB_CHANNEL_CONTEXT_LOGGING="contextLogging",P.CONST.PUBSUB_CHANNEL_MAIN_MODULE="mainModule",P.CONST.PUBSUB_CHANNEL_REQUEST="request",P.CONST.PUBSUB_CHANNEL_SITE="site",P.CONST.PUBSUB_CHANNEL_TUTORIAL="tutorial",P.CONST.PUBSUB_CHANNEL_UNAUTH_NAG="unauthNag",P.CONST.PUBSUB_MESSAGE_BOARD_SET_PUBLIC="boardSetPublic",P.CONST.PUBSUB_MESSAGE_USER_EMAIL_UPDATED="userEmailUpdated",P.CONST.PUBSUB_TOPIC_APP_VERSION="appVersion",P.CONST.PUBSUB_TOPIC_APP_VERSION_AVAILABLE="appVersionAvailable",P.CONST.PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE="boardApprovedCollaboratorInvite",P.CONST.PUBSUB_TOPIC_BOARD_BANNED_COLLABORATOR="boardBannedCollaborator",P.CONST.PUBSUB_TOPIC_BOARD_COVER_UPDATED="boardCoverUpdated",P.CONST.PUBSUB_TOPIC_BOARD_CREATED="boardCreated",P.CONST.PUBSUB_TOPIC_BOARD_DELETED="boardDeleted",P.CONST.PUBSUB_TOPIC_BOARD_FOLLOW="boardFollow",P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF="boardRemovedCollaboratorSelf",P.CONST.PUBSUB_TOPIC_BOARD_UNFOLLOW="boardUnfollow",P.CONST.PUBSUB_TOPIC_BOARD_UPDATED="boardUpdated",P.CONST.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED="boardWriteAccessUpdated",P.CONST.PUBSUB_TOPIC_BREADCRUMB_UPDATE="updateBreadcrumb",P.CONST.PUBSUB_TOPIC_CONSUMER_UPDATED="consumerUpdated",P.CONST.PUBSUB_TOPIC_CONSUMER_LIST_UPDATED="consumerListUpdated",P.CONST.PUBSUB_TOPIC_CONTEXT_LOG_PLAIN_OBJECT="contextLogPlainObject",P.CONST.PUBSUB_TOPIC_PLACED_EXPERIENCES_FROM_SERVER="placedExperiencesFromServer",P.CONST.PUBSUB_TOPIC_CURRENT_CATEGORY="currentCategory",P.CONST.PUBSUB_TOPIC_DEEP_LINK="deepLink",P.CONST.PUBSUB_TOPIC_SET_DRAG_MAP_REDO_SEARCH="disableDragMapReDoSearch",P.CONST.PUBSUB_TOPIC_HEADER_ALT_STATE="headerAltState",P.CONST.PUBSUB_TOPIC_MAIN_MODULE_NEW="mainModuleNew",P.CONST.PUBSUB_TOPIC_MAP_BOUNDS_CHANGED="mapBoundsChanged",P.CONST.PUBSUB_TOPIC_NAG_STATE="nagState",P.CONST.PUBSUB_TOPIC_NAG_UPDATED="nagUpdated",P.CONST.PUBSUB_TOPIC_PAGE_INFO="pageInfo",P.CONST.PUBSUB_TOPIC_PIN_COMMENT_CREATED="pinCommentCreated",P.CONST.PUBSUB_TOPIC_PIN_COMMENT_DELETED="pinCommentDeleted",P.CONST.PUBSUB_TOPIC_PIN_CREATED="pinCreated",P.CONST.PUBSUB_TOPIC_PIN_DELETED="pinDeleted",P.CONST.PUBSUB_TOPIC_PIN_LIKED="pinLiked",P.CONST.PUBSUB_TOPIC_PIN_UNLIKED="pinUnliked",P.CONST.PUBSUB_TOPIC_PIN_UPDATED="pinUpdated",P.CONST.PUBSUB_TOPIC_PIN_FLAGGED="pinFlagged",P.CONST.PUBSUB_TOPIC_PLACEHOLDER_MARKER_CLOSED="placeholderMarkerClosed",P.CONST.PUBSUB_TOPIC_PLACEHOLDER_MARKER_OPENED="placeholderMarkerOpened",P.CONST.PUBSUB_TOPIC_PREPEND_ITEM_MAP_BOARD="prependNewPinMapBoard",P.CONST.PUBSUB_TOPIC_REQUEST_IDENTIFIER="requestIdentifier",P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP="scrollToTop",P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP_HIDDEN="scrollToTopHidden",P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP_VISIBLE="scrollToTopVisible",P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED="searchQueryUpdated",P.CONST.PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED="searchScopeUpdated",P.CONST.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED="socialNetworkUpdated",P.CONST.PUBSUB_TOPIC_TOPIC_MAP_DRAGGED="mapDragged",P.CONST.PUBSUB_TOPIC_TUTORIAL_NEXT="tutorialNext",P.CONST.PUBSUB_TOPIC_USER_BLOCKED="userBlocked",P.CONST.PUBSUB_TOPIC_USER_FOLLOW="userFollow",P.CONST.PUBSUB_TOPIC_USER_UNBLOCKED="userUnblocked",P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW="userUnfollow",P.CONST.PUBSUB_TOPIC_USER_UPDATED="userUpdated",P.CONST.PUBSUB_TOPIC_USER_CHANGED_PASSWORD="userChangedPassword",P.CONST.PUBSUB_TOPIC_UNAUTH_NAG_TYPE="unauthNagType",P.CONST.SHOW_SEARCH_AROUND_WORLD="show_search_around_world",P.CONST.MAX_CHARS_FOR_BOARD_TITLE=100,P.CONST.MAX_CHARS_FOR_USER_DESCRIPTION=160,P.CONST.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION=500,P.CONST.OVERFLOWING_TEXT_OVERFLOWING_CLASS="overflowing",P.CONST.MIN_PINNABLE_IMAGE_HEIGHT=50,P.CONST.MIN_PINNABLE_IMAGE_WIDTH=100,P.CONST.ErrorStrategy=a,P.CONST.PositionMode=b,P.CONST.TYPEAHEAD_ATTRIBUTE_EMPTY_STATE="results_empty",P.CONST.TYPEAHEAD_CATEGORY_CITY="City",P.CONST.TYPEAHEAD_TYPE_GPLUS_NON_PINNER="gplus_non_pinner",P.CONST.BOARD_LAYOUT_PLACES="places",P.CONST.AUTO_PASSWORD_RESET_ERROR_CODE=85,P.CONST.API_ERROR_UNDERAGE_REGISTER_ATTEMPT=93;
var c,d,e=parseInt("0000000000001",2),f=0;P.CONST.PositionPointFlag={},_.each(["VERTICAL","HORIZONTAL"],function(a){d=0,_.each(["BOTTOM","LEFT","CENTER","RIGHT","TOP"],function(b){c=e<<f++,d|=c,P.CONST.PositionPointFlag["FLAG_"+a+"_"+b]=c}),P.CONST.PositionPointFlag["FLAG_"+a]=d});var g=P.CONST.PositionPointFlag;P.CONST.PositionPoint={BOTTOM_CENTER:g.FLAG_VERTICAL_BOTTOM|g.FLAG_VERTICAL_CENTER,BOTTOM_LEFT:g.FLAG_VERTICAL_BOTTOM|g.FLAG_VERTICAL_LEFT,BOTTOM_RIGHT:g.FLAG_VERTICAL_BOTTOM|g.FLAG_VERTICAL_RIGHT,TOP_CENTER:g.FLAG_VERTICAL_TOP|g.FLAG_VERTICAL_CENTER,TOP_LEFT:g.FLAG_VERTICAL_TOP|g.FLAG_VERTICAL_LEFT,TOP_RIGHT:g.FLAG_VERTICAL_TOP|g.FLAG_VERTICAL_RIGHT,LEFT_BOTTOM:g.FLAG_HORIZONTAL_LEFT|g.FLAG_HORIZONTAL_BOTTOM,LEFT_CENTER:g.FLAG_HORIZONTAL_LEFT|g.FLAG_HORIZONTAL_CENTER,LEFT_TOP:g.FLAG_HORIZONTAL_LEFT|g.FLAG_HORIZONTAL_TOP,RIGHT_BOTTOM:g.FLAG_HORIZONTAL_RIGHT|g.FLAG_HORIZONTAL_BOTTOM,RIGHT_CENTER:g.FLAG_HORIZONTAL_RIGHT|g.FLAG_HORIZONTAL_CENTER,RIGHT_TOP:g.FLAG_HORIZONTAL_RIGHT|g.FLAG_HORIZONTAL_TOP}}(),function(){goog.provide("P.csrf"),goog.require("P.CONST"),goog.require("P.url"),P.Csrf={},P.csrf.addCsrfToken=function(){$(document).ajaxSend(function(a,b,c){P.csrf._needsCsrfToken(c.type,c.url)&&b.setRequestHeader("X-CSRFToken",P.csrf.getCSRFToken())})},P.csrf.cleanUpCookie=function(){var a=P.CONST.COOKIE_CSRF,b=document.cookie.match(new RegExp(a+"=.+?($|;)","g")),c=b&&b.length>1;c&&(document.cookie=P.CONST.COOKIE_CSRF+"=bad; expires=Thu, 01-Jan-1970 00:00:00 GMT; Max-Age=0; Path=/")},P.csrf.getCSRFToken=function(){return Cookie.get(P.CONST.COOKIE_CSRF)},P.csrf._isSafeMethod=function(a){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(a)},P.csrf._needsCsrfToken=function(a,b){return!P.csrf._isSafeMethod(a)&&P.url.isTrustedOrigin(b)}}(),function(){goog.provide("P.NOOP"),goog.provide("P.state"),goog.provide("P.Mixins"),goog.provide("P.app"),goog.provide("P.beginsWith"),goog.require("P.csrf"),_.bindFn=_.bind,P.NOOP=function(){},P.state={activeTarget:null},P.Mixins={},P.app=null,P.beginsWith=function(a,b){return 0===a.lastIndexOf(b,0)},P.csrf.cleanUpCookie(),P.csrf.addCsrfToken(),$(document).ajaxSend(function(a,b){b.setRequestHeader("X-NEW-APP","1")})}(),function(){goog.provide("P.interfaces.ILogger");var a={FINEST:0,FINER:1,FINE:2,INFO:3,WARN:4,ERROR:5,NONE:6},b={LOG:"log",ERROR:"error",PAGE_LOAD_METRIC:"page_load_metric",APP_METRIC:"app_metric"},c={GET:"get",POST:"post"};P.Logger={LOG_LEVEL:a,LOGGABLE_HTTP_METHOD:c,SERVER_LOG_TYPE:b},P.interfaces.ILogger=function(){},_.extend(P.interfaces.ILogger.prototype,{finest:function(){},finer:function(){},fine:function(){},debug:function(){},warn:function(){},error:function(){},setLogLevel:function(){},logToServer:function(){}})}(),function(){goog.provide("P.interfaces.IHistoryNavigator"),goog.require("P.navigateData.NavigateData"),P.interfaces.IHistoryNavigator=function(){},P.interfaces.IHistoryNavigator.prototype.navigate=function(){};var a=function(){};a.prototype.navigate=function(){},P._historyNavigator=null,P.setHistoryNavigator=function(a){P._historyNavigator=a},P.getHistoryNavigator=function(){return P._historyNavigator},P.setHistoryNavigator(new a)}(),function(){goog.provide("P.interfaces.IModalManager"),P.interfaces.IModalManager=function(){},_.extend(P.interfaces.IModalManager.prototype,{showModal:function(){},removeModal:function(){},removeAllModals:function(){},showInModal:function(){}});var a=function(){};_.extend(a.prototype,{showModal:function(){},removeModal:function(){},removeAllModals:function(){},showInModal:function(){}}),P.setModalManager=function(a){P._modalManager=a},P.setModalManager(new a),P.getModalManager=function(){return P._modalManager}}(),function(){goog.provide("P.interfaces.IResource"),goog.require("P.resourceResponse");P.interfaces.IResource=function(){},_.extend(P.interfaces.IResource.prototype,Backbone.Events),_.extend(P.interfaces.IResource.prototype,{getName:function(){},setOptions:function(){},set:function(){},get:function(){},copyOptions:function(){},callGet:function(){},callCreate:function(){},callUpdate:function(){},callDelete:function(){},abort:function(){},resetBookmark:function(){},atEnd:function(){},isEqual:function(){},toString:function(){},isCalling:function(){}})}(),function(){goog.provide("P.interfaces.IStorage"),P.interfaces.IStorage=function(){},P.interfaces.IStorage.prototype.length=function(){},P.interfaces.IStorage.prototype.key=function(){},P.interfaces.IStorage.prototype.getItem=function(){},P.interfaces.IStorage.prototype.setItem=function(){},P.interfaces.IStorage.prototype.removeItem=function(){},P.interfaces.IStorage.prototype.clear=function(){}}(),function(){goog.provide("P.interfaces.IWindowManager"),P.interfaces.IWindowManager=function(){},_.extend(P.interfaces.IWindowManager.prototype,{open:function(){},_makeWindowOptions:function(){},shrinkWrap:function(){},contain:function(){}}),P.setWindowManager=function(a){P._window=a},P.getWindowManager=function(){return P._window}}(),goog.provide("P.contextEvent"),goog.require("P.ContextLogging.ComponentType"),goog.require("P.ContextLogging.ElementType");var ContextEvent=function(a,b,c,d,e,f,g,h){this._eventType=a,this._viewType=b,this._viewParameter=c,this._helperData=d,this._requestIdentifier=e,this._element=f,this._component=g,this._time=null,this._eventData={},this._auxData={},this._objectIdStr=h};ContextEvent.prototype.appendPinImpressions=function(a){this._eventData.pinImpressions=this.getPinImpressions().concat(a)},ContextEvent.prototype.copyViewContext=function(a){this._viewType=a.getViewType(),this._viewParameter=a.getViewParameter(),this._helperData=$.extend(!0,{},a.getHelperData())},ContextEvent.prototype.getEventType=function(){return this._eventType},ContextEvent.prototype.getHelperData=function(){return this._helperData},ContextEvent.prototype.getPinImpressions=function(){return this._eventData.pinImpressions||[]},ContextEvent.prototype.getViewParameter=function(){return this._viewParameter},ContextEvent.prototype.getViewType=function(){return this._viewType},ContextEvent.prototype.hasSameViewContext=function(a){return this.getViewType()===a.getViewType()&&this.getViewParameter()===a.getViewParameter()&&_.isEqual(this.getHelperData(),a.getHelperData())},ContextEvent.prototype.setEventType=function(a){this._eventType=a},ContextEvent.prototype.setObjectIdStr=function(a){this._objectIdStr=a},ContextEvent.prototype.setPinImpressions=function(a){this._eventData.pinImpressions=a},ContextEvent.prototype.setComponent=function(a){this._component=a},ContextEvent.prototype.setElement=function(a){this._element=a},ContextEvent.prototype.updateAuxData=function(a){this._auxData=_.extend(this._auxData,a)},ContextEvent.prototype.setRequestIdentifier=function(a){this._requestIdentifier=a},ContextEvent.prototype.setTime=function(a){this._time=a},ContextEvent.prototype.toSerializable=function(){var a={event_type:this._eventType,view_type:this._viewType,view_parameter:this._viewParameter,helper_data:this._helperData,request_identifier:this._requestIdentifier,element:this._element,component:this._component,time:this._time,event_data:this._eventData,aux_data:this._auxData};return this._objectIdStr&&(a[P.ContextEvent.KEY_OBJECT_ID_STR]=this._objectIdStr),a},P.ContextEvent={},Pc.TEST_MODE&&(P.ContextEvent=ContextEvent),P.ContextEvent.KEY_EVENT_TYPE="event_type",P.ContextEvent.KEY_OBJECT_ID_STR="object_id_str",P.ContextEvent.fromEventType=function(a){var b=P.ContextEvent.fromPlainObject({});return b.setEventType(a),b},P.ContextEvent.fromPlainObject=function(a){return new ContextEvent(a.event_type,a.view_type,a.view_parameter,a.helper_data,a.request_identifier,a.element,a.component,a.object_id_str)},function(){goog.provide("P.storage"),goog.require("P.interfaces.IStorage");var a=function(a){this._cookieKey=a};_.extend(a.prototype,{length:function(){var a=Cookie.get(this._cookieKey),b=a?JSON.parse(a):{};return _.keys(b).length},key:function(){throw new Error("intentionally unimplemented function")},getItem:function(a){var b=Cookie.get(this._cookieKey),c=b?JSON.parse(b):{};return c[a]},setItem:function(a,b){var c=Cookie.get(this._cookieKey),d=c?JSON.parse(c):{};d[a]=b,Cookie.set(this._cookieKey,JSON.stringify(d))},removeItem:function(a){var b=Cookie.get(this._cookieKey),c=b?JSON.parse(b):{};delete c[a],Cookie.set(this._cookieKey,JSON.stringify(c))},clear:function(){Cookie.unset(this._cookieKey)}});var b=function(){};_.extend(b.prototype,{length:function(){return window.sessionStorage.length},key:function(){throw new Error("intentionally unimplemented function")},getItem:function(a){var b=window.sessionStorage.getItem(a);return null!=b?JSON.parse(b):null},setItem:function(a,b){window.sessionStorage.setItem(a,JSON.stringify(b))},removeItem:function(a){window.sessionStorage.removeItem(a)},clear:function(){window.sessionStorage.clear()}});var c=function(){};_.extend(c.prototype,{length:function(){return window.localStorage.length},key:function(){throw new Error("intentionally unimplemented function")},getItem:function(a){var b=window.localStorage.getItem(a);return null!=b?JSON.parse(b):b},setItem:function(a,b){window.localStorage.setItem(a,JSON.stringify(b))},removeItem:function(a){window.localStorage.removeItem(a)},clear:function(){window.localStorage.clear()}});var d=function(d){var e;try{e=d?window.sessionStorage:window.localStorage}catch(f){e=null}var g=d?P.CONST.COOKIE_SESSION_STORAGE:P.CONST.COOKIE_LOCAL_STORAGE,h=!1,i=e;if(i)try{i.setItem("testing","test"),i.removeItem("testing")}catch(f){if(f.code!==window.DOMException.QUOTA_EXCEEDED_ERR||0!==i.length)throw f;h=!0}else h=!0;return h?new a(g):d?new b:new c};P.SessionStorage=d(!0),P.LocalStorage=d(!1),Pc.TEST_MODE&&(P.CookieBackedStorage=a,P.WindowSessionStorage=b,P.WindowLocalStorage=c,P.FakeStorage=function(){this.len=0,this.storage={}},_.extend(P.FakeStorage.prototype,{length:function(){return this.length},key:function(){throw new Error("intentionally unimplemented function")},getItem:function(a){return this.storage[a]},setItem:function(a,b){this.storage[a]=b},removeItem:function(a){delete this.storage[a]},clear:function(){this.storage.key={}}}))}(),function(){goog.provide("P.logger"),goog.require("P.interfaces.ILogger");var a=function(a){this.name=a;var b;if(P.DEBUG){var c=P.LocalStorage.getItem(this._getStorageKey());null!==c&&void 0!==c&&(b=parseInt(c,10))}void 0===b&&(b=P.DEBUG?P.Logger.LOG_LEVEL.FINE:P.Logger.LOG_LEVEL.NONE),this.setLogLevel(b)},b=window.navigator.userAgent,c=window.navigator.platform;_.extend(a.prototype,{finest:function(){var a=_.toArray(arguments);this._addLogName(a),this._printToConsole(P.Logger.LOG_LEVEL.FINEST,a)},finer:function(){var a=_.toArray(arguments);this._addLogName(a),this._printToConsole(P.Logger.LOG_LEVEL.FINER,a)},fine:function(){var a=_.toArray(arguments);this._addLogName(a),this._printToConsole(P.Logger.LOG_LEVEL.FINE,a)},debug:function(){return this.fine.apply(this,arguments)},warn:function(){var a=_.toArray(arguments);this._addLogName(a),this._printToConsole(P.Logger.LOG_LEVEL.WARN,a)},error:function(){var a=_.toArray(arguments);this._addLogName(a),this._printToConsole(P.Logger.LOG_LEVEL.ERROR,a);var b=a.shift(),c={message:b,messages:a};this.logToServer(P.Logger.SERVER_LOG_TYPE.ERROR,"post",c)},setLogLevel:function(a){this.logLevel=a,P.DEBUG&&P.LocalStorage.setItem(this._getStorageKey(),a)},_getStorageKey:function(){return"logLevels."+this.name},_addLogName:function(a){a[0]=this.name+": "+a[0]},_printToConsole:function(a,b){var c=window.console||null;if(c&&!(this.logLevel>a)){var d;a===P.Logger.LOG_LEVEL.ERROR&&c.error?d=c.error:a===P.Logger.LOG_LEVEL.WARN&&c.warn?d=c.warn:c.log&&(d=c.log),d&&Function.prototype.apply.apply(d,[c,b])}},logToServer:function(a,b,c){var d=this;this._logToServer(a,b,c).fail(function(){var a={message:"Failed to log error!",method:b};d._logToServer(P.Logger.SERVER_LOG_TYPE.ERROR,"post",a)})},_logToServer:function(a,d,e){var f="/_/_/report/"+a+"/",g={app_version:P.AppVersion.currentVersion,current_url:window.location.href,user_agent:b,platform:c,app_invalid:P.AppVersion.isNewVersionRequired(),page_load_request_identifier:P.PAGE_LOAD_REQUEST_IDENTIFIER};P.state.activeTarget&&(g.active_target=P.state.activeTarget.getFullName());var h={report_context:JSON.stringify(g),report_data:JSON.stringify(e)};return"get"===d?$.get(f,h):$.post(f,h)}});var d=[],e={};_.extend(P.Logger,{getLogger:function(b){var c=e[b];return c||(c=new a(b),e[b]=c,d.push(c)),c},getAll:function(){return d},getByName:function(a){return e[a]}}),Pc.TEST_MODE&&(P.Logger.clear=function(){d=[],e={}})}(),function(){goog.provide("P.contextLogger"),goog.require("P.logger");var a=P.Logger.getLogger("P.contextLogger"),b=function(){this._events=[],this._currentViewContext=null,this._logTimeout=null,$(window).on("beforeunload",_.bindFn(function(){this.flushEvents(!0)},this))};b.FLUSH_INTERVAL_MS=1e4,b.prototype.addEvent=function(c,d){var e=c.getEventType();if(null!==e&&void 0!==e){if(d&&(this._lastLoggedEvent=d.originalEvent),c.getEventType()===P.ContextLogging.EventType.VIEW)this._currentViewContext=P.ContextEvent.fromPlainObject({}),this._currentViewContext.copyViewContext(c);else{if(!this._currentViewContext)return;c.copyViewContext(this._currentViewContext);var f=P.ContextLogging.EventType.PIN_IMPRESSION_ONE_PIXEL;if(c.getEventType()===f){var g=_.last(this._events);if(g&&g.hasSameViewContext(c)&&g.getEventType()===f)return void g.appendPinImpressions(c.getPinImpressions())}}c.setTime(this._currentNs()),this._events.push(c),a.fine("addEvent",c),this._logTimeout||(this._logTimeout=P.setTimeout(_.bindFn(this.flushEvents,this),b.FLUSH_INTERVAL_MS))}},b.prototype.clearContext=function(){this._currentViewContext=null},b.prototype.eventLogged=function(a){return this._lastLoggedEvent===a.originalEvent},b.prototype.flushEvents=function(a){if(this._events.length){for(var b=[],c=0;c<this._events.length;c++)b.push(this._events[c].toSerializable());this._reset();var d=P.resourceFactory.create("ContextLogResource",{events:b,report_time:this._currentNs()}),e={async:!a,error:P.NOOP};d.callCreate(e)}},b.prototype._currentNs=function(){return 1e6*Date.now()},b.prototype._reset=function(){this._events=[],clearTimeout(this._logTimeout),this._logTimeout=null},P.ContextLogger={},Pc.TEST_MODE&&(P.ContextLogger=b);var c=null;P.ContextLogger.getInstance=function(){return c||(c=new b,P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_CONTEXT_LOGGING,P.CONST.PUBSUB_TOPIC_CONTEXT_LOG_PLAIN_OBJECT,function(a,b,c){if(P.ContextEvent.KEY_EVENT_TYPE in c){var d=P.ContextEvent.fromPlainObject(c);P.ContextLogger.getInstance().addEvent(d)}})),c}}(),goog.provide("P.ContextLogging"),P.ContextLogging={},goog.provide("P.ContextLogging.ViewType"),P.ContextLogging.ViewType={ABOUT:6,ANDROID_WIDGET:13,ANDROID_WIDGET_FEED:26,BOARD:5,BOARD_PICKER:21,BOOKMARKLET:12,BROWSER:11,CAMERA:15,CATEGORY_GRID:19,DEEP_LINKING:20,DISCOVER:22,EDUCATION:23,ERROR:17,EXPLORE_FEED:28,EXPLORE_PAGE:27,FEED:1,FEED_EDITOR:25,FIND_FRIENDS:30,FRIEND_INVITER:8,FRIEND_MULTI_INVITER:29,LOGIN:9,NEWS:18,ORIENTATION:24,PIN:3,REGISTRATION:10,REPORT:16,SEARCH:2,SETTINGS:7,SPLASH:14,USER:4},goog.provide("P.ContextLogging.ViewParameterType"),P.ContextLogging.ViewParameterType={ABOUT_ABOUT:77,ABOUT_BOOKMARKLET:62,ABOUT_CAREERS:79,ABOUT_COPYRIGHT:84,ABOUT_ETIQUETTE:76,ABOUT_GOODIES:78,ABOUT_PRESS:81,ABOUT_PRIVACY:82,ABOUT_SUPPORT:61,ABOUT_TEAM:80,ABOUT_TERMS:60,ABOUT_USE:83,BOARD_COLLABORATORS:90,BOARD_CREATE:87,BOARD_EDIT:88,BOARD_EDIT_COLLABORATORS:104,BOARD_FOLLOWERS:54,BOARD_MAP:122,BOARD_PLACE:121,BOARD_SETTINGS:55,CATEGORY_DISCOVER:91,DEEP_LINKING_APP:115,DEEP_LINKING_EMAIL:112,DEEP_LINKING_FACEBOOK:114,DEEP_LINKING_WEB:113,DISCOVER_CATEGORY:137,DISCOVER_INTEREST:138,EDUCATION_CONTEXTUAL_MENU:108,EDUCATION_LONGPRESS:94,EDUCATION_RELATED_PINS:101,EDUCATION_SECRET_BOARD:95,ERROR_NO_ACTIVITY:70,ERROR_NO_BOARD:68,ERROR_NO_INTERNET:66,ERROR_NO_PIN:67,ERROR_NO_USER:69,FEED_CATEGORY_ANIMALS:5,FEED_CATEGORY_ARCHITECTURE:6,FEED_CATEGORY_ART:7,FEED_CATEGORY_CARS_MOTORCYCLES:8,FEED_CATEGORY_CELEBRITIES:9,FEED_CATEGORY_CHRISTMAS_SWEATER:130,FEED_CATEGORY_DESIGN:10,FEED_CATEGORY_DIY_CRAFTS:11,FEED_CATEGORY_EDUCATION:12,FEED_CATEGORY_FILM_MUSIC_BOOKS:13,FEED_CATEGORY_FOOD_DRINK:14,FEED_CATEGORY_GARDENING:15,FEED_CATEGORY_GEEK:16,FEED_CATEGORY_HAIR_BEAUTY:17,FEED_CATEGORY_HEALTH_FITNESS:18,FEED_CATEGORY_HISTORY:19,FEED_CATEGORY_HOLIDAYS_EVENTS:20,FEED_CATEGORY_HOLIDAY_FOR_ALL:127,FEED_CATEGORY_HOLIDAY_FOR_HER:125,FEED_CATEGORY_HOLIDAY_FOR_HIM:124,FEED_CATEGORY_HOLIDAY_FOR_KIDS:126,FEED_CATEGORY_HOME_DECOR:21,FEED_CATEGORY_HUMOR:22,FEED_CATEGORY_ILLUSTRATIONS_POSTERS:23,FEED_CATEGORY_KIDS:24,FEED_CATEGORY_MENS_FASHION:25,FEED_CATEGORY_OUTDOORS:26,FEED_CATEGORY_PHOTOGRAPHY:27,FEED_CATEGORY_PRODUCTS:28,FEED_CATEGORY_QUOTES:29,FEED_CATEGORY_SCIENCE_NATURE:30,FEED_CATEGORY_SPORTS:31,FEED_CATEGORY_TATTOOS:32,FEED_CATEGORY_TECHNOLOGY:33,FEED_CATEGORY_TRAVEL:34,FEED_CATEGORY_WEDDINGS:35,FEED_CATEGORY_WOMENS_FASHION:36,FEED_DOMAIN:129,FEED_EDITOR_FOLLOW_BOARDS:109,FEED_EDITOR_UNFOLLOW_BOARDS:110,FEED_EVERYTHING:2,FEED_FOLLOWING:0,FEED_FRIENDS:1,FEED_GIFTS:85,FEED_GIFTS_100_200:40,FEED_GIFTS_20:37,FEED_GIFTS_200_500:41,FEED_GIFTS_20_50:38,FEED_GIFTS_500:42,FEED_GIFTS_50_100:39,FEED_HOME:92,FEED_INTEREST:136,FEED_POPULAR:3,FEED_RELATED_BOARD:116,FEED_RELATED_INTEREST:117,FEED_SOURCE:4,FEED_SUBCATEGORY:120,FEED_TOP_PICKS:111,FEED_VIDEOS:128,FEED_WELCOME:118,FIND_FRIENDS:135,FRIEND_INVITER_EMAIL:56,FRIEND_INVITER_FACEBOOK:57,FRIEND_INVITER_FIND_FRIENDS:131,FRIEND_INVITER_GMAIL:58,FRIEND_INVITER_INVITE:132,FRIEND_INVITER_TWITTER:133,FRIEND_INVITER_YAHOO:59,LOGIN_EMAIL:63,LOGIN_FACEBOOK:64,LOGIN_TWITTER:65,MOBILE_ORIENTATION_COLLECT:97,MOBILE_ORIENTATION_DISCOVER:96,MOBILE_ORIENTATION_FUNCTIONAL:98,MOBILE_ORIENTATION_STORY:99,ORIENTATION_FAST_FOLLOW:102,PICKED_FOR_YOU_FEED:106,PIN_ARTICLE:141,PIN_CREATE:73,PIN_CREATE_PINMARKLET:119,PIN_CREATE_PLACES:150,PIN_CREATE_REPIN:72,PIN_CREATE_SDK:100,PIN_EDIT:89,PIN_MOVIE:142,PIN_OTHER:139,PIN_PLACE:143,PIN_PRODUCT:144,PIN_RECIPE:145,PIN_REGULAR:140,PIN_SEND_TO:105,REGISTRATION_BOARDS:48,REGISTRATION_LANDING:46,REGISTRATION_SIGNUP:47,REPORT_PIN:71,REPORT_USER:86,SEARCH_AUTOCOMPLETE:103,SEARCH_BOARDS:44,SEARCH_INTERESTS:182,SEARCH_MY_PINS:107,SEARCH_PINS:43,SEARCH_PLACES:123,SEARCH_PLACE_BOARDS:181,SEARCH_USERS:45,USER_ABOUT:75,USER_ACTIVITY:53,USER_BOARDS:49,USER_EDIT:93,USER_FOLLOWERS:50,USER_FOLLOWING:51,USER_INTERESTS:183,USER_LIKES:52,USER_PINS:74},goog.provide("P.ContextLogging.ComponentType"),P.ContextLogging.ComponentType={BOARD_PINS_GRID:29,BROWSER:17,BULK_INVITE:37,CATEGORIES_CAROUSEL:42,CONTEXTUAL_MENU:18,DOMAIN:30,EDUCATION:14,FLOWED_BOARD:1,FLOWED_CATEGORY:11,FLOWED_PIN:0,HOMEFEED_INVITE_MODULE:24,INTEREST_CAROUSEL:40,INTEREST_GRID:36,INTEREST_RELATED_CAROUSEL:41,LIST_HEADER:27,MAP:26,MODAL_ADD_PIN:7,MODAL_CREATE_BOARD:12,MODAL_DIALOG:9,MODAL_PIN:4,MODAL_POST_REPIN:6,MODAL_REPIN:5,NAG:19,NAVIGATION:8,NEWS_FEED:3,ORIENTATION:16,REGISTRATION:15,RELATED_BOARDS:31,RELATED_INTERESTS:39,SEARCH_RELATED_CATEGORIES:33,SEARCH_RELATED_QUERIES:32,SHEET:13,SUGGESTED_USERS:2,TOAST:20,TRENDING_CATEGORIES:25,TYPEAHEAD_SUGGESTIONS:35,USER_FEED:10,USER_NEWS:38,USER_REPINS_FROM:28,USER_SELECT_SEARCH_BOX:34,WIDGET_ACTION_BAR:21,WIDGET_FOOTER:23,WIDGET_HEADER:22},goog.provide("P.ContextLogging.ElementType"),P.ContextLogging.ElementType={ADD_MESSAGE_BUTTON:99,ADD_PLACE_BUTTON:165,ANALYTICS_BUTTON:24,APP_ICON:137,APP_RATING_ATTEMPT_BUTTON:205,APP_RATING_DECLINE_BUTTON:206,APP_RATING_REMIND_BUTTON:207,AUTOCOMPLETE_SUGGESTION:104,BACK_BUTTON:34,BOARD_CATEGORY:51,BOARD_COVER:36,BOARD_CREATE:22,BOARD_CREATE_SECRET:90,BOARD_CREATE_SUGGESTED:23,BOARD_DELETE_BUTTON:50,BOARD_DESCRIPTION:93,BOARD_EDIT_BUTTON:81,BOARD_FOLLOW:37,BOARD_LEAVE_BUTTON:97,BOARD_NAME:52,BOARD_PICKER:67,BOARD_RELATED_BOARD:180,BOARD_SECRET:53,BROWSER_BUTTON:79,BROWSER_WEB_IMAGE:109,BULK_INVITER_BUTTON:215,BUY_BUTTON:201,CAMERA_BUTTON:54,CANCEL_BUTTON:73,CATEGORY_ICON:38,CATEGORY_RECENT:127,CHANGE_PASSWORD_BUTTON:128,CLEAR_CONTACTS_BUTTON:115,CLEAR_HISTORY_BUTTON:102,CLEAR_SEARCHES_BUTTON:114,CLIPBOARD_BUTTON:101,CLOSE_BUTTON:75,COLLABORATOR_TEXT:171,COMPOSE_SMS_INVITE_BUTTON:210,COPY_LINK_BUTTON:100,COUNTRY_BUTTON:124,CREATE_BUTTON:44,DECLINE_BUTTON:86,DISCOVER_TRENDING_CATEGORY:153,DOMAIN_URL:177,DONE_BUTTON:76,DUPLICATE_PIN_WARNING:120,EDIT_HOME_FEED_BUTTON:117,EDUCATION_TARGET:95,EMAIL_BUTTON:123,EXPLORE_BUTTON:78,FACEBOOK_CONNECT:68,FACEBOOK_INVITE_BUTTON:202,FACEBOOK_TIMELINE_CONNECT:21,FEED_SUBCATEGORY:152,FINDFRIENDS_BUTTON:58,FIND_IMAGES_BUTTON:56,FIND_MORE_BOARDS_BUTTON:105,FLOWED_INTEREST:211,FOLLOWERS_BUTTON:42,FOLLOWING_BUTTON:41,FOLLOW_ALL_USERS_BUTTON:20,FOLLOW_BOARDS_BUTTON:118,GALLERY_BUTTON:55,GET_STARTED_BUTTON:106,GPLUS_CONNECT:208,GPLUS_INVITE_BUTTON:203,INVITE_ALL_TOGGLE:173,INVITE_BUTTON:59,INVITE_DELETE_BUTTON:150,LIKES_BUTTON:175,LINK_OUT_BUTTON:144,LOCATION_BUTTON:159,LOGIN_BUTTON:30,LOGO:178,LOGOUT_BUTTON:19,MAP_ADD_BUTTON:157,MAP_ANNOTATION:154,MAP_DIRECTIONS_BUTTON:156,MAP_PIN_ICON:164,MAP_SEE_ON_MAP_BUTTON:155,MAP_TOGGLE_BUTTON:170,MENU_BUTTON:74,MORE_PINS_BUTTON:141,NAME_BUTTON:136,NAVIGATION_DISCOVER_BUTTON:147,NAVIGATION_HOME_BUTTON:146,NEWS_BUTTON:77,NEWS_FEED_BOARD:39,NEWS_FEED_PIN:15,NEWS_FEED_USER:16,NEXT_BUTTON:96,NOTIFICATIONS_ICON:139,PFY_REASON_BUTTON:145,PHONE_BUTTON:161,PHOTOS_BUTTON:149,PIN_ATTRIBUTION:27,PIN_BOARD:5,PIN_BOARD_FOLLOW:6,PIN_BOARD_PIN:7,PIN_CAPTION_COMMENT:4,PIN_COMMENT_BUTTON:2,PIN_DELETE_BUTTON:49,PIN_DESCRIPTION:116,PIN_DOMAIN:25,PIN_EDIT_BUTTON:3,PIN_FLAG_BUTTON:176,PIN_LIKER:28,PIN_LIKE_BUTTON:1,PIN_ORIGINAL_BOARD:8,PIN_ORIGINAL_BOARD_FOLLOW:9,PIN_ORIGINAL_BOARD_PIN:10,PIN_PINNED_TO:29,PIN_PROMOTED_INFO:142,PIN_RELATED_PIN:148,PIN_REPIN_BUTTON:0,PIN_REPORT_BUTTON:47,PIN_RICH_PIN_ACTION_BUTTON:110,PIN_SAVE_BUTTON:48,PIN_SEND_BUTTON:98,PIN_SHARE:46,PIN_SHARE_BUTTON:72,PIN_SOURCE_IMAGE:35,PIN_SUBMIT:70,PIN_UPLOAD_BUTTON:18,PIN_USER:26,PIN_VIA:12,PIN_VIA_PIN:11,PLACES_BUTTON:158,PLACES_LIST_PLACE:160,PLACE_IMAGE:163,PLACE_PICKER_CREATE:166,PLACE_PICKER_IMAGE:167,PROFILE_BUTTON:40,PROFILE_FACEBOOK:65,PROFILE_IMAGE:63,PROFILE_TWITTER:66,PROFILE_URL:64,PROMOTED_OK_BUTTON:143,PUSH_NOTIFICATIONS_BUTTON:125,RAKUTEN_CONNECT:151,REFRESH_BUTTON:45,RELATED_INTEREST:216,RELATED_RICH_PIN_BUTTON:214,REMOVE_BUTTON:107,REMOVE_SUGGESTED_USER_BUTTON:14,REPINS_BUTTON:174,REPIN_ADD_PLACE_BUTTON:212,REPIN_EDIT_PLACE_BUTTON:213,REPIN_SUGGESTED_BOARD:17,RESET_BUTTON:33,RETRY_BUTTON:32,RIBBON_BUTTON:131,SAVE_USER_SETTINGS_BUTTON:130,SEARCH_BUTTON:43,SEARCH_RELATED_CATEGORY:192,SEARCH_RELATED_QUERY:191,SEE_MORE_BUTTON:179,SEE_OTHER_PINS_BUTTON:140,SEND_BUTTON:103,SEND_INVITE_BUTTON:172,SEND_SMS_INVITE_BUTTON:209,SEND_TO_PINNER_BUTTON:204,SETTINGS_BUTTON:57,SHOW_PASSWORD_BUTTON:129,SIGNUP_BUTTON:31,SUGGESTED_EMAIL:121,SUGGESTED_USER:13,SUPPORT_BUTTON:60,TOS_BUTTON:61,TWITTER_CONNECT:69,UNDO_BUTTON:113,UNFOLLOW_BOARDS_BUTTON:119,UPDATE_BUTTON:126,USERNAME_BUTTON:122,USER_ABOUT_BUTTON:85,USER_ABOUT_EDIT_BUTTON:91,USER_BLOCK_BUTTON:87,USER_BOARDS_BUTTON:84,USER_EDIT_BUTTON:94,USER_FEED_FOLLOW:71,USER_FEED_INVITE_CUSTOM_EMAIL:135,USER_FEED_INVITE_EMAIL:133,USER_FEED_INVITE_SMS:134,USER_FLAG_BUTTON:80,USER_FOLLOW:62,USER_ICON:138,USER_LIKES_BUTTON:82,USER_LIST_CONTACT:132,USER_LIST_USER:112,USER_PINS_BUTTON:83,USER_RECENT_CONTACT:111,USER_REPORT_BUTTON:89,USER_UNBLOCK_BUTTON:88,USER_URL_EDIT_BUTTON:92,WEBSITE_BUTTON:162,WHO_CAN_PIN_BUTTON:108},goog.provide("P.ContextLogging.EventType"),P.ContextLogging.EventType={ANDROID_REQUEST:1001,ANDROID_WIDGET_DISABLE:401,ANDROID_WIDGET_ENABLE:400,ANDROID_WIDGET_UPDATE:402,ANSWER_CREATE:240,ANSWER_DELETE:243,ANSWER_EDIT:242,ANSWER_LIKE:244,ANSWER_REPORT:246,ANSWER_UNLIKE:245,ANSWER_VIEW:241,API_PAGEVIEW:100,APP_START:406,BOARD_ACCEPT_INVITE_COLLABORATOR:32,BOARD_ADD_COLLABORATOR:24,BOARD_CREATE:20,BOARD_DECLINE_INVITE_COLLABORATOR:29,BOARD_DELETE:22,BOARD_EDIT:21,BOARD_FOLLOW:26,BOARD_INVITE_COLLABORATOR:28,BOARD_REMOVE_COLLABORATOR:25,BOARD_REQUEST_APPROVAL_INVITE_COLLABORATOR:34,BOARD_REQUEST_INVITE_COLLABORATOR:33,BOARD_SEND:35,BOARD_SET_PRIVATE:30,BOARD_SET_PUBLIC:31,BOARD_UNFOLLOW:27,BOARD_VIEW:23,BROWSER:83,CLICK:101,CONTEXTUAL_MENU_CLOSE:119,CONTEXTUAL_MENU_OPEN:118,CONVERSATION_MESSAGE_SEND:180,DEVICE_START:405,DOMAIN_VERIFIED:200,DRAG:104,EMAIL_CLICK:73,EMAIL_CLICK_API:74,EMAIL_OPEN:71,EMAIL_OPEN_API:72,EMAIL_RECEIVE:70,EMAIL_SUBSCRIBE_SETTINGS_CHANGE:502,EMAIL_UNSUBSCRIBE_SETTINGS_CHANGE:503,EXPLAIN_CREATE:260,EXPLAIN_DELETE:263,EXPLAIN_EDIT:262,EXPLAIN_VIEW:261,FEED_SUBCATEGORY:69,FEED_VIEW:80,GOT_BOARD_FOLLOW:1104,GOT_BOARD_INVITE_COLLABORATOR:1105,GOT_PIN_COMMENT:1101,GOT_PIN_LIKE:1103,GOT_PIN_REPIN:1102,GOT_PIN_VIEW:1100,GOT_USER_FOLLOW:1106,HOVER:105,INTEREST_FOLLOW:601,INTEREST_IMPRESSION_SERVER_SIDE:600,INTEREST_UNFOLLOW:602,IPAD_REQUEST:1002,IPHONE_REQUEST:1003,IPOD_REQUEST:1004,LONG_PRESS:103,MAC_REQUEST:1005,NOTIFICATION_SUBSCRIBE_SETTINGS_CHANGE:500,NOTIFICATION_UNSUBSCRIBE_SETTINGS_CHANGE:501,OTHER_REQUEST:1007,PAGEVIEW:0,PINCH:109,PIN_CLICKTHROUGH:12,PIN_CLOSEUP:16,PIN_COMMENT:7,PIN_CREATE:1,PIN_DEACTIVATE:133,PIN_DELETE:3,PIN_DELETE_COMMENT:10,PIN_EDIT:2,PIN_FLAG:11,PIN_HIDE:17,PIN_IMPRESSION_ONE_PIXEL:18,PIN_IMPRESSION_SERVER_SIDE:19,PIN_INSERTION:15,PIN_LIKE:6,PIN_REACTIVATE:134,PIN_REPIN:5,PIN_REPORT:59,PIN_SAVE_TO_DEVICE:82,PIN_SEND:14,PIN_SHARE:8,PIN_SHARE_FACEBOOK:1300,PIN_UNLIKE:9,PIN_UPVOTE:130,PIN_VIEW:4,PLACE_CREATE:1200,PROMOTED_PIN_FLAG:131,PROMOTED_PIN_HIDE:132,PULL_NOTIFICATION_OPENED_BY:408,PULL_NOTIFICATION_RECEIVED_BY:407,PUSH_NOTIFICATION_DEVICE_ASSOCIATED:114,PUSH_NOTIFICATION_DEVICE_DISABLED:117,PUSH_NOTIFICATION_DEVICE_DISASSOCIATED:115,PUSH_NOTIFICATION_DEVICE_ENABLED:116,PUSH_NOTIFICATION_OPENED_BY:113,PUSH_NOTIFICATION_RECEIVED_BY:112,PUSH_NOTIFICATION_SENT_TO:111,QUESTION_CREATE:220,QUESTION_DELETE:223,QUESTION_EDIT:222,QUESTION_LIKE:224,QUESTION_REPORT:226,QUESTION_UNLIKE:225,QUESTION_VIEW:221,REFRESH:81,RENDER:120,SCROLL:110,SEARCH_BOARDS:61,SEARCH_MY_PINS:63,SEARCH_PINS:60,SEARCH_PLACE_BOARDS:66,SEARCH_RECIPES:65,SEARCH_USERS:62,SEARCH_VIDEOS:64,SEND_PIN_RECOMMENDATION:410,SWIPE:108,TAP:102,TOGGLE_OFF:107,TOGGLE_ON:106,TOP_NOTIFICATION_CLICKED:300,URL_CHECK:201,URL_CLICKTHROUGH:203,URL_IMAGE:202,USER_BLOCK:54,USER_CREATE:40,USER_DEACTIVATED:48,USER_DELETE:42,USER_DISABLE_ANALYTICS:85,USER_DISABLE_FACBOOK:87,USER_DISABLE_FACEBOOK_TIMELINE:89,USER_DISABLE_GPLUS:93,USER_DISABLE_RAKUTEN:95,USER_DISABLE_TWITTER:91,USER_EDIT:41,USER_ENABLE_ANALYTICS:84,USER_ENABLE_FACEBOOK:86,USER_ENABLE_FACEBOOK_TIMELINE:88,USER_ENABLE_GPLUS:92,USER_ENABLE_RAKUTEN:94,USER_ENABLE_TWITTER:90,USER_FOLLOW:45,USER_INVITE:47,USER_INVITE_CREATE:151,USER_INVITE_CREATE_DEPRECATED:1201,USER_INVITE_EMAIL_SENT:154,USER_INVITE_FACEBOOK_CREATE:152,USER_INVITE_FACEBOOK_SENT:153,USER_LOGIN_ATTEMPT:50,USER_PARTNER_CONVERT:58,USER_PARTNER_CREATE:57,USER_PASSWORD_RESET_COMPLETED:52,USER_PASSWORD_RESET_REQUEST:51,USER_PUBLISH_TO_SOCIAL_NETWORK:75,USER_REACTIVATED:49,USER_REORDER_BOARDS:44,USER_REPORT:56,USER_SEND:150,USER_SUSPICIOUS_LOGIN:53,USER_UNBLOCK:55,USER_UNFOLLOW:46,USER_VIEW:43,VIEW:13,WEB_OR_API_REQUEST:1e3,WINDOWS_REQUEST:1006},goog.provide("P.Experiences"),P.Experiences={},goog.provide("P.Experiences.Placement"),P.Experiences.Placement={ANDROID_HOME_HEADER:20001,ANDROID_NOOP:2e4,IOS_GLOBAL_NAG:10001,IOS_HOMEFEED_TAKEOVER:10003,IOS_HOME_PR_NAG:10002,IOS_MAIN_USER_ED:10006,IOS_NOOP:1e4,IOS_PIN_CLOSEUP_TAKEOVER:10004,IOS_REPIN_DIALOG_TAKEOVER:10005,NOOP:1,WEB_BOARD_HERO:17,WEB_BOARD_TAKEOVER:18,WEB_CATEGORY_HERO:23,WEB_EMPTY_PLACES_BOARD_TAKEOVER:20,WEB_EXPLORE_TAKEOVER:22,WEB_FILLED_PLACES_BOARD_TAKEOVER:21,WEB_HERO:13,WEB_HOME_HERO:15,WEB_HOME_TAKEOVER:11,WEB_MOBILE_EVERYTHING_FEED_TAKEOVER:40001,WEB_MOBILE_NOOP:4e4,WEB_NOOP:10,WEB_PIN_CLOSEUP:12,WEB_PIN_SUCCESS:14,WEB_TOOLTIP:16,WEB_USER_PROFILE_TAKEOVER:19},goog.provide("P.Experiences.Experience"),P.Experiences.Experience={ANDROID_HERO_EMPTY_HOMEFEED:30001,ANDROID_NOOP:3e4,CONFIRM_EMAIL:2,IOS_HOME_WELCOME_HELPER:20006,IOS_NAG_CONFIRM_EMAIL:20001,IOS_NAG_INVITER:20003,IOS_NAG_PLACE_PINS:20002,IOS_NAG_WRITE_BANNED:20008,IOS_NOOP:2e4,IOS_NUX_FIRST_PIN:20004,IOS_NUX_MANDATORY:20005,IOS_PINS_LIVE_PROFILE_HELPER:20007,NOOP:1,WEB_BLANK_SESSION:10009,WEB_CATEGORY_SEARCH_USER_ED:10014,WEB_EMPTY_PLACES_BOARD_USER_ED:10016,WEB_EXPLORE_BUTTON_USER_ED:10019,WEB_EXPLORE_PAGE_USER_ED:10020,WEB_FAST_FOLLOW_USER_ED:10012,WEB_FEED_EDITOR_USER_ED:10001,WEB_FILLED_PLACES_BOARD_USER_ED:10017,WEB_FIND_FRIENDS_USER_ED:10013,WEB_FIRST_BOARD_USER_ED:10018,WEB_FIRST_FOLLOW:10007,WEB_FIRST_PIN_SUCCESS:10005,WEB_FIRST_PIN_USER_ED:10010,WEB_HERO_EMPTY_HOMEFEED:10051,WEB_HERO_HOLIDAY_GUIDE:10058,WEB_HERO_INSTALL_APP:10052,WEB_HERO_INSTALL_EXTENSION:10060,WEB_HERO_INVITE_FRIENDS:10050,WEB_HERO_LANGUAGE:10054,WEB_HERO_PINIT_BUTTON:10053,WEB_HERO_PINIT_WEBMASTER:10055,WEB_HERO_PLACE_PINS:10056,WEB_HERO_PLACE_PINS_BOARD:10057,WEB_HERO_VALENTINES:10059,WEB_MANDATORY_AUTOBAHN:10004,WEB_MOBILE_NOOP:4e4,WEB_MOBILE_NUX_MANDATORY:40001,WEB_MODERN_HEADER_USER_ED:10021,WEB_NOOP:1e4,WEB_PINIT_BOOKMARKLET:10008,WEB_PIN_CLOSEUP_AUTOBAHN:10003,WEB_PIN_CLOSEUP_LITE:10002,WEB_PIN_SUCCESS_EXTENSION_UPSELL:10022,WEB_PLACE_PINS_TOOLTIP:10015,WEB_SEARCH_DISCOVER_TOOLTIP:10006,WEB_YOUR_BOARDS_USER_ED:10011},function(){goog.provide("P.spinner");var a={SMALL:"Small",MEDIUM:"Medium"},b={size:a.MEDIUM},c=function(a){this.options=_.extend({},b,a),this.$spinEl=null};c.Size=a,c.prototype={spin:function(a,b){this.$spinEl&&this.stop(),b=b||"spinner";var c=b+this.options.size;this.$spinEl=$('<div class="Spinner"><div class="'+c+'"></div></div>'),this.$spinEl.prependTo(a)},stop:function(){this.$spinEl.remove(),this.$spinEl=null}},P.Spinner=c}(),function(){goog.provide("P.body"),goog.require("P.logger");var a=P.Logger.getLogger("Body"),b="noScroll",c=function(){this.scrollStack=[!0]};c.prototype={pushScrolling:function(a){return this.push().setScrolling(a),this},pop:function(){return this.scrollStack.length<=1?void a.error("Tried to pop with only one item on stack.  Mismatched push and pops?"):(this.scrollStack.pop(),this.updateElement(),this)},setScrolling:function(a){return this.scrollStack[this.scrollStack.length-1]=a,this.updateElement(),this},push:function(){return this.scrollStack.push(this.peek()),this},peek:function(){return this.scrollStack[this.scrollStack.length-1]},updateElement:function(){var a=this.peek();$("body").toggleClass(b,!a)}},P.Body=new c,Pc.TEST_MODE&&(P.Body.constructor=c)}(),function(){goog.provide("P.polyfills");for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),Date.now=Date.now||function(){return(new Date).getTime()}}(),function(){goog.provide("P.pubsub");var a=0;P.PubSub=function(a){this.ns=a,this.channels={}};var b=function(a,b,c){this.pubsub=a,this.target=b,this.options=c,this.topics={}},c=function(a,b){this.pubsub=a,this.target=b,this.subscribers={},this.filters={},this.messages={}};_.extend(P.PubSub.prototype,{createSubscriber:function(a,c){return new b(this,a,c)},subscribe:function(a,b,c,d){var e=this.createSubscriber(a,{handler:c,scope:d});return e.subscribe(b),e},publish:function(a,b,c){this.getChannel(a).publish(b,c)},getChannel:function(a){return this.channels[a]||(this.channels[a]=new c(this,a)),this.channels[a]},clearChannel:function(a){var b=this.channels[a];b&&(b.unsubscribeAll(),delete this.channels[a])}}),_.extend(c.prototype,{addSubscriber:function(a,b){var c=this,d=a.getId();return this.subscribers[d]=a,_.each(b,function(b){c.filters[b]||(c.filters[b]={}),c.filters[b][d]||(c.filters[b][d]=a,_.isUndefined(c.messages[b])||a.publish(b,c.messages[b]))
}),a},removeSubscriber:function(a,b){var c=this,d=a.getId();_.each(b,function(a){c.filters[a]&&delete c.filters[a][d]}),_.keys(this.subscribers).length<1&&this.pubsub.clearChannel(this.target)},publish:function(a,b){_.each(this.filters[a],function(c){c.publish(a,b)}),"*"!==a&&this.publish("*",b),this.messages[a]=b},getSubscribers:function(){var a=_.toArray(arguments);if(!a.length)return _.values(this.subscribers);var b=this,c={};return _.each(a,function(a){_.extend(c,b.filters[a])}),_.values(c)},unsubscribeAll:function(){_.each(this.subscribers,function(a){a.unsubscribe()})}}),_.extend(b.prototype,{publish:function(a,b){return this.getHandler().call(this.getScope(),this.target,a,b),this},subscribe:function(){var a=this,b=_.toArray(arguments);return this.getChannel().addSubscriber(a,b),_.each(b,function(b){a.topics[b]=1}),this},unsubscribe:function(){var a=this,b=_.toArray(arguments);return 0===b.length&&(b=this.getTopics()),_.each(b,function(b){delete a.topics[b]}),this.getChannel().removeSubscriber(this,b),this},getChannel:function(){return this.pubsub.getChannel(this.target)},getHandler:function(){return this.options.handler},getScope:function(){return _.result(this.options,"scope")},getName:function(){return _.result(this.options,"name")},getId:function(){return this.id||(this.id=a++),this.id},getTopics:function(){return _.keys(this.topics)}}),P.PubSub.Subscriber=b,P.PubSub.Channel=c,P.pubsub=new P.PubSub("local")}(),function(){goog.provide("P.appVersion");var a={CURRENT:1,NEW_VERSION_AVAILABLE:2,NEW_VERSION_REQUIRED:3},b=function(){this.currentVersion=null,this.versionState=a.CURRENT};_.extend(b.prototype,{setup:function(b){var c=this;this.currentVersion=b,$(document).ajaxSend(function(a,b){b.setRequestHeader("X-APP-VERSION",c.currentVersion)}),P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_APP_VERSION,function(a,b,d){c._checkVersion(d)}),P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_APP_VERSION_AVAILABLE,function(){c.versionState===a.CURRENT&&(c.versionState=a.NEW_VERSION_AVAILABLE)})},_checkVersion:function(b){b!==this.currentVersion&&(this.versionState=a.NEW_VERSION_REQUIRED)},isNewVersionAvailable:function(){return this.versionState===a.NEW_VERSION_AVAILABLE||this.isNewVersionRequired()},isNewVersionRequired:function(){return this.versionState===a.NEW_VERSION_REQUIRED}}),P.AppVersion=new b}(),function(){goog.provide("P.deepLink");var a=function(){this.url=null};_.extend(a.prototype,{updateUrl:function(a){this.url=a},setup:function(a,b){var c=this;this.url=a||b,P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_DEEP_LINK,function(a,b,d){c.updateUrl(d)})},getUrl:function(){return this.url},attemptIOSDeepLink:function(a){var b=this.getUrl();window.setTimeout(function(){window.location=b,window.setTimeout(function(){window.location=a},50)},100)},attemptAndroidDeepLink:function(a){var b=document.createElement("iframe");b.style.visibility="hidden",b.src=this.getUrl(),document.body.appendChild(b),window.setTimeout(function(){window.location=a},50)},redirectToDeepLink:function(a,b){b===P.CONST.USER_AGENT_PLATFORM_IOS?this.attemptIOSDeepLink(a):b===P.CONST.USER_AGENT_PLATFORM_ANDROID&&this.attemptAndroidDeepLink(a)},getLinkForAgent:function(a,b){var c;return a===P.CONST.USER_AGENT_PLATFORM_IOS?c=b.ios_deep_link:a===P.CONST.USER_AGENT_PLATFORM_ANDROID&&(c=b.android_deep_link),c}}),P.DeepLink=new a}(),function(){goog.provide("P.experiments"),P.experiments.Client=function(a,b){this.active=_.clone(a),this.triggerable=_.clone(b)},P.experiments.Client.prototype.getGroupForExperiment=function(a,b){void 0===b&&(b=!0);var c=this.active[a];return void 0===c&&b&&(c=this.triggerable[a],void 0!==c&&(delete this.triggerable[a],this.active[a]=c,this.reportExperimentActivated(a))),c||null},P.experiments.Client.prototype.inExperimentGroups=function(a,b,c){var d=this.getGroupForExperiment(a,c);return null!==d&&_.contains(b,d)},P.experiments.Client.prototype.inExperimentGroup=function(a,b,c){return this.inExperimentGroups(a,[b],c)},P.experiments.Client.prototype.inExperimentGroupActiveOrTriggerable=function(a,b){return(this.active[a]||this.triggerable[a])===b},P.experiments.Client.prototype.reportExperimentActivated=function(a){var b=P.resourceFactory.create("ActivateExperimentResource",{experiment_name:a});b.callCreate({error:P.NOOP})},P.experiments.Client.prototype.getDebugInfo=function(){return JSON.stringify({active:this.active,triggerable:this.triggerable})};var a=Pc.experiments;P.experiments.instance=new P.experiments.Client(a.active,a.triggerable),P.experiments.modernHeader=P.experiments.instance.inExperimentGroups("modern_header_update",["enabled_grid","enabled_dropdown","enabled_grid_no_tutorial","employees"])}(),function(){goog.provide("P.error"),P.Error=function(){this.name="P.Error",this.code=null,this.http_status=null,this.api_error_code=null,this.target=null,this.stack_trace=null,this.extra_data=null,this.request_identifier=null},P.Error.prototype=new Error,P.Error.prototype.constructor=P.Error,P.Error.fromPlainObject=function(a){var b=new P.Error;return a.message&&(b.message=a.message),a.code&&(b.code=a.code),a.http_status&&(b.http_status=a.http_status),a.api_error_code&&(b.api_error_code=a.api_error_code),a.target&&(b.target=a.target),a.stack_trace&&(b.stack_trace=a.stack_trace),a.extra_data&&(b.extra_data=a.extra_data),a.request_identifier&&(b.request_identifier=a.request_identifier),b}}(),function(){goog.provide("P.errors"),goog.require("P.experiments"),P.Errors={},P.Errors.ENABLE_WRAPPING=P.experiments.instance.inExperimentGroup("denzel_error_wrap","enabled"),P.Errors.wrapFn=function(a,b){return b?P.Errors.ENABLE_WRAPPING?function(){try{return b.apply(this,arguments)}catch(c){if(!c.loggedToServer){var d=Array.prototype.slice.call(arguments,0);P.Errors.reportError(this,a,d,c),c.loggedToServer=!0}throw c}}:b:function(){}},P.Errors.wrap=function(a,b){_.each(b,function(b){var c=a[b];a[b]=P.Errors.wrapFn(b,c)})},P.Errors.reportError=function(a,b,c,d){var e={format:"sentry",fn_name:b||"unknown_function_name"};if(a instanceof P.Module){for(var f=b,g=a;g;)f=g.getDebugInfo()+":"+f,g=g.parent;e.error_path=f}else a instanceof P.Resource&&(e.resource_name=a.name);if(c[0]instanceof $.Event){var h=c[0],i=h.currentTarget;e.event={type:h.type,target_class:i.className.replace(/\s+/g," ")},i.href&&(e.event.target_href=i.href)}e.traceback=printStackTrace({e:d}).join("\n"),P.Logger.getLogger("Errors").error(d.message,e)},P.showError=function(a){a=_.escape(a),P.showHtmlError(a)},P.showHtmlError=function(a,b){var c={name:"ConfirmDialog",options:{view_type:"error",message:a,template:null}};P.loadModule(c,function(a){b&&a.on(P.CONST.EVENT_CONFIRM,b),P.getModalManager().showInModal(a)})}}(),function(){goog.provide("P.fb"),goog.require("P.script");var a=!1;P.fb={},P.fb.ensureInit=function(b){var c="fb";P.script.load([],"//connect.facebook.net/en_US/all.js",c),P.script.ready(c,function(){var c=window.FB;c&&(a||(c.init({appId:P.FB_KEY,status:!0}),a=!0),b(c))})},P.fb.ensureLoggedIn=function(a){P.fb.ensureInit(function(b){b.getUserID()?a(b):b.login(function(){a(b)})})}}(),function(){goog.provide("P.gapi"),P.gapi={},P.gapi.get=function(a){var b="gplus";P.script.load([],"https://apis.google.com/js/client:plusone.js",b),P.script.ready(b,function(){a(window.gapi)})}}(),function(){goog.provide("P.hoverIntent"),P.HoverIntent=function(a,b){this.$el=a,this.options=_.extend({sensitivity:10,enterDelay:0,exitDelay:0,interval:40},b),this.$el.on("mouseenter mouseleave",_.bindFn(this._handleHover,this))},_.extend(P.HoverIntent.prototype,Backbone.Events,{_checkMouseEnter:function(){this._clearTimeout(),this._isMouseStill()?this._onMouseEnterComplete():(this._setPreviousXY(this._currX,this._currY),this._timeout=P.setTimeout(_.bindFn(this._checkMouseEnter,this),this.options.interval))},_clearTimeout:function(){this._timeout&&(this._timeout=clearTimeout(this._timeout))},_handleHover:function(a){this._clearTimeout();var b=this;"mouseenter"===a.type?(this._onMouseEnterStart(),this.options.enterDelay?(this._setPreviousXY(a.pageX,a.pageY),this.$el.on("mousemove.HoverIntent",function(a){b._setCurrentXY(a.pageX,a.pageY)}),this._isEntered||(this._timeout=window.setTimeout(function(){b._checkMouseEnter()},this.options.enterDelay))):this._onMouseEnterComplete()):(this._onMouseOutStart(),this._isEntered&&(this._timeout=window.setTimeout(function(){b._onMouseOutComplete()},this.options.exitDelay)))},_isMouseStill:function(){var a=Math.abs(this._prevX-this._currX),b=Math.abs(this._prevY-this._currY);return a||b||(a=0,b=0),a+b<this.options.sensitivity},_onMouseEnterStart:function(){this.trigger(P.CONST.EVENT_HOVERINTENT_ENTER_START)},_onMouseEnterComplete:function(){this.$el.off("mousemove.HoverIntent"),this._isEntered=1,this.trigger(P.CONST.EVENT_HOVERINTENT_ENTER_COMPLETE)},_onMouseOutStart:function(){this.$el.off("mousemove.HoverIntent"),this.trigger(P.CONST.EVENT_HOVERINTENT_OUT_START)},_onMouseOutComplete:function(){this._clearTimeout(),this._isEntered=0,this.trigger(P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE)},_setCurrentXY:function(a,b){this._currX=a,this._currY=b},_setPreviousXY:function(a,b){this._prevX=a,this._prevY=b}})}(),function(){goog.provide("P.isHovering");var a="data-is-hovering";jQuery.fn.initHovering=function(){return this.each(function(b,c){$(c).hover(function(){$(c).attr(a,"true")},function(){$(c).removeAttr(a)}).removeAttr(a)}),this},jQuery.fn.isHovering=function(){return!!$(this).attr(a)}}(),function(){goog.provide("P.fbUtil"),goog.require("P.fb");var a="publish_actions";P.FbUtil={},P.FbUtil.checkFbTimelinePermission=function(b){var c=function(c){c.api("/me/permissions",function(c){var d=c.data;d&&d[0][a]?b.success&&b.success():b.error&&b.error()})};P.fb.ensureInit(c)},P.FbUtil.fbConnectedAccountMatchesLoggedInAccount=function(a,b){if(!b)return!0;var c=a.getAuthResponse();return c?b===c.userID:!0},P.FbUtil.maybeRequestFbTimelinePermission=function(a,b){P.fb.ensureInit(function(c){var d=P.FbUtil.fbConnectedAccountMatchesLoggedInAccount(c,b);return d?void P.FbUtil.checkFbTimelinePermission({success:function(){a.success&&a.success(),a.complete&&a.complete()},error:function(){P.FbUtil.fbLogin(a)}}):(P.showError(P._("Oops! Your account is linked to a different Facebook account than the one you're logged into now.")),a.error&&a.error(),void(a.complete&&a.complete()))})},P.FbUtil.fbLogin=function(b){P.fb.ensureInit(function(c){c.login(function(a){a.authResponse?P.FbUtil.checkFbTimelinePermission(b):b.error&&b.error(),b.complete&&b.complete()},{scope:a})})}}(),function(){goog.provide("P.user"),goog.require("P.start"),goog.require("P.fb"),P.User=Backbone.Model.extend({initialize:function(){this.log=P.Logger.getLogger("User")},isAuthenticated:function(){return!!this.get("id")},attemptLogin:function(){this.attemptLoginWithFacebook()},attemptLoginWithFacebook:function(){if(!Cookie.get(P.CONST.COOKIE_FB_AUTO_LOGIN_DISABLED)){var a=this;P.fb.ensureInit(function(b){var c=_.bindFn(a._attemptLoginWithFacebook,a);b.getLoginStatus(c,!0)})}},_attemptLoginWithFacebook:function(a){var b=a.authResponse;if(b){var c={facebook_id:b.userID,facebook_token:b.accessToken,facebook_autologin:!0};this.login(c,function(){window.location.reload(!0)})}},trackCMCoverage:function(){var a=P.resourceFactory.create("CookieMonsterTrackViewResource",{}),b=Cookie.get("_pinterest_cm"),c=window.location.host.replace(/^\w+\./,"log."),d=P.absolutify("/backfill",window.location.protocol,c),e={path:P.getCurrentUrl(),backfill:0,has_cm:0};b?(e.has_cm=1,a.setOptions(e),a.callUpdate()):$.ajax({cache:!1,url:d}).always(function(){e.backfill=1,Cookie.get("_pinterest_cm")&&(e.has_cm=1),a.setOptions(e),a.callUpdate()})},login:function(a,b,c,d){var e=P.resourceFactory.create("UserSessionResource",a),f=this;e.callCreate({success:function(a){f.log.debug("Login, successful",a),f.set(a.resource_response.data),b&&b(a)},error:c||P.NOOP,complete:d||P.NOOP,async:!1})},logout:function(a){Cookie.set(P.CONST.COOKIE_FB_AUTO_LOGIN_DISABLED,"True"),a()}}),P.currentUser=new P.User,P.start.ready(function(a){P.currentUser.set(a.scrubbedUser),P.currentUser.isAuthenticated()||Cookie.get("_track_cm")||(Cookie.set("_track_cm","1",24),P.currentUser.trackCMCoverage())})}(),function(){goog.provide("P._"),goog.provide("P.string"),P._=function(a){return P.STRINGS&&P.STRINGS.hasOwnProperty(a)?P.STRINGS[a]:a},P.string.common={},P.string.initializeCommonStrings=function(){P.string.common={successInviteSentToEmail:P._("Success! Invitation sent to {{ email }}"),connectError:P._("Couldn't connect. You must authorize Pinterest."),defaultErrorMessage:P._("Sorry! Something went wrong on our end!"),asciiPasswordError:P._("Oops! Your password can only have English letters, numbers and basic symbols.")}};var a=/\{\{\s*(\w+)\s*\}\}/g;P.string.format=function(b,c){var d=function(a,d){return c&&c.hasOwnProperty(d)?_.escape(c[d]):(P.string.logError("Missing arg for format string",{format:b,argId:d}),"")},e=b.replace(a,d);return e},P.string.logError=function(a,b){P.Logger.getLogger("Strings").error(a,b)}}(),function(){goog.provide("P.router"),goog.require("P.logger"),function(){var a=P.Logger.getLogger("P.router"),b=/\$\{(\d+)\}/g,c=/\?\{(\w+)\}/g,d=/\$\{(\w+)\}/g,e=/^([^\?]*?)\?(.*)$/,f=function(a,e,f,g){var h=!1;return a=a.replace(c,function(a,b){var c=f[b];return void 0===c&&(h=!0),c}),h?null:(a=a.replace(b,function(a,b){return e[parseInt(b,10)]}),g&&(a=a.replace(d,function(a,b){var c=g[b];return e[c]})),a)},g=function(a,b,c,d){var e=a;return _.isObject(a)?(e={},_.each(a,function(a,f){e[g(f,b,c,d)]=g(a,b,c,d)})):_.isString(a)&&(e=f(a,b,c,d)),e};P.Route=function(a){this.pathPattern=new RegExp(a,"i"),this.module="",this.named={},this.options={},this.resource=null,this.extraContent={}},P.Route.fromPlainObject=function(a){var b=a.pathPattern;if(!b)throw new Error("pathPattern is required");var c=new P.Route(b);return"module"in a&&(c.module=a.module),"named"in a&&(c.named=a.named),"options"in a&&(c.options=a.options),"resource"in a&&(c.resource=a.resource),"extraContent"in a&&(c.extraContent=a.extraContent),c},P.RouteMatch=function(){this.pathPattern=null,this.module="",this.named={},this.options={},this.resource=null,this.extraContent={},this.navigateData=null},P.Router=function(){this.routes=[],this.lastUrl=window.location.href,this.log=P.Logger.getLogger("Router")},_.extend(P.Router.prototype,Backbone.Events),_.extend(P.Router.prototype,{start:function(){var a=this;if(_.each(P.ROUTES,function(b){var c=P.Route.fromPlainObject(b);a.addRoute(c)}),P.useHistory()){if(window.history.replaceState){var b=$("link[rel=canonical]").attr("href");if(window.location.href!==b){var c="state"in window.history?window.history.state:{};try{window.history.replaceState(c,document.title,b)}catch(d){this.log.error("replaceState failed",d)}this.lastUrl=window.location.href}}$(window).on("popstate",function(b){a.log.debug("popstate fired, lastUrl",a.lastUrl," new URL ",window.location.href),a.lastUrl===window.location.href?a.log.debug("ignoring spurious popstate event"):a.onStateChange(b),a.lastUrl=window.location.href})}},navigate:function(a,b,c){c=c||new P.navigateData.NavigateData,this.navigateData=c,b.trigger&&($("link[rel=canonical]").remove(),window.history.pushState({},document.title,a),this.lastUrl=window.location.href);var d=this.resolve(a);this.log.debug("route matched",d,a),d?this.trigger(P.CONST.EVENT_ROUTE_MATCHED,d):this.trigger(P.CONST.EVENT_ROUTE_NO_MATCH,a)},resolve:function(a){var b=null,c=null,d=null;(d=e.exec(a))?(b=d[1],c=d[2]):b=a;for(var f=decodeURIComponent(b),g=null,h=0;h<this.routes.length;h++){var i=this.routes[h],j=i.pathPattern.exec(f);if(j){var k=j.slice(1);g=this.subRoute(i,k,c);break}}return g},addRoute:function(a){this.routes.push(a)},subRoute:function(a,b,c){var d=P.getQueryStringParams(c),e=new P.RouteMatch;return e.pathPattern=a.pathPattern,e.module=g(a.module,b,d,a.named),e.named=g(a.named,b,d,a.named),e.options=g(a.options,b,d,a.named),e.resource=g(a.resource,b,d,a.named),e.extraContent=g(a.extraContent,b,d,a.named),e.navigateData=this.navigateData,this.navigateData=new P.navigateData.NavigateData,e},onStateChange:function(){this.navigate(window.location.pathname,{trigger:!1})}}),P.navigate=function(b,c){b=P.normalizeUrl(b),c=c||new P.navigateData.NavigateData;var d=P.url.getUrlClass(b);if(d===P.url.UrlClass.UNTRUSTED){var e=null;return c.evt&&c.evt.data&&(e=c.evt.data.pinId),void P.SafeLink.open(b,e)}return P.useHistory()&&d!==P.url.UrlClass.TRUSTED_DIFFERENT_ORIGIN?d===P.url.UrlClass.SAME_ORIGIN?(c.fromNavigate=!0,void P.router.get().navigate(b,{trigger:!0},c)):void a.error("unexpected UrlClass",d,b):void P.changeWindowLocation(b,!1)},P.Errors.wrap(P.Router.prototype,["start"]),P.router.set=function(a){P._router=a},P.router.get=function(){return P._router},P.router.set(new P.Router)}()}(),function(){goog.provide("P.url"),goog.require("P.start");var a=P.Logger.getLogger("P.url");P.url={},P.getQueryStringParams=function(a){a=a||window.location.search,"?"===a[0]&&(a=a.substring(1));for(var b,c=/\+/g,d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(c," "))},f={};b=d.exec(a);)f[e(b[1])]=e(b[2]);return f};var b="";P.url._getAuthenticationOrigin=function(){return b},P.start.ready(function(a){b=a.authenticationOrigin});var c=function(b,c){c=c||{},c.next&&a.error('makeNextUrl: passing "next" in "params" is not allowed',{next:c.next});var d=_.extend({},c,{next:window.location.href}),e=P.url._getAuthenticationOrigin()+b+"?"+$.param(d);return e};P.getRegisterUrl=function(a){return c("/join/",a)},P.getLoginUrl=function(a){return c("/login/",a)},P.absolutify=function(a,b,c){return a?a.match(/^https{0,1}:\/\//)?a:(void 0===b&&(b=window.location.protocol),void 0===c&&(c=window.location.hostname,window.location.port&&(c+=":"+window.location.port)),b+"//"+c+a):a},P.normalizeUrl=function(a){var b=P.absolutify("/");return P.beginsWith(a,b)?a.substr(b.length-1):a},P.getCurrentUrl=function(){return window.location.pathname+("?"===window.location.search?"":window.location.search)},P.isLocalUrl=function(a){return P.beginsWith(a,"/")||P.beginsWith(a,"?")},P.isOffsiteUrl=function(a){return!(!a||!a.match(/^https{0,1}:\/\//))},P.url.UrlClass={SAME_ORIGIN:1,TRUSTED_DIFFERENT_ORIGIN:2,UNTRUSTED:3},P.url.getUrlClass=function(a){if(P.isLocalUrl(a))return P.url.UrlClass.SAME_ORIGIN;if(P.beginsWith(a,window.location.origin+"/"))return P.url.UrlClass.SAME_ORIGIN;var b=P.url._getAuthenticationOrigin();return a===b||P.beginsWith(a,b+"/")?P.url.UrlClass.TRUSTED_DIFFERENT_ORIGIN:P.url.UrlClass.UNTRUSTED},P.url.isTrustedOrigin=function(a){var b=P.url.getUrlClass(a);return b===P.url.UrlClass.SAME_ORIGIN||b===P.url.UrlClass.TRUSTED_DIFFERENT_ORIGIN}}(),function(){goog.provide("P.util"),goog.require("P.errors"),goog.require("P.ContextLogging.ComponentType"),goog.require("P.ContextLogging.EventType");var a={_:function(a){return nunjucks.runtime.markSafe(P._(a))},_interpolate:function(a,b){return P.string.format(a,b)},ComponentType:P.ContextLogging.ComponentType,ElementType:P.ContextLogging.ElementType},b=_.memoize(function(){var a=nunjucks.configure({autoescape:!0});return a});P.renderNunjucks=function(c,d){var e=b(),f=_.extend({},d,a);return e.render(c,f)},P.useHistory=function(){return!!(window.history&&window.history.pushState&&window.history.replaceState)},jQuery.fn.positionAncestor=function(a){var b=0,c=0;return a.length>0&&this.each(function(d,e){var f=$(e),g=f.offset();if(a[0]===window)b=g.left,c=g.top;else{var h=a.scrollLeft(),i=a.scrollTop(),j=a.offset();b=h+g.left-j.left,c=i+g.top-j.top}return!1}),{left:b,top:c}},P.debounce=function(a,b,c){var d=_.debounce(a,c,!0),e=_.debounce(b,c);return function(){d.apply(this,arguments),e.apply(this,arguments)}},P.toArgumentString=function(a){var b=[];return _.each(a,function(a,c){a=a&&a.toString?a.toString():JSON.stringify(a),b.push(c+"="+a)}),b.join(", ")};var c=/(<([^>]+)>)/gi;P.stripTags=function(a){return a.replace(c,"")},P.requestAnimationFrameThrottled=function(a){var b=!1;return function(){b||(b=!0,window.requestAnimationFrame(function(){b=!1,a()}))}};var d=[];P.scrollToTop=function(a){var b=a.callback||P.NOOP,c=a.duration||P.CONST.SCROLL_TO_TOP_ANIMATION_TIME,d=a.$scroller||$("body,html");d[0]===window&&(d=$("body,html"));var e=a.newScrollOffset||0;d.animate({scrollTop:e},{duration:c,complete:_.once(b)})};var e={},f=function(){for(var a=d.length,b=0;b<a;b++){var c=d.shift();c.resolve()}};e.scheduleFlush=P.requestAnimationFrameThrottled(f),P.Errors.wrap(e,["scheduleFlush"]),P.deferDomManipulation=function(a){P.deferDomManipulationPromise().then(a)},P.deferDomManipulationPromise=function(){var a=new $.Deferred;return d.push(a),e.scheduleFlush(),a.promise()},P.changeWindowLocation=function(a,b){b?window.open(a,"_blank"):window.location.href=a},P.navigateAfterLoginStatusChange=function(a){var b=/^https?:\/\/(?:\w+\.)+pinterest\.com/.test(a);b||(a=P.normalizeUrl(a),P.isLocalUrl(a)||(a="/")),window.location.href=a},P.trackRegisterAction=function(a){var b=P.resourceFactory.create("UserRegisterTrackActionResource",{action:a});b.callUpdate({error:P.NOOP})},P.getDebugWindow=function(){return window.opener||window},P.prefixVendorAttributes=function(a){for(var b=["ms","moz","webkit","o"],c=0;c<b.length;c++)b[c]="-"+b[c]+"-"+a;return b.push(a),b},P.getResetPasswordOneClickUrl=function(a){return"/login/reset/?"+$.param(a)},P.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}(),function(){goog.provide("P.promise"),P.Promise={},P.Promise.all=function(a){return $.when.apply($,a).then(function(){var a=_.toArray(arguments);return a})},P.Promise.resolve=function(a){var b=new $.Deferred;return b.resolve(a),b.promise()},P.Promise.reject=function(a){var b=new $.Deferred;return b.reject(a),b.promise()}}(),function(){goog.provide("P.desktopUtil"),goog.require("P.HistoryManager"),goog.require("P.interfaces.HistoryManagerProvider"),P.scrollbarWidth=_.memoize(function(){var a=document.createElement("div");$(a).css({height:"100px",left:"100px",overflow:"scroll",position:"absolute",width:"100px"}),document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return document.body.removeChild(a),b}),P.preloadImage=function(a,b,c){var d=new Image;d.src=a,d.onload=b||P.NOOP,d.onerror=c||P.NOOP};var a=function(){};a.prototype.navigate=function(a,b){var c=P.app;c.getHistoryManager().navigate(a,b||{})},P.setHistoryNavigator(new a),P.supportCSSTransitions=_.memoize(function(){var a=document.createElement("p").style,b="transition"in a||"WebkitTransition"in a||"MozTransition"in a||"msTransition"in a||"OTransition"in a;return b}),P.setTitlePrefix=function(a){var b=document.title;b=b.replace(/^\(\w+\) /,""),a&&(b="("+a+") "+b),document.title=b}}(),function(){goog.provide("P.viewport"),goog.require("P.start");var a=function(){this.height=0,this.width=0};_.extend(a.prototype,{init:function(){this.on(P.CONST.EVENT_RESIZE,this._onResize,this),$(window).on("resize",_.debounce(_.bindFn(this._cacheWindowSize,this),200)),this._cacheWindowSize(),this.updateBodyColumns()},_cacheWindowSize:function(){var a=$(window),b=a.height(),c=a.width();(b!==this.height||c!==this.width)&&(this.height=b,this.width=c,this.trigger(P.CONST.EVENT_RESIZE))},_onResize:function(){this.updateBodyColumns()},updateBodyColumns:function(){this.setBodyColumns(P.bodyColumns.getBodyColumnsNeeded())},setBodyColumns:function(a){a!==this.numColumns&&(this.numColumns=a,P.bodyColumns.setNumColumns(a),this.trigger(P.CONST.EVENT_BODY_COLUMN_CHANGE))}}),P.Viewport=new a,_.extend(P.Viewport,Backbone.Events),P.start.ready(function(){P.Viewport.init()})}(),function(){function a(a){return a===window.setTimeout?function(a,b){return window.setTimeout(a,b)}:a===window.setInterval?function(a,b){return window.setInterval(a,b)}:a}goog.provide("P.window");var b=function(b,c){var d=a(c);if(!P.Errors.ENABLE_WRAPPING)return d;var e=function(a,c,e){if("string"===typeof a&&(a=window[a]),!a)return-1;var f=b+":"+e,g=_.isFunction(a)?P.Errors.wrapFn(f,a):a;return d(g,c)};return e};P.setTimeout=b("setTimeout",window.setTimeout),P.setInterval=b("setInterval",window.setInterval)}(),function(){goog.provide("P.googleAnalytics"),goog.require("P.start"),goog.require("P.logger"),goog.require("P.pubsub"),window._gaq=window._gaq||[];var a,b=P.Logger.getLogger("GoogleAnalytics"),c=function(c){b.finer("gaqPush",c);for(var d=0;d<a.length;d++){var e=a[d];window._gaq.push(["_setAccount",e]),window._gaq.push(c)}},d=function(b){a=b;var d=document.createElement("script");d.type="text/javascript",d.async=!0,d.src=("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(d),P.DEBUG&&(c(["_setSampleRate",100]),c(["_setSiteSpeedSampleRate",100]))},e={VISITOR:1,SESSION:2,PAGE:3},f=function(a){var b=a?"logged in":"logged out";c(["_setCustomVar",1,"is_logged_in",b,e.SESSION])};P.start.ready(function(a){d(a.gaAccountNumbers),f(a.isLoggedIn)}),P.getTrackGAPageviewUrl=function(a,b){var c=a,d=P.getQueryStringParams(b),e=d.q;return e&&(c+="?"+$.param({q:e})),c},P.trackGAPageview=function(a,b){b=b||{streaming:void 0,scriptLoadMethod:void 0},c(["_setCustomVar",2,"page_name",a,e.PAGE]),c(["_setCustomVar",3,"streaming",String(b.streaming),e.PAGE]),c(["_setCustomVar",4,"script_load_method",String(b.scriptLoadMethod),e.PAGE]),c(["_trackPageview",P.getTrackGAPageviewUrl(window.location.pathname,window.location.search)])},P.trackGAEvent=function(a,b,d,e){c(["_trackEvent",a,b,d,e])},P.trackGACategoryEvent=function(a,b,c){P.trackGAEvent(a+"_"+b,c)}}(),function(){goog.provide("P.event"),P.Event=function(a,b,c){this.type=a,this.target=b,this.currentTarget=b,this.data=c||{},this.stopped=!1},P.Event.prototype.stopPropagation=function(){this.stopped=!0},P.Event.prototype.shouldPropagate=function(){return!this.stopped}}(),function(){goog.provide("P.loader"),goog.require("P.resourceFactory"),P.ModuleConstructorNotFoundError=function(){Error.apply(this,arguments)},P.ModuleConstructorNotFoundError.prototype=new Error,P.ModuleConstructorNotFoundError.prototype.name="P.ModuleConstructorNotFoundError",P._loadModuleConstructor=function(a){for(var b,c=P.modules,d=a.split(/\./),e=0;e<d.length&&c;e++)if(c=c[d[e]],!c)return b=new P.ModuleConstructorNotFoundError,b.moduleName=a,P.Promise.reject(b);var f=c;return _.isFunction(f)?P.Promise.resolve(f):(b=new P.ModuleConstructorNotFoundError,b.moduleName=a,P.Promise.reject(b))},P.loadModuleConstructor=_.memoize(P._loadModuleConstructor),P.loadModule=function(a,b){var c=a.name,d=P.loadModuleConstructor(c).then(function(b){var c=new b(a);return c});return b&&d.done(b),d},P.moduleFactory={create:function(a,b,c){return P.loadModuleConstructor(a.name).then(function(d){var e=$("#"+a.uid,b),f={el:e,options:a.options,id:a.id||void 0,resource:a.resource||void 0},g=new d(f);return c&&c.addChild(g),g.loadFromModuleTree(a).then(function(){return g})})}}}(),function(){goog.provide("P.resourceFactory"),goog.require("P.interfaces.IResource");var a=function(){this.defaultConstructorFn=null,this.nameToConstructorFn={}};a.prototype={setDefaultConstructorFn:function(a){this.defaultConstructorFn=a},create:function(a,b){var c,d=b||{},e=this.nameToConstructorFn[a];if(e)c=new e(d);else{if(!this.defaultConstructorFn)throw new Error("Couldn't find constructor function for "+a);c=new this.defaultConstructorFn(a,d)}return c},clone:function(a){return this.create(a.getName(),a.copyOptions(!0))},register:function(a,b){this.nameToConstructorFn[a]=b}},P.ResourceFactory=a,P.resourceFactory=new a}(),function(){function a(a){this.name=a,this.id=null,this.options={},this.data=null,this.resource=null,this.append=!1,this.errorStrategy=P.CONST.ErrorStrategy.REMOVE}goog.provide("P.moduleRenderOptions"),goog.require("P.interfaces.IResource"),a.prototype={setName:function(a){this.name=a},setId:function(a){this.id=a},setOptions:function(a){this.options=a},setData:function(a){this.data=a},setResource:function(a){this.resource=a},setAppend:function(a){this.append=a},setErrorStrategy:function(a){this.errorStrategy=a}},a.fromPlainObject=function(b){var c=new a(b.name);if("id"in b&&c.setId(b.id),"options"in b&&c.setOptions(b.options),"data"in b&&c.setData(b.data),"resource"in b){var d=P.resourceFactory.create(b.resource.name,b.resource.options);c.setResource(d)}return"append"in b&&c.setAppend(b.append),"errorStrategy"in b&&c.setErrorStrategy(b.errorStrategy),c},P.ModuleRenderOptions=a}(),function(){goog.provide("P.ModuleRenderer"),P.ModuleRenderer=function(){},P.ModuleRenderer.prototype={render:function(){}}}(),function(){function a(a){this.name=a,this.attributes={"class":"",id:""},this.id=null,this.children=[],this.data=null,this.extraData=null,this.errorStrategy=P.CONST.ErrorStrategy.REMOVE,this.options={},this.uid="",this.async=!1,this.resource=null,this.tagName=null,this.additionalClasses=null,this.additionalAttributes=null,this.innerHtml=null,this.outerHtml=null,this.error=null}goog.provide("P.moduleTree"),goog.require("P.interfaces.IResource"),a.prototype={setAttributes:function(a){this.attributes=a},setId:function(a){this.id=a},setChildren:function(a){this.children=a},addChild:function(a){this.children.push(a)},setData:function(a){this.data=a},setExtraData:function(a){this.extraData=a},setErrorStrategy:function(a){this.errorStrategy=a},setError:function(a){this.error=a},setOptions:function(a){this.options=a},setUid:function(a){this.uid=a},setAsync:function(a){this.async=a},setResource:function(a){this.resource=a},setTagName:function(a){this.tagName=a},setAdditionalClasses:function(a){this.additionalClasses=a},setAdditionalAttributes:function(a){this.additionalAttributes=a},setInnerHtml:function(a){this.innerHtml=a},setOuterHtml:function(a){this.outerHtml=a},flattenHtml:function(){var b=this,c=this.innerHtml.split(a.modulePlaceholder),d=this.name.replace(".","-");this.uid=_.uniqueId("m");var e=this.tagName||"div",f="<"+e+' class="Module '+d;return this.additionalClasses&&(f+=" "+this.additionalClasses.join(" ")),f+='" id="'+this.uid+'"',this.additionalAttributes&&_.each(this.additionalAttributes,function(a,b){f+=" "+b+'="'+a+'"'}),f+=">",_.each(c,function(a,c){f+=a;var d=b.children[c];d&&(f+=d.getTreeOuterHtml(),d.outerHtml=null)}),f+="</"+e+">",this.outerHtml=f,this.outerHtml},getTreeOuterHtml:function(){return this.outerHtml}},a.fromPlainObject=function(b){var c=new a(b.name);return"attributes"in b&&c.setAttributes(b.attributes),"id"in b&&c.setId(b.id),"data"in b&&c.setData(b.data),"extraData"in b&&c.setExtraData(b.extraData),"errorStrategy"in b&&c.setErrorStrategy(b.errorStrategy),"options"in b&&c.setOptions(b.options),"uid"in b&&c.setUid(b.uid),"async"in b&&c.setAsync(b.async),"resource"in b&&c.setResource(b.resource),"error"in b&&c.setError(b.error),_.each(b.children,function(b){var d=a.fromPlainObject(b);c.addChild(d)}),c},a.modulePlaceholder="<!--placeholder-->",P.ModuleTree=a}(),function(){goog.provide("P.moduleTemplate"),goog.require("P.interfaces.IResource"),goog.require("P.moduleTree"),goog.require("P.experiments");var a=nunjucks.runtime.markSafe(P.ModuleTree.modulePlaceholder),b=function(a,b){for(var c in b)"__keywords"!==c&&(a[c]=b[c])};P.moduleTemplate={},P.moduleTemplate.Result=function(){this.innerHtml="",this.childrenModuleRenderOptions=[],this.additionalClasses=[],this.additionalAttributes={},this.data={},this.extraData={},this.tagName=null},P.moduleTemplate.render=function(c,d,e,f){var g=new P.moduleTemplate.Result,h={};return h.options=c,h.data=d,h.resource=e,h.context={},h.context.experiments={in_experiment_group:function(a,b,c){var d=c&&c.activate;return P.experiments.instance.inExperimentGroup(a,b,d)},in_experiment_groups:function(a,b,c){var d=c&&c.activate;return P.experiments.instance.inExperimentGroups(a,b,d)
},get_group_for_experiment:function(a,b){var c=b&&b.activate;return P.experiments.instance.getGroupForExperiment(a,c)}},h.context.experiences={is_placed_experience:function(a,b){var c=P.Experiences.Placement[a],d=P.Experiences.Experience[b];return P.ExperienceManager.instance().isPlacedExperience(c,d)},is_placed_experience_with_context:function(){throw new Error("not implemented")},experience_viewed:function(){throw new Error("not implemented")}},h.context.user=P.currentUser.attributes,h.module=function(b,c){var d=P.ModuleRenderOptions.fromPlainObject(c);return d.setName(b),g.childrenModuleRenderOptions.push(d),a},h.create_resource=function(a,b){var c=P.resourceFactory.create(a);return b.options&&(c.options=b.options),c},h.tag_name=function(a){g.tagName=a},h.addclass=function(a){g.additionalClasses.push(a)},h.attr=function(a){b(g.additionalAttributes,a)},h.extra_data=function(a){_.extend(g.extraData,a)},h.include_data=function(){arguments[0]===!0?g.data=d:_.each(arguments,function(a){g.data[a]=d[a]})},h.describe=function(a){b(h.options,a)},h.base=function(a){h.addclass(a)},g.innerHtml=P.renderNunjucks(f,h),g}}(),function(){goog.provide("P.ModuleRendererLocal"),goog.require("P.logger"),goog.require("P.ModuleRenderer"),goog.require("P.moduleTemplate"),goog.require("P.moduleTree"),goog.require("P.promise"),goog.require("P.resourceCache");var a=P.Logger.getLogger("ModuleRendererLocal"),b=function(a){this.templateName=a};b.prototype={_getData:function(a){return a.data||!a.resource?P.Promise.resolve(a.data):P.resourceCache.instance.getData(a.resource)},_getErrorModuleTree:function(a){var b=new P.ModuleTree(a.name);return b.setInnerHtml("error"),P.Promise.resolve(b)},_renderModuleTree:function(a,b){var c=a.resource,d=P.moduleTemplate.render(a.options,b,c,this.templateName),e=_.map(d.childrenModuleRenderOptions,function(a){return P.loadModuleConstructor(a.name).then(function(b){var c=b.prototype,d=c.moduleRenderer;return d.render(a)})});return P.Promise.all(e).then(function(b){b=_.without(b,null);var c=new P.ModuleTree(a.name);return a.id&&c.setId(a.id),a.options&&c.setOptions(a.options),a.resource&&c.setResource(a.resource),c.setAdditionalClasses(d.additionalClasses),c.setAdditionalAttributes(d.additionalAttributes),c.setData(d.data),c.setExtraData(d.extraData),d.tagName&&c.setTagName(d.tagName),c.setChildren(b),c.setInnerHtml(d.innerHtml),c.flattenHtml(),c})},render:function(b){var c=this;return this._getData(b).then(function(a){return c._renderModuleTree(b,a)},function(a){return a}).then(null,function(d){switch(b.errorStrategy){case P.CONST.ErrorStrategy.SHOW:return c._getErrorModuleTree(b);case P.CONST.ErrorStrategy.REMOVE:return P.Promise.resolve(null);default:return a.warn("unknown moduleRenderOptions.errorStrategy",b.errorStrategy),P.Promise.resolve(null);case P.CONST.ErrorStrategy.BUBBLE:return d}})}},P.ModuleRendererLocal=b}(),function(){goog.provide("P.moduleRendererRemote"),goog.require("P.ModuleRenderer");var a=function(){};a.prototype={render:function(a){var b=a.resource;b||(b=P.resourceFactory.create(P.Resource.NOOP_RESOURCE.name,P.Resource.NOOP_RESOURCE.options));var c={error:P.NOOP};return b.callGet(c,a).then(function(a){return a.moduleTree})}},P.ModuleRendererRemote=a}(),function(){"use strict";function a(a,b,c,e){var f=$.Deferred(),g=a.$el,h=_.map(b,c);return P.Promise.all(h).then(function(b){var c=[];_.each(b,function(a){c=c.concat(a.errors)});var h={$el:g,errors:c};a.trigger(d,h),e&&e(h),f.resolve(h)}),f.promise()}goog.provide("P.form"),goog.require("P.placeholder"),goog.require("P.promise");var b=P.Logger.getLogger("Form"),c="hasError",d="validated",e=5,f=5e3,g="disabled",h="[type=submit]",i=["button","file","image","reset","submit"],j=100,k=["pinterest","password","123456","welcome","ninja","abc123","123456789","12345678","sunshine","princess","qwerty","master","michael","jordan","dragon","soccer","killer","pepper","devil","princess","1234567","iloveyou"],l=function(a,b){this.$el=a,this.rules=b};_.extend(l.prototype,Backbone.Events),_.extend(l.prototype,{validate:function(b){var c=this;return a(this,this.rules,function(a){return a(c.$el)},b)}}),l.Required=function(a){return function(b,c){var d=b.val(),e=[],f="checkbox"===b.attr("type")&&!b.is(":checked"),g="radio"===b.attr("type")&&!b.is(":checked");if(f||g||!d){var h=a&&a.message?a.message:P._("Required");e.push(h)}var i={$el:b,errors:e};return c&&c(i),P.Promise.resolve(i)}},l.Email=function(a){return function(b,c){var d=$.trim(b.val()),e=[];if(d&&!d.match(/.+@.+\..+/gi)){var f=a&&a.message?a.message:P._("Not a valid email.");e.push(f)}var g={$el:b,errors:e};return c&&c(g),P.Promise.resolve(g)}},l.StrictEmail=function(a){var b={},c=P.resourceFactory.create("EmailValidationResource",{}),d=null,g={EMAIL_VALID:1,EMAIL_INVALID:2,REQUEST_IN_PROGRESS:3,REQUEST_ERROR:4,REQUEST_CANCELED:5};return function(h,i){var j=$.trim(h.val()),k=a&&a.message?a.message:P._("Not a valid email."),m=l.Email(a),n=m(h,null).then(function(a){if(!j||a.errors.length>0||_.keys(b).length>=e||b[j]===g.EMAIL_VALID)return a;if(b[j]===g.EMAIL_INVALID)return a.errors.push(k),a;if(b[j]===g.REQUEST_IN_PROGRESS)return d;b[j]=g.REQUEST_IN_PROGRESS,c.options={email:j};var h=new $.Deferred;return d=h,c.callGet({error:P.NOOP,timeout:f}).then(function(c){var d=c.resource_response.data;d.is_valid?b[j]=g.EMAIL_VALID:(b[j]=g.EMAIL_INVALID,a.errors.push(k)),h.resolve(a)},function(){b[j]=g.REQUEST_ERROR,h.resolve(a)}),_.each(b,function(a,c){c!==j&&b[c]===g.REQUEST_IN_PROGRESS&&(b[c]=g.REQUEST_CANCELED)}),h.promise()}).always(function(a){i&&i(a)});return n}},l.PhoneNumber=function(a){return function(b,c){var d=$.trim(b.val()),e=d.replace(/[\(\)\+\-\. ]/g,""),f=/^(\(?\+?[0-9]*\)?)?[0-9_\- \.\(\)]*$/g,g=[];if(d&&(!d.match(f)||e.length<7)){var h=a&&a.message?a.message:P._("Not a phone number.");g.push(h)}var i={$el:b,errors:g};return c&&c(i),P.Promise.resolve(i)}},l.Number=function(a){return function(b,c){var d=$.trim(b.val()),e=/^\d+$/,f=[];if(d&&!d.match(e)){var g=a&&a.message?a.message:P._("Not a number.");f.push(g)}var h={$el:b,errors:f};return c&&c(h),P.Promise.resolve(h)}},l.URL=function(a){return function(b,c){var d=b.val(),e=[];if(d&&!d.match(/^(https?:\/\/){0,1}[a-z0-9_\-]+\..+/gi)){var f=a&&a.message?a.message:P._("Not a valid url.");e.push(f)}var g={$el:b,errors:e};return c&&c(g),P.Promise.resolve(g)}},l.Password=function(a){return function(b,c){var d=b.val(),e=[],f={shortPassStr:a&&a.shortPassStr||P._("Too short"),badPassStyle:a&&a.badPassStyle||P._("Not proper style"),samePasswordStr:a&&a.samePasswordStr||P._("Password and username can't match"),blackPassStr:a&&a.blackPassStr||P._("Please try using a stronger password"),goodPassStr:a&&a.goodPassStr||P._("Great!"),userid:$('[name="username"]').length?$('[name="username"]').val():""},g=$.fn.teststrength(d,f,k);if(g.length){var h=g[g.length-1];if(h){var i=g[0];e.push(i)}}var j={$el:b,errors:e};return c&&c(j),P.Promise.resolve(j)}},l.Length=function(a){return function(b,c){var d,e,f=b.val(),g=a.max||1/0,h=a.min||0,i=[],j=f.length;j<h?(d=P.string.format(P._("Please enter at least {{ character_count }} characters."),{character_count:h}),e=a&&a.messages&&a.messages.min?a.messages.min:d,i.push(e)):j>g&&(d=P.string.format(P._("Please enter no more than {{ character_count }} characters."),{character_count:g}),e=a&&a.messages&&a.messages.max?a.messages.max:d,i.push(e));var k={$el:b,errors:i};return c&&c(k),P.Promise.resolve(k)}},l.EqualTo=function(a){return function(b,c){var d=b.val(),e=$('[name="'+a.targetFieldName+'"]').val(),f=[];d!==e&&f.push(a.message);var g={$el:b,errors:f};return c&&c(g),P.Promise.resolve(g)}},l.ContainsOnlyAscii=function(a){return function(b,c){var d=b.val(),e=[],f=/^[\040-\176]*$/.test(d);f||e.push(a.message);var g={$el:b,errors:e};return c&&c(g),P.Promise.resolve(g)}},l.MatchesRegex=function(a){return function(b,c){var d=b.val(),e=[];a.pattern.test(d)||e.push(a.message);var f={$el:b,errors:e};return c&&c(f),P.Promise.resolve(f)}},P.Validator=l,P.Form=function(a,c,e){var f=this;e=e||{},this.$el=a,this.validators={},this.errorFields={},this.fastValidateFields={},this.hideErrors=!!e.hideErrors,this.prevalidating=!!e.prevalidate,this.onFieldBlur=_.bindFn(this.onFieldBlur,this),this.onFieldChange=_.bindFn(this.onFieldChange,this),this.onFieldKeyup=_.bindFn(this.onFieldKeyup,this),this.onFieldValidated=_.bindFn(this.onFieldValidated,this),this.onSubmit=_.bindFn(this.onSubmit,this),_.each(c,function(a,c){var e=f.getField(c);if(e[0]){var g=new P.Validator(e,a);f.validators[c]=g,g.on(d,f.onFieldValidated),e.on("blur",f.onFieldBlur),e.on("change",f.onFieldChange),e.on("keyup",f.onFieldKeyup)}else b.warn(c+" wasn't found in the form")}),this.prevalidating&&this.validate(function(){f.prevalidating=!1}),a.submit(this.onSubmit),a.find("[placeholder]").placeholder()},_.extend(P.Form.prototype,Backbone.Events),_.extend(P.Form.prototype,{validate:function(b){return a(this,this.validators,function(a){return a.validate()},b)},getField:function(a){var b=this.$el.find("[name="+a+"]");return"radio"===b.attr("type")&&(b=this.$el.find("[name="+a+"]:checked")),b},getFieldErrorMessages:function(a){return a.nextAll(".formErrorMessage")},getFieldLabels:function(a){var b=a.attr("id"),c=this.$el.find('label[for="'+b+'"]'),d=a.closest("label",this.$el);return c.add(d)},validateField:function(a,b){var c=a.attr("name");return this.validators[c].validate(b)},getValue:function(a){var b=this.getField(a);return"checkbox"===b.attr("type")?b.is(":checked"):b.val()},getSubmitButtons:function(){return this.$el.find(h)},disableSubmitButtons:function(){this.getSubmitButtons().prop(g,!0).addClass(g)},enableSubmitButtons:function(){this.getSubmitButtons().prop(g,!1).removeClass(g)},hasErrors:function(){return!(!_.find(this.errorFields,function(a){return a})&&!this.$el.find("."+c)[0])},setFieldErrors:function(a,b){this.clearFieldErrorMessages(a);var d=!!b[0];if(this.errorFields[a.attr("name")]=d,!this.prevalidating&&!this.hideErrors){var e=this.getFieldLabels(a),f=e.add(a);f.toggleClass(c,d),this.appendFieldErrorMessages(a,b)}},appendFieldErrorMessages:function(a,b){b&&b.length&&a.parent().children().last().after('<p class="formErrorMessage">'+b.join(" ")+"</p>")},clearFieldErrorMessages:function(a){var b=this.getFieldErrorMessages(a);b.remove()},enableFastValidateOnField:function(a){this.fastValidateFields[a]=1},onSubmit:function(a){a.preventDefault(),a.stopPropagation();var b=this;this.trigger("submitStarted",this.$el),this.validate(function(a,c){b.trigger(P.CONST.EVENT_SUBMIT_VALIDATED,a,c)})},onFieldValidated:function(a){var b=a.$el,c=a.errors;c[0]&&this.enableFastValidateOnField(b.attr("name")),this.setFieldErrors(b,c),this.hasErrors()?this.disableSubmitButtons():this.enableSubmitButtons()},onFieldKeyup:function(a){if(a.keyCode!==P.keyCode.TAB){var b=$(a.target);this.fastValidateFields[b.attr("name")]&&this.validateField(b)}},onFieldBlur:function(a){var b=this,c=$(a.target);_.delay(function(){b.validateField(c)},j)},onFieldChange:function(a){var b=$(a.target);this.validateField(b)},getData:function(){for(var a,b,c,d,e,f=this.$el.find("input,select,textarea"),g=f.length,h={},j=0;j<g;++j)a=$(f[j]),c=a.attr("name"),void 0===c||a.is(":disabled")||(b=a.attr("type"),_.contains(i,b)||"radio"===b&&!a.is(":checked")||(d="checkbox"===b?a.is(":checked"):a.val(),_.has(h,c)?(e=h[c],_.isArray(e)||(e=[e],h[c]=e),e.push(d)):h[c]=d));return h}}),P.Errors.wrap(P.Form.prototype,["onSubmit"])}(),function(){goog.provide("P.placeholder");var a=P.Logger.getLogger("Placeholder"),b="placeholder",c="placeholder",d="placeholder-visible";if(P.isPlaceholderSupported=b in document.createElement("input"),P.isPlaceholderSupported)jQuery.fn.placeholder=function(){return this};else{var e={initPlaceholder:function(){this.blur(e._onPlaceholderBlur),this.focus(e._onPlaceholderFocus),this.each(function(a,b){e._clearPlaceholder(b),e._setPlaceholder(b)})},_onPlaceholderBlur:function(){e._setPlaceholder(this)},_onPlaceholderFocus:function(){e._clearPlaceholder(this)},_setPlaceholder:function(a){var e=$(a),f=e.val();f||(a[d]=!0,e.addClass(c),a.value=e.attr(b))},_clearPlaceholder:function(a){var b=$(a);a&&a[d]&&(a[d]=!1,b.removeClass(c),a.value="")}};jQuery.fn.placeholder=function(){return e.initPlaceholder.apply(this),this};var f={get:function(a){var c=$(a),e=a[d];return e&&c.attr(b)===a.value?"":a.value},set:function(a,b){var c=$(a);return b&&a[d]?e._clearPlaceholder(a):b||e._setPlaceholder(a),a.value=b,e._setPlaceholder(a),c}};a.debug("Adding hooks on input and textarea for placeholders."),$.valHooks.input=f,$.valHooks.textarea=f,$(document).delegate("form","submit",function(){var a=$("input",this).each(e._clearPlaceholder);window.setTimeout(function(){a.each(e._setPlaceholder)},10)})}}(),function(){goog.provide("P.Module"),goog.require("P.errors"),goog.require("P.interfaces.IResource"),goog.require("P.ModuleRenderer"),goog.require("P.promise");var a=300,b="fadeIn",c="fadeOut",d=b+" "+c,e="loading",f=300,g="moduleMask",h="inModal",i="notNavigatable",j="savedScrollTop",k="data-element-type",l="data-component-type",m="data-aux",n=_.invert(P.CONST.ErrorStrategy),o=0,p=function(a,b,c){var d="other";this.object=a,this.event=b,this.fn=c,this.object instanceof P.Module?this.id=this.object.cid:(this.id=d+o,o+=1)};P.Module=function(){},P.Module=Backbone.View.extend({className:"Module",GACategory:null,moduleRenderer:new P.ModuleRendererRemote,constructor:function(a){Backbone.View.call(this,a),a&&(a.id&&(this.id=a.id),a.options&&this.setOptions(a.options),a.resource&&this.setResource(a.resource))},initialize:function(a){this.log=P.Logger.getLogger(this.className),this.id=null,this.cid=this.cid||"",this.options={},a&&a.options&&(this.options=a.options),this.resource=null,this.parent=null,this.children=[],this._childrenIdMap={},this._listeners={},this._pubsubHandlers={},this.inDom=!1,this.contentReady=!1,this._html=null,this._pendingRenderRequest=!1,this._pendingRenderAppendRequest=!1,this.extraState={},this._spinner=null,this._$mask=null,this.data=null,this.extraData=null,this.model=null,this.onCreated()},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=this.attributes||{};if(!a["class"]){var b=["Module"],c=this.className.replace(/\./g,"-");b.push(c),a["class"]=b.join(" ")}var d=$(document.createElement(this.tagName));d.attr(a),this.setElement(d,!1)}},setAsMainModule:function(a,b,c){return this.errorStrategy=P.CONST.ErrorStrategy.SHOW,this.hasSameOptions(a,b)&&this.contentReady&&!this._forceRefreshRequested(c)?P.Promise.resolve(null):(this.empty(),this._forceRefreshRequested(c)&&(this.extraState={}),this.setOptions(a),this.setResource(b),this.performTransition(c))},_forceRefreshRequested:function(a){return!!(a&&a.evt&&a.evt.data&&a.evt.data.forceRefresh)},performTransition:function(){return this.render()},setResource:function(a){(!a||_.isEqual(a,{}))&&(a=P.Resource.NOOP_RESOURCE),this.resource=P.resourceFactory.create(a.name,a.options)},setOptions:function(a){var b=this.options;this.options=a||{},this.onOptionsChanged(b,this.options)},setModal:function(a){this.$el.toggleClass(h,!!a),this.modal!==a&&(this.modal=a,a&&this.onAddedToModal(a))},prependChild:function(a){this.$el.prepend(a.$el),this.addChild(a,0)},appendChild:function(a){this.insertChild(a,this.$el)},insertChild:function(a,b,c,d){d?a.$el.insertAfter(d):a.$el.appendTo(b),this.addChild(a,c)},removeChild:function(a){if(a.parent===this){a.parent=null,this._removeListenersOnModule(a),this.children=_.filter(this.children,function(b){return a!==b}),a.id&&delete this._childrenIdMap[a.id];var b=a.getParentElement();a.detachElement(),a.onRemoved(),this.onChildRemoved(a,b)}},getChildByElement:function(a){var b=_.find(this.children,function(b){return b.$el.is(a)});return b},getChildByModuleName:function(a){var b=_.find(this.children,function(b){return b.className===a});return b},getChildrenByModuleName:function(a){var b=_.filter(this.children,function(b){return b.className===a});return b},getChildById:function(a){return this._childrenIdMap[a]},getHasError:function(){return!!this.error},removeChildById:function(a){var b=this.getChildById(a);b&&b.remove()},remove:function(){this.parent&&this.parent.removeChild(this)},detachElement:function(){this.remove(),this.$el.detach(),this.inDom&&this._setInDom(!1)},destroy:function(){this.triggerEvent(P.CONST.EVENT_DESTROYED),this.empty(),this.detachElement(),this._removeListeners(),this._subscribers&&_.each(this._subscribers,function(a){a.unsubscribe()}),this.undelegateEvents(),this.destroyed=!0,this.onDestroyed()},destroyIfEmpty:function(){return this.isEmpty()?(this.destroy(),!0):!1},empty:function(){for(this.$el.empty();this.children.length;)this.children[0].destroy();this.children=[],this._childrenIdMap={},this.contentReady=!1,this.onEmpty()},onEmpty:P.NOOP,onRendered:P.NOOP,onContentReady:P.NOOP,onAdded:P.NOOP,onRemoved:P.NOOP,onDestroyed:P.NOOP,onCreated:P.NOOP,onChildAdded:function(){},onChildRemoved:function(){},onChildRendered:P.NOOP,onAddedToDom:P.NOOP,onRemovedFromDom:P.NOOP,onPubSubMessage:function(){},onOptionsChanged:function(){},onAddedToModal:function(){},handleError:function(a){var b=this.getFullName();this.errorStrategy===P.CONST.ErrorStrategy.REMOVE?(this.log.warn("Removing module because of error."),this.destroy()):this.errorStrategy===P.CONST.ErrorStrategy.BUBBLE&&(this.log.warn("Bubbling up the error."),this.parent.handleError(a)),this.log.warn("Error in: "+b+"\nError Strategy: "+n[this.errorStrategy]+"\nStack Trace:"+a.stack_trace+"\nError Object: ",a),this.triggerEvent(P.CONST.EVENT_ERROR,a,this)},getSubscriber:function(a){if(this._subscribers||(this._subscribers={}),!this._subscribers[a]){var b=P.pubsub.createSubscriber(a,{handler:this._handlePubsub,scope:this,name:this.className});this._subscribers[a]=b}return this._subscribers[a]},pubsubSubscribe:function(a,b){var c=this.getSubscriber(a);c.subscribe.apply(c,_.keys(b)),this._pubsubHandlers[a]||(this._pubsubHandlers[a]={}),_.extend(this._pubsubHandlers[a],b)},pubsubUnsubscribe:function(a){var b=_.tail(_.toArray(arguments)),c=this.getSubscriber(a);c.unsubscribe.apply(c,b)},_handlePubsub:function(a,b,c){var d=(this._pubsubHandlers[a]||{})[b];d&&d.call(this,a,b,c),this.onPubSubMessage(a,b,c)},ensureAuthentication:function(){if(!P.currentUser.isAuthenticated()){var a={contextualResource:this.getContextualResource(),authRedirectUrl:this.getAuthRedirectUrl()};return this.triggerEvent(P.CONST.EVENT_REQUIRES_AUTHENTICATION,a,!0),!1}return!0},getAuthRedirectUrl:function(){return P.getRegisterUrl()},getContextualResource:function(){return null},getFullName:function(){for(var a=[this.toString(!0)],b=this;b.parent;)b=b.parent,a.unshift(b.toString());return a.join(">")},toString:function(a){var b=this.className,c=[];return a&&this.options&&c.push(P.toArgumentString(this.options)),this.resource&&"NoopResource"!==this.resource.name&&c.push("resource="+this.resource.toString()),b+"("+c.join(", ")+")"},getHeight:function(a){return a=a||!1,this.$el.outerHeight(a)},getWidth:function(a){return a=a||!1,this.$el.outerWidth(a)},getOffset:function(){return this.$el.offset()},getPosition:function(){return this.$el.position()},getParentElement:function(){return this.$el.parent()},getContent:function(){return this.$el},getScrollableElement:function(){return this.getScrollableElementForElement(this.$el)},getScrollableElementForElement:function(a){var b=this.getOwnedScrollables();if(b.length>0){var c=a;c=c.add(a.parentsUntil(this.$el)),c=c.add(this.$el);var d=c.filter(b);if(d.length>0)return d.last()}return this.parent?this.parent.getScrollableElementForElement(this.$el.parent()):$(window)},listen:function(a,b,c){var d=this,e=function(){c.apply(d,_.toArray(arguments))};a.on(b,e);var f=new p(a,b,e);return this._listeners[f.id]||(this._listeners[f.id]=[]),this._listeners[f.id].push(f),f},childListen:function(a,b){return this.listen(this,"child:"+a,b)},delegateEvents:function(){if(!this.__wrapEvents){this.events=this.events||{},this.events["click.logging"]="_logContextEvent",this.events["click.logging ["+k+"]"]="_logContextEvent",this.events["click a"]="_handleLinkClick";var a=this,b={};_.each(this.events,function(c,d){b[d]=_.isFunction(c)?P.Errors.wrapFn("eventFunction",c):P.Errors.wrapFn(c,function(){return P.state.activeTarget=a,a[c].apply(a,_.toArray(arguments))})}),this._wrappedLogContextEvent=this.events["click.logging"],this.events=b,this.__wrapEvents=!0}return this.$el.attr(k)||0===this.$el.attr(k)?this.events["click.logging"]=this._wrappedLogContextEvent:delete this.events["click.logging"],Backbone.View.prototype.delegateEvents.call(this)},navigate:function(a,b,c){var d={url:a,$el:b};if(c&&(d.forceRefresh=1),this.triggerEvent(P.CONST.EVENT_NAVIGATE,d,!0)){this.log.debug("Navigate event wasn't prevented. Navigating to:",a);var e=new P.navigateData.NavigateData;e.evt=new P.Event("",null,d),P.getHistoryNavigator().navigate(a,e)}},showInModal:function(a,b){var c={module:a,extraOptions:b};this.triggerEvent(P.CONST.EVENT_MODAL,c,!0)&&(this.log.debug("Modal event wasn't prevented. Telling modalManager to open:",a),P.getModalManager().showInModal(a,b||{},this))},removeListener:function(a){a.object.off(a.event,a.fn),this._listeners[a.id]=_.filter(this._listeners[a.id],function(b){return a!==b})},triggerEvent:function(a,b,c){var d=new P.Event(a,this,b);if(this.trigger(a,d),d.shouldPropagate()&&c){for(var e=new P.Event("child:"+a,this,b),f=this.parent;f&&e.shouldPropagate();)f.trigger.call(f,e.type,e),e.currentTarget=f,f=f.parent;return e.shouldPropagate()}return d.shouldPropagate()},_removeListenersOnModule:function(a){_.each(this._listeners[a.cid],function(a){a.object.off(a.event,a.fn)}),delete this._listeners[a.cid]},showLoading:function(a,b){if(a=!!a,b=b||this.$el,this.$el.addClass(e),null===this._spinner){var c=this.getLoadingSpinnerOptions();null===c||void 0!==c.enable&&!c.enable||(this._spinner=new P.Spinner(c),this._spinner.spin(b,this.getLoadingSpinnerClassName()))}a?this.showMask():this.hideMask()},hideLoading:function(){this.$el.removeClass(e),null!==this._spinner&&(this._spinner.stop(),this._spinner=null),this.hideMask()},isLoading:function(){return this.$el.hasClass(e)},showMask:function(){null===this._$mask&&(this._$mask=$("<div></div>").addClass(g).css({left:0,top:0,width:this.getWidth(),height:this.getHeight()}).prependTo(this.$el))},hideMask:function(){null!==this._$mask&&(this._$mask.remove(),this._$mask=null)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},fadeIn:function(d){this.$el.removeClass(c).addClass(b);var e=function(){d&&d()};P.setTimeout(e,a)},fadeOut:function(d){this.$el.removeClass(b).addClass(c);var e=function(){d&&d()};P.setTimeout(e,a)},clearFades:function(){this.$el.removeClass(d)},getLoadingSpinnerOptions:function(){return _.extend({enable:!0},this.options.spinner||{})},getLoadingSpinnerClassName:function(){return null},render:function(a,b){return this._renderInternal(!1).done(a).fail(b)},renderExistingData:function(){return this._renderInternal(!0)},_renderInternal:function(a){var b=this.getParentElement();return 0===b.length&&(b=$(document.body)),this._render(b,a)},renderAppend:function(a,b){var c=this;return!this.contentReady||this._pendingRenderRequest||this._pendingRenderAppendRequest||this.resource.atEnd()?!1:(this._fetch(!0,!1).done(function(){c._pendingRenderAppendRequest=!1,a&&a.call(c),c.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)}).fail(function(){c._pendingRenderAppendRequest=!1,b&&b.call(c),c.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)}).always(function(a,b){"abort"===b&&(c._pendingRenderAppendRequest=!1)}),this._pendingRenderAppendRequest=!0,!0)},renderAbort:function(){return this._pendingRenderRequest?(this.resource?this.resource.abort():this._pendingRenderRequest=!1,!0):!1},insertAfterModule:function(a,b){return a.insertAfter(b.$el),P.Promise.resolve(a)},appendToElement:function(a){return a.append(this.$el),P.Promise.resolve(a)},_render:function(a,b){if(this._pendingRenderRequest)return P.Promise.reject(new Error("render already in progress"));this._pendingRenderAppendRequest&&this.resource.abort();var c=this,d=P.setTimeout(function(){c.showLoading(),d=null},f,"_render Loading"),e=function(){d?clearTimeout(d):c.hideLoading()},g=function(){c.rendered=!0,c._pendingRenderRequest=!1,e(),c.onRendered(),c.parent&&c.parent.onChildRendered(c),c.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},h=function(){c._pendingRenderRequest=!1,e()},i=function(a,b){"abort"===b&&(c._pendingRenderRequest=!1,e())};this._pendingRenderRequest=!0;var j=this._fetch(!1,b).done(g).fail(h).always(i);return j},_fetch:function(a,b){var c=this;!a&&this.resource&&this.resource.resetBookmark();var d=new P.ModuleRenderOptions(this.className);if(d.setOptions(this.options),b){var e=this.model.toJSON();d.setData(e)}return d.setResource(this.resource),d.setAppend(a),d.setErrorStrategy(this.errorStrategy),this.moduleRenderer.render(d).then(function(b){return c.loadFromModuleTree(b,a)},function(b,d){var e=new $.Deferred;return d?c.loadFromModuleTree(d,a).always(function(){e.reject()}):(c.error=b,b.target=this,c.handleError(b),e.reject()),e.promise()})},loadFromModuleTree:function(a,b){var c=a.getTreeOuterHtml(),d=c?$(c):this.$el;if(d&&!b&&(this.contentReady=!1),a.id&&(this.id=a.id),a.data&&(this.data=a.data),a.extraData&&(this.extraData=a.extraData),a.options&&this.setOptions(a.options),!a.resource||a.error&&b||this.setResource(a.resource),this.data&&this.resource&&(P.resourceCache.instance.addDataToCache(this.data),this.model=P.resourceCache.instance.getModel(this.resource)),b)this.$el.append(d);else{var e=d.attr("id"),f=e&&!!document.getElementById(e),g=!this.inDom&&f;this.inDom=this.inDom||f,this._replaceElement(d),this.$el.removeAttr("id"),g&&this.onAddedToDom()}if(_.isUndefined(a.errorStrategy)||null===a.errorStrategy||(this.errorStrategy=a.errorStrategy),this.error=a.error,a.error)return a.error.target=this,this.handleError(a.error),P.Promise.resolve();if(a.async)return this.render(),P.Promise.resolve();var h=this,i=_.map(a.children,function(a){return P.moduleFactory.create(a,h.$el,h)});return i=i,P.Promise.all(i).then(function(){d&&!b&&(h.contentReady=!0,h.onContentReady())})},addChild:function(a,b){var c="undefined"===typeof b&&-1||b;a.parent!==this&&(a.parent&&a.remove(),a.parent=this,-1===c?this.children.push(a):this.children.splice(c,0,a),a.id&&(this._childrenIdMap[a.id]=a),a.onAdded(),this.onChildAdded(a,b),this.inDom&&a._setInDom(!0))},isEmpty:function(){return!$.trim(this.$el.html())&&!this.children.length},isInModal:function(){return!!this.modal},isElement:function(a){return this.$el.get(0)===$(a).get(0)},loadFromData:function(){this.log.error("override method loadFromData")},hasSameOptions:function(a,b){var c=this.hasSameModuleOptions(a),d=this.hasSameResourceOptions(b);return this.log.debug("has same options? ",c,this.options,a,d,!this.resource||this.resource.options,b),c&&d},hasSameModuleOptions:function(a){return a=a||{},_.isEqual(this.options,a)},hasSameResourceOptions:function(a){(!a||_.isEqual(a,{}))&&(a=P.Resource.NOOP_RESOURCE);var b=!this.resource&&_.isEqual(a,P.Resource.NOOP_RESOURCE);return b||this.resource&&this.resource.isEqual(a)},setChildId:function(a,b){a.parent===this&&(this.removeChildId(a),a.id=b,this._childrenIdMap[a.id]=a)},removeChildId:function(a){a.id&&a.parent===this&&(delete this._childrenIdMap[a.id],delete a.id)},getOwnedScrollables:function(){return $()},saveExtraState:function(a){if(a){var b=this.getScrollableElement().scrollTop();this.extraState={scrollableElementScrollTop:b}}this.getOwnedScrollables().each(function(a,b){var c=$(b),d=c.scrollTop();c.data(j,d)}),_.each(this.children,function(a){a.saveExtraState(!1)})},restoreExtraState:function(a){var b=this;if(a){var c=this.extraState.scrollableElementScrollTop||0;b.getScrollableElement().scrollTop(c)}var d=b.getOwnedScrollables();d.length&&P.deferDomManipulation(function(){d.each(function(a,b){var c=$(b),d=c.data(j);void 0!==d&&c.scrollTop(d)})}),_.each(this.children,function(a){a.restoreExtraState(!1)})},_setInDom:function(a){this.inDom!==a&&(this.inDom=a,a?this.onAddedToDom():this.onRemovedFromDom(),_.each(this.children,function(b){b._setInDom(a)}))},_replaceElement:function(a){a[0]!==this.$el[0]&&(this.empty(),this.undelegateEvents(),a.css({display:this.$el.css("display")}),a.insertBefore(this.$el),this.$el.remove(),this.$el=a,this.el=a[0],this.delegateEvents())},_removeListeners:function(){_.each(this._listeners,function(a){_.each(a,function(a){a.object.off(a.event,a.fn)})}),this._listeners={}},_handleLinkClick:function(a){this._logContextEvent(a);var b=$(a.currentTarget),c=$(a.target),d=b.attr("href"),e=!c.hasClass(i)&&!b.hasClass(i),f=b.hasClass("external"),g=c.attr("data-ga");if(g&&P.trackGAEvent(g,P.CONST.GA_ACTION_CLICK),!e)return!1;if(f)return P.changeWindowLocation(d,!0),this.triggerEvent(P.CONST.EVENT_EXTERNAL_CLICK,null,!0),!1;if(P.isOffsiteUrl(d)||!(a.which>1||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey)){var h=d&&d.length&&"#"!==d.charAt(0)&&!P.beginsWith(d,"javascript:")&&!P.beginsWith(d,"mailto:");return h?(this.navigate(d,c,!!b.attr("data-force-refresh")),!1):void 0}},_logContextEvent:function(a){if(!P.ContextLogger.getInstance().eventLogged(a)){var b=P.ContextLogging.EventType.CLICK,c=$(a.target).closest("["+k+"]",this.$el),d=c.parent().closest("["+l+"]");if(0!==c.length&&0!==d.length){var e=c.attr(m)||"{}",f=P.ContextEvent.fromEventType(b),g=parseInt(c.attr(k),10),h=parseInt(d.attr(l),10),i=JSON.parse(e);f.setElement(g),f.setComponent(h),f.updateAuxData(i);var j=this.getLoggingObjectIdStr();j&&f.setObjectIdStr(j),P.ContextLogger.getInstance().addEvent(f,a)}}},_logCustomContextEvent:function(a,b,c,d){var e=P.ContextEvent.fromEventType(a);e.setElement(b),e.setComponent(c),e.updateAuxData(d),P.ContextLogger.getInstance().addEvent(e,null)},getDebugInfo:function(){return this.className},getLoggingObjectIdStr:function(){return null}}),P.Errors.wrap(P.Module.prototype,["_build","loadFromModuleTree","render","renderAppend"]);var q=P.Module.extend;_.extend(P.Module,{extend:function(a,b){return a&&a.mixins&&_.extend.apply(_,[a].concat(a.mixins)),q.call(this,a,b)}})}(),function(){goog.provide("P.tutorialManager"),goog.require("P.event"),goog.require("P.interfaces.ModalTutorialStep"),goog.require("P.interfaces.TutorialStep");var a=P.Logger.getLogger("TutorialManager"),b=function(a,b){this.url=a,this.forceRefresh=!!b},c={yourBoards:{stepNames:["ModalSeeProfileIntro"],expiredSteps:{},canExit:!1,inModal:!0,nextUrlInfo:function(){return new b("/"+P.currentUser.get("username")+"/",!1)},onUserExit:P.NOOP},findFriends:{stepNames:["ModalFindFriendsIntro"],expiredSteps:{},nextUrlInfo:function(){return new b("/find_friends/",!1)},canExit:!1,inModal:!0,onUserExit:P.NOOP},fastFollowIntro:{stepNames:["ModalFastFollowIntro"],expiredSteps:{},nextUrlInfo:function(){return new b(null,!1)},canExit:!1,inModal:!0,onUserExit:P.NOOP},firstPinIntro:{stepNames:["ModalFirstPinIntro"],expiredSteps:{},canExit:!0,inModal:!0,nextUrlInfo:function(){return new b(null,!1)},onUserExit:P.NOOP},categorySearchIntro:{stepNames:["ModalCategorySearchIntro"],expiredSteps:{},canExit:!1,inModal:!0,nextUrlInfo:function(){return new b(null,!1)},onUserExit:P.NOOP},placePinsIntro:{stepNames:["ModalPlacePinsIntro"],expiredSteps:{},canExit:!0,inModal:!0,nextUrlInfo:function(){return new b(null,!1)},onUserExit:P.NOOP},emptyPlacesBoardIntro:{stepNames:["ModalPlacePinsAddEmpty","ModalPlacePinsSearch"],expiredSteps:{},canExit:!0,inModal:!0,nextUrlInfo:function(){return new b(null,!1)},onUserExit:P.NOOP},exploreButton:{stepNames:["ModalExploreButton"],expiredSteps:{},canExit:!0,inModal:!0,nextUrlInfo:function(){return new b(null,!1)},onUserExit:P.NOOP},explorePage:{stepNames:["ModalExplorePage","ModalExploreInterest","ModalExploreCheckBack"],expiredSteps:{},canExit:!1,inModal:!0,nextUrlInfo:function(){return new b(null,!1)},onUserExit:P.NOOP},filledPlacesBoardIntro:{stepNames:["ModalPlacePinsEdit","ModalPlacePinsShow","ModalPlacePinsAddFilled"],expiredSteps:{},canExit:!0,inModal:!0,nextUrlInfo:function(){return new b(null,!1)
},onUserExit:P.NOOP},newUserIgnitionSteps:{stepNames:["NewUserPin","NewUserPinSource","NewUserPinUsage","NewUserInterestSearch"],expiredSteps:{},canExit:!1,nextUrlInfo:function(){return new b("/?allow_nux=no",!0)},onUserExit:P.NOOP},newUserIgnitionPinCreate:{stepNames:["NewUserPin","NewUserPinSource","NewUserPinUsage","NewUserPinCreate"],expiredSteps:{},canExit:!1,nextUrlInfo:function(){return new b("/?allow_nux=no",!0)},onUserExit:P.NOOP},firstBoardIntro:{stepNames:["ModalFirstBoardIntro"],expiredSteps:{},canExit:!1,inModal:!0,nextUrlInfo:function(){return new b(null,!1)},onUserExit:P.NOOP},newUserWhitneyEd:{stepNames:["ModalNuxWelcome","ModalNuxDiscover","ModalNuxPin","ModalNuxBoard"],expiredSteps:{},canExit:!1,inModal:!0,nextUrlInfo:function(){return new b("/",!0)},onUserExit:P.NOOP}},d="tutorial",e="Tutorial";P.TutorialManager=function(){},P.TutorialManager.prototype={startTutorial:function(a,b){return b=b||{},this.moduleContainer=b.moduleContainer,this.renderModule=b.renderModule,this.progressModule=b.progressModule||this.progressModule,this._isActive?void(this.renderModule===!1||this.currentModule||this._loadModuleForStep(this.currentStep)):void this._start(a,!0)},stopTutorial:function(){this._isActive&&(this._isActive=!1,this.moduleContainer=null,this.renderModule=!1,this.progressModule=null,$("body").removeClass(this.tutorialClassName),this.tutorialName=null,this.tutorialClassName=null,this.tutorial=null,this.allStepNames=null,this.numTotalSteps=null,this.currentStep=null)},resumeTutorial:function(){if(!this._isActive){var a=this._getStoredData();a&&a.name&&this._start(a.name,!1)}},_start:function(a,b){var d=c[a];d&&(this._clear(b),this._isActive=!0,this.tutorialName=a,this.tutorialClassName=this.tutorialName+e,$("body").addClass(this.tutorialClassName),this.tutorial=d,this.expiredSteps=this.tutorial.expiredSteps,this.allStepNames=this.tutorial.stepNames,this.numTotalSteps=this.tutorial.stepNames.length,this._funnelPrefix="tutorial_"+a,this.renderModule=this.renderModule===!1?!1:!0,this.tutorial.inModal?(this._setupModal(),this._setStep(this._getStoredStep()||this.allStepNames[0])):(this.moduleContainer||!this.renderModule)&&this._setStep(this._getStoredStep()||this.allStepNames[0]),this.progressModule&&(this.progressModule.listen(this.progressModule,P.CONST.EVENT_NEXT,_.bindFn(this._next,this)),this.progressModule.listen(this.progressModule,P.CONST.EVENT_PREVIOUS,_.bindFn(this._previous,this))))},isTutorialActive:function(){return this._isActive},_setupModal:function(){var a=this,b={name:"Modal",options:{mask_type:"dark",can_dismiss:!1}};P.loadModule(b,function(b){a.modal=b,a.modal.render(),a.modal.childListen(P.CONST.EVENT_NEXT,_.bindFn(a._next,a)),a.modal.childListen(P.CONST.EVENT_PREVIOUS,_.bindFn(a._previous,a)),P.getModalManager().showModal(a.modal,null)})},_next:function(){var a=this._getStepIndex(this.currentStep);return this.currentStep===_.last(this.allStepNames)?void this._endTutorial(!0):void this._setStep(this.allStepNames[a+1])},_previous:function(){var b=this._getStepIndex(this.currentStep);return 0===b?(a.logToServer(P.Logger.SERVER_LOG_TYPE.LOG,"get",{type:"tutorial",tutorial:this.tutorialName,step:this.currentStep,step_number:b,action:"exit"}),this.tutorial.onUserExit(b),void this._endTutorial(!1)):void this._setStep(this.allStepNames[b-1])},_endTutorial:function(a){var b=this,c=function(){var c=b.tutorial.nextUrlInfo().url,d=b.tutorial.nextUrlInfo().forceRefresh;if(b._clear(!0),a&&c){var e=new P.navigateData.NavigateData;d&&(e.evt=new P.Event("",null,{forceRefresh:1})),P.getHistoryNavigator().navigate(c,e)}},d=function(){b.currentModule.onExit(function(){c()})},e=function(){b.currentModule?a?b.currentModule.completePlacedExperience(d):b.currentModule.dismissPlacedExperience(d):c()};this.progressModule?this.progressModule.onExit(function(){e()}):e(),P.trackRegisterAction(this._funnelPrefix+"_complete")},_setStep:function(b){if(P.trackRegisterAction(this._funnelPrefix+"_"+b),a.debug("set step from",this.currentStep,"to",b),b!==this.currentStep){_.contains(this.allStepNames,b)||this.expiredSteps[b]||this._endTutorial(!0),this.expiredSteps[b]&&(b=this.expiredSteps[b]),this.currentStep=b,this._saveCurrentStep();var c=this._getStepIndex(this.currentStep);if(this.progressModule&&(this.progressModule.progressBar.options.current_step=c+1,this.progressModule.progressBar.options.steps=this.numTotalSteps,this.progressModule.progressBar.render(),this.progressModule.nextStep(c+1)),!this.currentModule)return void(this.renderModule&&this._loadModuleForStep(this.currentStep));var d=this;this.currentModule.onExit(function(){d.currentModule.onRemoved(),d._loadModuleForStep(b)})}},_loadModuleForStep:function(a){var b=this,c={name:"tutorials."+a,options:{tutorial_name:this.tutorialName,current_step:this._getStepIndex(a),total_steps:this.numTotalSteps,can_exit:this.tutorial.canExit}};P.loadModule(c,function(a){var c=b.currentModule;b.currentModule=a,a=a,a.onEnter(function(){b.modal?a.render().then(function(){var d=b.modal;d.setModule(a),a=a,c&&c.destroy(),a.setModalPosition(),a.onShow()}):a.render(function(){var c=b.moduleContainer.children[0];b.moduleContainer.prependChild(a),c&&c.destroy(),a.onShow()})})})},_getStepIndex:function(a){var b=_.indexOf(this.allStepNames,a);return-1!==b?b:0},_getStoredStep:function(){var a=this._getStoredData();return a&&a.name!==this.tutorialName&&(this._clearStoredData(),a=null),a&&a.step||null},_getStoredData:function(){var a=P.SessionStorage.getItem(d);return a},_saveCurrentStep:function(){P.SessionStorage.setItem(d,{name:this.tutorialName,step:this.currentStep})},_clear:function(a){this.tutorial&&(this.stopTutorial(),this.modal&&this._destroyModal(),a&&this._clearStoredData())},_clearStoredData:function(){P.SessionStorage.removeItem(d)},_destroyModal:function(){this.modal.destroy(),this.modal=null}};var f=null;P.TutorialManager.instance=function(){return f||(f=new P.TutorialManager),f}}(),function(){goog.provide("P.modalManager"),goog.require("P.interfaces.IModalManager");var a=function(a){this._onModalDestroyed=_.bindFn(this._onModalDestroyed,this),this._onModalDismiss=_.bindFn(this._onModalDismiss,this),this._onKeyup=_.bindFn(this._onKeyup,this),this.$container=a||null,this.modals=[]};_.extend(a.prototype,{getContainer:function(){return this.$container||(this.$container=$("body")),this.$container},showModal:function(a,b){var c=this.getContainer();return this.modals.push(a),c.append(a.$el),a.moduleOpener=b,a._setInDom(!0),a.on(P.CONST.EVENT_DESTROYED,this._onModalDestroyed),a.on("child:"+P.CONST.EVENT_DISMISS,this._onModalDismiss),a.show(),1===this.modals.length&&this._addListeners(),a},hasModals:function(){return this.modals.length>=1},removeModal:function(a){a.destroy()},removeAllModals:function(a){_.each(this.modals,function(b){var c=b;(a||c.getCanDismiss())&&c.destroy()})},showInModal:function(a,b,c){var d={module:a};_.extend(d,b);var e=this,f={name:"Modal",options:d};P.loadModule(f,function(a){e.showModal(a,c)})},_onModalDismiss:function(a){var b=a.target.parent;this.removeModal(b)},_onModalDestroyed:function(a){var b=a.target;b.off(P.CONST.EVENT_DESTROYED,this._onModalDestroyed),b.off("child:"+P.CONST.EVENT_DISMISS,this._onModalDismiss),this.modals=_.filter(this.modals,function(a){return b!==a}),this.modals.length||this._removeListeners()},_addListeners:function(){$(document).on("keyup",this._onKeyup)},_removeListeners:function(){$(document).off("keyup",this._onKeyup)},removeTopModal:function(){if(this.hasModals()){var a=this.modals.pop();a.destroy()}},_onKeyup:function(a){a.keyCode===P.keyCode.ESCAPE&&this.removeTopModal()}}),P.setModalManager(new a)}(),function(){goog.provide("P.resourceResponse"),P.resourceResponse={fromPlainObject:function(a){var b=new P.ResourceResponse;b.client_context=a.client_context,b.page_info=a.page_info,b.request_identifier=a.request_identifier,b.resource_response.data=a.resource_response.data;var c=a.resource_response.error;b.resource_response.error=c?P.Error.fromPlainObject(c):null;var d=a.module;if(d){var e=P.ModuleTree.fromPlainObject(d.tree);e.setOuterHtml(d.html),b.moduleTree=e}return b}},P.ResourceResponse=function(){this.resource_response={data:null,error:null},this.client_context=null,this.moduleTree=null,this.page_info=null,this.request_identifier=""}}(),function(){goog.provide("P.resource"),goog.require("P.interfaces.IResource"),goog.require("P.logger"),goog.require("P.resourceFactory"),goog.require("P.resourceResponse");var a=P.Logger.getLogger("Resource"),b="-end-",c={BoardEdit:!0,PinEdit:!0};P.Resource=function(a,b){this.name=a,this.options=b||{}},_.extend(P.Resource.prototype,{getName:function(){return this.name},setOptions:function(a){this.options=a},set:function(a,b){this.options[a]=b},get:function(a){return this.options[a]||null},copyOptions:function(a){var b=_.clone(this.options);return b&&a&&delete b.bookmarks,b},callGet:function(a,b){return this.call("get",a,b)},callCreate:function(a){return this.call("create",a)},callUpdate:function(a){return this.call("update",a)},callDelete:function(a){return this.call("delete",a)},_isUrlShortEnoughForHttpGet:function(a,b){var c=a+"?"+$.param(b);return c.length<=2e3},call:function(a,b,c){var d=this,e=b&&void 0!==b.async?b.async:!0,f=b&&b.timeout||null,g=this._call(a,e,f,c);g.done(function(a){d.onResponseSuccess(a)}),g.fail(function(a){d.onResponseError(a)}),b&&b.success&&g.done(b.success);var h=b&&b.error?b.error:function(a){P.showError(a.message)};return g.fail(h),b&&b.complete&&g.always(b.complete),g},_call:function(b,d,e,f){var g=this,h=new $.Deferred;this.xhr&&this.xhr.abort();var i,j={options:this.options,context:P.CONTEXT};if(i="/resource/"+this.name+"/"+b+"/",f){if(P.currentUser.get("autologin")&&c[f.name]){var k=P.getLoginUrl({next:f.options.next_url});return P.getHistoryNavigator().navigate(k),h.promise()}j.module={name:f.name,options:f.options},j.append=f.append,j.error_strategy=f.errorStrategy}var l={source_url:P.getCurrentUrl(),data:JSON.stringify(j)};P.state.activeTarget&&(l.module_path=P.state.activeTarget.getFullName());var m="get"===b&&this._isUrlShortEnoughForHttpGet(i,l);return this.xhr=$.ajax({cache:!1,url:i,async:d,data:l,dataType:"json",timeout:e,type:m?"get":"post",complete:function(b,c){if("abort"===c)return void h.reject(new Error("aborted"));if(0===b.status)return void h.reject(new Error("Connectivity error or cancelled by navigation"));var d=null,e=null;try{var f=JSON.parse(b.responseText);if(!(f instanceof Object))throw Error("JSON.parse did not return an object");d=P.resourceResponse.fromPlainObject(f),e=d.resource_response.error;var j=!!b.getResponseHeader("X-Pinterest-New-Version");j&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_APP_VERSION_AVAILABLE)}catch(k){e=new P.Error,e.message=P.string.common.defaultErrorMessage,e.http_status=b.status,a.error("Failed to parse resource response JSON.  HTTP status: "+b.status,{format:"sentry",js_exception_message:k.message,resource_name:g.name,response_headers:b.getAllResponseHeaders(),http_status:b.status,text_status:c,respose_text:b.responseText})}if(e&&403===e.http_status&&!P.currentUser.isAuthenticated())return void(window.location.href="/login/");if(e&&401===e.http_status&&1001===e.api_error_code){var l=P.getLoginUrl();return void P.changeWindowLocation(l,!1)}e?d&&d.moduleTree?h.resolve(d):h.reject(e):d?h.resolve(d):a.error("no error and no resource response",{status:b.status,textStatus:c,xhrUrl:i}),g.xhr=null}}),h.promise()},abort:function(){this.xhr&&this.xhr.abort()},resetBookmark:function(){this.options&&delete this.options.bookmarks},atEnd:function(){var a=this.options.bookmarks;return a&&_.last(a)===b},onResponseSuccess:function(a){if(a.client_context){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_APP_VERSION,a.client_context.app_version);var b=a.client_context.event_log_info;b&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CONTEXT_LOGGING,P.CONST.PUBSUB_TOPIC_CONTEXT_LOG_PLAIN_OBJECT,b);var c=a.client_context.placed_experiences;c&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_PLACED_EXPERIENCES_FROM_SERVER,c)}P.CONTEXT=a.client_context,a.page_info&&(a.page_info.title||_.keys(a.page_info.meta).length)&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_PAGE_INFO,a.page_info),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_REQUEST,P.CONST.PUBSUB_TOPIC_REQUEST_IDENTIFIER,a.request_identifier)},onResponseError:function(b){a.warn("Request error for "+this.name,b,b.stack_trace)},isEqual:function(a){if(this.name!==a.name)return!1;var b=_.omit(this.options,"bookmarks"),c=_.omit(a.options,"bookmarks");return _.isEqual(b,c)},toString:function(){var a=_.omit(this.options,"bookmarks","field_set_key");return this.name+"("+P.toArgumentString(a)+")"},isCalling:function(){return!!this.xhr}}),P.Resource.NOOP_RESOURCE={name:"NoopResource",options:{}},P.resourceFactory.setDefaultConstructorFn(P.Resource),P.logFrontEndEvent=function(a){var b=P.resourceFactory.create("IncrementEventResource",{event:a});b.callCreate({error:P.NOOP})}}(),function(){goog.provide("P.safeLink");var a="offsite_",b="-";P.SafeLink={open:function(c,d){var e=Math.round(1e3*Math.random())+"",f=Math.round(1e3*Math.random())+"";Cookie.set(a+e,f);var g={token:e+b+f,url:c};d&&(g.pin=d),P.changeWindowLocation("/offsite/?"+$.param(g),!0)}}}(),function(){goog.provide("P.socialConnect"),P.SocialConnect=function(){};var a;_.extend(P.SocialConnect.prototype,Backbone.Events),_.extend(P.SocialConnect.prototype,{connect:function(a,b){b=_.extend({},{success:P.NOOP,error:P.NOOP,complete:P.NOOP},b);var c=null,d=null;a===P.SocialConnect.RAKUTEN&&(c=800,d=600);var e,f=P.FacebookDialog.getWindowOptions(c,d);if(e=window.open("/connect/"+a+"/","",f),!e)return void P.showError(P._("You must enable popups!"));var g=this,h=P.setInterval(function(){e.closed&&(clearInterval(h),g.handleComplete({network:a,error_message:"Window closed."}))},1e3);this.once("connect:"+a,function(a){clearInterval(h),a.error_message?b.error(a):b.success(a),b.complete()})},complete:function(a){var b=JSON.parse(a);this.handleComplete(b)},handleComplete:function(a){var b="connect:"+a.network;this.trigger(b,a)}}),_.extend(P.SocialConnect,{instance:function(){return a||(a=new P.SocialConnect),a},FACEBOOK:"facebook",TWITTER:"twitter",GOOGLE:"google",GPLUS:"gplus",YAHOO:"yahoo",RAKUTEN:"rakuten"})}(),function(){goog.provide("P.facebookDialog");var a=20;P.FacebookDialog={open:function(a){var b=_.pick(a,P.FacebookDialog._validParams),c=P.FacebookDialog._getDialogType(a),d=P.FacebookDialog.generateFbRef(),e=a.object_type&&a.object_id&&"feed"===c;b.method=c,b.link=P.absolutify(a.path),e&&(b.link+="?"+$.param({fb_ref:d})),P.fb.ensureInit(function(c){c.getLoginStatus(function(){c.ui(b,function(b){if(e&&b&&b.post_id){var c=P.resourceFactory.create("LogFacebookFeedShare",{});c.options={object_type:a.object_type,object_id:a.object_id,fb_ref:d},c.callCreate({error:P.NOOP})}a.callback&&a.callback(b)})})})},_validParams:["description","name","picture","to"],_validOptions:["send","feed"],generateFbRef:function(){for(var b="";b.length<a;)b+=Math.floor(65535*Math.random()).toString(16);return P.currentUser.id+":"+b},_getDialogType:function(a){var b=_.contains(P.FacebookDialog._validOptions,a.type),c=b?a.type:"feed";return c},getWindowOptions:function(a,b){var c=a?a:580,d=b?b:400,e=screen.width,f=screen.height,g=Math.round((e-c)/2),h=f>d?Math.round((f-d)/2):0;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+c+",height="+d+",left="+g+",top="+h}}}(),function(){goog.provide("P.lruCache");var a=10,b=function(a,b){this.uid=a,this.item=b,this.next=null,this.prev=null};P.LruCache=function(b){this._maxNumItems=b||a,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null},P.LruCache.prototype.set=function(a,c){var d=this._uidToData[a];d||(d=new b(a,c),this._uidToData[a]=d,this._numItems+=1),this._moveToFront(d),this._numItems>this._maxNumItems&&this._evict()},P.LruCache.prototype.get=function(a){var b=this._uidToData[a];return b?(this._moveToFront(b),b.item):null},P.LruCache.prototype.remove=function(a){var b=this._uidToData[a];b&&(delete this._uidToData[a],this._firstData===b&&(this._firstData=b.next),this._lastData===b&&(this._lastData=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),this._numItems-=1)},P.LruCache.prototype._moveToFront=function(a){this._firstData!==a&&(this._firstData?(this._lastData===a&&(this._lastData=a.prev),a.prev&&(a.prev.next=a.next),a.next&&(a.next.prev=a.prev),this._firstData.prev=a,a.next=this._firstData,a.prev=null,this._firstData=a):(this._firstData=a,this._lastData=a))},P.LruCache.prototype._evict=function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1}}(),function(){goog.provide("P.set"),P.Set=function(){this.items={}},P.Set.prototype.add=function(a){this.items[a]=!0},P.Set.prototype.remove=function(a){delete this.items[a]},P.Set.prototype.contains=function(a){return Object.prototype.hasOwnProperty.call(this.items,a)}}(),function(){goog.provide("P.modelManager"),goog.require("P.lruCache"),P.modelManager.EntityType={PIN:"pin"},P.modelManager.EntityDict,P.modelManager.EntityId,P.modelManager.CACHE_FOR_TYPE_SIZE=1e3,P.modelManager.CacheForType=function(a){this.cache=new P.LruCache(P.modelManager.CACHE_FOR_TYPE_SIZE),this._entityType=a},P.modelManager.CacheForType.prototype.getModel=function(a){var b=this.cache.get(a);return b||null},P.modelManager.CacheForType.prototype.addEntityDict=function(a){if(a.type!==this._entityType)throw new Error("invalid entityDict type");var b=a.id,c=this.cache.get(b);c||(c=new Backbone.Model,this.cache.set(b,c)),c.set(a)},P.modelManager.ModelManager=function(){var a=this;this.entityTypeToCache={},_.each(P.modelManager.EntityType,function(b){a.entityTypeToCache[b]=new P.modelManager.CacheForType(b)})},P.modelManager.ModelManager.prototype.getModel=function(a,b){var c=this.entityTypeToCache[a];return c?c.getModel(b):null},P.modelManager.ModelManager.prototype.add=function(a){var b=this;if(a instanceof Array)_.each(a,function(a){b._addEntity(a)});else if(a instanceof Object){var c=a;b._addEntity(c)}},P.modelManager.ModelManager.prototype._addEntity=function(a){var b=a.type;if(b){var c=b,d=this.entityTypeToCache[c];d&&d.addEntityDict(a)}},P.modelManager.instance=new P.modelManager.ModelManager}(),function(){goog.provide("P.resourceCache"),goog.require("P.modelManager"),P.resourceCache={},P.resourceCache.IResourceCacheStrategy=function(){},P.resourceCache.IResourceCacheStrategy.prototype.getModel=function(){},P.resourceCache.IResourceCacheStrategy.prototype.getCachedData=function(){},P.resourceCache.IResourceCacheStrategy.prototype.setCachedData=function(){},P.resourceCache.ResourceCacheStrategyEntity=function(a){this._entityType=a},P.resourceCache.ResourceCacheStrategyEntity.prototype.getModel=function(a,b){var c=a.options.id;if(c){var d=b.getModel(this._entityType,c);return d}return null},P.resourceCache.ResourceCacheStrategyEntity.prototype.getCachedData=function(a,b){var c=this.getModel(a,b);return c?c.toJSON():null},P.resourceCache.ResourceCacheStrategyEntity.prototype.setCachedData=function(a,b,c){b.add(c)},P.resourceCache.ResourceCache=function(a){this._modelManager=a},P.resourceCache.ResourceCache.prototype.getData=function(a){var b=this,c=this._resourceCacheStrategies[a.name],d=null;if(c){var e=c.getCachedData(a,this._modelManager);e&&(d=P.Promise.resolve(e))}var f=a.callGet().then(function(d){var e=d.resource_response.data;return c&&null!=e&&c.setCachedData(a,b._modelManager,e),e});return d||f},P.resourceCache.ResourceCache.prototype.getModel=function(a){var b=this._resourceCacheStrategies[a.name];return b?b.getModel(a,this._modelManager):null},P.resourceCache.ResourceCache.prototype.addDataToCache=function(a){this._modelManager.add(a)},P.resourceCache.ResourceCache.prototype._resourceCacheStrategies={PinResource:new P.resourceCache.ResourceCacheStrategyEntity(P.modelManager.EntityType.PIN)},P.resourceCache.instance=new P.resourceCache.ResourceCache(P.modelManager.instance)}(),function(){goog.provide("P.typeaheadProvider");var a=5;P.TypeaheadProvider=function(b){b=b||{},this.tags=b.tags,this.enable_recent_queries=!!b.enable_recent_queries,this.minimum_term_character_length=b.minimum_term_character_length||0,this.remove_lru_cache=b.remove_lru_cache;var c={tags:b.tags,pin:b.pin_id},d=b.num_places;d?c.num_places=d:c.count="count"in b?b.count:a,b.exclude_non_followers&&(c.exclude_non_followers=!0);var e="TypeaheadResource";P.experiments.instance.inExperimentGroupActiveOrTriggerable("search_autocomplete","enabled")&&(e=b.resource_name||e),this.searchResource=P.resourceFactory.create(e,c),this.itemsCache=new P.LruCache},_.extend(P.TypeaheadProvider.prototype,Backbone.Events),_.extend(P.TypeaheadProvider.prototype,{search:function(a,b){var c;if(a=$.trim(a),!a&&"userSelect"===this.tags)return this.abortSearch(),this.publishData(a,[],b);if(!a&&this.enable_recent_queries&&P.currentUser&&P.currentUser.isAuthenticated())c="recent_search";else{var d=this.remove_lru_cache?[]:this.itemsCache.get(a);if(d&&d.length)return this.abortSearch(),void this.publishData(a,d,b)}a.length>=this.minimum_term_character_length?this.fetch(a,c,b):this.publishData(a,[],b)},getResource:function(){return this.searchResource},abortSearch:function(){this.getResource().abort()},publishData:function(a,b,c){var d={term:a,items:b};this.trigger(P.CONST.EVENT_DATA,d),c&&c(d)},setAutocompleteScope:function(a){this.getResource().set("autocompleteScope",a)},fetch:function(a,b,c){var d=this.getResource();if(d.isCalling()){var e=d.get("term");if(a===e)return;this.abortSearch()}var f=this;this.trigger(P.CONST.EVENT_TYPEAHEAD_SEARCH_START,a),d.set("term",a),d.set("tags",b||this.tags),d.resetBookmark(),d.callGet({success:function(b){var d=b.resource_response.data;f.cacheData(a,d),f.publishData(a,d,c)},error:function(a){f.trigger("fetchError",a)}}),this.warm=!0},removeCacheForTerm:function(a){this.itemsCache.remove(a)},cacheData:function(a,b){this.itemsCache.set(a,b)},prefetch:function(){if(!this.warm){var a=P.resourceFactory.create("TypeaheadPrepareResource");a.callGet({success:P.NOOP,error:P.NOOP}),this.warm=!0}}})}(),function(){goog.provide("P.invite"),P.Invite={_logInvites:function(a){var b={invite_id:null,invite_code:null,invite_metadata:{invite_type:a,to_follow:[P.currentUser.id]}},c={topic:"sent_invites",content:b},d=P.resourceFactory.create("EventLoggingResource",c);d.callCreate({error:P.NOOP})},trackInvite:function(a,b){b?P.trackGACategoryEvent("user_invite",a,P.CONST.GA_ACTION_SUCCESS):P.trackGACategoryEvent("user_invite",a,P.CONST.GA_ACTION_ERROR),"gplus"===a&&P.Invite._logInvites(a)},_inviteFacebookUserId:function(a){var b=P.resourceFactory.create("FacebookInviteCreateResource",{type:"facebook",facebook_id:a});return b.callCreate()},_showFacebookDialog:function(a,b){P.Invite._inviteFacebookUserId(a.id).done(function(c){var d=c.resource_response.data,e=d.url,f=d.invite_code;P.FacebookDialog.open({type:"send",name:"name",path:e,to:a.id,picture:a.photo_url,callback:function(a){if(a&&a.success){P.Invite.trackInvite("facebook",!0);var c=P.resourceFactory.create("FacebookInviteSentResource",{invite_code:f});c.callCreate()}b&&b(a&&a.success)}}),P.trackGACategoryEvent("user_invite","facebook",P.CONST.GA_ACTION_OPEN_MODAL)}).fail(function(){P.Invite.trackInvite("facebook",!1)})},userInviteFacebook:function(a,b){P.fb.ensureLoggedIn(function(){P.Invite._showFacebookDialog(a,b)})},userInviteEmail:function(a,b){var c=P.resourceFactory.create("EmailInviteSentResource",{email:a,type:"email"});c.callCreate().done(function(){P.Invite.trackInvite("email",!0),b&&b(!0)}).fail(function(){P.Invite.trackInvite("email",!1),b&&b(!1)})}}}(),function(){goog.provide("P.userRegistration"),goog.require("P.fb");var a=P.Logger.getLogger("UserRegistration");P.UserRegistration={fastTrackSocialRegistration:function(a,b){var c=P.UserRegistration,d=new $.Deferred;if(a===P.SocialConnect.FACEBOOK)d=c.fetchNetworkData(a).then(function(a){return c.sendImmediateFbRegisterRequest(a,b)});else if(a===P.SocialConnect.RAKUTEN){var e={rakuten_id:P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_ID),rakuten_token:P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_TOKEN),rakuten_refresh_token:P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_REFRESH_TOKEN),first_name:P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_FIRST_NAME),email:P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_EMAIL),gender:P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_GENDER),country:null};return c.register(P.SocialConnect.RAKUTEN,e)}return d},sendImmediateFbRegisterRequest:function(a,b){var c=P.UserRegistration,d={first_name:a.first_name,last_name:a.last_name,email:a.email,gender:a.gender,social_username:a.username,image_url:a.image_url,facebook_id:a.id,facebook_token:a.access_token,country:null};return b&&_.extend(d,b),c.addExtraSocialParams(P.SocialConnect.FACEBOOK,d).then(function(){return c.register(P.SocialConnect.FACEBOOK,d)})},addExtraSocialParams:function(b,c){var d=P.SessionStorage.getItem(P.CONST.SESSION_FACEBOOK_ID),e=P.SessionStorage.getItem(P.CONST.SESSION_FACEBOOK_TOKEN),f=new $.Deferred;d&&(c.facebook_id||(c.facebook_id=d),P.SessionStorage.removeItem(P.CONST.SESSION_FACEBOOK_ID)),e&&(c.facebook_token||(c.facebook_token=e),P.SessionStorage.removeItem(P.CONST.SESSION_FACEBOOK_TOKEN));var g=P.SessionStorage.getItem(P.CONST.SESSION_KEY_INVITE_FOLLOW);return g&&(g.invite_follow_board&&(c.board_to_follow=g.invite_follow_board),g.invite_follow_user&&(c.user_to_follow=g.invite_follow_user)),b!==P.SocialConnect.FACEBOOK||c.facebook_token?f.resolve():(a.error("facebook token wasn't set"),P.fb.ensureInit(function(a){c.facebook_token=a.getAuthResponse().accessToken,f.resolve()})),f.promise()},fetchNetworkData:function(a){var b=new $.Deferred;return a===P.SocialConnect.FACEBOOK?(P.trackRegisterAction("register_facebook"),P.fb.ensureInit(function(a){a.getLoginStatus(function(c){if(c.authResponse){var d=["picture.type(large)","id","first_name","last_name","email","username","gender"],e="/me?fields="+d.join(",");a.api(e,function(a){a&&!a.error?(a.picture&&a.picture.data&&a.picture.data.url&&!a.picture.data.is_silhouette&&(a.image_url=a.picture.data.url),b.resolve(a)):b.reject("FB.api errored: "+a.error)})}else b.reject("not authed")},!0)})):b.reject("Unsupported social network: "+a),b.promise()},register:function(b,c){var d=P.UserRegistration.getResource(c),e=function(a,b){var c=b||"nonetwork";window.optimizely=window.optimizely||[],window.optimizely.push(["trackEvent",a]),window.optimizely.push(["trackEvent",c+a])};return e("SignupInit",b),d.callCreate({success:function(c){P.trackGAEvent("user_signup",P.CONST.GA_ACTION_SUCCESS),e("SignupSuccess",b),P.SessionStorage.removeItem(P.CONST.SESSION_KEY_INVITE_FOLLOW),a.debug("Login, successful",c),Cookie.set(P.CONST.COOKIE_USER_JUST_REGISTERED,"1")},error:function(a){P.trackGAEvent("user_signup",P.CONST.GA_ACTION_ERROR),e("SignupFail",b),a.api_error_code===P.CONST.API_ERROR_UNDERAGE_REGISTER_ATTEMPT?(Cookie.set(P.CONST.COOKIE_REGISTER_RESTRICT,"1"),Cookie.set(P.CONST.COOKIE_PERSONALIZE_FROM_OFFSITE_BROWSING_COOKIE_NAME,"disabled")):P.showError(a.message)}})},getResource:function(a){return P.resourceFactory.create("UserRegisterResource",a)},showSignupModal:function(a,b){var c={name:"reg.ContextualSignup",options:b||{}};a&&(c.resource=a),P.loadModule(c,function(a){P.getModalManager().showInModal(a,{mask_type:"dark"})})}}}(),function(){goog.provide("P.preventScroll"),function(){P.Mixins.PreventScroll={startPreventScroll:function(a,b){this.stopPreventScroll(),this._preventScrollListener=this.listen(a,"mousewheel",function(c){var d=c.originalEvent.wheelDeltaY<0?"down":"up",e=a.scrollTop();if("down"===d){var f=a.outerHeight()+e;f>=b.outerHeight()&&c.preventDefault()}else 0===e&&c.preventDefault()})},stopPreventScroll:function(){this._preventScrollListener&&(this.removeListener(this._preventScrollListener),this._preventScrollListener=null)}}}()}(),function(){goog.provide("P.navigateData.NavigateData"),goog.require("P.Module"),P.navigateData.NavigateData=function(){this.evt=null,this.handled=!1,this.reuseLast=!1,this.fromHistoryUid=null,this.fromNavigate=!1,this.currentModule=null}}(),function(){goog.provide("P.positioning"),P.Positioning={positionElementAtAnchor:function(a,b,c,d,e){var f=P.CONST.PositionPointFlag,g=b.offset(),h=a.outerWidth(),i=b.outerWidth();if(g){var j=0,k=0;if(c&f.FLAG_VERTICAL_BOTTOM||c&f.FLAG_VERTICAL_TOP?(j=c&f.FLAG_VERTICAL_BOTTOM?g.top+b.outerHeight():g.top-a.outerHeight(),k=c&f.FLAG_VERTICAL_LEFT?g.left:c&f.FLAG_VERTICAL_RIGHT?g.left+i-h:g.left+(i-h)/2):(c&f.FLAG_HORIZONTAL_LEFT||c&f.FLAG_HORIZONTAL_RIGHT)&&(k=c&f.FLAG_HORIZONTAL_LEFT?g.left-h:g.left+i,j=c&f.FLAG_HORIZONTAL_TOP?g.top:c&f.FLAG_HORIZONTAL_BOTTOM?g.top+b.outerHeight()-a.outerHeight():g.top+(b.outerHeight()-a.outerHeight())/2),d){var l=j-$(window).scrollTop();l>0&&(j=l)}a.hasClass("gridShare")&&a.hasClass("inCloseup")&&a.parents(".canClose").length&&(j+=$(".Closeup").scrollTop(),j-=$(window).scrollTop());var m={left:k,top:j};return e&&(m=P.Positioning.checkIfInViewportAndAdjustAccordingly(a,m,c)),a.css(m),c}},checkIfInViewportAndAdjustAccordingly:function(a,b){var c,d,e=a.width(),f=b.left,g=b.top,h=f+e,i=7;h>P.Viewport.width?c=f-(h-P.Viewport.width+i):f<i&&(c=i);var j={};return j.left=c?c:f,j.top=d?d:g,j}}}(),function(){goog.provide("P.browserHistory"),P.BrowserHistory=function(a){this._onRemoved=a,this._uidToData={},this._views=[],this._currentIndex=-1},_.extend(P.BrowserHistory.prototype,{add:function(a){var b=this.getCurrentUid(),c=void 0===this._uidToData[b],d=c&&null!==b;b=null!==b?b:this._getNewUid(),c?(d||(this._removeViewsAfter(this._currentIndex),this._saveState(b)),this._insert(b)):this._currentIndex=this._views.indexOf(b),this._uidToData[b]=a},_insert:function(a){var b=this._views.length;if(0===b||a>this._views[b-1])return this._views.push(a),void(this._currentIndex=b);for(var c=0;c<b;c++){var d=this._views[c];if(a<d){this._views.splice(c,0,a),this._currentIndex=c;break}if(a===d){this._currentIndex=c,this.log.error("Duplicate uid in browser history.");break}}},_removeViewsAfter:function(a){a<0&&(a=-1);var b=this,c=this._views.slice(a+1);_.each(c,function(a){var c=b._uidToData[a];b._onRemoved&&b._onRemoved(c),delete b._uidToData[a]}),this._views=this._views.slice(0,a+1)},_saveState:function(a){window.history.replaceState({uid:a},document.title,window.location.href)},getCurrentUid:function(){var a=window.history.state&&void 0!==window.history.state.uid?window.history.state.uid:null;return a},_getNewUid:function(){return window.history.length},getCurrent:function(){return this._uidToData[this.getCurrentUid()]},get:function(a){return this._uidToData[a]}})}(),function(){goog.provide("P.simpleBrowserHistory"),P.SimpleBrowserHistory=function(){this._uidToData={}},_.extend(P.SimpleBrowserHistory.prototype,{add:function(a){var b=this.getCurrentUid();b=null!==b?b:this._getNewUid(),this._uidToData[b]=a},getCurrentUid:function(){return window.location.href},_getNewUid:function(){return window.location.href},getCurrent:function(){return this._uidToData[this.getCurrentUid()]},get:function(a){return this._uidToData[a]}})}(),function(){goog.provide("P.HistoryManager"),goog.require("P.navigateData.NavigateData");var a=10,b=function(a,b,c){this.url=a,this.moduleUid=b,this.backgroundModuleUid=c||null,this.numHopsToBackground=0},c=function(a,b){this.module=a,this.backgroundModule=b||null},d=function(){this._browserHistory=null,this._seenModules=null,this._pageInfoCache={},this._init()};_.extend(d.prototype,{start:function(a){this._init(),a&&(a.uid=this._getNewUid(a),this._addToHistory(a,null))},_init:function(){this._seenModules=new P.LruCache(a),this._browserHistory=new P.SimpleBrowserHistory},navigate:function(a,b){b.fromHistoryUid=this._browserHistory.getCurrentUid(),b.reuseLast=!!b.handled,P.navigate(a,b,{})
},getModule:function(a,b){var d=null,e=null,f=null,g=null;return g=b.reuseLast?this._browserHistory.get(b.fromHistoryUid):this._browserHistory.getCurrent(),g&&(d=this._seenModules.get(g.moduleUid),f=g.moduleUid,e=this._seenModules.get(g.backgroundModuleUid)),d||(d=new a,f=null!==f?f:this._getNewUid(d),d.uid=f),this._addToHistory(d,e),new c(d,e)},updateBackgroundModule:function(a,b){var c=this._browserHistory.getCurrent(),d=this._browserHistory.get(b.fromHistoryUid);a?(c.backgroundModuleUid=a.uid,this._seenModules.set(a.uid,a),b.fromNavigate&&d&&(c.numHopsToBackground=d.numHopsToBackground+1)):(c.backgroundModuleUid=null,c.numHopsToBackground=0)},cancelNavigation:function(){var a=this._browserHistory.getCurrent();this._seenModules.remove(a.moduleUid),this._go(-1)},closeCurrentModule:function(){var a=this._browserHistory.getCurrent();a&&0!==a.numHopsToBackground&&this._go(-a.numHopsToBackground)},setPageInfo:function(a){var b=this._getUrl();this._pageInfoCache[b]=a},getPageInfo:function(a){return a=a||this._getUrl(),this._pageInfoCache[a]},_go:function(a){window.history.go(a)},_getUrl:function(){return window.location.href},_getNewUid:function(a){return a.cid},_addToHistory:function(a,c){var d=this._getUrl(),e=c?c.uid:null,f=this._browserHistory.getCurrent();f||(f=new b(d,a.uid,e)),this._browserHistory.add(f),this._seenModules.set(a.uid,a),c&&this._seenModules.set(e,c)}});var e=function(){this._pageInfoCache={}};_.extend(e.prototype,{start:P.NOOP,navigate:function(a,b){P.navigate(a,b,{})},getModule:function(a){return[new a({}),[]]},updateBackgroundModule:P.NOOP,cancelNavigation:P.NOOP,closeCurrentModule:P.NOOP,setPageInfo:function(a){var b=this._getUrl();this._pageInfoCache[b]=a},getPageInfo:function(a){return a=a||this._getUrl(),this._pageInfoCache[a]},_getUrl:function(){return window.location.href}}),P.HistoryManager=P.useHistory()?d:e,Pc.TEST_MODE&&(P.PushStateHistoryManager=d,P.NoPushStateHistoryManager=e,P.HistoryRecord=b)}(),goog.provide("P.experienceManager"),goog.require("P.Experiences"),goog.require("P.logger"),goog.require("P.resourceFactory"),goog.require("P.set");var logger=P.Logger.getLogger("ExperienceManager"),PlacedExperience,PlacedExperiences;P.ExperienceManager=function(a){this._placedExperiences=a,this._triggered=new P.Set},P.ExperienceManager.prototype={_getResource:function(a,b){return P.resourceFactory.create(a,b)},isPlacedExperience:function(a,b){var c=this.getPlacedExperienceId(a,b);return c&&this.triggerPlacedExperienceId(a,c),null!==c},getPlacedExperienceId:function(a,b){if(a&&b){var c=this._placedExperiences[a];if(c&&c.experience_id===b)return c.id}return null},getPlacedExperience:function(a){return this._placedExperiences[a]},refreshPlacedExperiences:function(){logger.debug("Refreshing all placed experiences.");var a=this._getResource("UserExperiencePlatformResource");a.callGet({error:P.NOOP}).done(function(a){if(a.resource_response.data){var b=a.resource_response.data;this._placedExperiences=b}})},dismissPlacedExperience:function(a,b,c){var d=this.getPlacedExperienceId(a,b);d?(delete this._placedExperiences[a],this.dismissPlacedExperienceId(d,c)):c&&c()},dismissPlacedExperienceId:function(a,b){var c=this;if(a){logger.debug("Delete placed experience: ",a);var d=this._getResource("UserExperienceResource",{placed_experience_id:a});d.callDelete({error:P.NOOP}).done(function(){c.refreshPlacedExperiences(),b&&b()})}else b&&b()},viewPlacedExperience:function(a,b){var c=this.getPlacedExperienceId(a,b);c&&this.viewPlacedExperienceId(c)},triggerPlacedExperienceId:function(a,b){if(!this._triggered.contains(a)){this._triggered.add(a);var c=this._getResource("UserExperienceTriggerResource",{placed_experience_id:b});c.callUpdate({error:P.NOOP})}},viewPlacedExperienceId:function(a){if(a){logger.debug("Viewed placed experience: ",a);var b=this._getResource("UserExperienceViewedResource",{placed_experience_id:a});b.callUpdate({error:P.NOOP})}},completePlacedExperience:function(a,b,c){var d=this.getPlacedExperienceId(a,b);d?(delete this._placedExperiences[a],this.completePlacedExperienceId(d,c)):c&&c()},completePlacedExperienceId:function(a,b){var c=this;if(a){logger.debug("Complete placed experience: ",a);var d=this._getResource("UserExperienceCompletedResource",{placed_experience_id:a});d.callUpdate({error:P.NOOP}).done(function(){c.refreshPlacedExperiences(),b&&b()})}else b&&b()}};var instance=null;P.ExperienceManager.instance=function(){if(!instance){var a=P.expns;instance=new P.ExperienceManager(a),P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_PLACED_EXPERIENCES_FROM_SERVER,function(a,b,c){instance=new P.ExperienceManager(c)})}return instance},P.ExperienceManager.Tutorials={},P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_FIRST_PIN_USER_ED]="firstPinIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_YOUR_BOARDS_USER_ED]="yourBoards",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_FAST_FOLLOW_USER_ED]="fastFollowIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_FIND_FRIENDS_USER_ED]="findFriends",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_CATEGORY_SEARCH_USER_ED]="categorySearchIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_PLACE_PINS_TOOLTIP]="placePinsIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_EMPTY_PLACES_BOARD_USER_ED]="emptyPlacesBoardIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_FILLED_PLACES_BOARD_USER_ED]="filledPlacesBoardIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_EXPLORE_BUTTON_USER_ED]="exploreButton",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_EXPLORE_PAGE_USER_ED]="explorePage",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_FIRST_BOARD_USER_ED]="firstBoardIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_MODERN_HEADER_USER_ED]="modernHeaderIntro",P.ExperienceManager.Tutorials[P.Experiences.Experience.WEB_MOBILE_NUX_MANDATORY]="newUserWhitneyEd",goog.provide("P.versionedFileLoader"),goog.require("P.logger"),goog.require("P.script");var versionedFileLoaderLog=P.Logger.getLogger("VersionedFileLoader");P.VersionedFileLoader=function(){},P.VersionedFileLoader.prototype={getJSFiles:function(){return Pc.dynamicallyLoadedJSFiles},loadScript:function(a,b){var c=this.getJSFiles(),d=c[a];return d?(P.script.load([],d,a),void P.script.ready(a,function(){b()})):void versionedFileLoaderLog.error("Tried loading file (",+a+"), but it does not exist.")}},P.VersionedFileLoader.instance=new P.VersionedFileLoader,goog.provide("P.adTracking"),P.AdTracking={},P.AdTracking.trackConversions=function(){P.currentUser.isAuthenticated()&&(Cookie.get(P.CONST.COOKIE_USER_JUST_REGISTERED)?(P.AdTracking.pingGoogleConversion(),P.AdTracking.pingFacebookConversion(),Cookie.unset(P.CONST.COOKIE_USER_JUST_REGISTERED)):P.AdTracking.pingGoogleRemarketing())},P.AdTracking.pingUrl=function(a){var b=new Image;a+="&cache_bust="+Date.now(),b.src=a},P.AdTracking.pingGoogleConversion=function(){P.AdTracking.pingUrl("https://www.googleadservices.com/pagead/conversion/983308403/?value=0&label=BAZXCN218AYQ87Dw1AM&guid=ON&script=0")},P.AdTracking.pingGoogleRemarketing=function(){P.AdTracking.pingUrl("//googleads.g.doubleclick.net/pagead/viewthroughconversion/983308403/?value=0&guid=ON&script=0")},P.AdTracking.pingFacebookConversion=function(){P.AdTracking.pingUrl("https://www.facebook.com/offsite_event.php?id=6007773338208&value=0&currency=USD")},function(){goog.provide("P.nuxUtils"),goog.require("P.event"),P.NuxUtils={},P.NuxUtils.MODULE_NAME_CLOSEUP="Closeup",P.NuxUtils.MODULE_NAME_FEEDPAGE="FeedPage",P.NuxUtils.MODULE_NAME_SEARCHPAGE="SearchPage",P.NuxUtils.preventNavigationIfNecessary=function(a){var b=a&&a.data?a.data.url:"";if(P.ExperienceManager.instance().isPlacedExperience(P.Experiences.Placement.WEB_HOME_TAKEOVER,P.Experiences.Experience.WEB_MANDATORY_AUTOBAHN)){var c=P.router.get().resolve(b);if(!c)return P.NuxUtils.handleAutobahnExternalClick(a),!0;var d=c.module;if(d!==P.NuxUtils.MODULE_NAME_CLOSEUP&&d!==P.NuxUtils.MODULE_NAME_FEEDPAGE&&d!==P.NuxUtils.MODULE_NAME_SEARCHPAGE)return P.NuxUtils.handleAutobahnExternalClick(a),!0}return!1},P.NuxUtils.handleAutobahnExternalClick=function(a){P.trackRegisterAction("autobahn_disabled_link"),a.stopPropagation();var b={name:"ConfirmDialog",options:{template:"autobahn_click_tip"}};P.loadModule(b,function(a){P.app.showInModal(a,{mask_type:"dark",can_dismiss:!1})})}}(),function(){goog.provide("P.reportMetrics");var a=P.Logger.getLogger("ReportMetrics"),b={reportPageLoadMetrics:function(){if(Pc.reportPageLoadTimings){var b={};window.performance&&(window.performance.getEntriesByType&&(b.resourceTimings=window.performance.getEntriesByType("resource")),window.performance.navigation&&(b.navigation=window.performance.navigation),window.performance.timing&&(b.timing=window.performance.timing),_.isEmpty(b)||(P.PAGE_ROUTE_PATTERN&&(b.routePattern=P.PAGE_ROUTE_PATTERN),a.logToServer(P.Logger.SERVER_LOG_TYPE.PAGE_LOAD_METRIC,"post",b)))}}};$(window).on("load",function(){b.reportPageLoadMetrics()}),P.Errors.wrap(b,["reportPageLoadMetrics"])}(),function(){function a(){}goog.provide("P.desktopWindow"),goog.require("P.interfaces.IWindowManager"),_.extend(a.prototype,{open:function(a,b,c,d){var e=this._makeWindowOptions(c,d);P.debugWindow=window.open(a,b,e)},_makeWindowOptions:function(a,b){var c=screen.width,d=screen.height,e=Math.round((c-a)/2),f=d>b?Math.round((d-b)/2):0;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+a+",height="+b+",left="+e+",top="+f},shrinkWrap:function(){this._resizeToFit()},contain:function(){this._resizeToFit(!0)},_resizeToFit:function(a){var b=document.documentElement,c=b.scrollWidth-b.clientWidth,d=b.scrollHeight-b.clientHeight;a&&(c=Math.max(c,0),d=Math.max(d,0)),window.resizeBy(c,d)}}),P.setWindowManager(new a)}(),function(){goog.provide("P.sticky");var a="sticky",b="absolute",c="below",d=b+" "+c,e=d+" "+a,f=a,g=0,h=1,i=2;P.Sticky=function(a,b){this.$el=a,this.elementHeight=null,this.headerHeight=b.headerHeight,this.boundElementHeight=null,this.$boundTo=b.$boundTo,this.$scrollable=b.$scrollable,this.updateFixed=_.bindFn(this.updateFixed,this),this._onScroll=_.bindFn(this._onScroll,this),this.$scrollable.on("scroll.sticky",this._onScroll),this.pendingScrollRAF=!1,this.lastState=null;var c=this;P.deferDomManipulation(function(){c.elementHeight=a.height(),c.boundElementHeight=c.$boundTo.height()})},_.extend(P.Sticky.prototype,Backbone.Events),P.Sticky.prototype.destroy=function(){this.$scrollable.off("scroll.sticky",this.updateFixed)},P.Sticky.prototype.unSticky=function(){this.destroy()},P.Sticky.prototype._onScroll=function(){if(!this.pendingScrollRAF){var a=this;P.deferDomManipulation(function(){return a.scrollTop=a.$scrollable.scrollTop(),a.scrollTop===a.lastScrollTop?void(a.pendingScrollRAF=!1):(a.updateFixed(),a.lastScrollTop=a.scrollTop,void(a.pendingScrollRAF=!1))}),this.pendingScrollRAF=!0}},P.Sticky.prototype.updateFixed=function(){var b,c=$(window),f=c.scrollTop(),j=f,k=this.$boundTo.offset().top,l=k-this.headerHeight,m=k+this.boundElementHeight-this.headerHeight;b=j>=l&&j<=m?h:j>=m?i:g,b!==this.lastState&&(b===h?(this.$el.css("top","").addClass(a).removeClass(d),this.trigger(P.CONST.EVENT_STICKY_FIXED,!0)):b===i?(this.$el.removeClass(a),this.trigger(P.CONST.EVENT_STICKY_FIXED,!1),this.handleReachingBottom()):b===g&&(this.$el.removeClass(e),this.trigger(P.CONST.EVENT_STICKY_NORMAL),this.trigger(P.CONST.EVENT_STICKY_FIXED,!1))),this.lastState=b},P.Sticky.prototype.handleReachingBottom=function(){if(!this.$el.hasClass(d)){var a=this.boundElementHeight||0,e=this.$el.css("top");e=e?e.split("px")[0]:0,e=parseInt(e,10)||0,this.$el.addClass(b+" "+c).css("top",a+e+1)}},jQuery.fn.sticky=function(b){return this.each(function(c,d){var e=$(d),g=e.data(f);if(g&&(g.destroy(),e.removeData(a)),"unsticky"===b);else if("object"===typeof b){var h={$scrollable:b.$scrollable,$boundTo:b.$boundTo,headerHeight:b.headerHeight||0};b.$scrollable&&(g=new P.Sticky(e,h),e.data(f,g))}}),this}}(),function(){goog.provide("P.number"),P.number.toRadians=function(a){return a*Math.PI/180}}(),function(){goog.provide("P.overflowingText"),jQuery.fn.overflowingText=function(){return this.each(function(a,b){if(b.offsetHeight<b.scrollHeight||b.offsetWidth<b.scrollWidth){var c=$(b);c.addClass(P.CONST.OVERFLOWING_TEXT_OVERFLOWING_CLASS)}}),this}}(),function(){goog.provide("P.focusWithoutScrolling"),jQuery.fn.focusWithoutScrolling=function(){return this.each(function(a,b){var c=$(window),d=c.scrollLeft(),e=c.scrollTop();$(b).focus();var f=$(".Closeup");return f.length?(e=f.scrollTop(),void f.scrollTop(e)):(c.scrollLeft(d),void c.scrollTop(e))}),this}}(),function(){goog.provide("P.style"),P.Style=function(a,b){P.Style.addStyle(a,b)},P.Style.addStyle=function(a,b){var c=a+"Styles",d=document.getElementById(c);d||(d=document.createElement("style"),d.setAttribute("type","text/css"),d.setAttribute("id",c),document.getElementsByTagName("head")[0].appendChild(d)),d.styleSheet?d.styleSheet.cssText=b:d.appendChild(document.createTextNode(b))}}(),goog.require("P.resourceFactory");var LogLevelResource=function(){};LogLevelResource.prototype={callGet:function(a){a=a||{};var b=P.getDebugWindow(),c=P.Logger.getAll();b&&(c=b.P.Logger.getAll()),c=_.sortBy(c,function(a){return a.name.toLowerCase()});for(var d=3,e=Math.ceil(c.length/d),f=[],g=0;g<d;g++){for(var h=[],i=0;i<e;i++){var j=g*e+i;if(j>=c.length)break;h.push(c[j])}f.push(h)}var k=new P.ResourceResponse;return k.resource_response.data={levels:_.pairs(b.P.Logger.LOG_LEVEL),loggerColumns:f},a.success&&a.success(resourceData),a.complete&&a.complete(),P.Promise.resolve(k)},resetBookmark:function(){}},P.resourceFactory.register("LogLevelResource",LogLevelResource),function(){goog.provide("P.transition"),P.TransitionState={NOT_STARTED:0,STARTED:1,ENDED:2};var a=function(a){return{"animation-duration":a,"-webkit-animation-duration":a,"-o-animation-duration":a}},b=function(a){return{width:a.width+"px",height:a.height+"px"}},c=function(a){return{top:a.top+"px",left:a.left+"px"}},d=function(a){return{transition:a,"-moz-transition":a,"-webkit-transition":a,"-o-transition-duration":a}};P.Transition=function(a,b,c,d){this.element=a,this.endPos=b,this.endDim=c,this.duration=d,this.state=P.TransitionState.NOT_STARTED,this.listener=null},_.extend(P.Transition.prototype,{start:function(){this.state=P.TransitionState.STARTED,this.onStart(),this.listener.started();var a=this;P.setTimeout(function(){a.end()},this.duration)},end:function(){this.state=P.TransitionState.ENDED,this.onEnd(),this.listener.ended()},addListener:function(a){this.listener=a},onStart:function(){},onEnd:function(){}}),P.Transition.extend=Backbone.View.extend,P.Transition.Zoom=P.Transition.extend({onStart:function(){var a=this.duration/1e3,e="all "+a+"s ease-out",f=_.extend({position:"fixed"},d(e),b(this.endDim),c(this.endPos));this.element.css(f)}}),P.Transition.Spin=P.Transition.extend({onStart:function(){var e=this.duration/1e3+"s",f="all "+e+" ease-out",g=_.extend({position:"fixed"},d(f),a(e),b(this.endDim),c(this.endPos));this.element.addClass("rotate").css(g)}})}(),function(){goog.provide("P.updater");var a="mousemove.updater";P.Updater=function(){this.decay=0,this.lastFetchTime=0,this.timeout=null,this.recentPinId=null,this.conversationId=null,this.updatesResource=P.resourceFactory.create("UpdatesResource",{});var b=this;$(document).on(a,_.throttle(function(){b.wake()},1e3)),this.deferredFetch()},_.extend(P.Updater.prototype,Backbone.Events),_.extend(P.Updater.prototype,{getUpdatesResourceOptions:function(){var a={};return this.recentPinId&&(a.last_pin_id=this.recentPinId),this.conversationId&&(a.conversation_id=this.conversationId),a},setRecentPinId:function(a){this.recentPinId=a},setConversationId:function(a){this.conversationId=a},wake:function(){this.msSinceLastFetch()>P.CONST.UPDATES_MIN_POLL&&(this.decay=0,this.fetch())},fetch:function(){var b=this;clearTimeout(this.timeout);var c=function(a){var c=a.resource_response.data;_.each(c,function(a,c){b.trigger(c,a)}),b.deferredFetch()};this.lastFetchTime=(new Date).getTime(),this.updatesResource.setOptions(this.getUpdatesResourceOptions()),this.updatesResource.callGet({success:c,error:function(){$(document).off(a)}})},deferredFetch:function(){this.decay=Math.min(2*(this.decay||1e3),P.CONST.UPDATES_MAX_POLL);var a=this;this.timeout=P.setTimeout(function(){a.fetch()},P.CONST.UPDATES_MIN_POLL+this.decay)},msSinceLastFetch:function(){return(new Date).getTime()-this.lastFetchTime}}),P.Updater.instance=function(){return P.Updater._instance||(P.Updater._instance=new P.Updater),P.Updater._instance}}(),function(){goog.provide("P.pushNotifications");var a="web.com.pinterest.www";P.requestPushNotifications=function(){if(P.currentUser.isAuthenticated()&&window.safari&&window.safari.pushNotification){var b=window.safari.pushNotification.permission(a);"default"===b.permission&&window.safari.pushNotification.requestPermission("https://"+window.location.hostname+"/_/_/push",a,{},function(){})}}}(),goog.provide("P.modules.AnimationPlacesBase"),goog.require("P.Module"),P.modules.AnimationPlacesBase=P.Module.extend({}),goog.provide("P.modules.AppBase"),goog.require("P.HistoryManager"),goog.require("P.interfaces.HistoryManagerProvider"),goog.require("P.Module"),goog.require("P.util");var LOADING_DELAY=500,NEXT_ACTION={REPLACE:0,REPLACE_TOP:1,APPEND:2,CLOSE:3,IGNORE:4};P.modules.AppBase=P.Module.extend({MAIN_MODULE_ID:"mainModule",CLOSEUP_NAME:"Closeup",onCreated:function(){P.currentUser.isAuthenticated()||P.currentUser.attemptLogin(),this.historyManager=new P.HistoryManager,this.backgroundModule=null,this.canUpdatePageInfo=!1},onAddedToDom:function(){var a=P.router.get();a.start(),P.AppVersion.setup(P.CONTEXT.app_version),this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate),this.childListen(P.CONST.EVENT_SCROLL_TO_TOP,this.onChildScrollToTop),this.listen(a,P.CONST.EVENT_ROUTE_MATCHED,this.onRouteMatched),this.listen(a,P.CONST.EVENT_ROUTE_NO_MATCH,this.onRouteNoMatch),this.childListen(P.CONST.EVENT_REQUIRES_AUTHENTICATION,this.onChildEventRequiresAuthentication);var b={};b[P.CONST.PUBSUB_TOPIC_PAGE_INFO]=this.onPageInfoChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,b)},onChildAdded:function(){this._adjustScrollToTopPositionIfNeeded()},onChildEventRequiresAuthentication:function(a){this.navigate(a.data.authRedirectUrl)},onChildScrollToTop:function(){var a=this._getCurrentMainModule(),b=a.getScrollableElement();P.scrollToTop({$scroller:b}),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_MAIN_MODULE,P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP,{})},_getCurrentMainModule:function(){var a=this.getChildById(this.MAIN_MODULE_ID);return a?a:this.children[this.children.length-1]},setUpContextLogging:function(){var a=this._getCurrentMainModule();if(!a.getHasError()){var b=window.location.pathname+window.location.search,c=P.router.get().resolve(b);if(c){var d=c.extraContent.log;if(d){var e=P.ContextEvent.fromPlainObject(d);e.setEventType(P.ContextLogging.EventType.VIEW),e.setRequestIdentifier(P.PAGE_LOAD_REQUEST_IDENTIFIER);var f=a.getLoggingObjectIdStr();f&&e.setObjectIdStr(f),P.ContextLogger.getInstance().addEvent(e)}}else this.log.error("Router couldn't resolve url for context logging",{url:b})}},onRemovedFromDom:function(){this._removeListeners()},onRouteMatched:function(a){if(P.AppVersion.isNewVersionAvailable()&&this.midNavigate&&(P.AppVersion.isNewVersionRequired()||"Closeup"!==a.module))return this._setVersionRedirectCookie(),void window.location.reload();this.log.debug("onRoute",a),P.trackGAPageview(a.module);var b,c=a.module,d=a.options,e=a.resource;this.extraData&&this.extraData.userAgent&&a.extraContent&&(b=P.DeepLink.getLinkForAgent(this.extraData.userAgent,a.extraContent)),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_DEEP_LINK,b);var f="https:"===window.location.protocol,g=a.extraContent.https,h=P.CONTEXT.https_exp;if(!P.currentUser.isAuthenticated()&&h&&(g=!0),a.extraContent.require_explicit_login&&P.currentUser.get("autologin"))return void P.navigate(P.getLoginUrl());if(a.extraContent.require_authentication&&!P.currentUser.isAuthenticated())return void P.navigate(P.getRegisterUrl());if(g&&!f)return void window.location.replace(window.location.href.replace(/http:\/\//,"https://"));if(!g&&f)return void window.location.replace(window.location.href.replace(/https:\/\//,"http://"));this.removeAllModals();var i=this;P.loadModuleConstructor(c).then(function(b){var c=i.historyManager.getModule(b,a.navigateData);if(!i._getCurrentMainModule())return void window.location.reload();var f=null,g=a.extraContent.log;g?(g.event_type=P.ContextLogging.EventType.VIEW,f=P.ContextEvent.fromPlainObject(g)):P.ContextLogger.getInstance().clearContext(),i.updateMainModule(c,d,e,a.navigateData,f)});var j=this.historyManager.getPageInfo();j&&this.setPageInfo(j),this.canUpdatePageInfo=!j;var k=this.getChildById("nags");k&&k.clearKeywords()},onRouteNoMatch:function(){window.location.reload()},onPageInfoChange:function(a,b,c){this.canUpdatePageInfo&&(this.historyManager.setPageInfo(c),this.setPageInfo(c),this.canUpdatePageInfo=!1)},setPageInfo:function(a){a.title&&$(document).attr("title",a.title),$("head meta[data-app]").remove();var b=[];_.each(a.meta,function(a,c){b.push($("<meta>").prop({name:c,property:c,content:a,"data-app":1}))}),$("head").append(b)},startModuleTransition:function(a){var b=this;a.fadeOut(),clearTimeout(this._loaderTimeout),this._loaderTimeout=P.setTimeout(function(){b.loadingShown=!0,b.showLoading()},LOADING_DELAY,"App loader")},stopModuleTransition:function(a){clearTimeout(this._loaderTimeout),a.fadeIn(),this.loadingShown&&(this.hideLoading(),this.loadingShown=!1)},updateMainModule:function(a,b,c,d,e){var f=a.module,g=a.backgroundModule,h=this._getCurrentMainModule();h.saveExtraState(!0),this.log.debug("Current:",h.className,"New:",f.className);var i=this._getNextAction(h,f,g,d),j=i===NEXT_ACTION.REPLACE&&h.className!==this.CLOSEUP_NAME&&f.className!==this.CLOSEUP_NAME;j&&this.startModuleTransition(h),f.clearFades();var k=this._getCanClose(h,a,i);null!==k&&(b.can_close=k);var l=null===k||k===!1;P.Body.setScrolling(l);var m=this;if(e){var n=function(a,b,c){var d=c;e.setRequestIdentifier(d),m.pubsubUnsubscribe(P.CONST.PUBSUB_CHANNEL_REQUEST)},o={};o[P.CONST.PUBSUB_TOPIC_REQUEST_IDENTIFIER]=n,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_REQUEST,o)}var p=function(){if(m.midNavigate=!1,j&&m.stopModuleTransition(f),m.updateScrollWatchers(f),e&&!f.getHasError()){var a=f.getLoggingObjectIdStr();a&&e.setObjectIdStr(a),P.ContextLogger.getInstance().addEvent(e),P.pubsub.clearChannel(P.CONST.PUBSUB_CHANNEL_REQUEST)}};d.currentModule=h,f.errorStrategy=P.CONST.ErrorStrategy.SHOW,f.setAsMainModule(b,c,d).done(function(){m._performNextAction(i,h,a,d),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_MAIN_MODULE,P.CONST.PUBSUB_TOPIC_MAIN_MODULE_NEW,m._getCurrentMainModule()),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_BREADCRUMBS,P.CONST.PUBSUB_TOPIC_BREADCRUMB_UPDATE,null),m._adjustScrollToTopPositionIfNeeded()}).fail(function(){m.historyManager.cancelNavigation()}).always(function(){p()})},_getNextAction:function(a,b,c,d){var e=null;return e=a===b?NEXT_ACTION.IGNORE:b.className!==this.CLOSEUP_NAME?a.className===this.CLOSEUP_NAME&&a.options.can_close&&this.backgroundModule&&b===this.backgroundModule?NEXT_ACTION.CLOSE:NEXT_ACTION.REPLACE:d.fromNavigate?a.className===this.CLOSEUP_NAME?a.options.can_close?NEXT_ACTION.REPLACE_TOP:NEXT_ACTION.REPLACE:NEXT_ACTION.APPEND:a===c&&b.className===this.CLOSEUP_NAME?NEXT_ACTION.APPEND:NEXT_ACTION.REPLACE},_getCanClose:function(a,b,c){var d=b.module,e=b.backgroundModule;if(d.className!==this.CLOSEUP_NAME)return null;var f=a.className===this.CLOSEUP_NAME,g=!!a.options.can_close;switch(c){case NEXT_ACTION.REPLACE:return!!e;case NEXT_ACTION.REPLACE_TOP:return g;case NEXT_ACTION.APPEND:return!f||g;case NEXT_ACTION.IGNORE:return g}return null},_performNextAction:function(a,b,c,d){var e=this,f=c.module,g=c.backgroundModule,h=f.$el,i=a!==NEXT_ACTION.IGNORE,j=this.getChildById("header"),k=0;if(j&&(k=j.getHeight()),a===NEXT_ACTION.IGNORE)e.backgroundModule&&e.historyManager.updateBackgroundModule(e.backgroundModule,d);else if(a===NEXT_ACTION.CLOSE)e.backgroundModule=null,b.detachElement(),e.removeChildId(b);else if(a===NEXT_ACTION.REPLACE){e.backgroundModule!==g&&(e.backgroundModule&&(e.backgroundModule.detachElement(),e.backgroundModule=null),g&&(g!==b&&(g.appendToElement(e.$(".mainContainer")),e.addChild(g)),e.backgroundModule=g)),b!==g&&(this.removeChildId(b),b.detachElement()),e.removeChildId(b),h.css("min-height",P.Viewport.height-k);var l=$(e.backgroundModule?".appendedContainer":".mainContainer");l.append(h),e.addChild(f)}else a===NEXT_ACTION.REPLACE_TOP?(b.detachElement(),h.css("min-height",P.Viewport.height-k),$(".appendedContainer").append(h),e.addChild(f),e.historyManager.updateBackgroundModule(e.backgroundModule,d)):a===NEXT_ACTION.APPEND&&(e.backgroundModule=b,e.removeChildId(b),h.css("min-height",P.Viewport.height-k),$(".appendedContainer").append(h),e.addChild(f),e.historyManager.updateBackgroundModule(e.backgroundModule,d));(i||this._forceRefreshRequested(d))&&(e.setChildId(f,this.MAIN_MODULE_ID),f.restoreExtraState(!0))},_setVersionRedirectCookie:function(){Cookie.set(P.CONST.COOKIE_VERSION_REFRESH,P.AppVersion.currentVersion,1)},onContentReady:function(){this.setUpContextLogging();var a=this._getCurrentMainModule();P.trackGAPageview(a.className,this._getGAPageviewOptions()),_.defer(_.bindFn(this._startTutorials,this)),this.setChildId(a,this.MAIN_MODULE_ID),this.historyManager.start(a),this.historyManager.setPageInfo(P.PAGE_INFO),this.updateScrollWatchers(a),this._adjustScrollToTopPositionIfNeeded()},onChildNavigate:function(a){if(this.midNavigate)return void a.stopPropagation();this._adjustScrollToTopPositionIfNeeded();var b=a.data.url;if(!P.isOffsiteUrl(b)&&(this.midNavigate=!0,P.AppVersion.isNewVersionRequired()))return this._setVersionRedirectCookie(),window.location.href=b,void a.stopPropagation();this.log.debug("App got navigate event from child",a.target,"for url:",b);var c=new P.navigateData.NavigateData;c.handled=!!a.data.handled,c.evt=a,this.historyManager.navigate(b,c),a.stopPropagation()},_adjustScrollToTopPositionIfNeeded:function(){},_getGAPageviewOptions:function(){return{}},_startTutorials:function(){P.TutorialManager.instance().resumeTutorial()},isTutorialActive:function(){return P.TutorialManager.instance().isTutorialActive()},updateScrollWatchers:function(){},removeAllModals:function(){}}),goog.provide("P.modules.AutoFollow"),goog.require("P.Module"),P.modules.AutoFollow=P.Module.extend({events:{},onContentReady:function(){var a={username:this.options.username,username_and_slug:this.options.username_and_slug},b="UserAutoFollowResource",c="/"+this.options.username+"/",d="user_auto_follow";this.options.username_and_slug&&(b="BoardAutoFollowResource",c="/"+this.options.username_and_slug+"/",d="board_auto_follow");var e=this,f=P.resourceFactory.create(b,a);f.callCreate({success:function(){P.trackGAEvent(d,P.CONST.GA_ACTION_SUCCESS)},error:function(){P.trackGAEvent(d,P.CONST.GA_ACTION_ERROR)},complete:function(){e.navigate(c+"?auto_follow=1")}})}}),goog.provide("P.modules.AuxiliarySiteHeader"),goog.require("P.Module"),P.modules.AuxiliarySiteHeader=P.Module.extend({}),goog.provide("P.modules.BoardBase"),goog.require("P.Module"),P.modules.BoardBase=P.Module.extend({getId:function(){return this.data&&this.data.id},onBoardDeleted:function(){this.destroy()},onBoardUpdated:function(){this.render()},getLoggingObjectIdStr:function(){return this.getId()}}),goog.provide("P.modules.BoardCollaboratorInvitesBase"),goog.require("P.Module"),P.modules.BoardCollaboratorInvitesBase=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_INVITE_USER,this.onChildInviteUser),this.childListen(P.CONST.EVENT_INVITE_EMAIL,this.onChildInviteEmail)},onChildInviteUser:function(a){var b=this.getChildById("boardInviteForm");b.showLoading();var c=a.data.userId,d={board_id:this.getBoardId(),invited_user_id:c},e=P.resourceFactory.create("BoardInviteResource",d);e.callCreate({success:function(){b.clearTypeahead()},complete:function(){b.hideLoading()}})},getBoardId:function(){return this.resource.options.board_id},onChildInviteEmail:function(a){var b=this,c=this.getChildById("boardInviteForm");c.showLoading();var d=a.data.email,e={board_id:this.getBoardId(),emails:[d]},f=P.resourceFactory.create("BoardEmailInviteResource",e);f.callCreate({success:function(){c.clearTypeahead();var a=P.string.format(P.string.common.successInviteSentToEmail,{email:d}),e=$("<div class='alert'>"+a+"</div>").hide();b.insertAfterModule(e,c).then(function(){e.fadeIn(function(){e.delay(5e3).fadeOut(function(){e.remove()})})})},complete:function(){c.hideLoading()}})}}),goog.provide("P.modules.BoardCollaboratorsBase"),goog.require("P.Module"),P.modules.BoardCollaboratorsBase=P.Module.extend({events:{}}),goog.provide("P.modules.BoardInviteBase"),goog.require("P.Module");var showSuccessMs=5e3;P.modules.BoardInviteBase=P.Module.extend({onContentReady:function(){this.declineButton=this.getChildById("declineButton"),this.removeButton=this.getChildById("removeButton"),this.acceptButton=this.getChildById("acceptButton"),this.approveButton=this.getChildById("approveButton"),this.declineButton&&this.listen(this.declineButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickDecline),this.removeButton&&this.listen(this.removeButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickRemove),this.acceptButton&&this.listen(this.acceptButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickAccept),this.approveButton&&this.listen(this.approveButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickApprove)},getConfirmBoardInvite:function(){return"boardEdit"===this.options.view_type},deleteBoardInvite:function(a){var b,c=this._getCurrentUserIsInvitedUser(),d=this;b=c?"collaborator_decline_invite":"collaborator_delete_invite",P.trackGAEvent(b,P.CONST.GA_ACTION_CLICK),this.removeButton&&this.removeButton.showLoading();var e=!1;if(a){var f=a.data.formData;e=f&&f.ban}var g=this._getRemoveResource(e);g.callDelete({success:function(){P.trackGAEvent(b,P.CONST.GA_ACTION_SUCCESS);var a=d.data.board.id;d.fadeOut(function(){d.destroy(),P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED),e&&d.extraData.has_delete_permission&&P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_BOARD_BANNED_COLLABORATOR)}),c&&(P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF),P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF))},error:function(){P.trackGAEvent(b,P.CONST.GA_ACTION_ERROR)},complete:function(){d.removeButton.hideLoading()}})},onClickDecline:function(){},onClickRemove:function(){},onClickAccept:function(){var a="collaborator_invite_accept";P.trackGAEvent(a,P.CONST.GA_ACTION_CLICK);var b=this;this.acceptButton&&this.acceptButton.showLoading();var c=P.resourceFactory.clone(this.resource);c.callUpdate({success:function(){P.trackGAEvent(a,P.CONST.GA_ACTION_SUCCESS);var c=b.$(".pending"),d=b.$(".success"),e=b.data.board.id;P.pubsub.publish(e,P.CONST.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED),c.fadeOut(function(){d.fadeIn(function(){d.delay(showSuccessMs).fadeOut(function(){b.destroy()})})})},error:function(){P.trackGAEvent(a,P.CONST.GA_ACTION_ERROR)},complete:function(){b.acceptButton.hideLoading()}})},onClickApprove:function(){var a="collaborator_approve_invite",b=P.resourceFactory.create("BoardInviteResource",this.resource.copyOptions(!0));this.approveButton&&this.approveButton.showLoading();var c=this;b.callUpdate({success:function(){P.trackGAEvent(a,P.CONST.GA_ACTION_SUCCESS),c.fadeOut(function(){c.destroy()});var b=c.data.board.id;P.pubsub.publish(b,P.CONST.PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE,{userId:c._getInviteUserId()})},error:function(){P.trackGAEvent(a,P.CONST.GA_ACTION_ERROR)},complete:function(){c.approveButton.hideLoading()
}})},_getRemoveResource:function(a){var b=this.extraData.accepted,c=b?"BoardCollaboratorResource":"BoardInviteResource",d=this.resource.copyOptions(!0);b&&this.getConfirmBoardInvite()&&(d.ban=a);var e=P.resourceFactory.create(c,d);return e},_getInviteUserId:function(){return this.extraData.invitedUserId},_getCurrentUserIsInvitedUser:function(){return this.extraData.currentUserIsInvitedUser},_getInvitedUserFullName:function(){return this.extraData.invitedUserFullName}}),goog.provide("P.modules.BoardInviteForm"),goog.require("P.Module"),P.modules.BoardInviteForm=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(P.CONST.EVENT_ENTER_PRESSED,this.onChildEnterPressed),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onClickInviteButton)},onChildItemSelected:function(a){P.trackGAEvent("collaborator_invite_user",P.CONST.GA_ACTION_SELECT_SUBMIT);var b=a.data.item;this._inviteUser(b),a.stopPropagation()},onChildEnterPressed:function(a){P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_ENTER_SUBMIT),this.submit(),a.stopPropagation()},onClickInviteButton:function(a){P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_CLICK_SUBMIT),this.submit(),a.stopPropagation()},submit:function(){var a=this.getChildById("typeaheadField"),b=a.getValue(),c=a.getField(),d=this;if(this.options.email_supported){var e=new P.Validator(c,[P.Validator.Length({min:1}),P.Validator.Email()]);e.validate(function(a){a.errors.length>0?d.log.debug(a.errors):d._inviteEmail(b)})}return!1},setTypeaheadFieldValue:function(a){var b=this.getChildById("typeaheadField");b.setValue(a)},clearTypeahead:function(){var a=this.getChildById("typeaheadField");a.clear()},_inviteEmail:function(a){this.triggerEvent(P.CONST.EVENT_INVITE_EMAIL,{email:a},!0)},_inviteUser:function(a){var b=a.get("id"),c=a.get("type");this.triggerEvent(P.CONST.EVENT_INVITE_USER,{userId:b,type:c,pending:this.options.pending},!0)}}),goog.provide("P.modules.BoardPageBase"),goog.require("P.Module");var ID_ADD_TO_MAP_BUTTON="addToMap";P.modules.BoardPageBase=P.Module.extend({events:{},onContentReady:function(){this.map=this.getChildById("map"),this.map&&(this.childListen(P.CONST.EVENT_MAP_READY,this.onMapReady),this.childListen(P.CONST.EVENT_PIN_DELETED,this.onPinDeleted))},getGrid:function(){return this.getChildById("grid")},onMapReady:function(){this.setMapPaddingTopLeft(),this.addMarkersToMap()},_removePinFromMap:function(a){if(this.map){var b=a.getId();this.map.removeMarkerForPinId(b)}},onPinDeleted:function(a){var b=a.data;this._removePinFromMap(b)},addMarkersToMap:function(){var a=this.getPins();this._pinCount=a.length;var b=_.filter(a,function(a){return null!==a.getCoordinates()}),c=b.length>0;this._pinCount&&c?(this.map.addMarkersToMap(a),this.map.fitViewToPinMarkers()):this.map.fitWorld()},getPins:function(){var a=this.getGrid();if(!a)return[];var b=a.getGridItemsChildren();return b.length?b:[]},_getAddToMapButton:function(){return this.getChildById(ID_ADD_TO_MAP_BUTTON)},setMapPaddingTopLeft:function(){}}),goog.provide("P.modules.ButtonBase"),goog.require("P.Module");var ButtonStates={ATTR_DISABLED:"disabled",CLASS_DISABLED:"disabled",CLASS_ACTIVE:"active",CLASS_BADGED:"badged",SELECTOR_BUTTON_TEXT:".buttonText",SELECTOR_BUTTON_BADGE:".buttonBadge"};P.modules.ButtonBase=P.Module.extend({events:{click:"onClick"},onClick:function(a){return a&&this.isDisabled()?(a.preventDefault(),!1):void this.triggerEvent(P.CONST.EVENT_BUTTON_CLICK,null,!0)},disable:function(){this.$el.attr(ButtonStates.ATTR_DISABLED,!0).addClass(ButtonStates.CLASS_DISABLED)},enable:function(){this.$el.removeAttr(ButtonStates.ATTR_DISABLED).removeClass(ButtonStates.CLASS_DISABLED)},setEnabled:function(a){a?this.enable():this.disable()},setHighlight:function(a){this.$el.toggleClass(P.CONST.CLASS_BUTTON_HIGHLIGHTED,a)},isDisabled:function(){return this.$el.is(":disabled")},showLoading:function(){this.options.loading_class_name&&this.$el.addClass(this.options.loading_class_name)},hideLoading:function(){this.options.loading_class_name&&this.$el.addClass(this.options.loading_class_name)},isCancelButton:function(){return this.options.cancelButton},getText:function(){var a=this.$(ButtonStates.SELECTOR_BUTTON_TEXT).text();return $.trim(a)},setText:function(a){var b=$.trim(a);this.$(ButtonStates.SELECTOR_BUTTON_TEXT).text(b)},setStyles:function(a){var b=this.$el;_.each(a,function(a,c){b.toggleClass(c,a)})},getLoadingSpinnerOptions:function(){return _.extend(P.Module.prototype.getLoadingSpinnerOptions.call(this),{size:P.Spinner.Size.SMALL})},setBadge:function(a){var b=$.trim(a);this.$(ButtonStates.SELECTOR_BUTTON_BADGE).text(b),this.$el.addClass(ButtonStates.CLASS_BADGED)},clearBadge:function(){this.$(ButtonStates.SELECTOR_BUTTON_BADGE).text(""),this.$el.removeClass(ButtonStates.CLASS_BADGED)},setBadgeCount:function(a){a<=0?this.clearBadge():this.setBadge(a)},setActiveStyle:function(a){this.$el.toggleClass(ButtonStates.CLASS_ACTIVE,a)},isActive:function(){return this.$el.hasClass(ButtonStates.CLASS_ACTIVE)}}),goog.provide("P.modules.CategoriesSelect"),goog.require("P.Module"),P.modules.CategoriesSelect=P.Module.extend({getValue:function(){return $.trim(this.$("option:selected").val())}}),goog.provide("P.modules.CloseupRichPinContentBase"),goog.require("P.Module"),P.modules.CloseupRichPinContentBase=P.Module.extend({getLoggingObjectIdStr:function(){return this.resource.id},onCreated:function(){this.childListen(P.CONST.EVENT_MAP_READY,this.onMapReady)},onMapReady:function(){var a=this.getChildById("map");a&&a.addMarkerToCloseupMap()}}),goog.provide("P.modules.ConfirmDialog"),goog.require("P.form"),goog.require("P.Module"),P.modules.ConfirmDialog=P.Module.extend({events:{"click .cancelButton":"onCloseClick","click .confirm":"onConfirmClick","change #confirmCheckbox":"onConfirmCheckboxChange"},returnData:null,onContentReady:function(){var a=this.$("form");a&&(this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(a,this.formConfig),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated));var b=this.options.auto_close_delay_ms;b&&this.closeOnDelay(b)},render:function(a){var b=this,c=function(){b.triggerEvent("rendered",b),a&&a()};if(!this.options.message)return P.Module.prototype.render.call(this,c);this.empty();var d='<form class="standardForm"><h1>'+P._("Whoops!")+'</h1><p class="body">'+this.options.message+'</p><div class="formFooter"><div class="formFooterButtons"><button class="Button confirm btn primary rounded">'+P._("Ok")+"</button></div></div></form>";this.$el.append(d),c()},onConfirmCheckboxChange:function(){this.$("#confirmCheckbox").is(":checked")?this.$(".confirm").removeAttr("disabled"):this.$(".confirm").attr("disabled","disabled")},onSubmitValidated:function(a){if(!a.errors[0]){this.formData={};var b=this;_.each(this.returnData,function(a){b.formData[a]=b.form.getValue(a)}),this.confirm()}},onCloseClick:function(){return this.close(),!1},close:function(){this.triggerEvent(P.CONST.EVENT_CLOSE,this),this.destroy()},closeOnDelay:function(a){this.closeTimer&&clearTimeout(this.closeTimer);var b=this;this.closeTimer=P.setTimeout(function(){b.closeTimer=null,b.destroy()},a)},open:function(){this.triggerEvent(P.CONST.EVENT_OPEN,this)},onConfirmClick:function(){return this.confirm(),!1},confirm:function(){this.showLoading(!0),this.triggerEvent(P.CONST.EVENT_CONFIRM,this,!0),this.destroy()},setPrimaryButtonText:function(a){this.$(".primary .buttonText").text(a)},onDestroyed:function(){this.closeTimer&&clearTimeout(this.closeTimer)}}),goog.provide("P.modules.DomainFeedPageContainerBase"),goog.require("P.Module"),P.modules.DomainFeedPageContainerBase=P.Module.extend({}),goog.provide("P.modules.FeedPageBase"),goog.require("P.Module"),P.modules.FeedPageBase=P.Module.extend({events:{}}),goog.provide("P.modules.GridFooter"),goog.require("P.Module");var SHOW_GRID_LOADING_CLASS="showGridLoading";P.modules.GridFooter=P.Module.extend({events:{"click .gridError .Button":"onTryAgainClick"},onTryAgainClick:function(a){this.triggerEvent(P.CONST.EVENT_BUTTON_CLICK,a,!0)},show:function(){this.$el.css("display","block")},_getErrorDiv:function(){return this.$el.find(".gridError")},showError:function(){var a=this._getErrorDiv();a.css("display","block")},hideError:function(){var a=this._getErrorDiv();a.css("display","none")},showGridLoading:function(){this.$el.addClass(SHOW_GRID_LOADING_CLASS)},hideGridLoading:function(){this.$el.removeClass(SHOW_GRID_LOADING_CLASS)}}),goog.provide("P.modules.GridItems"),goog.require("P.Module");var CLASS_ACTIVE_ITEM="activeItem",DEFAULT_MINIMUM_NUM_COLUMNS=P.CONST.MIN_COLUMNS,ITEM_HIDE_BUFFER=3e3,SORTABLE_ZINDEX=1e3,SORTABLE_ITEM_CLASS="gridSortable",MODULE_NAME_PIN="Pin",Direction={UP:0,DOWN:1},pxToInt=function(a){var b=parseInt(a.replace("px",""),10);return isNaN(b)?0:b},ItemInfo=function(a){this.childModule=a,this.top=null,this.height=null,this.bottom=null,this.$itemWrapper=a.getParentElement().closest(".item"),this.columnIndex=null,this.inDom=!0,this.impressionReported=!1,this.impressionStart=null};ItemInfo.prototype={log:P.Logger.getLogger("ItemInfo"),_logHeightError:_.throttle(function(){var a=jQuery.contains(document.documentElement,this.$itemWrapper[0]),b=null;if(window.getComputedStyle){var c=window.getComputedStyle(this.$itemWrapper[0]);b=c.height}var d={height:this.height,inDom:a,"itemWrapper length":this.$itemWrapper.length,"childModule's el length":this.childModule.$el.length,"childModule's parent el length":this.childModule.getParentElement().length,"itemWrapper width":this.$itemWrapper.width(),"itemWrapper children count":this.$itemWrapper.children.length,"itemWrapper descendants count":this.$itemWrapper.find("*").length,rawHeight:b};this.log.error("unexpected height value and couldn't recover",d)},1e3),_logHeightRecovery:_.throttle(function(){this.log.warn("recovered from unexpected height value")},1e3),_calculateHeight:function(){this.height=this.$itemWrapper.height(),this.height<=0&&(this.$itemWrapper.appendTo(this.$itemWrapper.parent()),this.height=this.$itemWrapper.height(),this.height<=0?this._logHeightError():this._logHeightRecovery())},ensureHeightCalculated:function(){null===this.height&&this._calculateHeight()},recalculateHeight:function(){this.inDom?this._calculateHeight():this.log.error("Cannot calculate height because this item is not inDom")},setPosition:function(a,b){this.top=a,this.bottom=b},hasPosition:function(){return null!==this.top}};var VariableHeightLayoutManager=function(a,b){this.gridItems=a,this.options=b,this.shortestColumnIndex=0,this.columnLengths=[],this.childCidToItemInfo={};var c=this;_.each(this.gridItems.children,function(a){c.childCidToItemInfo[a.cid]=new ItemInfo(a)}),this.lastKnownItemInfosInViewport=[]};VariableHeightLayoutManager.prototype={getFilledHeight:function(){return this.columnLengths[this.shortestColumnIndex]},onChildRendered:function(a){this._reflowOnChildChanged(a)},onChildAdded:function(a){this.childCidToItemInfo[a.cid]=new ItemInfo(a)},onChildRemoved:function(a,b){if(!this.gridItems.isEmptying){b.remove();var c=this.childCidToItemInfo[a.cid],d=c.columnIndex;delete this.childCidToItemInfo[a.cid],this._reflowColumnContent(d)}},empty:function(){this.childCidToItemInfo={}},onChildContentChanged:function(a){this._reflowOnChildChanged(a)},onChildDimsChanged:function(a){this._reflowOnChildChanged(a,!1)},_reflowOnChildChanged:function(a,b){var c=this.childCidToItemInfo[a.cid];c.recalculateHeight(),this._reflowColumnContent(c.columnIndex,b)},_reflowColumnContent:function(a,b){void 0===b&&(b=this.options.reflow_all),b?this.positionGrid():this._repositionItemsInColumn(a)},_calculateNumColumns:function(){var a=this.options.minimum_num_columns||DEFAULT_MINIMUM_NUM_COLUMNS;if(!this.itemWidth)return a;this.options.centered||this.gridItems.$el.css("width","auto");var b=this.gridItems.getWidth(!1),c=Math.floor(b/this.itemWidth);return Math.max(a,c)},_positionItemInColumn:function(a,b){if(this.gridItems.isReady()){var c=this.childCidToItemInfo[a.cid],d=c.$itemWrapper;b=Math.max(0,b),b=Math.min(this.columnLengths.length-1,b);var e=this.columnLengths[b];d.css({top:e+"px",left:b*this.itemWidth+"px",visibility:"visible"}),c.columnIndex=b;var f=c.height+this.topBuffer+this.bottomBuffer,g=e+f;c.setPosition(e,g),this.columnLengths[b]=g,this._setShortestColumnIndex()}},_positionItem:function(a){if(this.gridItems.isReady()){if(0===this.columnLengths.length){if(!this.itemWidth){var b=this.childCidToItemInfo[a.cid],c=b.$itemWrapper;this.itemWidth=c.outerWidth(!0);var d=c.css("margin-top"),e=c.css("padding-top"),f=c.css("margin-bottom"),g=c.css("padding-bottom");this.topBuffer=pxToInt(d)+pxToInt(e),this.bottomBuffer=pxToInt(f)+pxToInt(g)}var h=this._calculateNumColumns();this.options.centered||this.gridItems.$el.css("width",h*this.itemWidth),this.columnLengths=new Array(h),this._setShortestColumnIndex()}var i=this.shortestColumnIndex;this._positionItemInColumn(a,i)}},_setShortestColumnIndex:function(){this.shortestColumnIndex=0;for(var a=0;a<this.columnLengths.length;a++)this.columnLengths[a]=this.columnLengths[a]||0,this.columnLengths[a]<this.columnLengths[this.shortestColumnIndex]&&(this.shortestColumnIndex=a)},_repositionItemsInColumn:function(a){if(this.gridItems.isReady()){var b=this;this.columnLengths[a]=0;var c=_.filter(this.childCidToItemInfo,function(b){return b.columnIndex===a}),d=_.sortBy(c,function(a){return a.top});_.each(d,function(c){b._positionItemInColumn(c.childModule,a)}),this.resizeContainer()}},resizeGrid:function(){var a=this.columnLengths.length,b=this._calculateNumColumns();a!==b&&(this.positionGridChildren(),this.gridItems.rearrangeItems(!0),this.gridItems.scheduleImpressionLogging())},resizeContainer:function(){var a=Math.max.apply(Math,this.columnLengths);this.gridItems.$el.css("height",a+"px"),this.gridItems.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},positionGrid:function(){this.gridItems.isReady()&&(this.positionGridChildren(),this.gridItems.rearrangeItems(),this.gridItems.scheduleImpressionLogging())},positionGridChildren:function(a){if(this.gridItems.isReady()){var b=this;a||(this.columnLengths=[]),_.each(this.gridItems.children,function(a){var c=b.childCidToItemInfo[a.cid];c.ensureHeightCalculated()}),_.each(this.gridItems.children,function(c){var d=b.childCidToItemInfo[c.cid];a&&d.hasPosition()||b._positionItem(d.childModule)}),this.resizeContainer()}},hideAndShowItems:function(a,b,c,d,e){var f=this,g=[],h=[];_.each(this.childCidToItemInfo,function(f){var i=f.$itemWrapper[0];f.bottom<d?a&&f.inDom&&(b||c!==Direction.DOWN||(g.push(i),f.inDom=!1)):f.top>e?a&&f.inDom&&(b||c!==Direction.UP||(g.push(i),f.inDom=!1)):f.inDom||(h.push(i),f.inDom=!0)}),(h.length>0||g.length>0)&&P.deferDomManipulation(function(){f.gridItems.log.debug("hideAndShowItems DOM manip showing ",h.length," hiding ",g.length);var a;if(h.length>0){var b=document.createDocumentFragment();for(a=0;a<h.length;a++)b.appendChild(h[a]);f.gridItems.$el[0].appendChild(b)}for(a=0;a<g.length;a++){var c=g[a];c.parentNode&&c.parentNode.removeChild(c)}})},logImpressions:function(a,b){var c=this,d=[];_.each(this.childCidToItemInfo,function(e){var f=e.top+c.topBuffer,g=e.bottom-c.bottomBuffer,h=!(f>=b||g<=a);h&&(d.push(e),null==e.impressionStart&&(e.impressionStart=Date.now()))});var e=_.difference(this.lastKnownItemInfosInViewport,d);this.lastKnownItemInfosInViewport=d,this._reportImpressions(e)},flushImpressions:function(){this._reportImpressions(this.lastKnownItemInfosInViewport)},_reportImpressions:function(a){for(var b=_.filter(a,function(a){return!a.impressionReported}),c=[],d=0;d<b.length;d++){var e=b[d];if(e.childModule.className===MODULE_NAME_PIN){var f=e.childModule.getLoggingObjectIdStr();f&&c.push({time:1e6*e.impressionStart,pinIdStr:f,endTime:1e6*Date.now()})}}if(c.length){var g=P.ContextEvent.fromEventType(P.ContextLogging.EventType.PIN_IMPRESSION_ONE_PIXEL);g.setPinImpressions(c),P.ContextLogger.getInstance().addEvent(g)}}};var FixedHeightLayoutManager=function(a,b){this.gridItems=a,this.options=b};FixedHeightLayoutManager.prototype={resizeGrid:function(){},onChildContentChanged:function(){},onChildDimsChanged:function(){},onChildRendered:function(){},onChildAdded:function(){},positionGridChildren:function(){},empty:function(){},positionGrid:function(){this.gridItems.isReady()&&this.gridItems._requestMoreItemsIfNeeded()},hideAndShowItems:function(){},onChildRemoved:function(a,b){b.remove(),this.gridItems.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},getFilledHeight:function(){var a=this.gridItems.getWidth(!1),b=this.gridItems.children.length;if(0===b)return 0;var c=this.gridItems.children[0],d=c.$el.outerWidth(!0),e=c.$el.outerHeight(!0),f=Math.floor(a/d),g=Math.ceil(b/f),h=b%f!==0,i=g*e;return h&&(i-=e),i},logImpressions:P.NOOP,flushImpressions:P.NOOP};var CloudGridLayoutManager=function(a,b){this.gridItems=a,this.options=b,this.$gridEl=this.gridItems.$el,this.$gridEl.grid({children:[],gridGutter:this.options.layout_manager_options.grid_gutter,gridSize:this.options.layout_manager_options.grid_size,setChildPosition:function(a,b){var c=a.parent();c.css(b)},unsetChildPosition:function(a){var b=a.parent();b.css({left:"auto",top:"auto"})},setChildProperties:function(a,b){a.css(b);var c=a.parent();c.css({visibility:"visible"})},unsetChildProperties:function(a){var b=a.parent();b.css({visibility:"hidden"})},maxRows:this.options.layout_manager_options.max_rows});var c=this;_.each(this.gridItems.children,function(a){c.$gridEl.grid("appendChild",a.$el,!0)})};CloudGridLayoutManager.prototype={resizeGrid:function(){this.positionGridChildren(!1)},onChildContentChanged:function(){this.positionGridChildren(!1)},onChildDimsChanged:function(){this.positionGridChildren(!1)},onChildRendered:function(){},onChildAdded:function(a){this.$gridEl.grid("appendChild",a.$el,!0)},positionGridChildren:function(a){this.$gridEl.grid("reflowContent",a)},empty:function(){},positionGrid:function(){this.positionGridChildren(!1)},hideAndShowItems:function(){},onChildRemoved:function(){},getFilledHeight:function(){return this.$gridEl.grid("getFilledHeight")},logImpressions:P.NOOP,flushImpressions:P.NOOP};var SortManager=function(a,b,c,d){this.gridItems=a,b||(b={}),b=_.extend({containment:"parent",cursor:"move",items:"."+SORTABLE_ITEM_CLASS,tolerance:"pointer",zIndex:SORTABLE_ZINDEX},b),this.gridItems.$el.sortable(b),this.childModuleName=c,this.idFn=d,this._setSortableMetadata(),this._hasNewElements=!0};SortManager.prototype={_setSortableMetadata:function(){var a=this;_.each(this.gridItems.getChildrenByModuleName(this.childModuleName),function(b){a._addSortableItemClass(b)})},_addSortableItemClass:function(a){var b=a.getParentElement();b.addClass(SORTABLE_ITEM_CLASS)},onChildAdded:function(a){this._addSortableItemClass(a),this._hasNewElements=!0},getSortOrder:function(){var a=this.idFn,b=[];return this._hasNewElements&&(_.each(this.gridItems.getChildrenByModuleName(this.childModuleName),function(b){b.$el.attr("data-sort-id")||b.$el.attr("data-sort-id",a(b))}),this._hasNewElements=!1),_.each(this.gridItems.$el.find("."+this.childModuleName),function(a){b.push($(a).attr("data-sort-id"))}),b}};var GridItems=P.Module.extend({events:{"click .trackActiveItem .item":"onTrackItemClick"},mixins:[P.Mixins.PreventScroll],onChildNavigate:function(a){var b=a.currentTarget;this.updateActiveItem(b.getParentElement())},onTrackItemClick:function(a){var b=a.currentTarget;this.updateActiveItem($(b))},updateActiveItem:function(a){var b=this.$(".activeItem");b.removeClass(CLASS_ACTIVE_ITEM),a.addClass(CLASS_ACTIVE_ITEM)},onCreated:function(){this._scrollListener=null,this.alreadyInitialized=!1,this.scrollTop=0,this.lastScrollTop=null,this.viewableHeight=null,this.lastTopBorder=null,this.lastBottomBorder=null,this.layoutManager=null,this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this.childListen(P.CONST.EVENT_DIMS_CHANGED,this.onChildDimsChanged)},initializeSortManager:function(a,b,c){this.sortManager=new SortManager(this,a,b,c)},getSortOrder:function(a,b){return this.sortManager?this.sortManager.getSortOrder(a,b):void 0},getChildModuleAtIndex:function(a,b){var c=this.children[a];return c&&c.className===b?c:null},getChildren:function(){return this.children},onOptionsChanged:function(){this._setScrollableElement(),this.alreadyInitialized=!1},onResourceChanged:function(){this.alreadyInitialized=!1},prependChildItem:function(a){var b=0;this.children.length>0&&this.children[0].options.anchored&&(b=1);var c;this.children.length>0&&(c=this.children[b].$el.parent()),this.insertChild(a,this.$el,b,c),this.layoutManager.positionGrid()},prependNewItems:function(a,b){var c=this,d=0,e=P.resourceFactory.clone(this.resource);e.resetBookmark(),e.set("prepend",!1),e.set("page_size",a);var f=new GridItems({resource:e});this.children.length>0&&this.children[0].options.anchored&&(d=1),f.options=this.options,f.render(function(){_.each(f.children.reverse(),function(a){a.remove(),c.insertChild(a,c.$el,d)}),c.layoutManager.positionGrid(),b&&b()})},requestMoreItems:function(){this.isReady()&&this._requestMoreItems()},hasMoreItems:function(){return this.resource&&!this.resource.atEnd()},_triggerIfItemsEnd:function(){this.hasMoreItems()||this.triggerEvent(P.CONST.EVENT_ITEMS_END,null,!0)},setPageSize:function(a){this.resource&&this.resource.set("page_size",a)},setHasScroll:function(a){this.$el.toggleClass("hasScroll",a)},onAddedToDom:function(){this.resizeListener=this.listen(P.Viewport,P.CONST.EVENT_RESIZE,this.onResize),this.navigateListener=this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate),this._setUpGrid(),this.onResize()},onResize:function(){this.isReady()&&this.layoutManager.resizeGrid()},hasItems:function(){return this.children.length>0},onContentReady:function(){var a=this.options.layout;if(a&&"variable_height"!==a)if("fixed_height"===a)this.layoutManager=new FixedHeightLayoutManager(this,this.options);else{if("cloud_grid"!==a)return void this.log.error('GridItems invalid value for "layout"',a);this.layoutManager=new CloudGridLayoutManager(this,this.options)}else this.layoutManager=new VariableHeightLayoutManager(this,this.options);this._setUpGrid(),this._triggerIfItemsEnd()},onRemovedFromDom:function(){this._scrollListener&&(this.removeListener(this._scrollListener),this._scrollListener=null),this.stopPreventScroll(),this.layoutManager.flushImpressions(),this.navigateListener&&this.removeListener(this.navigateListener),this.resizeListener&&this.removeListener(this.resizeListener)},scrollToActiveItem:function(a){var b=a.height(),c=this.$(".activeItem"),d=c.offset().top;a.scrollTop(d-b)},onChildContentChanged:function(a){a.stopPropagation();var b=a.currentTarget;this.isReady()&&(this.layoutManager.onChildContentChanged(b),this.rearrangeItems(!0),this.scheduleImpressionLogging())},onChildDimsChanged:function(a){a.stopPropagation();var b=a.currentTarget;this.isReady()&&this.layoutManager.onChildDimsChanged(b)},onChildRendered:function(a){this.isReady()&&this.layoutManager.onChildRendered(a)},onChildAdded:function(a){var b=a.getParentElement();if(!b.hasClass("item")){var c=$("<div></div>").addClass("item");c.insertBefore(a.$el),c.append(a.$el),b=c}this.layoutManager&&this.layoutManager.onChildAdded(a),this.sortManager&&this.sortManager.onChildAdded(a)},onChildRemoved:function(a,b){this.layoutManager&&this.layoutManager.onChildRemoved(a,b)},empty:function(){this.isEmptying=!0,P.Module.prototype.empty.call(this),this.alreadyInitialized=!1,this.contentReady=!1,this.layoutManager&&this.layoutManager.empty(),this.isEmptying=!1},handleError:function(a){this.pendingMoreRequest?this.$(".errorMessage").remove():P.Module.prototype.handleError.call(this,a)},_setUpGrid:function(){this._setScrollableElement(),this.isReady()&&!this.alreadyInitialized&&(this.layoutManager.positionGrid(),this.alreadyInitialized=!0)},_setScrollableElement:function(){this._scrollListener&&(this.removeListener(this._scrollListener),this._scrollListener=null),this.scrollableElement=this.getScrollableElement(),this.options.scrollable&&(this._scrollListener=this.listen(this.scrollableElement,"scroll",this._onScroll)),this._preventDefaultIfNeeded()},isReady:function(){return this.inDom&&this.contentReady},rearrangeItems:function(){this._requestMoreItemsIfNeeded(),this._hideAndShowItems(!1)},_onScroll:function(){this.lastScrollTop=this.scrollTop,this.scrollTop=this.getScrollableElement().scrollTop(),this.lastScrollTop!==this.scrollTop&&(this.rearrangeItems(!1),this.scheduleImpressionLogging())},scheduleImpressionLogging:function(){this.options.track_item_impressions&&(this._impressionLoggingScheduled||(this._impressionLoggingScheduled=!0,P.deferDomManipulation(_.bindFn(function(){this._impressionLoggingScheduled=!1;var a=this.scrollTop-this.offsetFromScrollElement,b=a+this.viewableHeight;this.layoutManager.logImpressions(a,b)},this))))},_hideAndShowItems:function(a){if(this.options.virtualize){a=a||!1;var b=!this.lastScrollTop||this.scrollTop>=this.lastScrollTop?Direction.DOWN:Direction.UP,c=this.scrollTop-this.offsetFromScrollElement,d=c+this.viewableHeight,e=c-ITEM_HIDE_BUFFER,f=d+ITEM_HIDE_BUFFER,g=null===this.lastTopBorder||null===this.lastBottomBorder||c<this.lastTopBorder||d>this.lastBottomBorder;(g||a)&&(this.layoutManager.hideAndShowItems(a,this.pendingMoreRequest,b,e,f),this.lastTopBorder=e,this.lastBottomBorder=f)}},onRendered:function(){this._requestMoreItemsIfNeeded(),P.Module.prototype.onRendered()},_requestMoreItemsIfNeeded:function(){if(this.isReady()&&this.options.scrollable&&!this.pendingMoreRequest&&!this.hasError&&this.hasMoreItems()){this.viewableHeight=this.scrollableElement.height(),this.offsetFromScrollElement=this.$el.positionAncestor(this.scrollableElement).top;var a=this.offsetFromScrollElement+this.layoutManager.getFilledHeight();a-(this.viewableHeight+this.scrollTop)>2*this.viewableHeight||this._requestMoreItems()}},_requestMoreItems:function(a){_.isUndefined(a)&&(a=2),this.triggerEvent(P.CONST.EVENT_ITEMS_REQUEST_START,null,!0),this.pendingMoreRequest=!0;var b=this,c=this.renderAppend(function(){b.layoutManager.positionGridChildren(!0),b.pendingMoreRequest=!1,b.hasError&&(b.triggerEvent(P.CONST.EVENT_ERROR_RESOLVED,null,!0),b.hasError=!1),b.triggerEvent(P.CONST.EVENT_ITEMS_REQUEST_SUCCESS,null,!0),b._requestMoreItemsIfNeeded(),b._triggerIfItemsEnd(),b.scheduleImpressionLogging()},function(){a>0?b._requestMoreItems(a-1):(b.pendingMoreRequest=!1,b.hasError=!0,b.triggerEvent(P.CONST.EVENT_ERROR,null,!0),b._triggerIfItemsEnd())});return c||(b.pendingMoreRequest=!1),c},_preventDefaultIfNeeded:function(){this.options.prevent_default_scroll&&this.startPreventScroll(this.scrollableElement,this.$el)}});P.modules.GridItems=GridItems,goog.provide("P.modules.HeroHelperBase"),goog.require("P.Module");var BUTTON_ID_CLOSE="close",HIDE_DELAY_MILLISECONDS=1e3;P.modules.HeroHelperBase=P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this._onButtonClick),this.placementId=Number(this.options.placement_id),this.experienceId=Number(this.options.experience_id),this.placedExperienceId=this.options.placed_experience_id,this.setExperienceViewed()},hide:function(){var a=this;this.fadeOut(function(){a.destroy()})},dismiss:function(a){P.trackGAEvent("hero_helper_"+this.options.type,P.CONST.GA_ACTION_CLICK_CLOSE),this.dismissPlacedExperience(),a||this.hide()},complete:function(a){var b=this;P.trackGAEvent("hero_helper_"+this.options.type,P.CONST.GA_ACTION_CLICK_CONFIRM),this.completePlacedExperience(),a||(this.options.delay_hide?P.setTimeout(function(){b.hide()},HIDE_DELAY_MILLISECONDS):this.hide())},setExperienceViewed:function(){P.trackGAEvent("hero_helper_"+this.options.type,"viewed");var a=P.ExperienceManager.instance();this.placedExperienceId?a.viewPlacedExperienceId(this.placedExperienceId):a.viewPlacedExperience(this.placementId,this.experienceId)},completePlacedExperience:function(a){var b=P.ExperienceManager.instance();this.placedExperienceId?b.completePlacedExperienceId(this.placedExperienceId,a):b.completePlacedExperience(this.placementId,this.experienceId,a)},dismissPlacedExperience:function(a){var b=P.ExperienceManager.instance();this.placedExperienceId?b.dismissPlacedExperienceId(this.placedExperienceId,a):b.dismissPlacedExperience(this.placementId,this.experienceId,a)},onButtonClick:function(){},_onButtonClick:function(a){this.onButtonClick(a);var b=a.target;b.id===BUTTON_ID_CLOSE&&this.dismiss()}}),goog.provide("P.modules.HeroPlacePinsBase"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase"),P.modules.HeroPlacePinsBase=P.modules.HeroHelperBase.extend({}),goog.provide("P.modules.HeroPlacePinsExamplesBase"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase"),P.modules.HeroPlacePinsExamplesBase=P.modules.HeroHelperBase.extend({}),goog.provide("P.modules.ImagesFeedPageBase"),goog.require("P.Module"),P.modules.ImagesFeedPageBase=P.Module.extend({}),goog.provide("P.modules.InterestFeedPageBase"),goog.require("P.Module"),P.modules.InterestFeedPageBase=P.Module.extend({}),goog.provide("P.modules.LoginBase"),goog.require("P.Module"),P.modules.LoginBase=P.Module.extend({events:{},onContentReady:function(){this.setupForm(),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.getChildById("facebookLogin")&&this.listen(this.getChildById("facebookLogin"),P.CONST.EVENT_BUTTON_CLICK,this.facebookConnect),this.getChildById("twitterLogin")&&this.listen(this.getChildById("twitterLogin"),P.CONST.EVENT_BUTTON_CLICK,this.twitterConnect),this.getChildById("rakutenLogin")&&this.listen(this.getChildById("rakutenLogin"),P.CONST.EVENT_BUTTON_CLICK,this.rakutenConnect)},setupForm:function(){this.$form=this.$("form"),this.form=new P.Form(this.$form,{username_or_email:[P.Validator.Required(),P.Validator.Email()],password:[P.Validator.Required()]},{})},onSubmitValidated:function(a){a["errors[0]"]||this.login({username_or_email:this.form.getValue("username_or_email"),password:this.form.getValue("password")})},twitterConnect:function(a){a.stopPropagation(),this.connect(P.SocialConnect.TWITTER,this.onTwitterConnectSuccess)},facebookConnect:function(a){a.stopPropagation(),this.connect(P.SocialConnect.FACEBOOK,this.onFacebookConnectSuccess)},rakutenConnect:function(a){a.stopPropagation(),this.connect(P.SocialConnect.RAKUTEN,this.onRakutenConnectSuccess)},onFacebookConnectSuccess:function(a){var b=this,c=function(a){a.message&&P.showError(a.message)},d=this.getChildById("facebookSignup");this.options.register&&(c=function(){return d.showLoading(),P.UserRegistration.fastTrackSocialRegistration(P.SocialConnect.FACEBOOK).then(function(){d.hideLoading(),window.location.href="/"},function(){d.hideLoading(),b.navigate("/join/register/facebook/")}),P.NOOP}),this.login({facebook_id:a.id,facebook_token:a.access_token},c)},onTwitterConnectSuccess:function(a){var b=function(a){a.message&&P.showError(a.message)};P.SessionStorage.setItem(P.CONST.SESSION_TWITTER_ID,a.id),P.SessionStorage.setItem(P.CONST.SESSION_TWITTER_TOKEN,a.oauth_token),P.SessionStorage.setItem(P.CONST.SESSION_TWITTER_TOKEN_SECRET,a.oauth_secret),P.SessionStorage.setItem(P.CONST.SESSION_TWITTER_FIRST_NAME,a.first_name),P.SessionStorage.setItem(P.CONST.SESSION_TWITTER_LAST_NAME,a.last_name),P.SessionStorage.setItem(P.CONST.SESSION_TWITTER_USERNAME,a.screen_name),P.SessionStorage.setItem(P.CONST.SESSION_TWITTER_IMAGE_URL,a.image_url),this.options.register?this.navigate("/join/register/twitter/"):this.login({twitter_id:a.id,twitter_token:a.oauth_token,twitter_token_secret:a.oauth_secret},b)},onRakutenConnectSuccess:function(a){var b=function(a){a.message&&P.showError(a.message)};if(P.SessionStorage.setItem(P.CONST.SESSION_RAKUTEN_ID,a.id),P.SessionStorage.setItem(P.CONST.SESSION_RAKUTEN_TOKEN,a.access_token),P.SessionStorage.setItem(P.CONST.SESSION_RAKUTEN_REFRESH_TOKEN,a.refresh_token),P.SessionStorage.setItem(P.CONST.SESSION_RAKUTEN_FIRST_NAME,a.first_name),P.SessionStorage.setItem(P.CONST.SESSION_RAKUTEN_GENDER,a.gender),P.SessionStorage.setItem(P.CONST.SESSION_RAKUTEN_EMAIL,a.email),this.options.register){var c=this.getChildById("rakutenSignup");
b=function(){return c.showLoading(),P.UserRegistration.fastTrackSocialRegistration(P.SocialConnect.RAKUTEN).then(function(){c.hideLoading(),window.location.href="/"},function(){c.hideLoading(),this.navigate("/join/register/rakuten/")}),P.NOOP}}this.login({rakuten_id:a.id,rakuten_token:a.access_token,rakuten_refresh_token:a.refresh_token},b)},showError:function(a){this.$(".loginError").html("<p>"+a+"</p>").show()},connect:function(a,b){var c=P.SocialConnect.instance(),d=this;return c.connect(a,{success:function(a){b.call(d,a)},error:function(){P.showError(P.string.common.connectError)}}),!1},login:function(a,b){var c=this.getChildById("loginButton");c&&c.showLoading();var d=P.SessionStorage.getItem(P.CONST.SESSION_KEY_INVITE_FOLLOW),e=this,f=function(){e.showLoading(!0),e.redirect(d)};b||(b=function(b){if(e.showError(b.message),b.api_error_code===P.CONST.AUTO_PASSWORD_RESET_ERROR_CODE&&a.username_or_email){var c=P.getResetPasswordOneClickUrl({username_or_email:a.username_or_email});e.navigate(c)}});var g=function(){c&&c.hideLoading()};P.currentUser.login(a,f,b,g)},redirect:function(a){var b="/";a&&(a.invite_follow_user?b="/"+a.invite_follow_user+"/":a.invite_follow_board&&(b="/"+a.invite_follow_board+"/"),P.SessionStorage.removeItem(P.CONST.SESSION_KEY_INVITE_FOLLOW));var c=this.options.next||b;P.navigateAfterLoginStatusChange(c)}}),goog.provide("P.modules.LoginPageBase"),goog.require("P.Module"),P.modules.LoginPageBase=P.Module.extend({events:{}}),goog.provide("P.modules.LogoutPage"),goog.require("P.Module"),P.modules.LogoutPage=P.Module.extend({events:{},onContentReady:function(){this.logout()},logout:function(){var a=P.resourceFactory.create("UserSessionResource",{}),b=this.options.next||"/";a.callDelete({success:function(){P.SessionStorage.clear(),P.LocalStorage.clear(),P.currentUser.logout(function(){P.navigateAfterLoginStatusChange(b)})}})}}),goog.provide("P.modules.Map"),goog.require("P.Module"),goog.require("P.versionedFileLoader");var SAFE_ZONE_MIN_PADDING_VALUE=70;P.MarkerOptions=function(){this.pin=null,this.highlighted=!1,this.animated=!1,this.placeholder=!1,this.latitude=!1,this.longitude=!1},P.MarkerOptionsFactory={},P.MarkerOptionsFactory.fromPlainObject=function(a){var b=new P.MarkerOptions;return"pin"in a&&(b.pin=a.pin),"highlighted"in a&&(b.highlighted=a.highlighted),"animated"in a&&(b.animated=a.animated),"placeholder"in a&&(b.placeholder=a.placeholder),"latitude"in a&&(b.latitude=a.latitude),"longitude"in a&&(b.longitude=a.longitude),"type"in a&&"place"===a.type&&(b.place=a),b};var VIEW_TYPE_BOARD_PAGE="board_page",VIEW_TYPE_CLOSEUP="closeup",CLASS_FADE_OUT_UP="fadeOutUp",CLASS_TOP_ZINDEX="topZIndex",NUNJUCKS_TEMPLATE_DIRECTORY="app/common/modules/Map/",TEMPLATE_POPUP_DEFAULT=NUNJUCKS_TEMPLATE_DIRECTORY+"markerPopup.nunjucks",MARKER_CLUSTER_TEMPLATE=NUNJUCKS_TEMPLATE_DIRECTORY+"markerCluster.nunjucks",MARKER_TEMPLATE=NUNJUCKS_TEMPLATE_DIRECTORY+"marker.nunjucks",TEMPLATE_POPUP_TOAST=NUNJUCKS_TEMPLATE_DIRECTORY+"addToMapToast.nunjucks",MAX_ZOOM_LEVEL=17,DEFAULT_POPUP_WIDTH=270,TIME_UNTIL_TOAST_REMOVES_SELF=3e3,TIME_MARKER_ANIMATION=500,TIME_TOAST_FADE_ANIMATION=300;P.modules.Map=P.Module.extend({setup:function(){this.map||(this._generateMap(this.options.map_id),this._initializeMapHandlers(),this._paddingTopLeft=L.point(0,0)),this.triggerEvent(P.CONST.EVENT_MAP_READY,null,!0)},_isBoardView:function(){return this.options.view_type===VIEW_TYPE_BOARD_PAGE},_isCloseupView:function(){return this.options.view_type===VIEW_TYPE_CLOSEUP},addMarkerToCloseupMap:function(){var a=this.options.pin_geo;if(a){var b=[a.latitude,a.longitude],c=this.map,d={highlighted:!0,animated:!1,pin:this.options.pin},e=this._generateDivIcon(d),f=L.marker(b,{icon:e});f.addTo(c);var g=f.getLatLng();c.setView(g,15)}},replaceToastWithDefaultPopup:function(a){var b=a._source,c=b.options;c.template=TEMPLATE_POPUP_DEFAULT;var d=this._generatePopup(c);b.bindPopup(d,{closeButton:!1,autoPan:!1,maxWidth:DEFAULT_POPUP_WIDTH,minWidth:DEFAULT_POPUP_WIDTH})},addMarkerToMap:function(a){var b=this,c=a.pin;a.animated&&!a.placeholder&&c.render(_.bindFn(function(){var a=this;a.trigger(P.CONST.ADD_HOVER_LISTENER_FOR_MAP_MARKER)},c));var d=this._generateMarker(a),e=a.placeholder?this.placeholderMarkerLayer:this.markerLayer;if(e===this.placeholderMarkerLayer&&d.on("click",function(a){var c=a.target,d=c.options.place,e=_.indexOf(b.placeholderMarkerLayer.getLayers(),c),f={index:e,place_id:d};b.triggerEvent(P.CONST.PLACEHOLDER_MARKER_POPUP_OPENED,f,!0),b.highlightPlaceholderMarker(e)}),!a.placeholder){a.animated&&(a.template=TEMPLATE_POPUP_TOAST);var f=this._generatePopup(a);_.extend(d.options,a),d.bindPopup(f,{closeButton:!!a.animated,autoPan:!1,maxWidth:P.CONST.PIN_WIDTH,minWidth:P.CONST.PIN_WIDTH})}d.addTo(e),a.placeholder&&d._bringToFront()},toggleTranslucentMarkers:function(a){var b=this,c=this.markerLayer.getLayers();_.each(c,function(c){var d=b.markerLayer.getVisibleParent(c);d&&$(d._icon).toggleClass("fadeOut notActionable",a)})},_generateMarker:function(a){var b=a.pin,c=a.highlighted,d=a.animated,e=a.coordinates||b.getCoordinates(),f=a.name,g=a.placeholder,h={highlighted:c,animated:d,placeholder:g,pin:b};f&&(h.name=f);var i,j;if(b){i=b.getPinId();var k=b.getPlaceData();k&&(j=k.id)}"place"in a&&(j=a.place.id);var l=this._generateDivIcon(h),m=L.marker(e,{icon:l,riseOnHover:!0,pin_id:i,place:j});return i&&(m.pin_id=i),m},_generatePopup:function(a){var b=a.pin,c=a.url||a.source_url||b.getLink(),d=a.name||b.getPlaceName(),e=b.getPlaceData()||a,f=a.template||TEMPLATE_POPUP_DEFAULT,g=P.renderNunjucks(f,{url:c,name:d,place:e});return g},_generateDivIcon:function(a){var b=this._getDivIconOptions(a),c=L.divIcon(b);return c},clearMarkers:function(){this.markerLayer.clearLayers()},getCenter:function(){var a=this.map&&this.map.getCenter();return a?a:null},setPaddingTopLeft:function(a){this._paddingTopLeft=a},getZoom:function(){return this.map?this.map.getZoom():null},getBounds:function(){return this.map?this.map.getBounds():null},highlightMarkerForPinId:function(a){this._setHighlightMarkerForPinId(a,!0)},showOnlyPlaceholderMarkerAtIndex:function(a){var b=this.placeholderMarkerLayer.getLayers();_.each(b,function(b,c){c!==a?$(b._icon).hide():$(b._icon).show()})},showAllPlaceholderMarkers:function(){var a=this.placeholderMarkerLayer.getLayers();_.each(a,function(a){$(a._icon).show()})},unHighlightMarkerForPinId:function(a){this._setHighlightMarkerForPinId(a,!1);var b=this.getMarkerForPin(a);b.closePopup()},removeMarkerForPinId:function(a){var b=this.getMarkerForPin(a);b&&this.markerLayer.removeLayer(b)},_setHighlightMarkerForPinId:function(a,b){var c=this.getMarkerForPin(a);c=this.markerLayer.getVisibleParent(c),b?this.highlightMarker(c):this.unHighlightMarker(c)},unHighlightMarker:function(a){var b=this.markerLayer.getVisibleParent(a),c=this._getIconElement(b);c.removeClass("highlightedMarkerIcon"),this._highlightedPinMarker=null},_getIconElement:function(a){var b=$(a._icon);return b.find(".markerCluster, .markerIcon").first()},highlightMarker:function(a){var b=this.markerLayer.getVisibleParent(a),c=this._getIconElement(b);c.addClass("highlightedMarkerIcon"),this._highlightedPinMarker=b},_setHighlightMarker:function(a,b,c){var d=this._generateDivIcon({highlighted:b,animated:!1,placeholder:c});a.setIcon(d),a._highlighted=b,b&&a._bringToFront()},getHighlightedMarker:function(){return this._highlightedPinMarker},_initializeMapHandlers:function(){if(this._isBoardView()){var a=this;this.map.markerLayer.on("mousedown",function(){a._triggerBodyMousedown()}),this.map.on("mousedown",function(){a._triggerBodyMousedown()}),this.map.on("dragend",function(){a.onDragEnd()}),this.map.on("zoomend",function(){a.onZoomEnd()}),this.markerLayer.on("popupopen",function(b){var c=b.popup;a.onPopupOpen(c)}),this.markerLayer.on("popupclose",function(b){var c=b.popup;a.onPopupClose(c)}),this.markerLayer.on("clusterclick",function(){a.closeAllMarkerPopups()})}},onPopupOpen:function(a){var b=a._wrapper,c=a._source,d=c._icon,e=this.clientRectToBounds(b.getBoundingClientRect()),f=this.clientRectToBounds(d.getBoundingClientRect()),g=this.mergeBounds(e,f);this.ensureBoundsInSafeBounds(g);var h=c.options.pin_id;this.triggerEvent(P.CONST.EVENT_MAP_POPUP_OPENED,h,!0),c._bringToFront(),$(d).addClass(CLASS_TOP_ZINDEX)},onPopupClose:function(a){var b=this,c=a._source,d=c._icon,e=c.__parent,f=this.markerLayer.getVisibleParent(e);c.options.animated&&(this.replaceToastWithDefaultPopup(a),c.options.animated=!1),this.unHighlightMarker(c),f&&"unspiderfy"in f&&c===this._singleMarkerSpiderfied?(this._singleMarkerSpiderfied=null,f.unspiderfy(),P.setTimeout(function(){f._group._unspiderfyLayer(c),b.unHighlightMarker(f)},180)):this.unHighlightMarker(c),this.resetPinButtons(),$(d).removeClass(CLASS_TOP_ZINDEX)},getSafeZonePaddingTopLeft:function(){return this._paddingTopLeft},unHighlightPlaceholderMarker:function(a){var b=this.placeholderMarkerLayer.getLayers()[a];b&&this._setHighlightMarker(b,!1,!0)},getSafeZonePaddingBottomRight:function(){var a=SAFE_ZONE_MIN_PADDING_VALUE,b=SAFE_ZONE_MIN_PADDING_VALUE;return L.point(a,b)},clientRectToBounds:function(a){var b=L.point(a.left,a.top),c=L.point(a.right,a.bottom);return L.bounds(b,c)},inflateBounds:function(a,b){var c=L.bounds(a.min.clone(),a.max.clone());return c.min.x-=b,c.min.y-=b,c.max.x+=b,c.max.y+=b,c},mergeBounds:function(a,b){var c=Math.min(a.min.x,b.min.x),d=Math.min(a.min.y,b.min.y),e=Math.max(a.max.x,b.max.x),f=Math.max(a.max.y,b.max.y);return L.bounds(L.point(c,d),L.point(e,f))},ensureBoundsInSafeBounds:function(a){var b=this.getSafeZoneBounds(),c=5,d=this.inflateBounds(b,-1*c),e=0;a.min.x<d.min.x?e=a.min.x-d.min.x:a.max.x>d.max.x&&(e=a.max.x-d.max.x);var f=0;a.min.y<d.min.y?f=a.min.y-d.min.y:a.max.y>d.max.y&&(f=a.max.y-d.max.y),(0!==e||0!==f)&&this.panBy(L.point(e,f))},getRawView:function(){return{center:this.map.getCenter(),zoom:this.map.getZoom()}},setRawView:function(a){this.map.setView(a.center,a.zoom)},panTo:function(a){this.setView(a,this.map.getZoom())},setView:function(a,b){var c=this.getSafeZonePaddingTopLeft(),d=this.getSafeZonePaddingBottomRight(),e=d.subtract(c).divideBy(2),f=this.map.project(a,b),g=this.map.unproject(f.add(e),b);this.map.setView(g,b)},panBy:function(a){this.map.panBy(a)},fitBounds:function(a){var b=this.getSafeZonePaddingTopLeft(),c=this.getSafeZonePaddingBottomRight();this.map.fitBounds(a,{paddingTopLeft:b,paddingBottomRight:c})},fitWorld:function(){this.map.fitWorld().panTo([40.58,-36.91])},getMinZoomToCover:function(a,b){for(var c=L.CRS.EPSG3857,d=1;d<=MAX_ZOOM_LEVEL;d++){var e=L.latLng(90,-180),f=L.latLng(-90,180),g=c.latLngToPoint(e,d),h=c.latLngToPoint(f,d),i=h.x-g.x,j=h.y-g.y,k=i>a&&j>b;if(k)return d}return MAX_ZOOM_LEVEL},getMinZoom:function(a){var b=$(a),c=b.width(),d=b.height();return this.getMinZoomToCover(c,d)},updateMinZoom:function(){var a=this.map.getContainer(),b=this.getMinZoom(a);this.map.options.minZoom=b,this.map._updateZoomLevels()},zoomIn:function(){this.map.zoomIn()},zoomOut:function(){this.map.zoomOut()},_generateMap:function(a){var b="",c=this._isBoardView();b=c?"mapbox_board_page":"mapbox_closeup";var d=this.$("#"+b)[0],e=this.getMinZoom(document.getElementById(b)),f={detectRetina:!0};$(".ielt9").length||(f.format="png64"),this.map=L.mapbox.map(d,a,{maxZoom:MAX_ZOOM_LEVEL,minZoom:e,worldCopyJump:!0,keyboard:!1,zoomControl:!1,attributionControl:!1,inertiaThreshold:75,inertiaDeceleration:5e3,tileLayer:f}),this.markerLayer=new L.MarkerClusterGroup({mapModule:this,isMobile:this.options.is_mobile,showCoverageOnHover:!1,removeOutsideVisibleBounds:!1,maxClusterRadius:40,iconCreateFunction:function(a){a=a;var b=a.getAllChildMarkers(),c=b[0].options.pin,d=null,e=a.getChildCount();c&&(d=c.getImageUrl("236x"));var f={};return f.markerClusterPinImage=d,f.clusterChildCount=e,new L.DivIcon({html:P.renderNunjucks(MARKER_CLUSTER_TEMPLATE,f),iconSize:[52,74],iconAnchor:[24,66]})}}).addTo(this.map),this.placeholderMarkerLayer=L.featureGroup().addTo(this.map),this.map.scrollWheelZoom.disable(),c&&(this.options.is_mobile||(new L.Control.CustomMapZoomControl).addTo(this.map))},onResize:function(){this.updateMinZoom()},addPermanentMarkerFromTypeahead:function(a){var b=this,c=a.pin,d=c.getId();this.addMarkerToMap(a),P.setTimeout(function(){b.openPopupForPin(d),P.setTimeout(function(){var a=b.getMarkerForPin(d),c=b.$(".leaflet-popup-content-wrapper, .leaflet-popup-tip-container");c.addClass(CLASS_FADE_OUT_UP),P.setTimeout(function(){a.closePopup(),c.removeClass(CLASS_FADE_OUT_UP)},TIME_TOAST_FADE_ANIMATION)},TIME_UNTIL_TOAST_REMOVES_SELF)},TIME_MARKER_ANIMATION)},clearPlaceholderMarkers:function(){this.placeholderMarkerLayer.clearLayers()},setPlaceholderMarkers:function(a,b){this.clearPlaceholderMarkers();for(var c=0,d=a.length;c<d;c++){var e=a[c];this.addMarkerToMap(e)}b&&this.fitViewToPlaceholderMarkers()},clearPlaceholderHighlights:function(){var a=this;_.each(this.placeholderMarkerLayer.getLayers(),function(b){a._setHighlightMarker(b,!1,!0)})},highlightPlaceholderMarker:function(a){var b=this.placeholderMarkerLayer.getLayers()[a];b&&this._setHighlightMarker(b,!0,!0)},onAddedToDom:function(){var a=_.bindFn(this.setup,this);P.VersionedFileLoader.instance.loadScript("webapp/js/app/common/bundle-mapbox.js",function(){a()})},fitViewToPlaceholderMarkers:function(){this.fitViewToMarkers(!0)},fitViewToPinMarkers:function(){this.fitViewToMarkers(!1)},closeAllMarkerPopups:function(){var a=this.markerLayer.getLayers();_.each(a,function(a){a.closePopup()})},fitViewToMarkers:function(a){if(this.map){var b=a?this.placeholderMarkerLayer:this.markerLayer,c=b.getBounds();c&&!_.isEmpty(c)&&(this.fitBounds(c),a||this._ensureMarkersAreInBounds())}},_ensureMarkersAreInBounds:function(){var a=this.markerLayer.getLayers();if(a.length){var b=this,c=this.getSafeZoneBounds(),d=!1;if(_.each(a,function(a){var e=a.getLatLng(),f=b.map.latLngToContainerPoint(e);c.contains(f)&&(d=!0)}),!d){var e=this.markerLayer.getLayers()[0];this.panTo(e.getLatLng())}}},resetPinButtons:function(){this.triggerEvent(P.CONST.EVENT_RESET_SHOW_PIN_ON_MAP_BUTTON,null,!0)},getSafeZoneBounds:function(){var a=this.getSafeZonePaddingTopLeft(),b=this.map.getSize().subtract(this.getSafeZonePaddingBottomRight());return L.bounds(a,b)},getSafeZoneLatLngBounds:function(){var a=this.getSafeZonePaddingTopLeft(),b=this.map.getSize().subtract(this.getSafeZonePaddingBottomRight()),c=this.map.containerPointToLatLng(a),d=this.map.containerPointToLatLng(b);return new L.LatLngBounds(c,d)},openPopupForMarker:function(a){var b=this.markerLayer.getVisibleParent(a);if(b&&"getChildCount"in b&&b.getChildCount()>1){var c=this.map.latLngToLayerPoint(a._latlng);c.y+=10;var d=b._generatePointsCircle(1,c);b._animationSpiderfy([a],d),this._singleMarkerSpiderfied=a}a.openPopup(),a._bringToFront()},openPopupForPin:function(a){var b=this.getMarkerForPin(a);this.openPopupForMarker(b)},getMarkerForPin:function(a){if(this.markerLayer){var b=_.find(this.markerLayer.getLayers(),function(b){return b.pin_id===a});return b}},onCreated:function(){this._pinIdToMarkerIndex={},this._highlightedPinMarker=null,this.resizeListener=null,this._mapCardinalDirectionToNearestMoreMarker={},this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onChildButtonClick)},_getDivIconOptions:function(a){var b=a.highlighted,c=a.animated,d=a.placeholder,e=[0,-55],f="markerIconWrapper";c&&(f+=" animated");var g="markerIcon";b&&(g+=" highlightedMarkerIcon");var h,i,j,k,l,m;d?(g+=" placeholder",i=9,j=9,k=[i,j],l=[i/2,j/2]):(g+=" pin",i=52,j=70,k=[i,j],l=[17,70],h="",m=a.pin);var n={iconSize:[i,j],iconAnchor:[i/2,j],popupAnchor:e,pin:m},o=null;m&&!d&&(o="getImageUrl"in m?m.getImageUrl("236x"):m.images["236x"].url);var p={};return p.markerWrapperClassName=f,p.markerClassName=g,p.pinImage=[o],n.html=P.renderNunjucks(MARKER_TEMPLATE,p),n},addMarkersToMap:function(a){var b=this;_.each(a,function(a){var c=a.getCoordinates();if(c){var d={pin:a,highlighted:!1,animated:!1};b.addMarkerToMap(d)}})},_triggerBodyMousedown:function(){$("body").trigger("mousedown")},onDragEnd:function(){this.triggerEvent(P.CONST.EVENT_MAP_DRAG_END,null,!0)},onZoomEnd:function(){this.triggerEvent(P.CONST.EVENT_MAP_ZOOM_END,null,!0)}}),goog.provide("P.modules.ModalTrigger"),goog.require("P.Module"),P.modules.ModalTrigger=P.Module.extend({showModal:function(){this.options.ga_category&&P.trackGAEvent(this.options.ga_category,P.CONST.GA_ACTION_OPEN_MODAL);var a=this;this.showLoading(),P.loadModule(this.options.submodule,function(b){a.hideLoading(),a.showInModal(b,a.options.extra_options)})}}),goog.provide("P.modules.NuxProgress"),goog.require("P.Module"),goog.require("P.tutorialManager"),P.modules.NuxProgress=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick);var a={};a[P.CONST.PUBSUB_TOPIC_TUTORIAL_NEXT]=this.triggerNextEvent,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_TUTORIAL,a)},initializeProgress:function(a){this.module=a?a.module:null,this.tutorialManager.isTutorialActive()||this.tutorialManager.startTutorial(this.tutorialName,{renderModule:!1,progressModule:this})},onContentReady:function(){this.tutorialManager=P.TutorialManager.instance(),this.progressWrapper=this.$(".nuxProgress"),this.header1=this.$(".headerTitle1"),this.header2=this.$(".headerTitle2"),this.progressBar=this.getChildByModuleName("ui.Progress"),this.nextButton=this.getChildById("nextButton"),this.progressWrapper.removeClass("hidden"),this.tutorialName=this.getNuxTutorialName(),this.progressData=this.extraData?this.extraData.progressData:null,this.setStepTexts(1),this.initializeProgress()},onExit:function(a){this.endMandatoryFlow(a)},nextStep:function(a){this.setStepTexts(a)},onButtonClick:function(a){var b=a.target;b&&("previousButton"===b.id?(a.stopPropagation(),this.triggerPreviousEvent()):"nextButton"===b.id&&(a.stopPropagation(),this.triggerNextEvent()))},getNextButton:function(){return this.nextButton},endMandatoryFlow:function(a){var b=this,c=function(){a&&a(),b.remove();var c=P.app;c.updateNavigationBar()};P.ExperienceManager.instance().isPlacedExperience(P.Experiences.Placement.WEB_HOME_TAKEOVER,P.Experiences.Experience.WEB_MANDATORY_AUTOBAHN)?P.ExperienceManager.instance().completePlacedExperience(P.Experiences.Placement.WEB_HOME_TAKEOVER,P.Experiences.Experience.WEB_MANDATORY_AUTOBAHN,function(){c()}):c()},setStepTexts:function(a){var b=null,c=null,d=null;if(this.progressData){var e=this.progressData[this.tutorialName];if(e){var f=e.steps;if(f){var g=f[a];g&&(b=g.buttonText,c=g.header1,d=g.header2)}}}b&&this.getNextButton().setText(b),c&&this.header1.html(c),d&&this.header2.html(d)},getNuxTutorialName:function(){return this.extraData?this.extraData.tutorialName:"newUserExperienceWithInterestSearch"},triggerPreviousEvent:function(){this.triggerEvent(P.CONST.EVENT_PREVIOUS,null,!1)},triggerNextEvent:function(){this.triggerEvent(P.CONST.EVENT_NEXT,null,!1)}}),goog.provide("OAuthDialog"),goog.require("P.Module"),P.modules.OAuthDialog=P.Module.extend({events:{},onContentReady:function(){this.resizeWindowToFit()},onChildRemoved:function(){this.children.length?this.resizeWindowToFit():window.close()},resizeWindowToFit:function(){P.getWindowManager().shrinkWrap()}}),goog.provide("P.modules.OAuthPageBase"),goog.require("P.Module");var REDIRECT_DELAY=2e3;P.modules.OAuthPageBase=P.Module.extend({getOAuthResource:function(a){var b=_.extend(this.resource.copyOptions(!0),a);return P.resourceFactory.create("OAuthAuthorizationResource",b)},makeAuthorizationDecision:function(a,b,c){var d=this.getOAuthResource({authorized:a}),e=this;d.callCreate().done(function(a){e.tryRedirect(a.resource_response.data,c)}).fail(function(a){P.showError(a.message)}).always(function(){b&&b.hideLoading()})},tryRedirect:function(a,b){if(a.redirect){var c,d=a.redirect_uri;a.access_token?(d+="#",c={access_token:a.access_token,expires_at:a.expires_at,token_type:a.token_type}):a.code?(d+="?",c={code:a.code}):a.oauth_error_code?(d+="?",c={error:a.oauth_error_code}):(d+="?",c={error:"server_error"}),a.state&&(c.state=a.state),d+=$.param(c),b?(this.showRedirectScreen(),P.setTimeout(function(){window.location=d},REDIRECT_DELAY)):window.location=d}},onContentReady:function(){this.setupForm(),this.$("form input").first().focus()},setupForm:function(){if(0!==this.$(".loginForm").length){var a={username_or_email:[P.Validator.Required(),P.Validator.Email()],password:[P.Validator.Required()]};this.loginForm=new P.Form(this.$("form"),a),this.loginFormListener=this.listen(this.loginForm,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)}},onSubmitValidated:function(a){if(!a.errors||!a.errors.length){var b=this,c=function(){b.authorizeApp()},d=function(a){if(b.$(".loginError").html(a.message).show(),a.api_error_code===P.CONST.AUTO_PASSWORD_RESET_ERROR_CODE){var c=P.getResetPasswordOneClickUrl({username_or_email:this.loginForm.email});b.navigate(c)}};P.currentUser.login(this.loginForm.getData(),c,d)}},authorizeApp:function(){var a=this.getChildById("authorizeButton");a.showLoading(),this.makeAuthorizationDecision(!0,a,!0)},onAuthorizeButtonClicked:function(a){this.loginForm?this.loginForm.onSubmit(a):this.authorizeApp()},showRedirectScreen:function(){this.$(".body").hide(),this.$(".loading").show()}}),goog.provide("P.modules.OffsitePage"),goog.require("P.Module"),P.modules.OffsitePage=P.Module.extend({onContentReady:function(){var a={name:"ConfirmDialog",options:{template:"offsite_warning",sanitized_url:this.options.sanitized_url,redirect_status:this.options.redirect_status}},b=function(){window.close()},c=this;P.loadModule(a,function(a){a.render(function(){P.getModalManager().showInModal(a),a.on(P.CONST.EVENT_CONFIRM,function(){window.location.replace(c.options.sanitized_url),a.off(P.CONST.EVENT_DESTROYED,b)}),a.on(P.CONST.EVENT_DESTROYED,b)})})}}),goog.provide("P.modules.PagedGrid"),goog.require("P.Module");var DEFAULT_AJAX_PAGE_SIZE=9,HIDE_CLASS="hide";P.modules.PagedGrid=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onMoreItemsClick)},onAddedToDom:function(){this.contentReady&&this._setUpGrid()},onContentReady:function(){this.inDom&&this._setUpGrid()},prependChildItem:function(a){var b=this.getChildById("grid");b.prependChildItem(a)},onMoreItemsClick:function(a){var b=a.target;b&&"moreItems"===b.id&&(a.stopPropagation(),this.requestMore())},_setUpGrid:function(){var a=this.getChildById("grid"),b=this.options.ajax_page_size||DEFAULT_AJAX_PAGE_SIZE;a.setPageSize(b),a.hasMoreItems()||this.$(".moreItems").addClass(HIDE_CLASS),this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this.childListen(P.CONST.EVENT_ERROR,this.onChildError)},hasItems:function(){var a=this.getChildById("grid");return a.hasItems()},requestMore:function(){if(this.contentReady){var a=this.getChildById("moreItems");a.showLoading();var b=this.getChildById("grid");b.requestMoreItems()}},onChildContentChanged:function(){var a=this.getChildById("moreItems");if(a){if(this.gridHasError)return a.hide(),void(this.gridHasError=!1);var b=this.getChildById("grid");b.hasMoreItems()?(a.show(),a.hideLoading()):a.destroy()}},onChildError:function(a){this.log.debug("Child error!",a),a.target===this.getChildById("grid")&&(this.gridHasError=!0)}}),goog.provide("P.modules.PinBase"),goog.require("P.Module");var CLASS_MAP_FOCUS="mapFocus";P.modules.PinBase=P.Module.extend({onContentReady:function(){P.Module.prototype.onContentReady.call(this);var a=this.data.id;if(a){var b={};b[P.CONST.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,this.pubsubSubscribe(a,b)}},onPinDeleted:function(){this.triggerEvent(P.CONST.EVENT_PIN_DELETED,this,!0),this.destroy()},getLoggingObjectIdStr:function(){return this.getPinId()},getPinId:function(){return this.resource.get("id")},getPlaceName:function(){var a=this.getPlaceData();return a?a.name:null},getLink:function(){return this.data.link||null},getPlaceProvider:function(){var a=this.getPlaceData();return a?a.source_name:null},getPlaceProviderImage:function(){var a=this.getPlaceData();return a?a.source_icon:null},getImageUrl:function(a){if(!a)return"";var b=this.data.images;return b[a]?b[a].url:a===P.CONST.IMAGE_SIZE_ORIG&&b.originals?b.originals.url:""},getCoordinates:function(){var a=this.getPlaceData();return a?[a.latitude,a.longitude]:null},getPlaceData:function(){return this.data.place||null},getLocality:function(){var a=this.getPlaceData();if(!a)return null;var b=a.address;return b?b.locality:null},_highlightMarkerOnMap:function(){var a=this.getPinId();this.triggerEvent(P.CONST.EVENT_PIN_PLACE_CLICK,a,!0)},scrollIntoView:function(){var a=this;this._forceSeeOnMap=!0;var b,c=this.$el,d=c.offset().top,e=c.height(),f=P.Viewport.height,g=$(".headerBackground").height();b=e>=f-g?d-e/2+P.Viewport.height/2-g-1.5*P.CONST.PIN_MARGIN:d-f/2-g/2+e/2,this.$el.addClass(CLASS_MAP_FOCUS);var h=this.getChildById("seeOnMap");h&&h.setHighlight(!0),this._highlightMarkerOnMap();var i=function(){a._highlightMarkerOnMap()};P.scrollToTop({$scroller:null,newScrollOffset:b,callback:i})},resetShowOnMapButton:function(){var a=this.getChildById("seeOnMap");this.$el.removeClass(CLASS_MAP_FOCUS),a&&(a.setHighlight(!1),this._forceSeeOnMap=!1)}}),goog.provide("P.modules.PinCommentListBase"),goog.require("P.Module"),P.modules.PinCommentListBase=P.Module.extend({events:{"click .showAll":"onShowAll","focus .content":"onFocusCommentInput","click .addComment":"addComment"},onCreated:function(){this.commentContentHeight=null},onContentReady:function(){var a=this.options.pin_id;if(a){var b={};b[P.CONST.PUBSUB_TOPIC_PIN_COMMENT_CREATED]=this.onPinCommentCreated,this.pubsubSubscribe(a,b)}},_setOptionsForShowingAll:function(){var a=this.options.count;this.options.max_num_to_show=a},onShowAll:function(a){a.stopPropagation(),a.preventDefault(),this._setOptionsForShowingAll(),this.render()},addComment:function(){P.trackGAEvent("comment_create",P.CONST.GA_ACTION_CLICK_SUBMIT);var a=this.getChildById("pinCommentField").getValue(),b=this.options.pin_id,c=P.resourceFactory.create("PinCommentResource",{pin_id:b,text:a}),d=this.getChildById("addCommentButton");d.showLoading(),c.callCreate({success:function(){P.trackGAEvent("comment_create",P.CONST.GA_ACTION_SUCCESS),P.pubsub.publish(b,P.CONST.PUBSUB_TOPIC_PIN_COMMENT_CREATED)},complete:function(){d.hideLoading()}})},onPinCommentCreated:function(){this.options.count++,this.render()},onFocusCommentInput:function(){var a=this.$el.find(".addComment");this.options.type&&"closeup"===this.options.type?a.css("display","block"):a.show(),this.triggerEvent(P.CONST.EVENT_DIMS_CHANGED,null,!0)}}),goog.provide("P.modules.PinEditBase"),goog.require("P.Module"),P.modules.PinEditBase=P.Module.extend({onContentReady:function(){this.pinForm=this.getChildById("pinForm"),this.boardPicker=this.pinForm.getBoardPicker(),this.refreshOnSave=!1,this.listen(this.pinForm,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this._onButtonClick)},_onButtonClick:function(a){var b=a.target;switch(b.id){case"submitButton":P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_EDIT,P.CONST.GA_ACTION_CLICK_SUBMIT);break;case"cancelButton":P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_EDIT,P.CONST.GA_ACTION_CLICK_CANCEL);break;case"deleteButton":P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_DELETE,P.CONST.GA_ACTION_OPEN_MODAL),this.showConfirmation();break;default:this.onButtonClick(a)}},onSubmitValidated:function(a){var b=a.data;b.errors[0]||(this.needConfirm()?this.showPrivacyChangeConfirmation():this.savePin())},needConfirm:function(){var a=this.boardPicker.getPrivacy();return"secret"===this.data.board.privacy&&"public"===a},savePin:function(){var a=this,b=this.data.id,c=this.pinForm.getData();c.id=b;var d=P.resourceFactory.create("PinResource",c),e=function(a){P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_EDIT,P.CONST.GA_ACTION_ERROR),P.showError(a.message)},f=function(d){if(P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_EDIT,P.CONST.GA_ACTION_SUCCESS),d){var f=d.resource_response;if(f&&!f.error){if(!a.refreshOnSave&&a.isInModal()){P.pubsub.publish(b,P.CONST.PUBSUB_TOPIC_PIN_UPDATED,f.data);var g=c.board_id,h=a.data.board.id;g!==h&&(P.pubsub.publish(g,P.CONST.PUBSUB_TOPIC_PIN_CREATED),P.pubsub.publish(h,P.CONST.PUBSUB_TOPIC_PIN_DELETED)),a.destroy()}else{var i="/pin/"+b+"/";a.navigate(i)}return}}e(d)};this.showLoading(!0),d.callUpdate({success:f,error:e,complete:function(){a.hideLoading()}})},onDeleteConfirm:function(){P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_DELETE,P.CONST.GA_ACTION_CLICK_SUBMIT),this.deletePin()},onButtonClick:function(){},deletePin:function(){var a=this.data.id,b=this,c={id:a},d=P.resourceFactory.create("PinResource",c),e=function(a){P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_DELETE,P.CONST.GA_ACTION_ERROR),P.showError(a.message)},f=function(c){if(P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_DELETE,P.CONST.GA_ACTION_SUCCESS),c){var d=c.resource_response;if(d&&!d.error){if(P.pubsub.publish(b.data.board.id,P.CONST.PUBSUB_TOPIC_PIN_DELETED),P.pubsub.publish(b.data.pinner.id,P.CONST.PUBSUB_TOPIC_PIN_DELETED),!b.refreshOnSave&&b.isInModal())P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_PIN_DELETED),b.destroy();else{var f=b.data.board.url;b.navigate(f)}return}}e(c)};this.showLoading(!0),d.callDelete({success:f,error:e,complete:function(){b.hideLoading()}})},showConfirmation:function(){},showPrivacyChangeConfirmation:function(){}}),goog.provide("P.modules.PinnableBase"),goog.require("P.Module"),P.modules.PinnableBase=P.Module.extend({events:{click:"onClick"},onCreated:function(){this.onImageLoad=_.bindFn(this.onImageLoad,this),this.onImageError=_.bindFn(this.onImageError,this)},onAdded:function(){this.updateImage()},updateImage:function(){var a=this.$(".pinImageWrapper"),b=this.$img=$("<img>");b.on("load",this.onImageLoad),b.on("error",this.onImageError),b.attr("src",this.options.url),a.append(b)},onImageLoad:function(){this.$img.width()<P.CONST.MIN_PINNABLE_IMAGE_WIDTH||this.$img.height()<P.CONST.MIN_PINNABLE_IMAGE_HEIGHT?(this.log.debug("Too small!",this.$img.width(),this.$img.height()),this.destroy()):this.$el.css("visibility","visible"),this.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},onImageError:function(){this.destroy()}}),goog.provide("P.modules.PositionModule"),goog.require("P.Module");var CLASS_CARET="positionModuleCaret",MIN_VERTICAL_PADDING=50,MIN_CARET_OFFSET=5,POINT=P.CONST.PositionPoint,POINT_FLAG=P.CONST.PositionPointFlag,MAP_FLAG_TO_CLASS={};MAP_FLAG_TO_CLASS[POINT_FLAG.FLAG_HORIZONTAL_LEFT]="positionLeft",MAP_FLAG_TO_CLASS[POINT_FLAG.FLAG_HORIZONTAL_RIGHT]="positionRight",MAP_FLAG_TO_CLASS[POINT_FLAG.FLAG_VERTICAL_TOP]="positionTop",MAP_FLAG_TO_CLASS[POINT_FLAG.FLAG_VERTICAL_BOTTOM]="positionBottom",P.modules.PositionModule=P.Module.extend({positionMode:P.CONST.PositionMode.ANCHORED,onCreated:function(){var a=_.bindFn(this.positionModule,this);this.childListen(P.CONST.EVENT_CONTENT_CHANGED,a),this.listen(this,P.CONST.EVENT_DIMS_CHANGED,a),this.listen(this,P.CONST.EVENT_NAVIGATE,a),this.listen(P.Viewport,P.CONST.EVENT_RESIZE,a),this.listen(P.Viewport,P.CONST.EVENT_BODY_COLUMN_CHANGE,a)},getMinVerticalPadding:function(){return MIN_VERTICAL_PADDING},getPositionMode:function(){return P.CONST.PositionMode[this.options.position_mode]||this.positionMode},onOptionsChanged:function(){this.updateFixed()},getPositionElement:function(){return this.$el},getPositionAnchor:function(){return $(this.options.anchor)},getPositionPoint:function(){return POINT[this.options.position_point]||POINT.BOTTOM_LEFT},getPositionFixed:function(){return!!this.options.fixed},getPositionCaret:function(){return this.getCaret()},getCaret:function(){return this.$("."+CLASS_CARET)},_getPositionType:function(){return this.getPositionFixed?"fixed":"absolute"},positionModuleAtAnchor:function(a,b){var c=this.getPositionElement();c.addClass("positionModuleElement"),c.toggleClass("positionFixed",this.getPositionFixed()),_.each(MAP_FLAG_TO_CLASS,function(a){c.removeClass(a)}),b=P.Positioning.positionElementAtAnchor(c,a,b,this.getPositionFixed(),this.options.force_in_viewport);
var d=_.find(MAP_FLAG_TO_CLASS,function(a,c){return b&c?!0:void 0});c.addClass(d),this.positionCaret(a,b)},positionCaret:function(a,b){var c=this.$("."+CLASS_CARET);if(c.length){var d=P.CONST.PositionPointFlag,e=this.getPositionElement();e.addClass("bigCaret",!!this.options.largeCaret),e.addClass("defaultCaret",!this.options.largeCaret);var f="left",g="outerWidth",h="width";b&d.FLAG_HORIZONTAL&&(f="top",g="outerHeight",h="height");var i=0,j=b&(d.FLAG_HORIZONTAL_CENTER|d.FLAG_VERTICAL_CENTER),k=c[h]()>a[h]()-MIN_CARET_OFFSET;k&&!j&&(i=(c[h]()-a[h]())/2+MIN_CARET_OFFSET,(b&d.FLAG_VERTICAL_RIGHT||b&d.FLAG_HORIZONTAL_BOTTOM)&&(i=-i));var l=e.offset()[f],m=l+e[g](),n=a.offset()[f],o=n+a[g](),p=l;p<n&&(p=n);var q=m;q>o&&(q=o);var r=(p+q)/2-c[g]()/2+i,s={};if(s[f]=r,c.offset(s),i){var t=parseInt(e.css(f),10);e.css(f,t-i)}}},positionModule:function(){this.cleanPositionModuleElement(),this.getPositionMode()===P.CONST.PositionMode.MANUAL?this._positionManually():this.getPositionMode()===P.CONST.PositionMode.ANCHORED?this.positionModuleAtAnchor(this.getPositionAnchor(),this.getPositionPoint()):this._positionAbsoluteCenter()},_positionAbsoluteCenter:function(){var a=this.getScrollableElement().outerHeight(),b=this.getContent().outerHeight(),c=(a-b)/2;this.getPositionElement().css({marginTop:Math.max(this.getMinVerticalPadding(),c)}),this.options.auto_width||this.getContent().css({width:this.getModule().getWidth(!0)})},_positionManually:function(){var a=this.getPositionElement();a.addClass("positionModuleElement"),a.toggleClass("positionFixed",this.getPositionFixed())},cleanPositionModuleElement:function(){var a=this.getPositionElement();a.removeClass("positionModuleElement"),a.css({top:"",left:"",margin:""})},updateFixed:function(){this.$el.toggleClass("positionModuleFixed",this.getPositionFixed())},renderContainer:function(){this.empty();var a=this.$el;if(a.addClass("PositionModule"),a.addClass(this.options.class_name),this.updateFixed(),this.options.view_type&&a.addClass(this.options.view_type),!this.options.hide_caret){var b=$('<span class="'+CLASS_CARET+'"></span>');a.prepend(b)}},render:function(a){var b=_.bindFn(function(){this.onContentReady(),this.onRendered(),a&&a()},this);this.options.module?P.loadModule(this.options.module,_.bindFn(function(a){this.insertChild(a,this.getPositionElement()),a.render(b)},this)):b()}}),goog.provide("P.modules.PromotedPinInfo"),goog.require("P.Module"),P.modules.PromotedPinInfo=P.Module.extend({HIDDEN_CLASS:"hidden",HIDE_DELAY:3e3,events:{"click .hideThis":"onClickHideThis"},onClickHideThis:function(){var a=this.options.pin_id;this._hidePin(a)},_hidePin:function(a){var b=this;this.showLoading();var c=this._getResource(a);c.callUpdate().always(function(){b.hideLoading()}).done(function(){b.$(".preAction").addClass(b.HIDDEN_CLASS),b.$(".confirmHideThis").removeClass(b.HIDDEN_CLASS),b.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0),P.setTimeout(function(){b.triggerEvent(P.CONST.EVENT_DISMISS,null,!0),P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_PIN_DELETED)},b.HIDE_DELAY)})},_getResource:function(a){var b=P.resourceFactory.create("PromotedPinHideResource",{pin_id:a});return b}}),goog.provide("P.modules.RecipeFeedPage"),goog.require("P.Module"),P.modules.RecipeFeedPage=P.Module.extend({}),goog.provide("P.modules.RelatedPinInfo"),goog.require("P.Module"),P.modules.RelatedPinInfo=P.Module.extend({HIDDEN_CLASS:"hidden",HIDE_DELAY:3e3,onCreated:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onChildButtonClick)},onChildButtonClick:function(a){var b=a.target.id;"downvote"===b?this._doVote(!1):"upvote"===b&&this._doVote(!0)},_getResource:function(a){var b=this.options.pin_id,c={pin_id:b,feedback_type:a?"positive":"negative"},d=this.options.recommendation_reason;if(d){c.reason=d.reason;var e=d.board.id;e&&(c.through_board_id=e)}var f=P.resourceFactory.create("RecommendedPinFeedbackResource",c);return f},_doVote:function(a){var b=this,c=this.options.pin_id;this.showLoading();var d=this._getResource(a);d.callCreate().always(function(){b.hideLoading()}).done(function(){b.$(".preAction").addClass(b.HIDDEN_CLASS);var d=a?".confirmUpvote":".confirmDownvote";b.$(d).removeClass(b.HIDDEN_CLASS),b.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0),P.setTimeout(function(){b.triggerEvent(P.CONST.EVENT_DISMISS,null,!0),a||P.pubsub.publish(c,P.CONST.PUBSUB_TOPIC_PIN_DELETED)},b.HIDE_DELAY)})}}),goog.provide("P.modules.RepinsLikesFeedPage"),goog.require("P.Module"),P.modules.RepinsLikesFeedPage=P.Module.extend({}),goog.provide("P.modules.ResetPasswordPage"),goog.require("P.Module"),goog.require("P.router");var resetPasswordButtonId="resetPasswordSubmit";P.modules.ResetPasswordPage=P.Module.extend({onContentReady:function(){if(this.data.is_link_valid){var a={new_password:[P.Validator.Required(),P.Validator.ContainsOnlyAscii({message:P.string.common.asciiPasswordError}),P.Validator.Password()],new_password_confirm:[P.Validator.Required(),P.Validator.EqualTo({targetFieldName:"new_password",message:P._("Passwords don't match")})]};this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),a),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)}},onSubmitValidated:function(a){var b=this.getChildById(resetPasswordButtonId);a.errors[0]||(b.showLoading(!0),this.resetPassword())},resetPassword:function(){var a=this;this.hideLoading(!0);var b=function(){var b=a.getChildById(resetPasswordButtonId);b.hideLoading()},c=function(b){if(b){var c=b.resource_response;if(c&&!c.error&&c.data.password_changed){var d={name:"ConfirmDialog",options:{template:"change_password_success"}},e=function(){var a="/login";try{P.navigate(a)}catch(b){window.location.href=a}};P.loadModule(d,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,e)})}}},d={new_password:this.form.getValue("new_password"),new_password_confirm:this.form.getValue("new_password_confirm")},e=$.extend(_.clone(this.options),d),f=P.resourceFactory.create("ResetPasswordFromEmailResource",e);f.callUpdate({success:c,complete:b})}}),goog.provide("P.modules.RichPinInfer"),goog.require("P.Module"),P.modules.RichPinInfer=P.Module.extend({}),goog.provide("P.modules.SearchPageContent"),goog.require("P.Module"),P.modules.SearchPageContent=P.Module.extend({events:{}}),goog.provide("P.modules.ShoppingButtonBar"),goog.require("P.Module"),P.modules.ShoppingButtonBar=P.Module.extend({}),goog.provide("P.modules.Tutorial"),goog.require("P.Module"),P.modules.Tutorial=P.Module.extend({onContentReady:function(){this.manager=P.TutorialManager.instance(),this.childListen(P.CONST.EVENT_NEXT,_.bindFn(this.manager._next,this.manager)),this.childListen(P.CONST.EVENT_PREVIOUS,_.bindFn(this.manager._previous,this.manager)),this.manager.startTutorial(this.options.tutorial_name,{moduleContainer:this})},onDestroyed:function(){this.manager.stopTutorial()}}),goog.provide("P.modules.UserBase"),goog.require("P.Module"),P.modules.UserBase=P.Module.extend({events:{}}),goog.provide("P.modules.UserProfileContentBase"),goog.require("P.Module"),P.modules.UserProfileContentBase=P.Module.extend({events:{}}),goog.provide("P.modules.UserProfilePage"),goog.require("P.Module"),P.modules.UserProfilePage=P.Module.extend({events:{},_tabs_to_resource:{boards:"BoardsResource",pins:"UserPinsResource",likes:"UserLikesResource",followers:"UserFollowersResource",following:"UserFollowingResource"},getLoggingObjectIdStr:function(){return this.data.id},onAddedToDom:function(){this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate)},onRemovedFromDom:function(){this._removeListeners()},onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_USER_BLOCKED]=this.onAccessChange,a[P.CONST.PUBSUB_TOPIC_USER_UNBLOCKED]=this.onAccessChange,this.pubsubSubscribe(this.data.id,a),"1"===this.options.show_redirected_memo&&this.showRedirectDialog()},showRedirectDialog:function(){var a={name:"ConfirmDialog",options:{template:"deleted_board_redirect",user_name:this.data.full_name,auto_close_delay_ms:7e3}};P.loadModule(a,function(a){P.getModalManager().showInModal(a)})},onAccessChange:function(){this.render()},onChildNavigate:function(a){this.log.debug("UserProfilePage got navigate event from child",a.target,"for url:",a.data.url);var b=P.router.get()&&P.router.get().resolve(a.data.url);if(b){var c=b.module,d=b.options,e=b.resource,f=e.options&&e.options.username,g=this.data;if(this.contentReady&&c===this.className&&f===(g&&g.username)){this.setOptions(d),this.setResource(e);var h=this.$el.height();this.$el.css("min-height",h);var i=this.getScrollableElement(),j=i.scrollTop(),k=this,l=d.tab,m=this.getChildByModuleName("UserProfileContent"),n=this.getChildByModuleName("UserInfoBar");n.setOptions({tab:l}),n.render(),m.setOptions({tab:l}),m.showLoading(),m.render(function(){m.hideLoading(),k.$el.css("min-height","");var a=i.height(),b=k.$el.positionAncestor(i).top,c=k.$el.height(),d=j+a-c+b;d>0&&(k.$el.css("min-height",c+d),i.scrollTop(j))}),a.data.handled=!0}}}}),goog.provide("P.modules.UserRegisterBase"),goog.require("P.Module"),goog.require("P.modules.LoginBase");var USER_REGISTER_BASE_CLASS_HIDDEN="hidden";P.modules.UserRegisterBase=P.modules.LoginBase.extend({events:{"blur #userFirstName,#userLastName,#userEmail":"computeUsernameSuggestion","keyup #userEmail":"computeUsernameSuggestion","focus #userUserName":"onSuggestUsername","keyup #userUserName":"onUsernameChanged","keyup #userAge":"onAgeChanged",'change select[name="country"]':"onCountryChanged","blur input[name=email]":"onBlurEmail","click .suggestionEmail":"onClickSuggestionEmail",'click input[name="facebook_timeline_enabled"]':"onCheckboxChanged"},network:null,networkCredentials:{},usernameSuggestionResource:null,fieldValues:{},currentUsernameSuggestion:"",userModifiedUsername:!1,fbAccess:!1,onCountryChanged:function(a){var b=this.$(".termsWrapper"),c=this.$(".helpText");"FR"===$(a.target).val()?(b.removeClass(USER_REGISTER_BASE_CLASS_HIDDEN),c.addClass(USER_REGISTER_BASE_CLASS_HIDDEN)):(b.addClass(USER_REGISTER_BASE_CLASS_HIDDEN),c.removeClass(USER_REGISTER_BASE_CLASS_HIDDEN))},onBlurEmail:function(){if(this.extraData.show_email_suggestion){var a=this,b=this.$inputEmail.val(),c=_.extend({},{email:b,email_filter:"unused"});null==this.emailSuggestionResource&&(this.emailSuggestionResource=P.resourceFactory.create("EmailSuggestionResource",c)),this.emailSuggestionResource.options=c,this.emailSuggestionResource.callGet({success:function(c){var d=c.resource_response.data;d.length>0?(a.$inputEmail.val(d[0]),a.$suggestionEmail.text(b),a.$suggestion.slideDown()):a.$suggestion.slideUp()},error:function(){a.$suggestion.slideUp()}})}},onClickSuggestionEmail:function(a){var b=this.$suggestionEmail.text();this.$inputEmail.val(b),this.$suggestion.slideUp(),a.preventDefault()},onContentReady:function(){if(P.currentUser.isAuthenticated())return void this.redirect();if(Cookie.get(P.CONST.COOKIE_REGISTER_RESTRICT))return void this.redirect();var a=this;P.FbUtil.checkFbTimelinePermission({success:function(){a.toggleFbTimelinePermission(!0)},error:function(){a.toggleFbTimelinePermission(!1)}});var b={first_name:[P.Validator.Required()],email:[P.Validator.Required(),this.extraData.strict_email_validation?P.Validator.StrictEmail():P.Validator.Email()],age:[P.Validator.Number()]};this.$suggestion=this.$(".suggestion"),this.$suggestionEmail=this.$(".suggestionEmail"),this.$inputEmail=this.$("input[name=email]"),this.extraData.show_password&&(b.password=[P.Validator.ContainsOnlyAscii({message:P._("English letters, numbers, basic symbols only.")}),P.Validator.Password()]),this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),b),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated);var c=this.options.network&&!this.options.network_data;c&&(this.showLoading(),P.UserRegistration.fetchNetworkData(this.options.network).done(function(b){a.populateForm(b)}).always(function(){a.hideLoading()}));var d={};this.options.network===P.SocialConnect.GPLUS?(d.gplus_code=P.SessionStorage.getItem(P.CONST.SESSION_GPLUS_CODE),d.gplus_redirect_uri=P.SessionStorage.getItem(P.CONST.SESSION_GPLUS_REDIRECT_URI),a.populateForm(d),P.SessionStorage.removeItem(P.CONST.SESSION_GPLUS_CODE),P.SessionStorage.removeItem(P.CONST.SESSION_GPLUS_REDIRECT_URI)):this.options.network===P.SocialConnect.TWITTER?(d.twitter_id=P.SessionStorage.getItem(P.CONST.SESSION_TWITTER_ID),d.twitter_token=P.SessionStorage.getItem(P.CONST.SESSION_TWITTER_TOKEN),d.twitter_token_secret=P.SessionStorage.getItem(P.CONST.SESSION_TWITTER_TOKEN_SECRET),d.first_name=P.SessionStorage.getItem(P.CONST.SESSION_TWITTER_FIRST_NAME),d.last_name=P.SessionStorage.getItem(P.CONST.SESSION_TWITTER_LAST_NAME),d.username=P.SessionStorage.getItem(P.CONST.SESSION_TWITTER_USERNAME),d.image_url=P.SessionStorage.getItem(P.CONST.SESSION_TWITTER_IMAGE_URL),a.populateForm(d),P.SessionStorage.removeItem(P.CONST.SESSION_TWITTER_ID),P.SessionStorage.removeItem(P.CONST.SESSION_TWITTER_TOKEN),P.SessionStorage.removeItem(P.CONST.SESSION_TWITTER_TOKEN_SECRET),P.SessionStorage.removeItem(P.CONST.SESSION_TWITTER_FIRST_NAME),P.SessionStorage.removeItem(P.CONST.SESSION_TWITTER_LAST_NAME),P.SessionStorage.removeItem(P.CONST.SESSION_TWITTER_USERNAME),P.SessionStorage.removeItem(P.CONST.SESSION_TWITTER_IMAGE_URL)):this.options.network===P.SocialConnect.RAKUTEN&&(d.rakuten_id=P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_ID),d.rakuten_token=P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_TOKEN),d.rakuten_refresh_token=P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_REFRESH_TOKEN),d.first_name=P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_FIRST_NAME),d.email=P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_EMAIL),d.gender=P.SessionStorage.getItem(P.CONST.SESSION_RAKUTEN_GENDER),a.populateForm(d),P.SessionStorage.removeItem(P.CONST.SESSION_RAKUTEN_ID),P.SessionStorage.removeItem(P.CONST.SESSION_RAKUTEN_TOKEN),P.SessionStorage.removeItem(P.CONST.SESSION_RAKUTEN_REFRESH_TOKEN),P.SessionStorage.removeItem(P.CONST.SESSION_RAKUTEN_FIRST_NAME),P.SessionStorage.removeItem(P.CONST.SESSION_RAKUTEN_EMAIL),P.SessionStorage.removeItem(P.CONST.SESSION_RAKUTEN_GENDER)),this.fieldValues=this.getFieldValues(),this.currentUsernameSuggestion=this.$("#userUserName").val(),this.currentUsernameSuggestion&&this.addUsernameAsSuggestionMessage()},toggleFbTimelinePermission:function(a){this.fbAccess=a;var b=this.$('input[name="facebook_timeline_enabled"]');b.prop("checked",a)},getFieldValues:function(){var a={first_name:this.$("#userFirstName").val(),last_name:this.$("#userLastName").val()},b=this.$("#userEmail").val();return b&&b.match("@")&&(a.email=b.replace(/@.*/,"@")),a},computeUsernameSuggestion:function(){if(!this.userModifiedUsername){var a=this.getFieldValues();if(!_.isEqual(this.fieldValues,a)){this.fieldValues=a;var b=_.extend({},this.fieldValues,{limit:1});null==this.usernameSuggestionResource&&(this.usernameSuggestionResource=P.resourceFactory.create("UsernameSuggestionResource",b));var c=this;this.usernameSuggestionResource.options=b,this.usernameSuggestionResource.callGet({success:function(a){c.currentUsernameSuggestion=a.resource_response.data[0]},error:P.NOOP})}}},onSuggestUsername:function(){if(!this.userModifiedUsername&&this.currentUsernameSuggestion){var a=this.$("#userUserName");a.val()!==this.currentUsernameSuggestion&&(a.val(this.currentUsernameSuggestion),this.form.validateField(a),this.addUsernameAsSuggestionMessage())}},onUsernameChanged:function(){var a=this.$("#userUserName");a.val().length?this.currentUsernameSuggestion!==a.val()&&(this.userModifiedUsername=!0,this.removeUsernameAsSuggestionMessage()):(this.userModifiedUsername=!1,this.computeUsernameSuggestion(),this.removeUsernameAsSuggestionMessage())},onAgeChanged:function(){var a=this.$("#userAge");this.$(".ageLabel .hiddenValue").text(a.val()),a.val().length?this.$(".ageLabel").addClass("active"):this.$(".ageLabel").removeClass("active")},addUsernameAsSuggestionMessage:function(){var a=this.$("#userUserName");if(0===a.nextAll(".formHelpMessage").length){var b=P._("Suggested username");a.after('<p class="formHelpMessage">'+b+"</p>")}},removeUsernameAsSuggestionMessage:function(){var a=this.$("#userUserName"),b=a.nextAll(".formHelpMessage");b.remove()},onCheckboxChanged:function(a){var b=$(a.target),c=this;if(b.prop("checked")&&!this.fbAccess){var d={success:function(){c.fbAccess=!0},error:function(){b.prop("checked",!1)}};P.FbUtil.fbLogin(d)}},populateForm:function(a){this.options.network_data=a;var b={first_name:a.first_name,last_name:a.last_name,email:a.email,social_username:a.username,limit:1};this.resource=P.resourceFactory.create("UsernameSuggestionResource",b);var c=this,d=function(){c.hideLoading()};this.render(d,d)},onSubmitValidated:function(a){if(!a.errors[0]){var b=this.getChildById("submitButton"),c=this,d=this.extraData&&this.extraData.networkCredentials||{},e=_.extend({skip_nux:this.options.skip_nux},this.getFormData(),d);P.UserRegistration.addExtraSocialParams(this.options.network,e).done(function(){c.options.network_data&&(e.social_username=c.options.network_data.username),b.showLoading(),P.UserRegistration.register(c.options.network,e).done(function(){c.redirect()}).fail(function(a){b.hideLoading(),a.api_error_code===P.CONST.API_ERROR_UNDERAGE_REGISTER_ATTEMPT&&c.redirect()})})}},redirect:function(){return Cookie.get(P.CONST.COOKIE_REGISTER_RESTRICT)?void(window.location.href="/join/restricted/age/"):void(this.triggerEvent(P.CONST.EVENT_USER_REGISTER,{},!0)&&P.modules.LoginBase.prototype.redirect.call(this,{}))},getFormData:function(){var a=this.$("form").serializeArray(),b={};return _.each(a,function(a){b[a.name]="on"===a.value?!0:a.value}),b}}),goog.provide("P.modules.UserRegisterPageBase"),goog.require("P.Module"),P.modules.UserRegisterPageBase=P.Module.extend({}),goog.provide("P.modules.promo.PlacesBoardExamples"),goog.require("P.Module"),P.modules.promo.PlacesBoardExamples=P.Module.extend({}),goog.provide("P.modules.tutorials.StepBase"),goog.require("P.interfaces.TutorialStep"),goog.require("P.Module"),P.modules.tutorials.StepBase=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this._onButtonClick);var a={};a[P.CONST.PUBSUB_TOPIC_TUTORIAL_NEXT]=function(){this.triggerEvent(P.CONST.EVENT_NEXT,null,!0)},this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_TUTORIAL,a),this.initializeStep()},initializeStep:P.NOOP,onEnter:function(a){a&&a()},onShow:function(a){a&&a()},onRemoved:P.NOOP,onExit:function(a){a&&a()},onButtonClick:function(){},_onButtonClick:function(a){var b=a.target;b&&(this.onButtonClick(a),a.shouldPropagate()&&("previousButton"===b.id?(a.stopPropagation(),this.onPreviousButtonClicked()):"nextButton"===b.id&&(a.stopPropagation(),this.onNextButtonClicked())))},onPreviousButtonClicked:function(){this.triggerEvent(P.CONST.EVENT_PREVIOUS,null,!0)},onNextButtonClicked:function(){this.triggerEvent(P.CONST.EVENT_NEXT,null,!0)},getExperienceId:function(){return null},getPlacementId:function(){return null},completePlacedExperience:function(a){P.ExperienceManager.instance().completePlacedExperience(this.getPlacementId(),this.getExperienceId(),a)},dismissPlacedExperience:function(a){P.ExperienceManager.instance().dismissPlacedExperience(this.getPlacementId(),this.getExperienceId(),a)}}),goog.provide("P.modules.ui.Checkbox"),goog.require("P.Module");var CLASS_ON="on",PROP_CHECKED="checked";P.modules.ui.Checkbox=P.Module.extend({onContentReady:function(){this.$input=this.$el,"fancyToggle"===this.options.view_type||"fancyCheckbox"===this.options.view_type?(this.$input=this.$("input"),this.$el.on("click",_.bindFn(this.onFancyToggleCheckboxClick,this))):this.$el.on("change",_.bindFn(this.toggle,this))},onFancyToggleCheckboxClick:function(a){var b=$(a.currentTarget).parent()[0].tagName,c="label"===b.toLowerCase(),d=!c||c&&$(a.target).is(":checkbox");d&&this.toggle()},toggle:function(){this.setChecked(!this.options.checked)},setChecked:function(a,b){void 0===b&&(b=!0),a===this.options.checked||this.options.disabled||(this.options.checked=a,this.$el.toggleClass(CLASS_ON,a),this.$input.prop(PROP_CHECKED,a),b&&this.triggerEvent(P.CONST.EVENT_CHANGE,null,!0))},isChecked:function(){return!!this.options.checked}}),goog.provide("P.modules.ui.DateField"),goog.require("P.Module");var DF_ACTIVE_CLASS="active",DF_VALUE_CLASS="hasValue",DF_ERROR_FIELD_CLASS="errorField",DF_ERROR_CLASS="hasError";P.modules.ui.DateField=P.Module.extend({events:{click:"onFocus","click input":"onContentClick","click .dateSeparator":"onContentClick","focus .dateComponent":"onContentFocus","blur .dateComponent":"onContentBlur"},onContentReady:function(){this.$month=this.$(".mm"),this.$day=this.$(".dd"),this.$year=this.$(".yyyy")},onContentFocus:function(){this.$el.addClass(DF_ACTIVE_CLASS),this.triggerEvent("focus",null,!0),this.validate(!0)},onContentBlur:function(){this.$el.removeClass(DF_ACTIVE_CLASS),this.hasDate()?this.$el.addClass(DF_VALUE_CLASS):this.$el.removeClass(DF_VALUE_CLASS),this.validate(!1)},onContentClick:function(){return!1},onFocus:function(){this.$month.focus()},validate:function(a){var b,c,d,e;this.$month.removeClass(DF_ERROR_FIELD_CLASS),this.$day.removeClass(DF_ERROR_FIELD_CLASS),this.$year.removeClass(DF_ERROR_FIELD_CLASS),this.$el.removeClass(DF_ERROR_CLASS),(this.$month.val()||this.$day.val()||this.$year.val())&&(this.$month.val()?(c=parseInt(this.$month.val(),10),(!c||c<1||c>12)&&(b=!0,this.$month.addClass(DF_ERROR_FIELD_CLASS))):a||(b=!0),this.$day.val()?(e=parseInt(this.$day.val(),10),(!e||e<1||e>31)&&(b=!0,this.$day.addClass(DF_ERROR_FIELD_CLASS))):a||(b=!0),this.$year.val()?(d=parseInt(this.$year.val(),10),(!d||d<1900||d>(new Date).getFullYear())&&(b=!0,this.$year.addClass(DF_ERROR_FIELD_CLASS))):a||(b=!0)),b?(this.$el.addClass(DF_ERROR_CLASS),this.$(".selectedDate").val("error")):this.$(".selectedDate").val(this.getDateString())},hasDate:function(){return!!this.$month.val()||!!this.$day.val()||!!this.$year.val()},getTimeStamp:function(){var a=this.getDate();return a?Math.round(a/1e3):0},getDateString:function(){var a=this.getDate();return a?a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate():""},getDate:function(){if(!this.hasDate())return null;var a=this.$month.val()+"/"+this.$day.val()+"/"+this.$year.val(),b=Date.parse(a);return isNaN(b)===!1?new Date(b):null}}),goog.provide("P.modules.ui.Progress"),goog.require("P.Module");var PROGRESS_ACTIVE_CLASS="active";P.modules.ui.Progress=P.Module.extend({moveStep:function(a){this.setStep(this.options.current_step+a)},setStep:function(a){a<0||a>this.options.steps||(this.options.current_step=a,this._localRender(),a===this.options.steps&&this.triggerEvent(P.CONST.EVENT_PROGRESS_COMPLETED,null,!0))},_localRender:function(){var a=this.$el.children("li"),b=this.options.current_step;$.each(a,function(a,c){$(c).toggleClass(PROGRESS_ACTIVE_CLASS,b>=a+1)})}}),goog.provide("P.modules.ui.Select"),goog.require("P.Module"),P.modules.ui.Select=P.Module.extend({}),goog.provide("P.modules.ui.TextField"),goog.require("P.Module");var ACTIVE_CLASS="active",VALUE_CLASS="has-value",MENTION_TEMPLATE="<li data-value='${name}'><img src='${img}' /> ${name} <span>(${fullName})</span></li>";P.modules.ui.TextField=P.Module.extend({events:{click:"onFocus","focus .content":"onContentFocus","blur .content":"onContentBlur"},onContentReady:function(){this.options.mentions&&this.initAtMentions(),this.getContent().placeholder()},initAtMentions:function(){this.typeahead=new P.TypeaheadProvider({tags:"mentions",pin_id:this.options.pin_id}),this.getContent().atwho("@",{data:"/",tpl:MENTION_TEMPLATE,callbacks:{remote_filter:_.bindFn(this.onAtMentionFilter,this)}}),this.atwho=this.getContent().data("atwho")},onAtMentionFilter:function(a,b,c){if(a.q){var d=this;this.typeahead.search(a.q,function(a){var b=_.map(a.items,function(a){return{name:P.stripTags(a.username),fullName:P.stripTags(a.label),img:a.image}});c(b),d.atwho.settings["@"].data="/"})}},getContent:function(){return this.$content||(this.$content=this.$(".content")),this.$content},getValue:function(){return this.log.debug("value:",$.trim(this.getContent().val()),this.getContent()),$.trim(this.getContent().val())},onFocus:function(){this.getContent().focus()},onContentFocus:function(){this.$el.addClass(ACTIVE_CLASS),this.triggerEvent("focus",null,!0)},onContentBlur:function(){this.getValue().length?this.$el.addClass(VALUE_CLASS):this.$el.removeClass(VALUE_CLASS),this.$el.removeClass(ACTIVE_CLASS)}}),goog.provide("P.modules.ui.TypeaheadBase"),goog.require("P.Module");var DATA_MODEL_CID="cid",MODEL_ATTR_HIGHLIGHTED="highlighted",templateMap={search:"default_item",userSelect:"send_pin",map:"add_pin_to_map",place:"place"},ItemView=Backbone.View.extend({tagName:"li",initialize:function(a){this.options=a,this.$el.attr("tabindex",this.options.tabIndex?1:!1);var b=this.options.template;this.templateName=b,this.model.bind("change",this.onChange,this)},appendToElement:function(a){this.render(),a.append(this.$el)},onChange:function(){return this.render(),this.model.attributes.type===P.CONST.TYPEAHEAD_TYPE_GPLUS_NON_PINNER&&this.options.container.triggerEvent(P.CONST.EVENT_TYPEAHEAD_RENDER_DONE,this.model.attributes.id,!0),this},_getTemplateFilePath:function(){return"app/common/modules/ui/TypeaheadBase/"+this.templateName+".nunjucks"},render:function(){var a=this._getTemplateFilePath(),b=P.renderNunjucks(a,this.model.toJSON());return this.$el.html(b).toggleClass(P.CONST.CLASS_TYPEAHEAD_HIGHLIGHTED,!!this.model.get(MODEL_ATTR_HIGHLIGHTED)).data(DATA_MODEL_CID,this.model.cid),this}});P.modules.ui.TypeaheadBase=P.Module.extend({events:{"click .results li":"onResultClick","click .results .remove":"onRemoveResult",mousedown:"onMousedown","mouseenter .results li":"onResultMouseEnter",mouseleave:"onMouseleave",onchange:"onChange"},_isOpen:!1,items:[],onCreated:function(){this.typeahead=new P.TypeaheadProvider(this.options),this.listen(this.typeahead,P.CONST.EVENT_DATA,this.onTypeaheadData),this.listen(this.typeahead,P.CONST.EVENT_TYPEAHEAD_SEARCH_START,this.onSearchStart)},onSearchStart:function(a){this.triggerEvent(P.CONST.EVENT_TYPEAHEAD_SEARCH_START,a,!0)},removeCacheForTerm:function(a){this.typeahead.removeCacheForTerm(a)},getResource:function(){return this.typeahead.getResource()},onContentReady:function(){this.$results=this.$(".results")},getItemCount:function(){return this.itemsToRender.count},highlightItemWithAttributeAndValue:function(a,b){var c=this,d=this.itemsToRender,e=_.find(d,function(c){return c.get(a)===b});e&&c.highlight(e)},focusHighlighted:function(){this.$("."+P.CONST.CLASS_TYPEAHEAD_HIGHLIGHTED).focus()},getHighlightedItem:function(){return this.highlightedItem},search:function(a){this.lastTerm=a,this.typeahead.search(a)},setAutocompleteScope:function(a){this.typeahead.setAutocompleteScope(a)},renderResults:function(){var a=this,b=_.map(this.itemsToRender,function(b){return a.createItemView(b)});this.$results.empty(),_.each(b,function(b){b.appendToElement(a.$results)});var c=P.Viewport.height-P.CONST.PIN_MARGIN-this.$results.offset().top;this.$results.css({"max-height":c,"overflow-y":"auto"}),this.show()},emptyResults:function(){this.itemsToRender=[],this.$results.empty()},createItemView:function(a){var b=this.options.template?templateMap[this.options.template]:templateMap.search,c=this.options.use_tab_index,d=new ItemView({model:a,container:this,template:b,tabIndex:c});return d},hide:function(){this._isOpen=!1,this.highlight(null),this.select(null),this.$el.removeClass("open")},show:function(){this._isOpen=!0,this.$el.addClass("open")},isOpen:function(){return this._isOpen},getLastTerm:function(){return this.lastTerm},selectElement:function(a){var b=this.getItemByElement(a);return this.select(b)},getSelectedItem:function(){return this.selectedItem},select:function(a){return a=a||this.highlightedItem,a&&this.triggerEvent(P.CONST.EVENT_ITEM_SELECTED,{item:a},!0),this.selectedItem=a,a},highlightUp:function(){var a=this.highlightedItem,b=this.itemsToRender,c=a?_.indexOf(b,a)-1:b.length-1;return this.highlight(b[c])},highlightDown:function(){var a=this.highlightedItem,b=this.itemsToRender,c=a?_.indexOf(b,a)+1:0;return this.highlight(b[c])},highlightElement:function(a){var b=null;return a&&a[0]&&(b=this.getItemByElement(a)),this.highlight(b)},highlight:function(a){return a=a||null,a===this.highlightedItem?a:(this.highlightedItem&&this.highlightedItem.set(MODEL_ATTR_HIGHLIGHTED,!1),this.highlightedItem=a,a&&(a.set(MODEL_ATTR_HIGHLIGHTED,!0),this.triggerEvent(P.CONST.EVENT_ITEM_HIGHLIGHTED,{item:a},!0)),a)},getItemByElement:function(a){var b=a.data(DATA_MODEL_CID);return _.find(this.itemsToRender,function(a){return a.cid===b})},abortSearch:function(){this.typeahead.abortSearch()},prefetch:function(){this.typeahead.prefetch()},onMousedown:function(){this.triggerEvent("mousedown")},onMouseleave:function(){this.isOpen()&&this.highlightElement()},onRemoveResult:function(a){a.stopPropagation(),a.preventDefault();var b=$(a.currentTarget),c=b.attr("data-query");if(c){var d=P.resourceFactory.create("TypeaheadClearRecentResource",{query:c});d.callDelete(),b.parents("li").remove(),this.items=_.reject(this.items,function(a){return a.query===c}),0===this.items.length&&this.hide()}},onResultClick:function(a){this.selectElement($(a.currentTarget)),a.stopPropagation()},onResultMouseEnter:function(a){this.highlightElement($(a.currentTarget))},_updateItemsToRender:function(){var a=this.getLastTerm(),b=this;this.itemsToRender=_.map(this.items,function(c,d){return c.tag=c.tag||"",b.options.show_dividers&&d>0&&c.type!==b.items[d-1].type&&(c.class_name="sectionStart"),c.resultIndex=d,c.enteredQuery=a,new Backbone.Model(c)})},onTypeaheadData:function(a){P.experiments.instance.inExperimentGroup("search_autocomplete","enabled"),this.items=a.items,this._updateItemsToRender();var b=this.getLastTerm().length,c=this.options.enable_recent_queries;if(0===this.items.length||0===b){if(c)return void this.renderResults();this.hide(),this._triggerNoResultsReturned()}else this._triggerResultsReturned(),this.renderResults()},_renderEmptyState:function(){var a=[],b={},c=P.CONST.TYPEAHEAD_ATTRIBUTE_EMPTY_STATE;b[c]=!0,a.push(b),this.items=a,this._updateItemsToRender(),this.renderResults()},_triggerNoResultsReturned:function(a){this.triggerEvent(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,null,!0),a&&this._renderEmptyState()},_triggerResultsReturned:function(){var a={count:this.items.length,items:this.itemsToRender};this.triggerEvent(P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED,a,!0)}}),goog.provide("P.modules.ui.TypeaheadField"),goog.require("P.Module"),P.modules.ui.TypeaheadField=P.Module.extend({events:{"input .field":"onFieldInput","blur .field":"onFieldBlur","focus .field":"onFieldFocus","keyup .field":"onFieldKeyup","keydown .field":"onFieldKeydown"},onCreated:function(){this.valueFromHighlight=!1},initTypeahead:function(){this.typeahead=this.getChildById("typeahead"),this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(P.CONST.EVENT_ITEM_HIGHLIGHTED,this.onChildItemHighlighted),this.listen(this.typeahead,"mousedown",this.onTypeaheadMousedown)},hideTypeaheadUnlessPreserved:function(){this.options.preserve_typeahead||this.typeahead.hide()},enableInput:function(){this._setInputEnabled(!0)},_setInputEnabled:function(a){var b="disabled";this.$field.toggleClass(b,!a),a?this.$field.removeAttr(b):this.$field.attr(b,b)},disableInput:function(){this._setInputEnabled(!1)},onChildItemSelected:function(a){var b=a.data.item,c=b.get("label"),d=b.get("prevent_setting_value_when_selected")||!1;c&&!d&&(this.valueFromHighlight=!1,this.setValue(c)),this.blur()},onChildItemHighlighted:function(a){var b=a.data.item,c=b&&!b.get("ignoreLabel")?b.get("label"):this.typeahead.getLastTerm();this.options.populate_on_result_highlight&&(this.valueFromHighlight=!0,this.setValue(c))},highlightTypehaeadUp:function(){this.typeahead.highlightUp()},highlightTypeaheadDown:function(){this.typeahead.highlightDown()
},onContentReady:function(){this.initTypeahead(),this.$field=this.$(".field"),this.$field.placeholder()},onFieldInput:function(){this.search()},_focusHighlightedIfNeeded:function(){this.options.use_tab_index&&(this.typeahead.focusHighlighted(),this.focus())},onFieldKeydown:function(a){var b=this.typeahead,c=P.keyCode;if(b.isOpen())switch(a.keyCode){case c.ENTER:if(this.options.prevent_default_on_enter){a.preventDefault();break}}},focus:function(){this.getField().focus()},onFieldKeyup:function(a){var b=this.typeahead,c=P.keyCode;if(b.isOpen())switch(a.keyCode){case c.UP:b.highlightUp(),this._focusHighlightedIfNeeded(),a.preventDefault();break;case c.DOWN:b.highlightDown(),this._focusHighlightedIfNeeded(),a.preventDefault();break;case c.ENTER:case c.NUMPAD_ENTER:case c.TAB:var d={};if(b.highlightedItem){var e="pins",f=b.highlightedItem.get("type");"board_search"===f&&(e="boards",f="query"),"people_search"===f&&(e="users",f="query"),d={entered_query:b.getLastTerm(),selected_query:b.highlightedItem.get("label"),result_index:b.highlightedItem.get("resultIndex"),autocomplete_type:f,search_mode:e}}var g=b.select();this._logCustomContextEvent(P.ContextLogging.EventType.CLICK,P.ContextLogging.ElementType.AUTOCOMPLETE_SUGGESTION,P.ContextLogging.ComponentType.TYPEAHEAD_SUGGESTIONS,d),g&&(this.abortSearch(),a.preventDefault());break;case c.ESCAPE:this.blur(),a.preventDefault();break;default:this.search()}else switch(a.keyCode){case c.ENTER:case c.NUMPAD_ENTER:this.abortSearch(),this.triggerEvent(P.CONST.EVENT_ENTER_PRESSED,{},!0);break;default:this.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,{},!0),this.search()}},getTypeaheadItemsToRender:function(){return this.typeahead.itemsToRender},getTypeaheadHighlightedItem:function(){return this.typeahead.getHighlightedItem()},getTypeaheadSelectedItem:function(){return this.typeahead.getSelectedItem()},removeCacheForTerm:function(a){this.typeahead.removeCacheForTerm(a)},removeCacheForCurrentTerm:function(){var a=this.getValue();this.removeCacheForTerm(a)},closeTypeahead:function(){this.abortSearch(),this.typeahead.hide()},onFieldBlur:function(){return this.cancelBlur?void(this.cancelBlur=!1):(this.valueFromHighlight&&(this.valueFromHighlight=!1,this.reset()),this.hideTypeaheadUnlessPreserved(),void this.triggerEvent(P.CONST.EVENT_BLUR,null,!0))},onFieldFocus:function(){this.$field.trigger("mousedown"),this.options.search_on_focus&&this.search(),this.options.prefetch_on_focus&&this.typeahead.prefetch(),this.triggerEvent(P.CONST.EVENT_FOCUS,null,!0)},onTypeaheadMousedown:function(){this.cancelBlur=!0,window.setTimeout(function(){this.cancelBlur=!1},300)},getValue:function(){return this.$field.val()},getField:function(){return this.$field},reset:function(){this.abortSearch(),this.clear(),this.typeahead.emptyResults(),this.typeahead.hide()},setValue:function(a){this.$field.val(a),this.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,{},!0)},getTypeaheadResultCount:function(){return this.typeahead.getItemCount()},setAutocompleteScope:function(a){this.typeahead.setAutocompleteScope(a)},clear:function(){this.setValue("")},abortSearch:function(){this.searchTimer&&window.clearTimeout(this.searchTimer),this.typeahead.abortSearch()},setResourceOptionForTypeahead:function(a,b){var c=this.typeahead.getResource();c.set(a,b)},search:function(){var a=this;this.searchTimer&&window.clearTimeout(this.searchTimer);var b=function(){a.typeahead.search(a.getValue())},c=this.options.search_delay;c?this.searchTimer=window.setTimeout(b,c):b()},blur:function(){this.$field.blur()},alignLeft:function(){this.$field.css("transform","translateX(0)")},alignCenter:function(){var a=this.$field.innerWidth(),b=this.getValue();0===b.length&&(b=this.$field.attr("placeholder")||"");var c=$("<span>");c.text(b),c.css("font-size",this.$field.css("font-size")),c.css("font-family",this.$field.css("font-family")),c.css("font-weight",this.$field.css("font-weight")),c.css("padding-left",this.$field.css("padding-left")),c.css("padding-right",this.$field.css("padding-right")),c.css("display","none"),this.$field.after(c);var d=c.innerWidth();c.remove();var e=Math.floor((a-Math.min(a,d))/2);this.$field.css("transform","translateX("+e+"px)")},isFocussed:function(){return this.$field.is(":focus")}}),goog.provide("P.modules.AboutLinks"),goog.require("P.Module"),P.modules.AboutLinks=P.Module.extend({}),goog.provide("P.modules.AddPin"),goog.require("P.Module"),goog.require("P.modules.ButtonBase");var BUTTON_ID_UPLOAD="upload_button",BUTTON_ID_URL="url_button",BUTTON_ID_RECOMMENDED="recommended_button";P.modules.AddPin=P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),Modernizr.fileinput||this.$(".pinUpload").remove()},onButtonClick:function(a){var b,c=this,d=a.target,e=d.id,f=!1,g=this.options.board_id;d.showLoading(),e===BUTTON_ID_UPLOAD?b={name:"PinUploader",options:{default_board_id:g}}:e===BUTTON_ID_URL?b={name:"AddPinURL",options:{show_title:!0}}:e===BUTTON_ID_RECOMMENDED&&(b={name:"AddRecommendedPinsModal",options:{default_board_id:g}},f=!0),b&&P.loadModule(b,function(a){c.modal.setModule(a),f&&c.modal.setTransparentContent(!0)})}}),goog.provide("P.modules.AddPinRep"),goog.require("P.Module"),goog.require("P.modules.ModalTrigger"),P.modules.AddPinRep=P.modules.ModalTrigger.extend({events:{click:"onClick"},onClick:function(){return this.showModal(),!1}}),goog.provide("P.modules.AddPinToMap"),goog.require("P.Module"),goog.require("P.modules.Map");var SUBMIT_BUTTON_ID="submitButton",CLASS_SLIDE_OUT="slideOut",RESOURCE_OPTION_NEAR="near",RESOURCE_OPTION_BOUNDING_BOX="bounds",SEARCHING_NEAR=P._("Searching near"),CLASS_ADD_PIN_TO_MAP_LOADING="loading",CLASS_ADD_PIN_TO_MAP_HIDDEN="hidden",PIN_BUTTON_ID="pinIt",ANIMATION_DURATION=450;P.modules.AddPinToMap=P.Module.extend({onCreated:function(){this.onUploadSuccess=_.bindFn(this.onUploadSuccess,this),this._place=null,this.typeaheadItems=null,this.listen(this,P.CONST.EVENT_DROPDOWN_CONTAINER_HIDDEN,this._onDropdownHide),this.listen(this,P.CONST.EVENT_DROPDOWN_CONTAINER_SHOWN,this._onDropdownShow),this.childListen(P.CONST.EVENT_ITEM_HIGHLIGHTED,this.onTypeaheadItemHighlighted),this.childListen(P.CONST.EVENT_EXTERNAL_CLICK,this.onExternalClick),this.listen(this,P.CONST.EVENT_EXTERNAL_CLICK,this.onExternalClick),this.childListen(P.CONST.EVENT_CITY_SELECTED,this.onCitySelected),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE_NOT_PROPAGATE,this.onCitySearchHide),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE,this.onCitySearchHide),this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onTypeaheadItemSelected),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.childListen(P.CONST.EVENT_TYPEAHEAD_SEARCH_START,this.onTypeaheadSearchStart),this.childListen(P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onTypeaheadResultsReturned),this.childListen(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onTypeaheadNoResultsReturned)},onExternalClick:function(a){a.stopPropagation()},onCitySearchHide:function(a){a.stopPropagation(),this.$(".field").focus()},setLocationName:function(a){this.$(".locationName").text(a),this.setCityChanged(!0)},setLocationPrefix:function(a){this.$(".locationPrefix").text(a||SEARCHING_NEAR)},getLocationName:function(){return this.$(".locationName").text()},_resetLocationName:function(){this.setLocationPrefix(),this.setLocationName(P._("Current Map View")),this.setCityChanged(!1)},setCityChanged:function(a){var b=this.getChildById("cityChooserDropdownButton");if(b){var c=P._(a?"Change City":"Choose City");b.$(".buttonText").text(c)}},onCitySelected:function(a){a.stopPropagation(),this._city=a.data;var b=this._city,c=b.get("bounds"),d=b.get("latitude"),e=b.get("longitude"),f=!!d&&!!e;if(f){if(c){var g=c.ne,h=c.sw,i=L.latLng(g.latitude,g.longitude),j=L.latLng(h.latitude,h.longitude);c=L.latLngBounds(j,i)}var k=L.latLng(d,e),l={bounds:c,latLng:k};this.triggerEvent(P.CONST.EVENT_CITY_SELECTED,l,!0);var m=b.get("name");m&&(this.setLocationPrefix(),this.setLocationName(m),this.setOptionsForTypeahead(m,null))}else{var n=b.get("id");"satw"===n?this._setSearchingWorld():this._resetLocationName()}this.search()},getTerm:function(){var a=this.addPinToMapField.getValue();return a},search:function(){var a=this.getTerm();a.length&&(this.hideTypeaheadResults(),this.addPinToMapField.search())},setInitialStateVisible:function(a){this.$(".initialState").toggleClass("hidden",!a)},onTypeaheadSearchStart:function(){this.setInitialStateVisible(!1),this.hideNoResultsReturnedState(),this.showLoading()},hideTypeaheadResults:function(){this.addPinToMapField.typeahead.emptyResults()},showLoading:function(){this.$el.toggleClass(CLASS_ADD_PIN_TO_MAP_LOADING,!0)},hideLoading:function(){this.$el.toggleClass(CLASS_ADD_PIN_TO_MAP_LOADING,!1)},_setLoading:function(a){this.$el.toggleClass(CLASS_ADD_PIN_TO_MAP_LOADING,a)},onTypeaheadResultsReturned:function(a){var b=a.data.items;this.hideNoResultsReturnedState(),this._setPlaceholderMarkersOnMap(b),0!==b.length&&(this.setInitialStateVisible(!1),this.hideLoading())},onTypeaheadNoResultsReturned:function(){this.$(".ui-Typeahead").show(),this.clearPlaceholderMarkersFromMap(),this.hideLoading(),this.setInitialStateVisible(!1),this.hideTypeaheadResults(),this.getTerm().length?this.showNoResultsReturnedState():this.setInitialStateVisible(!0)},showNoResultsReturnedState:function(){this._toggleNoResults(!1)},_toggleNoResults:function(a){this.$(".noResults").toggleClass(CLASS_ADD_PIN_TO_MAP_HIDDEN,a)},hideNoResultsReturnedState:function(){this._toggleNoResults(!0)},mixins:[P.Mixins.PreventScroll],onContentReady:function(){var a=this,b=this.options.board_id;this.addPinToMapField=this.getChildById("addPinToMapField"),this.startPreventScroll(a.$(".ui-Typeahead"),a.$(".results"));var c={};c[P.CONST.PUBSUB_TOPIC_MAP_BOUNDS_CHANGED]=this.onMapBoundsChanged,c[P.CONST.PUBSUB_TOPIC_PLACEHOLDER_MARKER_OPENED]=this.onPlaceholderMarkerOpen,this.pubsubSubscribe(b,c),this.childListen(P.CONST.EVENT_PINIT_BUTTON_CLICKED,this.onPinItButtonClicked)},onMapBoundsChanged:function(a,b,c){var d=c.bounds;this.setOptionsForTypeahead(null,d),this.search()},_setSearchingWorld:function(){this.setOptionsForTypeahead(null,null),this.triggerEvent(P.CONST.EVENT_TYPEAHEAD_SEARCH_WORLD,null,!0)},setOptionsForTypeahead:function(a,b){return a&&b?void this.log.error("invalid params to setOptionsForTypeahead",a,b):(a?this.setLocationName(a):(this._resetLocationName(),b||(this.setLocationPrefix(P._("Searching around")),this.setLocationName(P._("the world")))),this.addPinToMapField.setResourceOptionForTypeahead(RESOURCE_OPTION_NEAR,a),void this.addPinToMapField.setResourceOptionForTypeahead(RESOURCE_OPTION_BOUNDING_BOX,b))},onPlaceholderMarkerOpen:function(a,b,c){var d=c.place_id;if(d){var e=this.addPinToMapField.typeahead;e.highlightItemWithAttributeAndValue("id",d),e.focusHighlighted()}},onUploadSuccess:function(a){a.stopPropagation();var b=a.data.image_url;this._setActiveImage(b)},_addImageToTypeaheadDom:function(a){var b=this.$(".uploadPinForMap"),c=P.renderNunjucks("app/desktop/modules/AddPinToMap/uploadedImage.nunjucks",{image_url:a}),d=$(c);b.addClass("hasUploadedImage").css("height","auto"),b.prepend(d)},onRemovedFromDom:function(){this.stopPreventScroll()},_onDropdownHide:function(){this.addPinToMapField.reset(),this.reset(),this.triggerEvent(P.CONST.ADD_PIN_TO_MAP_DIALOG_HIDDEN,null,!0)},_onDropdownShow:function(){var a=this;if(this._city){var b=this._city.get("name");this.setCityChanged(!0),this.setLocationName(b),this.addPinToMapField.setResourceOptionForTypeahead(RESOURCE_OPTION_NEAR,b),this.addPinToMapField.setResourceOptionForTypeahead(RESOURCE_OPTION_BOUNDING_BOX,null)}this._removePinForm(),this.triggerEvent(P.CONST.ADD_PIN_TO_MAP_DIALOG_SHOWN,null,!0),P.setTimeout(function(){a.$(".field").first().focusWithoutScrolling(),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_TUTORIAL,P.CONST.PUBSUB_TOPIC_TUTORIAL_NEXT)},ANIMATION_DURATION)},onButtonClick:function(a){var b=a.target,c=b.id;if("wrongPlace"===c||"addPlace"===c||"cancelButton"===c){this.showSearch();var d=this.getChildById("addPlace");d&&d.remove(),this.showFoursquareAttribution(),this._setPlaceholderMarkersOnMap(this.addPinToMapField.getTypeaheadItemsToRender())}else if("selectCity"===c){var e=this.getChildById("cityChooserDropdownButton");e&&e.showDropdown()}else if("searchGlobally"===c){if(this._setSearchingWorld(),!this.getTerm().length)return void this.$(".field").focus();this.search()}},reset:function(){this.showSearch(),this.addPinToMapField.reset(),this.showFoursquareAttribution(),this.setInitialStateVisible(!0),this.hideTypeaheadResults()},onPinItButtonClicked:function(a){var b=a.data;this._setActiveImage(b),this.createPin()},_setActiveImage:function(a){this._activeImageUrl=a},_getActiveImage:function(){return this._activeImageUrl},createPin:function(){var a=this,b=this._place,c=b.get("id"),d=this.$("textarea").val(),e=this.options.board_id,f=this._getActiveImage(),g={board_id:e,place:c,description:d,image_url:f},h=P.resourceFactory.create("PinResource",g);h.callCreate({success:function(){a._place.set("placeholder",!1),a._setActiveImage(null),P.pubsub.publish(e,P.CONST.PUBSUB_TOPIC_PREPEND_ITEM_MAP_BOARD,a._place.attributes);var b=a.parent;b.$el.addClass(CLASS_SLIDE_OUT),window.setTimeout(function(){var b=a.parent;b.hide(),a.showFoursquareAttribution(),b.$el.removeClass(CLASS_SLIDE_OUT),a._onDropdownHide()},500)}})},addPermanentMarkerToMap:function(a){var b=a.attributes;this.triggerEvent(P.CONST.EVENT_ADD_PERMANENT_MARKER_TO_MAP_FROM_TYPEAHEAD,b,!0)},_isNewPin:function(){return!this.options.pin_id},_getSubmitButton:function(){var a,b=this.options.pin_id;return a=this.getChildById(b?SUBMIT_BUTTON_ID:PIN_BUTTON_ID)},hideSearch:function(){this.$(".citySearch, .placeSearch").addClass(CLASS_ADD_PIN_TO_MAP_HIDDEN)},showSearch:function(){this.$(".citySearch, .placeSearch").removeClass(CLASS_ADD_PIN_TO_MAP_HIDDEN)},_replaceContentWithPinForm:function(a){var b=this,c=this.options.board_id,d={id:"addPlace",name:"AddAPlace",options:{place:a.attributes,board_id:c}};this.hideFoursquareAttribution(),P.loadModule(d,function(a){b.hideSearch(),b.showLoading(),a.render(function(){b.hideLoading();var c=b.$(".searchContainer");b.insertChild(a,c)})})},hideFoursquareAttribution:function(){this.$(".poweredByFoursquare").addClass(CLASS_SLIDE_OUT)},_setFoursquareAttributionHidden:function(a){this.$(".poweredByFoursquare").toggleClass(CLASS_SLIDE_OUT,a)},showFoursquareAttribution:function(){this.$(".poweredByFoursquare").removeClass(CLASS_SLIDE_OUT)},_removePinForm:function(){var a=this.getChildById("addPlace");a&&a.remove()},_getMarkerOptions:function(a){var b=P.MarkerOptionsFactory.fromPlainObject(a.attributes);return b},_setPlaceholderMarkersOnMap:function(a){var b=this;this.typeaheadItems=a;var c=_.map(a,function(a){return b._getMarkerOptions(a)});c=c;var d={markerOptionsList:c};this.triggerEvent(P.CONST.EVENT_SET_PLACEHOLDER_MARKERS,d,!0)},highlightPlaceholderMarkerOnMap:function(a){var b={index:_.indexOf(this.typeaheadItems,a)};this.triggerEvent(P.CONST.EVENT_HIGHLIGHT_PLACEHOLDER_MARKER,b,!0)},clearPlaceholderMarkersFromMap:function(){this.triggerEvent(P.CONST.EVENT_CLEAR_PLACEHOLDER_MARKER_HIGHLIGHT,null,!0)},onTypeaheadItemSelected:function(a){a.stopPropagation();var b=a.data.item;if(b&&!b.get(P.CONST.TYPEAHEAD_ATTRIBUTE_EMPTY_STATE)){var c=b.get("search_id"),d=b.get("id"),e=this;if(c){var f={search_id:c,place:d},g=P.resourceFactory.create("PlacePingbackResource",f);g.call("update",{error:P.NOOP,success:P.NOOP,complete:P.NOOP})}if(this._isNewPin()){this._place=b;var h=b.get("latitude"),i=b.get("longitude"),j=L.latLng(h,i),k=_.indexOf(this.typeaheadItems,b),l={latLng:j,index:k};return this.triggerEvent(P.CONST.EVENT_PLACE_SELECTED,l,!0),this._replaceContentWithPinForm(b),void window.setTimeout(function(){e.highlightPlaceholderMarkerOnMap(b)},150)}var m=a.target;m.showLoading(!0);var n=P.resourceFactory.create("PinResource",{id:this.options.pin_id,place:d});n.callUpdate({error:P.NOOP}).always(function(){m.hideLoading(),e.addPermanentMarkerToMap(b)})}},onTypeaheadItemHighlighted:function(a){var b=a.data.item;!b||b.get(P.CONST.TYPEAHEAD_ATTRIBUTE_EMPTY_STATE)?this.highlightPlaceholderMarkerOnMap(null):(this.highlightPlaceholderMarkerOnMap(b),a.stopPropagation())}}),goog.provide("P.modules.AddPinURL"),goog.require("P.Module"),P.modules.AddPinURL=P.Module.extend({onContentReady:function(){var a=this.$(".standardForm"),b={url:[P.Validator.Required(),P.Validator.URL()]},c={prevalidate:!0};this.form=new P.Form(a,b,c),this.form.getField("url").placeholder(),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(a){if(!a.errors[0]){var b=this.form.getValue("url");this.navigate("/pin/find/?"+$.param({url:b}))}}}),goog.provide("P.modules.AddRecommendedPinsModal"),goog.require("P.Module"),P.modules.AddRecommendedPinsModal=P.Module.extend({}),goog.provide("P.modules.AdhocFeedIndexPage"),goog.require("P.Module"),P.modules.AdhocFeedIndexPage=P.Module.extend({}),goog.provide("P.modules.AdhocFeedPage"),goog.require("P.Module"),P.modules.AdhocFeedPage=P.Module.extend({}),goog.provide("P.modules.Analytics.Metric"),goog.require("P.Module"),P.modules.Analytics.Metric=P.Module.extend({}),goog.provide("P.modules.Analytics.MetricChange"),goog.require("P.Module"),P.modules.Analytics.MetricChange=P.Module.extend({}),goog.provide("P.modules.Analytics.MetricGraph"),goog.require("P.Module"),P.modules.Analytics.MetricGraph=P.Module.extend({events:{"click .legendColorBox":"onClickLegend","click .legendLabel":"onClickLegend",resize:"onResize"},graphContainer:function(){return void 0===this.placeholder&&(this.placeholder=$(".graphPlaceholder",this.el)),this.placeholder},onCreated:function(){this.placeholder=void 0,this.disabledSeries={},this.resetCurrentHover()},onAddedToDom:function(){this._addedToDom=!0,this.trySetupGraph()},onContentReady:function(){this._contentReady=!0,this.trySetupGraph()},onRemoved:function(){this.hideDropdown()},resizeGraph:function(){this.updateGraph()},trySetupGraph:function(){this._addedToDom&&this._contentReady&&(this.listen(P.Viewport,P.CONST.EVENT_BODY_COLUMN_CHANGE,this.resizeGraph),this.updateGraph(),this.setupGraphClicks(),this.anchor=$("<em></em>").css({position:"absolute"}).appendTo(this.$el))},onClickLegend:function(a){var b=$(a.target).attr("data-index");this.toggleSeries(b)},toggleSeries:function(a){this.disabledSeries[a]=!this.disabledSeries[a],this.updateGraph()},extractMetricSeries:function(a){var b=this.data;return $.map(b,function(b){var c=1e3*b.timestamp,d=b[a];return[[c,d]]})},buildTimeSeries:function(){for(var a=[],b=0;b<this.options.metric_group.length;b++){var c=this.options.metric_group[b],d=[],e=0===b?"#E6E6FF":"#FAF0B4";this.disabledSeries[b]!==!0&&(d=this.extractMetricSeries(c),e=0===b?"#367CBD":"#C06506");var f=this.options.metric_type_map[c].graph_name;a.push({data:d,label:f,color:e,points:{show:!0,fill:!0,fillColor:e}})}return a},updateGraph:function(){var a=this.buildTimeSeries();this.drawGraph(a)},tickFormatterY:function(a,b){return a<0?"":b.max<1e6?a.toFixed(b.tickDecimals):(a/=1e6,a.toFixed(1)+"m")},timeFormatter:function(a,b){if(a<b.datamin||a>b.datamax)return"";var c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d=new Date(a),e=c[d.getUTCDay()],f=d.getUTCMonth()+1,g=d.getUTCDate();return f+"/"+g+"<br/>"+e},seriesMinMax:function(a,b){for(var c=0,d=Number.MAX_VALUE,e=0;e<a.length;e++)for(var f=a[e].data,g=0;g<f.length;g++){var h=f[g][b];c=c>h?c:h,d=d<h?d:h}return{min:d,max:c}},seriesMinMaxY:function(a){var b=this.seriesMinMax(a,1);return b.min-=.35*b.max,b.max+=.3*b.max,b},seriesMinMaxX:function(a){var b=864e5,c=this.seriesMinMax(a,0),d=c.max-c.min,e=.08*d;return c.max+=Math.max(b,e),c.min-=Math.max(b,e),c},drawGraph:function(a){var b=this.graphContainer(),c=this.seriesMinMaxX(a),d=this.seriesMinMaxY(a),e={series:{shadowSize:1,lines:{show:!0},points:{show:!0,lineWidth:1,fill:!0,radius:5}},legend:{margin:[140,10],noColumns:2,backgroundOpacity:0,labelBoxBorderColor:"rgba(0,0,0,0)"},grid:{backgroundColor:"rgb(249, 249, 249)",borderColor:"rgb(230, 230, 230)",borderWidth:0,minBorderMargin:0,labelMargin:0,clickable:!0,hoverable:!0,axisMargin:0},yaxis:{tickColor:"rgb(230, 230, 230)",reserveSpace:!0,max:d.max,min:d.min,tickFormatter:this.tickFormatterY},xaxis:{tickColor:"rgb(230, 230, 230)",mode:"time",min:c.min,max:c.max,tickFormatter:this.timeFormatter}};$.plot(b,a,e)},checkAndSetNewHover:function(a){var b={dataIndex:a.dataIndex,seriesIndex:a.seriesIndex};return b.dataIndex===this.currentHover.dataIndex&&b.seriesIndex===this.currentHover.seriesIndex?!1:(this.currentHover=b,!0)},onPointHovered:function(a){if(this.checkAndSetNewHover(a)!==!1){var b=this.getChildById("metricPoint");this.pointDropdown=b._dropdown;var c=this.pointDropdown.getChildById("dropdownModule");c.updateData({seriesIndex:a.seriesIndex,date:new Date(a.datapoint[0]),value:a.datapoint[1]}),this.anchor.css({top:a.pageY+10,left:a.pageX}),this.pointDropdown.options.anchor=$(this.anchor),this.pointDropdown.show()}},onPointUnhovered:function(){this.hideDropdown()},hideDropdown:function(){this.pointDropdown&&this.pointDropdown.hide(),this.resetCurrentHover()},resetCurrentHover:function(){this.currentHover={}},setupGraphClicks:function(){var a=this,b=this.graphContainer();b.bind("plothover",function(b,c,d){d?a.onPointHovered(d):a.onPointUnhovered(c)})}}),goog.provide("P.modules.Analytics.MetricOverview"),goog.require("P.Module"),P.modules.Analytics.MetricOverview=P.Module.extend({}),goog.provide("P.modules.Analytics.MetricPoint"),goog.require("P.Module"),P.modules.Analytics.MetricPoint=P.Module.extend({events:{},updateData:function(a){this.updateValue(a.value),this.updateDate(a.date),this.updateMetricClass(a.seriesIndex)},updateDate:function(a){var b=a.days[a.getUTCDay()];this.$(".day").text(b);var c=a.getMonthName(),d=c+" "+a.getUTCDate()+", "+a.getFullYear();this.$(".date").text(d)},updateValue:function(a){this.$(".value").text(a.toLocaleString())},updateMetricClass:function(a){var b=this.$(".value");b.removeClass("metric-primary metric-secondary");var c="metric-primary";1===a&&(c="metric-secondary"),b.addClass(c)}}),goog.provide("P.modules.Analytics.MetricRecommendation"),goog.require("P.Module"),P.modules.Analytics.MetricRecommendation=P.Module.extend({events:{"click .recommendationWrapper":"onClick"},onClick:function(a){a.preventDefault();var b=parseInt($(a.target).attr("data-index"),10);return this.showModal(b),!1},showModal:function(a){var b=this;this.showLoading();var c={name:"Analytics.MetricTipModal",options:{tipIndex:a,tips:this.data}};P.loadModule(c,function(a){P.trackGAEvent("analytics_tips",P.CONST.GA_ACTION_OPEN_MODAL),b.hideLoading(),b.showInModal(a)})}}),goog.provide("P.modules.Analytics.MetricTipModal"),goog.require("P.Module"),P.modules.Analytics.MetricTipModal=P.Module.extend({events:{"click .nextTip":"nextTip","click .prevTip":"prevTip"},onContentReady:function(){this.currentTip=this.options.tipIndex,this.tips=this.$(".tipGroup"),this.showTip(this.currentTip)},showTip:function(a){if(!(a>=this.tips.length||a<0)){this.currentTip=a;var b=this;this.tips.each(function(c,d){var e=a===c;e?($(d).show(),b.$("h1").text($(d).attr("data-title"))):$(d).hide()}),this.updateButtons(a)}},updateButtons:function(a){var b=a<this.tips.length-1;this.toggleButton("nextTipButton",b);var c=a>0;this.toggleButton("prevTipButton",c)},toggleButton:function(a,b){b?this.getChildById(a).enable():this.getChildById(a).disable()},nextTip:function(){this.showTip(this.currentTip+1)},prevTip:function(){this.showTip(this.currentTip-1)}}),goog.provide("P.modules.Analytics.MetricTypeInfo"),goog.require("P.Module"),P.modules.Analytics.MetricTypeInfo=P.Module.extend({}),goog.provide("P.modules.AnimationPlaces"),goog.require("P.Module"),goog.require("P.modules.AnimationPlacesBase"),P.modules.AnimationPlaces=P.modules.AnimationPlacesBase.extend({events:{"mouseenter .balloonLayer":"activateBalloon","mouseleave .balloonLayer":"deactivateBalloon"},onContentReady:function(){this.$balloon=this.$(".balloon")},activateBalloon:function(){var a=this.$(".balloonAudio").get(0);a.play(),this.$balloon.hide()},deactivateBalloon:function(){this.$balloon.show()}}),goog.provide("P.modules.BackgroundImage"),goog.require("P.Module"),P.modules.BackgroundImage=P.Module.extend({setNewImage:function(a,b){this.options.image_preload_bg=a,this.options.image_url=b,this.$el.css("background-color",this.options.image_preload_bg),this.background.removeClass("loaded"),this.holderImage.attr("src",this.options.image_url)},onContentReady:function(){this.holderImage=this.$(".holderImage"),this.background=this.$(".background"),this.holderImage.load(_.bindFn(this.onImageLoaded,this)),this.setNewImage(this.options.image_preload_bg,this.options.image_url)},onImageLoaded:function(){var a=this;a.background.css("background-image","url('"+a.options.image_url+"')"),setTimeout(function(){a.background.addClass("loaded")},100)},setActive:function(a){this.$el.toggleClass("active",a)}}),goog.provide("P.modules.BlendedCookieHomeFeedPage"),goog.require("P.Module"),P.modules.BlendedCookieHomeFeedPage=P.Module.extend({}),goog.provide("P.modules.BlendedHomeFeedPage"),goog.require("P.Module"),P.modules.BlendedHomeFeedPage=P.Module.extend({}),goog.provide("P.modules.BoardCollaborators"),goog.require("P.Module"),goog.require("P.modules.BoardCollaboratorInvitesBase"),P.modules.BoardCollaborators=P.modules.BoardCollaboratorInvitesBase.extend({onContentReady:function(){this.boardInviteForm=this.getChildById("boardInviteForm");var a=this.getBoardId();if(a){var b={};b[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.pubsubSubscribe(a,b)}},onBoardUpdated:function(){this.render()}}),goog.provide("P.modules.BoardCoverEditPage"),goog.require("P.Module"),P.modules.BoardCoverEditPage=P.Module.extend({events:{"click .save":"save","click .cancel":"cancel"},save:function(){P.trackGAEvent("board_edit_cover",P.CONST.GA_ACTION_CLICK_SUBMIT);var a=this.getChildByModuleName("BoardCoverEdit"),b=a.getBoardCoverData(),c=this.getChildById("saveCover");c.showLoading();var d=this,e=_.extend(b,{board_id:this.extraData.boardId,url:d.$(".in").attr("src")}),f=P.resourceFactory.create("BoardResource",e);f.callUpdate({success:function(){P.trackGAEvent("board_edit_cover",P.CONST.GA_ACTION_SUCCESS),d.destroy(),P.pubsub.publish(d.extraData.boardId,P.CONST.PUBSUB_TOPIC_BOARD_COVER_UPDATED,e)},complete:function(){c.hideLoading()}})},cancel:function(){P.trackGAEvent("board_edit_cover",P.CONST.GA_ACTION_CLICK_CANCEL),this.destroy()}}),goog.provide("P.modules.BoardCreateRep"),goog.require("P.Module"),goog.require("P.modules.ModalTrigger"),P.modules.BoardCreateRep=P.modules.ModalTrigger.extend({events:{click:"onClick"},onClick:function(){return this.showModal(),!1}}),goog.provide("P.modules.BoardFollowers"),goog.require("P.Module"),P.modules.BoardFollowers=P.Module.extend({}),goog.provide("P.modules.BoardHeader"),goog.require("P.Module");var BOARD_INFO_BAR_MODULE_NAME="BoardInfoBar";P.modules.BoardHeader=P.Module.extend({showEditModal:function(){var a=this.getChildByModuleName(BOARD_INFO_BAR_MODULE_NAME);return a.showEditModal()}}),goog.provide("P.modules.BoardInfoBar"),goog.require("P.Module");var EDIT_BUTTON_ID="editButton";P.modules.BoardInfoBar=P.Module.extend({onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED]=this.onWriteAccessChange,this.pubsubSubscribe(this.data.id,a)},onWriteAccessChange:function(){this.render()},showEditModal:function(){var a=this.getChildById(EDIT_BUTTON_ID);return a?(a.showModal(),!0):!1}}),goog.provide("P.modules.BoardInvite"),goog.require("P.Module"),goog.require("P.modules.BoardInviteBase"),P.modules.BoardInvite=P.modules.BoardInviteBase.extend({onClickRemove:function(){var a=this.options.view_type;"boardCreate"===a?(this.triggerEvent(P.CONST.EVENT_BOARD_CREATE_USER_REMOVED,{user_id:this.options.user_id},!0),this.destroy()):"email"===a?(this.triggerEvent(P.CONST.EVENT_BOARD_CREATE_USER_REMOVED,{email:this.options.email},!0),this.destroy()):this.getConfirmBoardInvite()?this.confirmDeleteBoardInvite():this.deleteBoardInvite()},confirmDeleteBoardInvite:function(){var a=this._getCurrentUserIsInvitedUser(),b=this._getInvitedUserFullName(),c=this,d={name:"RemoveUserFromBoardDialog",options:{template:"delete_board_invite",current_user_is_invited_user:a,invited_user_first_name:this.extraData.invitedUserFirstName,invited_user_full_name:b}};P.loadModule(d,function(a){c.showInModal(a),c.listen(a,P.CONST.EVENT_CONFIRM,c.deleteBoardInvite)})}}),goog.provide("P.modules.BoardPage"),goog.require("P.modules.BoardPageBase"),goog.require("P.Module"),goog.require("P.modules.Map"),goog.require("P.number");var CLOSE_BUTTON_ID="closeAddToMap",BOARD_PAGE_CLASS_VISIBLE="visible",CLASS_ATTRIBUTION_MOVED="moved",BOARD_PAGE_PINS_TAB="pins",TRAVEL_CATEGORY="travel";P.modules.BoardPage=P.modules.BoardPageBase.extend({onCreated:function(){this.userPreferredCenter=null,this.userPreferredZoom=null,this._draggingTriggerMapBoundsChanged=!0,this._pinCount=0,this._onPrependedToMapBoard=_.bindFn(this._onPrependedToMapBoard,this),this.map=null},addTutorials:function(){if(this.options.tab===BOARD_PAGE_PINS_TAB&&this.extraData.canEdit){var a,b=this.data,c=P.ExperienceManager.instance();b.layout===P.CONST.BOARD_LAYOUT_PLACES?a=_.isEmpty(this.getPins())?P.Experiences.Placement.WEB_EMPTY_PLACES_BOARD_TAKEOVER:P.Experiences.Placement.WEB_FILLED_PLACES_BOARD_TAKEOVER:b.category!==TRAVEL_CATEGORY&&(a=P.Experiences.Placement.WEB_BOARD_TAKEOVER);var d=c.getPlacedExperience(a);if(d){var e=P.ExperienceManager.Tutorials[d.experience_id];e&&(P.TutorialManager.instance().startTutorial(e),c.viewPlacedExperience(a,d.experience_id))}}},getLoggingObjectIdStr:function(){return this.data.id},onScrollToTopHidden:function(){this.restoreAttributionOriginalPosition()},onScrollToTopVisible:function(){this.preventAttributionObstruction()},restoreAttributionOriginalPosition:function(){this._toggleAttributionMoved(!1)},_toggleAttributionMoved:function(a){this.$(".attribution").toggleClass(CLASS_ATTRIBUTION_MOVED,a)},preventAttributionObstruction:function(){this._toggleAttributionMoved(!0)},addPermanentMarkerFromTypeahead:function(a){a=a.data,this.map.clearPlaceholderMarkers(),a.highlighted=!0,a.animated=!0,a.placeholder=!1,a=this._generateMapMarkerData(a),this.map.addPermanentMarkerFromTypeahead(a),this.onHideMapDropdown()},onSetPlaceholderMarkers:function(a){var b=this,c=a.data,d=c.markerOptionsList;_.each(d,function(a){a.placeholder=!0,a.highlighted=!1,a.animated=!1});var e=_.map(d,function(a){return b._generateMapMarkerData(a)});this.map.setPlaceholderMarkers(e,!1)},onHighlightPlaceholderMarker:function(a){var b=a.data.index;this.map.clearPlaceholderHighlights(),this.map.highlightPlaceholderMarker(b)},onClearPlaceholderMarkers:function(){this.map.clearPlaceholderMarkers()},_generateMapMarkerData:function(a){var b=a.pin||this.getPinToAddToMap(),c=[a.latitude,a.longitude],d=a.id,e={pin:b,coordinates:c,id:d},f=_.extend(e,a);return f},onRemovedFromDom:function(){this.data&&this.data.layout===P.CONST.BOARD_LAYOUT_PLACES&&(this._hideCloseDropdownButton(),this.hideMapDropdown(),this._setCloseButtonVisible(!1),this.map.clearMarkers())},_getBounds:function(){var a=this.map.getSafeZoneLatLngBounds(),b=a.getSouthWest(),c=a.getNorthEast(),d=[b.lat,b.lng],e=[c.lat,c.lng],f=[d,e];return f},haversine:function(a,b){var c=a.lat,d=a.lng,e=b.lat,f=b.lng,g=e-c,h=P.number.toRadians(g),i=f-d,j=P.number.toRadians(i),k=Math.sin(h/2)*Math.sin(h/2)+Math.cos(P.number.toRadians(c))*Math.cos(P.number.toRadians(e))*Math.sin(j/2)*Math.sin(j/2),l=2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)),m=6371*l;return m},_determineIfGlobalSearch:function(){var a=this.map.getSafeZoneLatLngBounds(),b=a.getNorthEast(),c=a.getNorthWest(),d=a.getSouthWest(),e=this.haversine(d,b)*this.haversine(c,b);return e>=1e4},_getPinByPinId:function(a){for(var b,c=this.getPins(),d=0,e=c.length;d<e;++d)if(b=c[d],b.getId()===a)return b;
return null},onMapBoundsChanged:function(){var a=this.data.id,b=this._getBounds(),c=this._determineIfGlobalSearch();c&&(b=null),this._searchingGlobally||P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_MAP_BOUNDS_CHANGED,{bounds:b}),this._searchingGlobally=c},onMapPopupOpened:function(a){var b=a.data,c=this._getPinByPinId(b);c.scrollIntoView(),this.map.highlightMarkerForPinId(b)},onContentReady:function(){if(this.data.id){var a={};a[P.CONST.PUBSUB_TOPIC_BOARD_BANNED_COLLABORATOR]=this.onBannedUser,a[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,a[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,a[P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf,a[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this.onPinAdded,a[P.CONST.PUBSUB_TOPIC_PREPEND_ITEM_MAP_BOARD]=this.onPrependNewPinMapBoard,a[P.CONST.PUBSUB_TOPIC_SET_DRAG_MAP_REDO_SEARCH]=this.onDisableDragMapReSearch,a[P.CONST.PUBSUB_TOPIC_PIN_FLAGGED]=this.onPinFlagged,this.pubsubSubscribe(this.data.id,a)}if(this.childListen(P.CONST.EVENT_PIN_UPDATED,this.onChildPinUpdated),this.childListen(P.CONST.EVENT_RESET_SHOW_PIN_ON_MAP_BUTTON,this.resetShowPinOnMapButtonStates),this.map=this.getChildById("map"),this.map){var b={};b[P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP_HIDDEN]=this.onScrollToTopHidden,b[P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP_VISIBLE]=this.onScrollToTopVisible,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,b),this.attachHoverListeners(),this.childListen(P.CONST.EVENT_MAP_POPUP_OPENED,this.onMapPopupOpened),this.childListen(P.CONST.EVENT_MAP_DRAG_END,this.onMapDragEnd),this.childListen(P.CONST.PLACEHOLDER_MARKER_POPUP_OPENED,this.onPlaceholderMarkerOpened),this.childListen(P.CONST.EVENT_MAP_ZOOM_END,this.onMapZoomEnd),this.childListen(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onTypeaheadNoResultsReturned),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_BOARD_CACHE_PIN_ID_TO_ADD_TO_MAP,this.onPinAddToMapCachePinId),this.childListen(P.CONST.EVENT_PIN_PLACE_CLICK,this.onPinPlaceClick),this.childListen(P.CONST.EVENT_PIN_MOUSE_IN,this.onPinMouseIn),this.childListen(P.CONST.EVENT_PIN_MOUSE_OUT,this.onPinMouseOut),this.childListen(P.CONST.EVENT_ADD_PERMANENT_MARKER_TO_MAP_FROM_TYPEAHEAD,this.addPermanentMarkerFromTypeahead),this.childListen(P.CONST.ADD_PIN_TO_MAP_DIALOG_HIDDEN,this.onAddPinToMapHidden),this.childListen(P.CONST.ADD_PIN_TO_MAP_DIALOG_SHOWN,this.onAddPinToMapShown),this.childListen(P.CONST.EVENT_CITY_SELECTED,this.onCitySelected),this.childListen(P.CONST.EVENT_PLACE_SELECTED,this.onPlaceSelected),this.childListen(P.CONST.EVENT_SET_PLACEHOLDER_MARKERS,this.onSetPlaceholderMarkers),this.childListen(P.CONST.EVENT_HIGHLIGHT_PLACEHOLDER_MARKER,this.onHighlightPlaceholderMarker),this.childListen(P.CONST.EVENT_REMOVE_PLACEHOLDER_MARKER_TO_MAP_FROM_TYPEAHEAD,this.onClearPlaceholderMarkers),this.childListen(P.CONST.EVENT_ITEMS_REQUEST_SUCCESS,this.onChildItemsAddedToGrid),this.childListen(P.CONST.EVENT_TYPEAHEAD_SEARCH_WORLD,this.onSearchGlobally)}P.modules.BoardPageBase.prototype.onContentReady.call(this),this.options.show_edit&&(this.extraData.canEdit&&this.showEditModal(),delete this.options.show_edit),this._sticky=new P.Sticky(this.$(".addPinToMapButtons"),{$boundTo:this.$el,$scrollable:this.getScrollableElement(),headerHeight:$(".headerBackground").height()}),this.addTutorials(),this.numPinsFlagged=0},onPinFlagged:function(){this.numPinsFlagged+=1},getNumPinsFlagged:function(){return this.numPinsFlagged},onSearchGlobally:function(){this._searchingGlobally=!0,this.map.fitWorld()},onCitySelected:function(a){var b=a.data;this._city=b;var c,d;b.bounds?d=b.bounds:c=b.latLng,d||(d=this.getCityBoundsFromCenter(c)),this.map.fitBounds(d)},onDisableDragMapReSearch:function(a,b,c){this._draggingTriggerMapBoundsChanged=c},onMapZoomEnd:function(){this._place||this._city||this.onMapBoundsChanged()},makeLatLngBoundsFromLatLngAndPadding:function(a,b){var c=L.latLng(a.lat-b,a.lng-b),d=L.latLng(a.lat+b,a.lng+b);return L.latLngBounds(c,d)},getCityBoundsFromCenter:function(a){var b=.05;return this.makeLatLngBoundsFromLatLngAndPadding(a,b)},onTypeaheadNoResultsReturned:function(){this.map&&this.map.clearPlaceholderMarkers()},onPlaceSelected:function(a){var b=a.data.index;this.map.showOnlyPlaceholderMarkerAtIndex(b),this._place=a.data},onPlaceholderMarkerOpened:function(a){var b=a.data.place_id,c=a.data.index,d=this.data.id;P.pubsub.publish(d,P.CONST.PUBSUB_TOPIC_PLACEHOLDER_MARKER_OPENED,{place_id:b}),this.map.highlightPlaceholderMarker(c)},onButtonClick:function(a){var b=a.target;if(b.id===CLOSE_BUTTON_ID){this.map.clearPlaceholderMarkers(),this.onHideMapDropdown(),this._hideCloseDropdownButton();var c=this.getPins();_.each(c,function(a){a.toggleActionButtons(!1)})}else"wrongPlace"===b.id&&(this._place=null)},_hideCloseDropdownButton:function(){var a=this.getChildById(CLOSE_BUTTON_ID);a&&a.$el.removeClass(BOARD_PAGE_CLASS_VISIBLE)},setMapPaddingTopLeft:function(){var a,b=this._getAddToMapButton();b||(a=this.getGrid());var c=a||b;if(c){var d=c.getOffset(),e=c.getPosition(),f=c.getWidth()+d.left+e.left,g=100,h=L.point(f,g);this.map.setPaddingTopLeft(h)}},onHideMapDropdown:function(){this.hideMapDropdown(),this.hideCloseButton()},hideMapDropdown:function(){var a=this.getPins();_.each(a,function(a){"closeAddToMapDropdownIfNeeded"in a&&a.closeAddToMapDropdownIfNeeded()});var b=this._getAddToMapButton();b&&b.hideDropdown()},onMapDragEnd:function(){this._draggingTriggerMapBoundsChanged&&this.onMapBoundsChanged()},_onPrependedToMapBoard:function(){var a=this.getPins()[0],b=this._markerToPrepend;b.pin=a,this.addPermanentMarkerFromTypeahead({data:b})},onPrependNewPinMapBoard:function(a,b,c){var d=this,e=this.getGrid();this._markerToPrepend=c,e.prependNewItems(1,d._onPrependedToMapBoard),this.hideCloseButton()},onPinMouseOut:function(a){var b=a.data;this.map.unHighlightMarkerForPinId(b)},onPinMouseIn:function(a){var b=a.data;this.map.highlightMarkerForPinId(b)},onPinPlaceClick:function(a){var b=a.data;this.map.highlightMarkerForPinId(b),this.map.openPopupForPin(b)},_setCloseButtonVisible:function(a){var b=this.getChildById(CLOSE_BUTTON_ID),c=this._getAddToMapButton();b&&(b.$el.toggleClass("visible",a),c.getButton().$el.toggleClass("hidden",a)),!a&&c&&c.setActiveStyle(!1)},showCloseButton:function(){this._setCloseButtonVisible(!0)},hideCloseButton:function(){this._setCloseButtonVisible(!1)},onAddPinToMapShown:function(){this._city||this.onMapBoundsChanged(),this.map.toggleTranslucentMarkers(!0),this.detatchHoverListeners(),this.map.closeAllMarkerPopups(),this.showCloseButton()},onAddPinToMapHidden:function(){this.setPinToAddToMap(null),this.map.clearPlaceholderMarkers(),this.attachHoverListeners(),this.map.toggleTranslucentMarkers(!1)},onPinAddToMapCachePinId:function(a){var b=a&&a.data;this.setPinToAddToMap(b),this.detatchHoverListeners()},getPinToAddToMap:function(){return this._pinToAddToMap},setPinToAddToMap:function(a){this._pinToAddToMap=a},_getPinsWithCoordinates:function(){var a=[];if(this.map){var b=this.getPins();_.each(b,function(b){var c=b.getCoordinates();c&&a.push(b)})}return a},detatchHoverListeners:function(){this.map&&this._toggleHoverListeners(!1)},_toggleHoverListeners:function(a){var b=this._getPinsWithCoordinates();_.each(b,function(b){var c=b.getCoordinates();if(c){var d=a?P.CONST.ADD_HOVER_LISTENER_FOR_MAP_MARKER:P.CONST.REMOVE_HOVER_LISTENER_FOR_MAP_MARKER;b.trigger(d)}})},attachHoverListeners:function(){this.map&&this._toggleHoverListeners(!0)},isPlaceBoard:function(){var a=this.data;return a?a.layout===P.CONST.BOARD_LAYOUT_PLACES:!1},onRendered:function(){var a="places"===this.data.layout;a&&this.attachHoverListeners(),P.Module.prototype.onRendered()},resetShowPinOnMapButtonStates:function(){var a=this.getPins();_.each(a,function(a){a.resetShowOnMapButton()})},onChildItemsAddedToGrid:function(){this.map&&(this.attachHoverListeners(),this.updatePinsOnMap())},updatePinsOnMap:function(){var a=this._pinCount,b=this.getPins();if(!b)return void(this._pinCount=0);var c=b.length,d=c-a-1;d&&(b=b.slice(a),this.map.addMarkersToMap(b,!0),this._pinCount=c)},onBoardUpdated:function(a,b,c){c.url!==this.data.url&&this.inDom?(this.data.url=c.url,this.navigate(c.url)):this.headerDataChanged(c)&&this.renderHeader(),c.layout!==this.data.layout&&(this.data.layout=c.layout,this.navigate(c.url,this,!0))},onPinAdded:function(){var a=this.getGrid();a.prependNewItems(1)},onBannedUser:function(){this.renderHeader();var a=this.getGrid();a.render()},headerDataChanged:function(a){var b=_.pick(this.data,"privacy","description"),c=_.pick(a,"privacy","description");return!_.isEqual(b,c)},onBoardDeleted:function(){this.inDom&&this.navigateToUserPage()},navigateToUserPage:function(){var a=this.extraData&&this.extraData.currentUsername,b="/",c=a?b+a+"/":b;this.navigate(c)},getHeader:function(){return this.getChildById("boardHeader")},renderHeader:function(){var a=this.getHeader();a.render()},showEditModal:function(){var a=this.getHeader();return a.showEditModal()},onChildPinUpdated:function(a){var b=a.data,c=b.board.id,d=b.place,e=a.target,f=b.id;if(c!==this.data.id&&(e.destroy(),this._removePinFromMap(e)),d||this._removePinFromMap(e),this.map){var g=this.map.getMarkerForPin(f);if(g&&d){var h=g.getLatLng(),i=h.lat,j=h.lng,k=d.latitude,l=d.longitude;if(l!==j||k!==i){this.map.removeMarkerForPinId(f);var m={data:d};m.data.pin=e,this.addPermanentMarkerFromTypeahead(m)}}}},onBoardRemovedSelf:function(){this.data.privacy===P.CONST.BOARD_PRIVACY_SECRET&&this.inDom?this.navigateToUserPage():this.renderHeader()}}),goog.provide("P.modules.BoardPicker2"),goog.require("P.Module");var ENTER_INSTRUCTIONS_CLASS="enterInstructions",BOARD_ID_ATTR2="data-id",BOARD_LIST_ITEM_CLASS="boardListItem",BOARDS_SHORTLIST_CLASS="boardsShortlist",ALL_BOARDS_HEADER_CLASS="allBoardsHeader",ALL_BOARDS_LIST_CLASS="allBoardsList",CREATE_BOARD_CLASS="createBoard",BOARD_NAME_CLASS="boardName",HIDDEN_CLASS="hidden",HIGHLIGHTED_CLASS="highlighted";P.modules.BoardPicker2=P.Module.extend({events:{"click .boardListItem":"onBoardClick","mouseenter .boardListItem":"onBoardHoverStart","mouseleave .boardListItem":"onBoardHoverEnd","textchange .boardSelectorInput":"onBoardSelectorInput",keydown:"onBoardSelectorKeydown"},onCreated:function(){this._lastInputValue="",this._boardsShortlistVisible=!0,this._boardDivsVisible=null,this._selectedBoardIdx=null,this._selectedBoardId=null,this.$_selectedBoardDiv=null},onContentReady:function(){this.$boardSelectorInput=this.$(".boardSelectorInput"),this._syncBoardSelectorToInput(),this.options.autofocus_board&&this._autofocusBoardSelector()},_autofocusBoardSelector:function(){this.$(".boardSelectorInput[autofocus]:not(:focus)").eq(0).focus()},getSelectedBoardId:function(){return this._selectedBoardId},getSelectedBoardName:function(){return this.$_selectedBoardDiv?this._getBoardName(this.$_selectedBoardDiv,!1,!0):""},setSelectedBoardId:function(a){this._selectedBoardId=a,this.$_selectedBoardDiv.attr(BOARD_ID_ATTR2)||this.$_selectedBoardDiv.attr(BOARD_ID_ATTR2,a)},getLoadingSpinTarget:function(){return this.$_selectedBoardDiv},onBoardHoverStart:function(a){var b=$(a.currentTarget);this._selectBoard(b,!1)},onBoardHoverEnd:function(){this._selectBoard(null,!1)},onBoardClick:function(a){var b=$(a.currentTarget);this._selectBoard(b,!0),a.stopImmediatePropagation()},onBoardSelectorInput:function(){this._syncBoardSelectorToInput(),this._lastInputValue=this._getBoardSelectorInputValue()},onBoardSelectorKeydown:function(a){if(""===this._getBoardSelectorInputValue()&&""!==this._lastInputValue&&this._syncBoardSelectorToInput(),this._boardDivsVisible.length){var b=P.keyCode;switch(a.keyCode){case b.UP:this._boardSelectorHighlightUp(),a.preventDefault();break;case b.DOWN:this._boardSelectorHighlightDown(),a.preventDefault();break;case b.ENTER:case b.NUMPAD_ENTER:var c=this._boardDivsVisible[this._selectedBoardIdx];this._selectBoard(c,!0)}}},_resetSelectedBoard:function(){this._selectedBoardIdx=null,this._selectedBoardId=null,this.$_selectedBoardDiv=null},_selectBoard:function(a,b){if(this.$_selectedBoardDiv&&this.$_selectedBoardDiv.removeClass(HIGHLIGHTED_CLASS),!a)return this._resetSelectedBoard(),b&&this.triggerEvent(P.CONST.EVENT_BOARD_SELECTED,{boardId:null},!0),!1;this.$_selectedBoardDiv=a,this.$_selectedBoardDiv.addClass(HIGHLIGHTED_CLASS);var c=this._getIdxOfBoardDiv(a);this._setSelectedBoardIdx(c);var d=a.attr(BOARD_ID_ATTR2);if(this._selectedBoardId=d,b){var e={};e.boardId=d,d||(e.boardName=this._getBoardName(a,!1,!0)),this.triggerEvent(P.CONST.EVENT_BOARD_SELECTED,e,!0)}return!0},_getIdxOfBoardDiv:function(a){for(var b=0;b<this._boardDivsVisible.length;b++)if(a.get(0)===this._boardDivsVisible[b].get(0))return b;return-1},_getBoardName:function(a,b,c){if(b&&a.hasClass(CREATE_BOARD_CLASS))return"";var d=$.trim(a.find("."+BOARD_NAME_CLASS).text());return c||(d=d.toLowerCase()),d},_syncBoardSelectorToInput:function(){this._resetBoardSelector();var a=this._getBoardSelectorInputValue(),b=""===a,c=!b&&a.length<20;this._toggleEnterInstructions(c);var d=b;this._setBoardsShortlistVisibility(d),this._setCreateBoardName(this._getBoardSelectorInputValue(!0));var e=this._tokenizeString(a),f=this,g=function(b){var c=f._getBoardName(b,!0,!0);if(""===c)return!1;if(""===a)return b.find(".boardNameWrapper ."+BOARD_NAME_CLASS).text(c),!0;var d=f._tokenizeString(c),g=[],h=[];_.each(e,function(){h.push(!1)}),_.each(d,function(a){var b="";if(_.each(e,function(c,d){P.beginsWith(a.toLowerCase(),c.toLowerCase())&&(c.length>b&&(b=c),h[d]=!0)}),b){var c=_.escape(a.substr(0,b.length)),d=_.escape(a.substr(b.length));g.push('<span class="boardListItemTextMatch">'+c+"</span>"+d)}else g.push(_.escape(a))});var i=_.every(h);return i&&b.find(".boardNameWrapper ."+BOARD_NAME_CLASS).html(g.join(" ")),i},h="."+BOARD_LIST_ITEM_CLASS;d||(h="."+ALL_BOARDS_LIST_CLASS+" "+h);var i=null;if(_.each(this.$(h),function(b){var c=$(b),d=g(c);c.toggleClass(HIDDEN_CLASS,!d),d&&(f._boardDivsVisible.push(c),i||f._getBoardName(c,!0,!1)!==a||(i=c))}),i)this._selectBoard(i,!1),this._setCreateBoardVisibility(!1);else{var j=!b;this._setCreateBoardVisibility(j)}var k=this._boardDivsVisible[0];this._selectBoard(k,!1)},_getBoardSelectorInputValue:function(a){var b=this.$boardSelectorInput.val();return a||(b=b.toLowerCase()),b},_toggleEnterInstructions:function(a){this.$("."+ENTER_INSTRUCTIONS_CLASS).toggleClass(HIDDEN_CLASS,!a)},_tokenizeString:function(a){return a.split(" ")},_resetBoardSelector:function(){if(null!==this.$_selectedBoardDiv&&this.$_selectedBoardDiv.removeClass(HIGHLIGHTED_CLASS),null!==this._selectedBoardIdx){var a=this._boardDivsVisible[this._selectedBoardIdx];a&&a.removeClass(HIGHLIGHTED_CLASS)}this._boardDivsVisible=[],this._selectBoard(null,!1)},_setBoardsShortlistVisibility:function(a){var b=this.$("."+BOARDS_SHORTLIST_CLASS+",."+ALL_BOARDS_HEADER_CLASS);b.toggleClass(HIDDEN_CLASS,!a),this._boardsShortlistVisible=a},_getCreateBoardDiv:function(){return this.$("."+CREATE_BOARD_CLASS)},_setCreateBoardVisibility:function(a){var b=this._getCreateBoardDiv();b.toggleClass(HIDDEN_CLASS,!a),this._boardDivsVisible.push(b)},_setCreateBoardName:function(a){this.$("."+CREATE_BOARD_CLASS+" ."+BOARD_NAME_CLASS).text(a)},_boardSelectorHighlightUp:function(){if(null!==this._selectedBoardIdx){var a=this._setSelectedBoardIdx(this._selectedBoardIdx-1),b=this._boardDivsVisible[a];this._selectBoard(b,!1),this._scrollSelectedBoardDivToView()}},_boardSelectorHighlightDown:function(){null===this._selectedBoardIdx&&(this._selectedBoardIdx=-1);var a=this._setSelectedBoardIdx(this._selectedBoardIdx+1),b=this._boardDivsVisible[a];this._selectBoard(b,!1),this._scrollSelectedBoardDivToView()},_setSelectedBoardIdx:function(a){return a<0?a=null:a>this._boardDivsVisible.length-1&&(a=this._boardDivsVisible.length-1),this._selectedBoardIdx=a,a},_scrollSelectedBoardDivToView:function(){if(null!==this._selectedBoardIdx){var a=this._boardDivsVisible[this._selectedBoardIdx],b=a.outerHeight(),c=b*this._selectedBoardIdx;if(this._boardsShortlistVisible){var d=this.$("."+BOARDS_SHORTLIST_CLASS+" ."+BOARD_LIST_ITEM_CLASS).length;this._selectedBoardIdx>=d&&(c+=this.$("."+ALL_BOARDS_HEADER_CLASS).outerHeight())}var e=this.$(".boardPickerListItems"),f=e.scrollTop();c<f?this._alignToViewTop(e,c):c+b>f+e.outerHeight()&&this._alignToViewBottom(e,c+b)}},_alignToViewTop:function(a,b){a.scrollTop(b)},_alignToViewBottom:function(a,b){a.scrollTop(b-a.outerHeight())}}),goog.provide("P.modules.BoardRecFeedHomePage"),goog.require("P.Module"),P.modules.BoardRecFeedHomePage=P.Module.extend({onContentReady:function(){var a=this.getChildById("grid"),b="none";a&&!a.hasItems()&&(a.remove(),b="block"),this.$(".noResults").css("display",b)}}),goog.provide("P.modules.BoardRecommendationsModule"),goog.require("P.Module"),P.modules.BoardRecommendationsModule=P.Module.extend({onContentReady:function(){this.destroyIfEmpty()},isEmpty:function(){if(!this.contentReady)return!1;var a=this.getChildById("relatedBoardsFeed");return!a||!a.hasItems()}}),goog.provide("P.modules.BusinessAccountConvert"),goog.require("P.Module"),P.modules.BusinessAccountConvert=P.Module.extend({events:{"keyup .aboutText":"onAboutTextKeyup"},onContentReady:function(){var a={contact_name:[P.Validator.Required()],email:[P.Validator.Email(),P.Validator.Required()],account_type:[P.Validator.Required()],business_name:[P.Validator.Required()],username:[P.Validator.Required()],about:[P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_USER_DESCRIPTION})],accept_terms:[P.Validator.Required()]},b={prevalidate:!0};this.$aboutCounter=$(".aboutCounter"),this.$(".aboutText").keyup(),this.$form=this.$("form"),this.form=new P.Form(this.$form,a,b),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(a){a.errors[0]||this.save()},onAboutTextKeyup:function(a){var b=a.target.value.replace(/\{.*\}/g,"").length,c=P.CONST.MAX_CHARS_FOR_USER_DESCRIPTION,d=c-b;this.$aboutCounter.text(d)},save:function(){var a=this,b=this.$form.serializeArray(),c={};_.each(b,function(a){c[a.name]="on"===a.value?!0:a.value});var d=this.getChildById("submitButton"),e=P.resourceFactory.create("PartnerResource",c),f=function(b){b&&!b.resource_response.error&&a.navigate("/business/getstarted/")};d.showLoading(),e.callUpdate({success:f,complete:function(){d.hideLoading()}})}}),goog.provide("P.modules.BusinessAccountCreate"),goog.require("P.Module"),P.modules.BusinessAccountCreate=P.Module.extend({onContentReady:function(){if(P.currentUser.isAuthenticated()){var a="/business/convert/";return P.currentUser.attributes.is_partner&&(a="/business/getstarted/"),void this.navigate(a)}}}),goog.provide("P.modules.BusinessGetStartedCards"),goog.require("P.Module"),P.modules.BusinessGetStartedCards=P.Module.extend({events:{"click .dismiss":"onDismissClick"},onDismissClick:function(a){var b=$(a.target),c=b.parents(".getStartedCard"),d=c.data("card-name"),e=P.resourceFactory.create("PartnerCardResource",{card_name:d});e.callDelete(),c.remove()}}),goog.provide("P.modules.BusinessGetStartedHeader"),goog.require("P.Module"),P.modules.BusinessGetStartedHeader=P.Module.extend({}),goog.provide("P.modules.Button"),goog.require("P.modules.ButtonBase"),P.modules.Button=P.modules.ButtonBase.extend({showLoading:function(){this.disable(),this.options.borderless||P.Module.prototype.showLoading.call(this)},hideLoading:function(){this.enable(),this.options.borderless||P.Module.prototype.hideLoading.call(this)},moduleRenderer:new P.ModuleRendererLocal("app/desktop/modules/Button/Button.nunjucks"),getLoggingObjectIdStr:function(){return this.parent?this.parent.getLoggingObjectIdStr():null}}),goog.provide("P.modules.CategoriesMenu"),goog.require("P.Module");var CLASS_SELECTED="selected";P.modules.CategoriesMenu=P.Module.extend({getItemByCategory:function(a){return this.$("a[data-category="+a+"]")},mixins:[P.Mixins.PreventScroll],onCategoryUpdated:function(a,b,c){if(this.$("a").removeClass(CLASS_SELECTED),c){var d=this.getItemByCategory(c);d.length?(d.addClass(CLASS_SELECTED),this.waitingMessage=null):this.waitingMessage=c}},onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_CURRENT_CATEGORY]=this.onCategoryUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,a),this.waitingMessage&&this.getItemByCategory(this.waitingMessage).addClass(CLASS_SELECTED)},getHeight:function(){var a=this.$(".categoriesWrapper").children(),b=0;_.each(a,function(a){var c=$(a).outerHeight();c>b&&(b=c)});var c=this.getChildByModuleName("AboutLinks");return c&&(b+=c.getHeight()),b}}),goog.provide("P.modules.CategoriesPage"),goog.require("P.Module"),P.modules.CategoriesPage=P.Module.extend({}),goog.provide("P.modules.Category"),goog.require("P.Module"),P.modules.Category=P.Module.extend({onContentReady:function(){this.listen(this,P.CONST.EVENT_NAVIGATE,this.onNavigate)},onNavigate:function(a){if(a.target===this){var b=this.triggerEvent("showAll",{title:this.data.name,category:this.data.key,resource:P.resourceFactory.create("BoardRecommendationsByCategoryFeedResource",{category:this.data.key})},!0);b||a.stopPropagation()}}}),goog.provide("P.modules.CitySearcher"),goog.require("P.Module"),P.modules.CitySearcher=P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_TYPEAHEAD_SEARCH_START,this.onTypeaheadSearchStart),this.listen(this,P.CONST.EVENT_DROPDOWN_CONTAINER_SHOWN,this.onDropdownShow),this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onItemSelected),this.childListen(P.CONST.EVENT_ITEM_HIGHLIGHTED,this.onItemHighlighted),this.childListen(P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onTypeaheadResultsReturned),this.childListen(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onTypeaheadNoResultsReturned),this.getLocationField().setResourceOptionForTypeahead("show_current_map",!0),this.getLocationField().setResourceOptionForTypeahead(P.CONST.SHOW_SEARCH_AROUND_WORLD,!0)},addLoader:function(){this._setLoader(!0)},removeLoader:function(){this._setLoader(!1)},_setLoader:function(a){a?this.getLocationField().showLoading():this.getLocationField().hideLoading()},getLocationField:function(){return this.getChildById("locationField")},onItemHighlighted:function(a){a.stopPropagation()},resetField:function(){var a=this.getLocationField();a.reset()},onDropdownShow:function(){var a=this;a.$(".field").focus()},onTypeaheadSearchStart:function(a){a.stopPropagation(),this.addLoader()},onTypeaheadResultsReturned:function(a){a.stopPropagation(),this.removeLoader()},onTypeaheadNoResultsReturned:function(){this.removeLoader()},onItemSelected:function(a){a.stopPropagation();var b=a.data.item;this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE_NOT_PROPAGATE,null,!0),this.triggerEvent(P.CONST.EVENT_CITY_SELECTED,b,!0),this.resetField()}}),goog.provide("P.modules.Close"),goog.require("P.Module"),P.modules.Close=P.Module.extend({onContentReady:function(){window.close()}}),goog.provide("P.modules.CloseupBottom"),goog.require("P.Module");var MODULE_ID_RELATED_PINS="relatedPins",MODULE_ID_RELATED_BOARDS="relatedBoards";P.modules.CloseupBottom=P.Module.extend({onChildRendered:function(a){var b,c,d=a.id===MODULE_ID_RELATED_PINS,e=a.id===MODULE_ID_RELATED_BOARDS;if(d&&(b=a.getChildByModuleName("Grid"),c=this.$(".relatedPinsWrapper")),e&&(b=a.getChildByModuleName("PagedGrid"),c=this.$(".relatedBoardsWrapper")),b&&c.length){var f=b.hasItems(),g=f?"visible":"hidden";c.css("visibility",g)}},setMinHeight:function(a){this.$el.css("min-height",null!==a?a:"")}}),goog.provide("P.modules.CloseupContent"),goog.require("P.Module"),P.modules.CloseupContent=P.Module.extend({getPin:function(){return this.getChildById("pin")},showEditModal:function(){var a=this.getPin();return a.showEditModal()},onContentReady:function(){if(this.data.id){var a={};a[P.CONST.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,this.pubsubSubscribe(this.data.id,a)}},onPinDeleted:function(){this.destroy()}}),goog.provide("P.modules.CloseupRelatedBoards"),goog.require("P.Module"),P.modules.CloseupRelatedBoards=P.Module.extend({onContentReady:function(){this.destroyIfEmpty()},isEmpty:function(){if(!this.contentReady)return!1;var a=this.getChildById("relatedBoardsFeed");return!a||!a.hasItems()}}),goog.provide("P.modules.CloseupRelatedPins"),goog.require("P.Module"),P.modules.CloseupRelatedPins=P.Module.extend({onContentReady:function(){this.destroyIfEmpty(),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onTypeClick)},isEmpty:function(){if(!this.contentReady)return!1;var a=this.getChildById("relatedPinsFeed");return!a||!a.hasItems()},getGrid:function(){return this.getChildById("relatedPinsFeed")},hideGrid:function(){this.getGrid().hide()},showGrid:function(){this.getGrid().show()},onTypeClick:function(a){var b=a.target;if(!b.isActive()){_.each(this.getChildrenByModuleName("Button"),function(a){a.setStyles({active:a===b})}),b.showLoading();var c=_.bindFn(b.hideLoading,b);b.options.annotation?this.showAnnotatedPins(b.options.annotation,c):this.showRelatedPins(c)}},showRelatedPins:function(a){this.updateRelatedPinsGrid(P.resourceFactory.create("RelatedPinFeedResource",{pin:this.options.pin_id}),a)},showAnnotatedPins:function(a,b){this.updateRelatedPinsGrid(P.resourceFactory.create("InterestsFeedResource",{interest:a}),b)},updateRelatedPinsGrid:function(a,b){var c=this.getGrid(),d=this;this.$el.css("height",this.$el.height()),c.emptyItems(),c.setItemsResource(a);var e=function(){(b||P.NOOP)(),d.$el.css("height","auto")};c.renderItems(e,e)}}),goog.provide("P.modules.CloseupRichPinContent"),goog.require("P.Module"),goog.require("P.modules.CloseupRichPinContentBase"),P.modules.CloseupRichPinContent=P.modules.CloseupRichPinContentBase.extend({}),goog.provide("P.modules.Consumer"),goog.require("P.Module"),P.modules.Consumer=P.Module.extend({events:{"click .consumerSecretText":"consumerSecretTextClicked"},consumerSecretTextClicked:function(){this.showConfirmation(this.extraData["secret-key"])},showConfirmation:function(a){var b=this,c={name:"ConfirmDialog",options:{template:"api_secret",apiSecret:a}};P.loadModule(c,function(a){b.showInModal(a)})}}),goog.provide("P.modules.ConsumerManagePage"),goog.require("P.Module"),P.modules.ConsumerManagePage=P.Module.extend({onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_CONSUMER_LIST_UPDATED]=this.onListUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a)},showNewDialog:function(){var a=this;P.loadModule({name:"ConsumerNewDialog"},function(b){a.showInModal(b,{})})},onListUpdated:function(){this.render()}}),goog.provide("P.modules.ConsumerNewDialog"),goog.require("P.Module"),P.modules.ConsumerNewDialog=P.Module.extend({onContentReady:function(){var a={name:[P.Validator.Required()],description:[P.Validator.Required()]};this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),a),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(a){a.errors[0]||this.createConsumer()},getFormData:function(){var a=this.$("form").serializeArray(),b={};return _.each(a,function(a){b[a.name]=a.value}),b},getSaveResource:function(a){return P.resourceFactory.create("ConsumerResource",a)},createConsumer:function(){var a=this.getFormData(),b=this.getChildById("submitButton"),c=this;b.showLoading();var d=this.getSaveResource(a);d.callCreate({success:function(a){var d;b.hideLoading(),a.resource_response.error?a.resource_response.message&&(d={message:a.resource_response.message}):(P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_CONSUMER_LIST_UPDATED),c.destroy())},error:function(a){P.showError(a.message)},complete:function(){b.hideLoading()}})}}),goog.provide("P.modules.Conversation"),goog.require("P.Module"),goog.require("P.modules.Button"),P.modules.Conversation=P.Module.extend({mixins:[P.Mixins.PreventScroll],onCreated:function(){this.onConversationScroll=_.bindFn(this.onConversationScroll,this),this.onConversationScrollWithThrottle=_.throttle(this.onConversationScroll,200)},onContentReady:function(){this.scrollableElement=this.$(".conversationContent"),this.scrollListener=this.listen(this.scrollableElement,"scroll",this.onConversationScrollWithThrottle);var a=this.$(".conversationItems");this.startPreventScroll(this.scrollableElement,a),P.scrollToTop({$scroller:this.scrollableElement,duration:0,newScrollOffset:a.height()});var b=this;this.listen(P.Updater.instance(),"has_new_conversation_message",function(a){a&&b.render()}),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onSendButtonClicked)},onAddedToDom:function(){P.Updater.instance().setConversationId(this.resource.options.conversation_id)},onRemovedFromDom:function(){P.Updater.instance().setConversationId(null)},onConversationScroll:function(){return!1},onSendButtonClicked:function(a){var b=this,c=a.target,d="sendMessageButton"===c.id;if(d){var e=this.$(".message"),f=$.trim(e.val());if(f.length){c&&c.showLoading();var g=P.resourceFactory.create("ConversationResource",{conversation_id:this.resource.options.conversation_id,text:f});g.callCreate({success:function(){b.render()},complete:function(){c.hideLoading()}})}}}}),goog.provide("P.modules.ConversationMessage"),goog.require("P.Module"),P.modules.ConversationMessage=P.Module.extend({}),goog.provide("P.modules.CookieRecFeedHomePage"),goog.require("P.Module"),P.modules.CookieRecFeedHomePage=P.Module.extend({}),goog.provide("P.modules.CsrfErrorPage"),goog.require("P.Module"),P.modules.CsrfErrorPage=P.Module.extend({}),goog.provide("P.modules.DatePicker"),goog.require("P.Module"),P.modules.DatePicker=P.Module.extend({onContentReady:function(){this.minDate=new Date(2012,10,1),this.maxDate=this.getYesterday(),this.setupPicker(),this.setupQuickSelect()},setupQuickSelect:function(){var a={yesterday:this.onYesterdayClick,lastWeek:this.onWeekClick,lastTwoWeeks:this.onTwoWeekClick,lastMonth:this.onMonthClick},b=this;_.each(a,function(a,c){var d=b.getChildById(c);d&&b.listen(d,P.CONST.EVENT_BUTTON_CLICK,a)})},updateUsingQuickSelect:function(a){"single"===this.options.selection_mode&&2===a.length&&(a=a[0]);var b=this.$(".pickerContainer");b.DatePickerSetDate(a,!0);var c=b.DatePickerGetDate(!0),d=b.DatePickerGetDate(!1);this.onChange(c,d)},onYesterdayClick:function(){this.updateUsingQuickSelect(this.getYesterday())},onWeekClick:function(){var a=this.getYesterday(),b=this.getDaysAgo(7),c=[b,a];this.updateUsingQuickSelect(c)},onTwoWeekClick:function(){var a=this.getYesterday(),b=this.getDaysAgo(14),c=[b,a];this.updateUsingQuickSelect(c)},onMonthClick:function(){var a=this.getYesterday(),b=this.getDaysAgo(28),c=[b,a];this.updateUsingQuickSelect(c)},getDaysAgo:function(a){var b=new Date;return b.setDate(b.getDate()-a),b},getYesterday:function(){return this.getDaysAgo(1)},setupPicker:function(){var a=this;this.$(".pickerContainer").DatePicker({flat:!0,date:this.options.selected_date||this.getYesterday(),calendars:1,mode:this.options.selection_mode||"range",starts:1,onChange:function(b,c){return a.onChange(b,c)},onRender:function(b){return a.onDateRender(b)}})},onDateRender:function(a){return{disabled:a.valueOf()>this.maxDate.valueOf()||a.valueOf()<this.minDate.valueOf()}},onChange:function(a,b){var c={formatted:a,dates:b};this.triggerEvent("datePickerDateSelected",c,!0),a.length>1&&a[0]!==a[1]&&this.triggerEvent("datePickerRangeSelected",c,!0)},hidePicker:function(){this.parent.hide()}}),goog.provide("P.modules.Developer"),goog.require("P.Module"),P.modules.Developer=P.Module.extend({}),goog.provide("P.modules.Domain"),goog.require("P.Module"),P.modules.Domain=P.Module.extend({getLoggingObjectIdStr:function(){return this.data.id}}),goog.provide("P.modules.DomainAnalyticsPage"),goog.require("P.Module"),P.modules.DomainAnalyticsPage=P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_DATEPICKER_DATE_SELECTED,this.onDateChanged),this.checkValidData()},checkValidData:function(){var a=!1;$.each(this.data,function(b,c){(c.PIN_REPIN||c.PIN_VIEW)&&(a=!0)}),a||(this.$(".noData").show(),this.$(".metricsContainer").hide())
},onDateChanged:function(a){var b=a.data.formatted[0],c=a.data.formatted[1];if(b!==c){this.showLoading(!0),a.target.parent.hide();var d=window.location.pathname,e=$.param({start_date:b,end_date:c}),f=d+"?"+e;this.navigate(f)}}}),goog.provide("P.modules.DomainBoardRecommendationsPage"),goog.require("P.Module"),P.modules.DomainBoardRecommendationsPage=P.Module.extend({}),goog.provide("P.modules.DomainFeedPage"),goog.require("P.Module"),P.modules.DomainFeedPage=P.Module.extend({}),goog.provide("P.modules.DomainFeedPageContainer"),goog.require("P.Module"),P.modules.DomainFeedPageContainer=P.Module.extend({onContentReady:function(){this.checkGridContent(),this.childListen(P.CONST.EVENT_DATEPICKER_DATE_SELECTED,this.onDateChanged)},checkGridContent:function(){var a=this.getChildById("feedGrid");a.hasItems()||this.$(".noData").show()},changeDate:function(a){var b=(a.endDate-a.startDate)/6e8,c={end_date:a.formattedEndDate};b>=2?c.aggregation="biweekly":b>=1&&(c.aggregation="weekly");var d=window.location.pathname,e=$.param(c),f=d+"?"+e;this.navigate(f)},onDateChanged:function(a){this.showLoading(!0),a.target.hidePicker();var b=a.data.dates[0],c=a.data.dates[1],d=a.data.formatted[1];this.changeDate({startDate:b,endDate:c,formattedEndDate:d})}}),goog.provide("P.modules.DomainInfoBar"),goog.require("P.Module"),P.modules.DomainInfoBar=P.Module.extend({}),goog.provide("P.modules.DomainOwnerInfoBar"),goog.require("P.Module"),P.modules.DomainOwnerInfoBar=P.Module.extend({events:{"click .export":"exportClicked"},exportMetricsUrl:function(){return this._buildUrl("",{end_date:this.options.end_date,start_date:this.options.start_date})},exportMostRepinnedUrl:function(){return this._buildUrl("top/repins/",{end_date:this.options.end_date})},exportMostClickedUrl:function(){return this._buildUrl("top/clicks/",{end_date:this.options.end_date})},exportMostRecentUrl:function(){return this._buildUrl("recent/",{})},_buildUrl:function(a,b){this.options.aggregation&&(b.aggregation=this.options.aggregation);var c=$.param(b),d="/analytics/"+this.options.domain+"/export/",e=d+a,f=e+"?"+c;return f},exportClicked:function(){var a=this.urlExportMap[this.options.feed_item_type];a||(a=this.exportMetricsUrl),this.downloadFile(a.apply(this))},downloadFile:function(a){var b="downloaderIFrame",c=document.getElementById(b);null===c&&(c=document.createElement("iframe"),c.id=b,c.style.display="none",document.body.appendChild(c)),c.src=a},onCreated:function(){this.urlExportMap={most_recent:this.exportMostRecentUrl,most_repinned:this.exportMostRepinnedUrl,most_clicked:this.exportMostClickedUrl}}}),goog.provide("P.modules.DomainVerify"),goog.require("P.Module"),P.modules.DomainVerify=P.Module.extend({events:{"click .helpText a":"onClickType"},onCreated:function(){this.METATAG="metatag",this.FILENAME="filename",this.verificationType=this.FILENAME},onContentReady:function(){this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),[]),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.downloadButton=this.getChildById("downloadButton"),this.downloadButton&&this.listen(this.downloadButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickDownload)},onSubmitValidated:function(a){a.errors[0]||this.verifyDomain()},swapVerificationType:function(){this.$(".filename, .metaTag").toggle(),this.verificationType=this.verificationType===this.METATAG?this.FILENAME:this.METATAG},onClickType:function(){this.swapVerificationType()},showError:function(a){this.$(".errorReason").text(a),this.$(".errorSection").show()},hideError:function(){this.$(".errorSection").hide()},waitForVerification:function(a,b){b=b||3;var c=0,d=P.resourceFactory.create("TaskStatusResource",{task_id:a}),e=this,f=function(){c>=b||d.callGet({success:function(a){var b=a.resource_response;b.error||("running"===b.data.status?P.setTimeout(f,200):"failure"===b.data.data.status?e.showError(b.data.data.message):e.isInModal()?(P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_USER_UPDATED),P.pubsub.publish(P.currentUser.attributes.id,P.CONST.PUBSUB_TOPIC_USER_UPDATED),e.destroy()):this.navigate("/"))},error:function(){P.showError("Trouble verifying your domain. Please try again later.")}})};P.setTimeout(f,200)},verifyDomain:function(){var a=this.getChildById("submitButton");a.showLoading(),this.hideError();var b=this,c={type:this.verificationType,domain:this.options.domain},d=P.resourceFactory.create("DomainVerifyResource",c);d.callUpdate({success:function(c){var d;a.hideLoading(),c.resource_response.error?c.resource_response.message&&(d={message:c.resource_response.message}):b.waitForVerification(c.resource_response.data.task_id)},error:function(a){P.showError(a.message)},complete:function(){a.hideLoading()}})},downloadFile:function(a){var b="downloaderIFrame",c=document.getElementById(b);null===c&&(c=document.createElement("iframe"),c.id=b,c.style.display="none",document.body.appendChild(c)),c.src=a},onClickDownload:function(){this.downloadFile("/website/verify/download/")}}),goog.provide("P.modules.EmailContact"),goog.require("P.Module"),P.modules.EmailContact=P.Module.extend({events:{"click .check":"_onClickCheck",click:"_onClick"},_onClickCheck:function(a){a.stopPropagation()},_onClick:function(){this.getChildById("check").setChecked(!this.isChecked(),!0)},setChecked:function(a){this.getChildById("check").setChecked(a,!1)},isChecked:function(){return this.getChildById("check").isChecked()},getEmail:function(){return this.options.email_contact.id}}),goog.provide("P.modules.EmbedPinner"),goog.require("P.Module"),P.modules.EmbedPinner=P.Module.extend({onContentReady:function(){$("head").append($("<script></script>").attr({async:!0,src:"//assets.pinterest.com/js/pinit.js"}));var a=this.$(".sampleCode textarea");a.focus(),a.select()}}),goog.provide("P.modules.Explore"),goog.require("P.Module");var GRID_GUTTER=P.CONST.PIN_MARGIN,GRID_SIZE=136,MINIMUM_NUM_COLUMNS=2*P.CONST.MIN_COLUMNS;P.modules.Explore=P.Module.extend({onAddedToDom:function(){this._setContentWidth(),this.resizeListener=this.listen(P.Viewport,P.CONST.EVENT_RESIZE,this.onResize)},onContentReady:function(){this.sections=[];var a=this.getChildById("exploreInterests");a&&this.sections.push(a);var b=this.getChildById("exploreRelatedInterests");b&&this.sections.push(b);var c=this.getChildById("exploreCategories");c&&this.sections.push(c),this._setContentWidth()},onResize:function(){this._setContentWidth()},_calculateNumColumns:function(){var a=this.getWidth(!1),b=GRID_SIZE+GRID_GUTTER,c=Math.floor(a/b);return c=Math.max(MINIMUM_NUM_COLUMNS,c),c%2!==0&&c--,c},_setContentWidth:function(){var a=this._calculateNumColumns(),b=a*(GRID_SIZE+GRID_GUTTER);_.each(this.sections,function(a){a.setContentWidth(b)})}}),goog.provide("P.modules.ExploreCategories"),goog.require("P.Module"),P.modules.ExploreCategories=P.Module.extend({setContentWidth:function(a){this.$(".content").css("width",a);var b=this.getChildById("categoriesGrid");b.onResize()}}),goog.provide("P.modules.ExploreInterests"),goog.require("P.Module"),P.modules.ExploreInterests=P.Module.extend({setContentWidth:function(a){this.$(".content").css("width",a);var b=this.getChildById("interestsGrid");b.onResize()}}),goog.provide("P.modules.ExploreRelatedInterest"),goog.require("P.Module"),P.modules.ExploreRelatedInterest=P.Module.extend({setContentWidth:function(a){this.$(".content").css("width",a);var b=this.getChildById("relatedInterestsGrid");b.onResize()}}),goog.provide("P.modules.ExploreRelatedInterests"),goog.require("P.Module"),P.modules.ExploreRelatedInterests=P.Module.extend({setContentWidth:function(a){this.$(".content").css("width",a),_.each(this.getChildrenByModuleName("ExploreRelatedInterest"),function(b){b.setContentWidth(a/2)})}}),goog.provide("P.modules.FacebookConnectButton"),goog.require("P.Module"),goog.require("P.modules.ButtonBase"),P.modules.FacebookConnectButton=P.modules.Button.extend({onContentReady:function(){this.listen(this,P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(a){a.stopPropagation();var b=P.SocialConnect.instance(),c=this;P.trackRegisterAction("register_facebook_attempt"),this.showLoading(),b.connect("facebook",{success:function(a){c.hideLoading(),c.login({facebook_id:a.id,facebook_token:a.access_token})}})},login:function(a){var b=this,c=function(){b.onLoginSuccess(a)},d=function(){b.onLoginError(a)};P.currentUser.login(a,c,d)},onLoginSuccess:function(a){this.triggerEvent(P.CONST.FACEBOOK_LOGIN_SUCCESS,a,!0)&&window.location.reload()},onLoginError:function(a){this.triggerEvent(P.CONST.FACEBOOK_LOGIN_FAILURE,a,!0)}}),goog.provide("P.modules.FacebookShareButton"),goog.require("P.Module"),goog.require("P.modules.Button"),P.modules.FacebookShareButton=P.modules.Button.extend({onClick:function(){var a=this.options.ga_category||"share_facebook";P.trackGAEvent(a,P.CONST.GA_ACTION_CLICK);var b=this.options.dialog_options||{},c=this;return b.callback=function(){var a=P.ContextEvent.fromEventType(P.ContextLogging.EventType.PIN_SHARE_FACEBOOK);c.options&&c.options.object_id&&a.setObjectIdStr(c.options.object_id),P.ContextLogger.getInstance().addEvent(a)},P.FacebookDialog.open(b),this.triggerEvent(P.CONST.EVENT_BUTTON_CLICK,null,!0),!1},moduleRenderer:new P.ModuleRendererLocal("app/desktop/modules/FacebookShareButton/FacebookShareButton.nunjucks")}),goog.provide("P.modules.FastFollowHeader"),goog.require("P.Module");var FAST_FOLLOW_PROGRESS_ID="followPageProgress";P.modules.FastFollowHeader=P.Module.extend({stepProgress:function(a){var b=this.getChildById(FAST_FOLLOW_PROGRESS_ID);b&&b.moveStep(a)}}),goog.provide("P.modules.FastFollowSidebar"),goog.require("P.Module");var FAST_FOLLOW_SIDEBAR_SELECTED_CLASS="selected";P.modules.FastFollowSidebar=P.Module.extend({events:{"click .followPageSidebarCategory":"onCategoryClick"},onCreated:function(){var a={};a[P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,a),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.toggleShowMoreCategories)},onContentReady:function(){Modernizr.touch||this.$(".followPageSidebarCategory").addClass("noTouch")},onCategoryClick:function(a){var b=$(a.currentTarget);if(b.length){var c=b.attr("data-category");c.length&&(this.highlightCategory(c),this.triggerEvent(P.CONST.EVENT_FAST_FOLLOW_CATEGORY_SELECTED,c,!0))}},onSearchQueryUpdated:function(a,b,c){var d=c||"";this.unhighlightCategory(),this.triggerEvent(P.CONST.EVENT_FAST_FOLLOW_SEARCH_QUERY_UPDATED,d,!0)},unhighlightCategory:function(){this.$("."+FAST_FOLLOW_SIDEBAR_SELECTED_CLASS).removeClass(FAST_FOLLOW_SIDEBAR_SELECTED_CLASS)},highlightCategory:function(a){this.unhighlightCategory(),this.$("[data-category="+a+"]").addClass(FAST_FOLLOW_SIDEBAR_SELECTED_CLASS)},toggleShowMoreCategories:function(){return this.$el.toggleClass("expand"),!1}}),goog.provide("P.modules.FeedPage"),goog.require("P.Module"),P.modules.FeedPage=P.Module.extend({onAddedToDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_CURRENT_CATEGORY,this.options.feed)},_resetCategory:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_CURRENT_CATEGORY,null)},onRemoved:function(){this._resetCategory()},onEmpty:function(){this._resetCategory()}}),goog.provide("P.modules.FeedUsers"),goog.require("P.Module"),P.modules.FeedUsers=P.Module.extend({onContentReady:function(){this.destroyIfEmpty()}}),goog.provide("P.modules.FillHomeFeed"),goog.require("P.Module"),P.modules.FillHomeFeed=P.Module.extend({}),goog.provide("P.modules.FindFriendsInfoBar"),goog.require("P.Module"),P.modules.FindFriendsInfoBar=P.Module.extend({onContentReady:function(){"invite"===this.options.focus&&this.getChildById("inviteFriends").getDropdown().show()}}),goog.provide("P.modules.FindFriendsPage"),goog.require("P.Module"),P.modules.FindFriendsPage=P.Module.extend({}),goog.provide("P.modules.FindFriendsRep"),goog.require("P.Module"),P.modules.FindFriendsRep=P.Module.extend({}),goog.provide("P.modules.FlagComment"),goog.require("P.Module"),P.modules.FlagComment=P.Module.extend({onContentReady:function(){var a=this.$("form"),b={reason:[P.Validator.Required()]},c={prevalidate:!0};this.form=new P.Form(a,b,c),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(a){a.errors[0]||this.flagComment()},flagComment:function(){var a=this,b=this.getChildById("submitButton");b.showLoading();var c={pin_id:this.options.pin_id,comment_id:this.options.comment_id,reason:this.$("form :checked").attr("value")};"other"===c.reason&&(c.explanation=this.$("textarea").val()),P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_CLICK_SUBMIT,"reason",c.reason);var d=P.resourceFactory.create("CommentFlagResource",c);d.callCreate({success:function(){P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_SUCCESS),a.destroy()},error:function(a){P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_ERROR),P.showError(a.message)},complete:function(){b.hideLoading()}})}}),goog.provide("P.modules.FlagCommentReasons"),goog.require("P.Module"),P.modules.FlagCommentReasons=P.Module.extend({}),goog.provide("P.modules.FlagContent"),goog.require("P.Module");var FLAG_CONTENT_HIDDEN_CLASS="hidden",FLAG_CONTENT_ACTIVE_CLASS="active",OTHER_STRING="other";P.modules.FlagContent=P.Module.extend({events:{"change input":"onChange"},onCreated:function(){this.listen(this,"change",this.checkIfOtherIsSelected)},onChange:function(a){var b=this,c=this.options,d=$(a.target),e=d.siblings("label");if(this._reason=d.attr("id"),this._reasonNoun=e.text(),this.checkIfOtherIsSelected(),this.triggerEvent("change",this,!0),"blockInput"===c.class_name&&this.updateLabel(d),c.reason=this._reason,c.reason_noun=this._reasonNoun,this.options.show_confirmation_on_change){var f={name:"FlagContentConfirm",options:c};P.loadModule(f,function(a){var d;"user"===c.object_flagged?d="user_flag":"pin"===c.object_flagged?d="pin_flag":"comment"===c.object_flagged&&(d="comment_flag"),d&&P.trackGAEvent(d,P.CONST.GA_ACTION_OPEN_MODAL,"reason",b._reason),b.hideLoading(),b.showInModal(a)})}},updateLabel:function(a){var b=$(a),c=b.siblings("label");this.$("."+FLAG_CONTENT_ACTIVE_CLASS).removeClass(FLAG_CONTENT_ACTIVE_CLASS),c.addClass(FLAG_CONTENT_ACTIVE_CLASS)},showOtherFieldIfNeed:function(){this.options.hide_other_field||this.$(".explanation").toggleClass(FLAG_CONTENT_HIDDEN_CLASS,!this.options.show_explanation)},checkIfOtherIsSelected:function(){this.options.show_explanation=this._reason===OTHER_STRING?!0:!1,this.showOtherFieldIfNeed()}}),goog.provide("P.modules.FlagContentConfirm"),goog.require("P.Module");var GA_CATEGORY="user_flag";P.modules.FlagContentConfirm=P.Module.extend({onContentReady:function(){var a=this.$("form"),b={};this.options.show_explanation&&(b={explanation:[P.Validator.Required(),P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_TITLE})]});var c={prevalidate:!0};this.form=new P.Form(a,b,c),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(a){var b=a.target;b&&("cancelButton"===b.id?P.trackGAEvent(GA_CATEGORY,P.CONST.GA_ACTION_CLICK_CANCEL):"reportButton"===b.id&&P.trackGAEvent(GA_CATEGORY,P.CONST.GA_ACTION_CLICK_SUBMIT))},onSubmitValidated:function(a){a.errors[0]||this.reportUser()},onReportUserSuccess:function(){var a=this,b={name:"ConfirmDialog",options:{template:"flag_user_success"}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.onFlagConfirm)})},onFlagConfirm:function(){this.destroy()},reportUser:function(){var a=this,b=this.options.user_id,c={reported_user:b,reason:this.options.reason};this.options.show_explanation&&(c.explanation=this.$("textarea").val());var d=P.resourceFactory.create("UserReportResource",c);d.callCreate({success:function(){P.trackGAEvent(GA_CATEGORY,P.CONST.GA_ACTION_SUCCESS),a.onReportUserSuccess()},error:function(a){P.showError(a.message),P.trackGAEvent(GA_CATEGORY,P.CONST.GA_ACTION_ERROR)},complete:function(){P.getModalManager().removeAllModals(),a.destroy()}})}}),goog.provide("P.modules.FlagPin"),goog.require("P.Module");var FLAG_PIN_GA_CATEGORY="pin_flag";P.modules.FlagPin=P.Module.extend({onContentReady:function(){var a=this.$("form"),b={reason:[P.Validator.Required()]},c={prevalidate:!0};this.form=new P.Form(a,b,c),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(a){a.errors[0]||this.flagPin()},flagPin:function(){var a=this,b=this.getChildById("submitButton");b.showLoading();var c="Unlabeled",d=null,e=null,f=P.app.backgroundModule,g=0,h="BoardPage";f&&(c=f.className,"SearchPage"===c?(d=f.options.scope,e=f.options.query):c===h?(d=f.options.tab,g=f.getNumPinsFlagged()):"FeedPage"===c?d=f.options.feed:"DomainFeedPage"===c&&(d=f.options.feed_item_type,e=f.options.domain));var i={pin_id:this.options.pin_id,reason:this.$("form :checked").attr("value"),source:c,sourceDetail1:d,sourceDetail2:e};"other"===i.reason&&(i.explanation=this.$("textarea").val());var j=3,k="flag_pin";g>=j&&(k="power_reporter_thanks");var l={name:"ConfirmDialog",options:{template:k}};P.trackGAEvent(FLAG_PIN_GA_CATEGORY,P.CONST.GA_ACTION_CLICK_SUBMIT,"reason",i.reason);var m=P.resourceFactory.create("PinFlagResource",i);m.callCreate({success:function(){P.trackGAEvent(FLAG_PIN_GA_CATEGORY,P.CONST.GA_ACTION_SUCCESS),P.loadModule(l,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.destroy)}),c===h&&P.pubsub.publish(a.options.board_id,P.CONST.PUBSUB_TOPIC_PIN_FLAGGED,{})},error:function(a){P.trackGAEvent(FLAG_PIN_GA_CATEGORY,P.CONST.GA_ACTION_ERROR),P.showError(a.message)},complete:function(){b.hideLoading()}})}}),goog.provide("P.modules.FlagUser"),goog.require("P.Module"),P.modules.FlagUser=P.Module.extend({}),goog.provide("P.modules.FlagUserPinReasons"),goog.require("P.Module"),P.modules.FlagUserPinReasons=P.Module.extend({}),goog.provide("P.modules.FollowButtonBase"),goog.require("P.modules.Button");var UNFOLLOW_CLASS="dim",FOLLOW_CLASS="primary";P.modules.FollowButtonBase=P.modules.Button.extend({getResourceId:function(){return null},getFollowResource:function(){return null},getFollowClass:function(){return FOLLOW_CLASS},getUnfollowClass:function(){return UNFOLLOW_CLASS},toggleState:function(){this.setState(!this.options.followed),this.trigger("toggleFollow"),this.getResourceId()&&P.pubsub.publish(this.getResourceId(),this.options.followed?P.CONST.PUBSUB_TOPIC_USER_FOLLOW:P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW,!0)},setState:function(a){this.$el.addClass(a?this.getUnfollowClass():this.getFollowClass()),this.$el.removeClass(a?this.getFollowClass():this.getUnfollowClass()),this.$el.text(this.options[a?"unfollow_text":"follow_text"]),this.options.followed=a},toggleFollow:function(){var a=this.getFollowResource(),b=this.options.followed?"delete":"create";if(!a)return void this.log.error("No resource returned in `getFollowResource()`");this.showLoading();var c=this.options.followed?this.options.unfollow_ga_category:this.options.follow_ga_category,d=this;a.call(b,{success:function(){c&&P.trackGAEvent(c,P.CONST.GA_ACTION_SUCCESS),d.toggleState()},error:function(a){P.showError(a.message),c&&P.trackGAEvent(c,P.CONST.GA_ACTION_ERROR)},complete:function(){d.hideLoading()}})},onClick:function(){if(this.ensureAuthentication()&&!this.options.is_me){var a=this.options.followed?this.options.unfollow_ga_category:this.options.follow_ga_category;return a&&P.trackGAEvent(a,P.CONST.GA_ACTION_CLICK),this.toggleFollow(),!1}},getAuthRedirectUrl:function(){return P.getRegisterUrl({action:"follow"})}}),goog.provide("P.modules.FramedSignup"),goog.require("P.Module"),P.modules.FramedSignup=P.Module.extend({postMessageEvents:{navigate:"onFrameNavigate",userRegister:"onFrameUserRegister",userLogin:"onFramedUserLogin",finishRegistration:"onFinishRegistration"},onContentReady:function(){this.$iframe=$("<iframe/>"),this.$iframe.attr({src:this.options.url+"?"+this.getIframeQueryString(),frameborder:"0",scrolling:"no"}),this.$el.append(this.$iframe),this.showLoading(!0),this.listen($(window),"message",this.onPostMessage),this.listen(this.$iframe,"load",this.onIframeLoaded)},getIframeQueryString:function(){var a=_.extend({},this.options);return $.param(a)},getIframeWindow:function(){return this.$iframe[0].contentWindow},onPostMessage:function(a){if(a.originalEvent.origin.split("://")[1]!==this.options.domain)return void this.log.warn("Received a message from a different origin.",a.originalEvent.origin);if(a.originalEvent.source!==this.getIframeWindow())return void this.log.warn("Ignoring data from different source.");var b=JSON.parse(a.originalEvent.data);if(!b)return void this.log.error("Inavlid post message data.");var c=this.postMessageEvents[b.event];return c&&this[c]?void this[c](b):void this.log.warn("No handler function for event type: '"+b.event+"'")},onFrameNavigate:function(a){P.changeWindowLocation(a.url,!0)},onFrameUserRegister:function(){this.options.skip_nux&&Cookie.set(P.CONST.COOKIE_SKIP_NUX,"1"),this.log.debug("User registered!"),this.onFramedUserLogin()},onFramedUserLogin:function(){window.location.reload()},onFinishRegistration:function(){P.navigate("/join/register/facebook/")},onIframeLoaded:function(){this.hideLoading()}}),goog.provide("P.modules.GroupBoardEmailSettings"),goog.require("P.Module"),P.modules.GroupBoardEmailSettings=P.Module.extend({onCreated:function(){this.childListen("change",this.onChildChange)},onSubmitValidated:function(){return this.save(),!1},save:function(){var a=this,b={},c=[];this.$form.find("input[name=collab_board_email]:checked").each(function(){c.push(this.value)}),b.email_collaborative_board_ids=c;var d=this.getChildById("submitButton"),e=P.resourceFactory.create("UserSettingsResource",b),f=function(a){a&&!a.resource_response.error};d.showLoading(),e.callUpdate({success:f,complete:function(){d.hideLoading(),a.destroy()}})},onContentReady:function(){P.Module.prototype.onContentReady.apply(this,arguments);var a={};this.$form=this.$("form"),this.form=new P.Form(this.$form,a),this.listen(this.form,"submitValidated",this.onSubmitValidated)},onChildChange:function(a){var b=a.target;if("toggleAll"===b.id){var c;c=b.isChecked()?function(a){a.setChecked(!0)}:function(a){a.setChecked(!1)};var d=this.getChildrenByModuleName("ui.Checkbox");_.each(d,c)}}}),goog.provide("P.modules.HeaderMore"),goog.require("P.Module"),P.modules.HeaderMore=P.Module.extend({getFindFriendsElement:function(){return this.getChildById("find_friends_button").$el},getFindBoardsElement:function(){return this.getChildById("follow_boards_button").$el},openFindBoards:function(){return this.getChildById("follow_boards_button").showModal()}}),goog.provide("P.modules.HeroFriendsInvite"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase");var BUTTON_ID_INVITE="invite";P.modules.HeroFriendsInvite=P.modules.HeroHelperBase.extend({onButtonClick:function(a){var b=a.target;if(b.id===BUTTON_ID_INVITE){var c={name:"MultiInviter"};P.loadModule(c,function(a){P.getModalManager().showInModal(a)})}}}),goog.provide("P.modules.HeroInstallApp"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase");var BUTTON_ID_INSTALL_APP="install_app";P.modules.HeroInstallApp=P.modules.HeroHelperBase.extend({onContentReady:function(){this.formListener&&this.removeListener(this.formListener);var a;a={phoneNumber:[P.Validator.Required(),P.Validator.PhoneNumber()]},this.form=new P.Form(this.$("form"),a),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.installAppButton=this.getChildById(BUTTON_ID_INSTALL_APP),P.modules.HeroHelperBase.prototype.onContentReady.call(this)},onSubmitValidated:function(a){a.errors[0]||this.installAppSms()},onSuccess:function(){this.complete(),this.installAppButton.hideLoading(),this.installAppButton.setText(this.options.sent_text),this.installAppButton.disable()},onFailure:function(){this.installAppButton.hideLoading()},installAppSms:function(){var a=this.form.getValue("phoneNumber"),b=this.form.getValue("country"),c=P.resourceFactory.create("SmsAppInstall",{number:a,country:b});this.installAppButton.showLoading(),c.callCreate({error:P.NOOP}).fail(_.bindFn(this.onFailure,this)).done(_.bindFn(this.onSuccess,this))}}),goog.provide("P.modules.HeroLanguagePicker"),goog.require("P.modules.HeroHelperBase"),P.modules.HeroLanguagePicker=P.modules.HeroHelperBase.extend({events:{"click .showEnglish":"showEnglish"},showEnglish:function(){this.options.show_english=!0,this.render()},_onButtonClick:function(a){var b=a.target,c=b.id;"switch"===c?this._switch():"close"===c&&this._close(!0)},_close:function(a){var b=a?"language_unchanged":"language_confirmation",c={name:"ConfirmDialog",options:{template:b,language_name:this.extraData.language_name}};P.modules.HeroHelperBase.prototype.dismiss.call(this,!0);var d=this;P.loadModule(c,function(b){d.showInModal(b),d.listen(b,P.CONST.EVENT_DESTROYED,_.bindFn(d.dismiss,d,!1,a))})},dismiss:function(a,b){b||window.location.reload(!0),this.destroy()},_switch:function(){var a={locale:this.resource.options.locale},b=P.resourceFactory.create("UserSettingsResource",a);b.callUpdate({success:_.bindFn(this._close,this,!1)})}}),goog.provide("P.modules.HeroPinItButton"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase");var BUTTON_ID_PINIT_BUTTON="pinitButton";P.modules.HeroPinItButton=P.modules.HeroHelperBase.extend({onContentReady:function(){this.extraData.isChrome&&this.detectExtensionInstalled()&&this.dismiss(),P.modules.HeroHelperBase.prototype.onContentReady.call(this)},onButtonClick:function(a){var b=a.target;b.id===BUTTON_ID_PINIT_BUTTON&&this.extraData.url&&(this.extraData.isChrome?this.handleChromeExtension():(P.changeWindowLocation(this.extraData.url,this.extraData.newWindow),this.complete(!0)))},handleChromeExtension:function(){this.detectExtensionInstalled()||(chrome.webstore.install(),this.complete(!0))},detectExtensionInstalled:function(){return"true"===$("body").attr("data-pinterest-extension-installed")}}),goog.provide("P.modules.HeroPinItWeb"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase");var BUTTON_ID_PINIT_BUTTON_WEB="pinitButton";P.modules.HeroPinItWeb=P.modules.HeroHelperBase.extend({onButtonClick:function(a){var b=a.target;b.id===BUTTON_ID_PINIT_BUTTON_WEB&&(P.changeWindowLocation(this.extraData.url,this.extraData.newWindow),this.complete(!0))}}),goog.provide("P.modules.HeroPlacePinsBoard"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase");var TRY_IT_BUTTON="tryItButton";P.modules.HeroPlacePinsBoard=P.modules.HeroHelperBase.extend({onButtonClick:function(a){var b=a.target;b.id===TRY_IT_BUTTON&&(this.changeBoardLayoutToPlaces(),this.complete())},changeBoardLayoutToPlaces:function(){var a=this.getChildById(TRY_IT_BUTTON),b=this.resource.options.board_id;a.showLoading(),this.resource.options.layout=P.CONST.BOARD_LAYOUT_PLACES,this.resource.callUpdate({success:function(a){var c=a.resource_response;P.pubsub.publish(b,P.CONST.PUBSUB_TOPIC_BOARD_UPDATED,c.data)},complete:function(){a.hideLoading()}})}}),goog.provide("P.modules.HeroPlacePinsExamples"),goog.require("P.Module"),goog.require("P.modules.HeroPlacePinsExamplesBase"),P.modules.HeroPlacePinsExamples=P.modules.HeroPlacePinsExamplesBase.extend({}),goog.provide("P.modules.HeroVerifyWebsite"),goog.require("P.Module"),goog.require("P.modules.HeroHelperBase"),P.modules.HeroVerifyWebsite=P.modules.HeroHelperBase.extend({}),goog.provide("P.modules.HomePage"),goog.require("P.Module"),P.modules.HomePage=P.Module.extend({}),goog.provide("P.modules.IframeEmbed"),goog.require("P.Module"),P.modules.IframeEmbed=P.Module.extend({}),goog.provide("P.modules.ImagesFeedPage"),goog.require("P.Module"),P.modules.ImagesFeedPage=P.Module.extend({onContentReady:function(){var a=this.getChildById("domainPinsGrid");a&&0===a.children.length?a.destroy():this.$(".domainPinsHolder").css("visibility","visible")}}),goog.provide("P.modules.InfoBarBase"),goog.require("P.Module");var INFO_BAR_ACTIVE_CLASS="active";P.modules.InfoBarBase=P.Module.extend({onCreated:function(){this.listen(this,P.CONST.EVENT_NAVIGATE,this.onTabClick),this.childListen(P.CONST.EVENT_NAVIGATE,this.onTabClick)},onTabClick:function(a){var b=a.data.url;b&&this.selectTab(b)},selectTab:function(a){this.$("a").each(function(){var b=$(this);b.attr("href")===a?b.addClass(INFO_BAR_ACTIVE_CLASS):b.removeClass(INFO_BAR_ACTIVE_CLASS)})}}),goog.provide("P.modules.InitiatePasswordReset"),goog.require("P.Module"),P.modules.InitiatePasswordReset=P.Module.extend({onContentReady:function(){this.$form=this.$("form"),this.form=new P.Form(this.$form,{email:[P.Validator.Required(),P.Validator.Email()]},{}),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(a){if(!a.errors[0]){var b=this.form.getValue("email");this.resetPassword(b)}},resetPassword:function(a){var b={username_or_email:a},c=P.resourceFactory.create("UserResetPasswordResource",b),d=this.getChildById("resetPasswordButton"),e=this;d.showLoading(),c.callCreate({error:P.NOOP}).done(function(){e.onSuccess(a)}).always(function(){d.hideLoading()})},onSuccess:function(a){this.$form.hide();var b=P.string.format(P._("An email was sent to <strong>{{ email }}</strong> describing how to reset your password."),{email:a});this.$(".messageText").html(b),this.$(".successMessage").show()}}),goog.provide("P.modules.InlineHoverButton"),goog.require("P.Module"),P.modules.InlineHoverButton=P.Module.extend({}),goog.provide("P.modules.Interest"),goog.require("P.Module"),P.modules.Interest=P.Module.extend({onContentReady:function(){var a=parseInt(this.$el.attr("class").replace(/^.*size([0-9]+).*$/,"$1"),10).toString().split(""),b="N"===a[0]?1:parseFloat(a[0]);this.state=b,$.data(this.$el,"grid-columns",this.state),$.data(this.$el,"grid-rows",this.state)}}),goog.provide("P.modules.InterestFeedPage"),goog.require("P.Module"),P.modules.InterestFeedPage=P.Module.extend({}),goog.provide("P.modules.InterestModal"),goog.require("P.Module"),P.modules.InterestModal=P.Module.extend({onContentReady:function(){$(".InterestPage").css({visibility:"hidden"}),$(".loading").fadeOut(400).remove(),this.parent.$(".closeModal").addClass("visible close")}}),goog.provide("P.modules.InterestPage"),goog.require("P.Module"),P.modules.InterestPage=P.Module.extend({onContentReady:function(){this.loadTutorial()},loadTutorial:function(){var a=P.ExperienceManager.instance(),b=P.Experiences.Placement.WEB_EXPLORE_TAKEOVER,c=a.getPlacedExperience(b);if(c){var d=P.ExperienceManager.Tutorials[c.experience_id];d&&(P.TutorialManager.instance().startTutorial(d),a.viewPlacedExperience(b,c.experience_id))}}}),goog.provide("P.modules.InterestRelatedPins"),goog.require("P.Module"),P.modules.InterestRelatedPins=P.Module.extend({onContentReady:function(){this.extraData.empty&&this.destroy()}}),goog.provide("P.modules.InviteFriendsRep"),goog.require("P.Module"),P.modules.InviteFriendsRep=P.Module.extend({events:{click:"onClick"},onClick:function(){return"facebook"===this.options.network&&P.FacebookDialog.open({type:"send",name:this.extraData.name,description:this.extraData.description,path:"/",picture:this.extraData.picture}),!1}}),goog.provide("P.modules.InviteLanding"),goog.require("P.Module"),P.modules.InviteLanding=P.Module.extend({}),goog.provide("P.modules.LanguageDropdown"),goog.require("P.Module"),P.modules.LanguageDropdown=P.Module.extend({events:{"click .language":"onClick"},onClick:function(a){var b=$(a.currentTarget),c=b.attr("data-url");return P.navigate(c),!1}}),goog.provide("P.modules.LanguageMenu"),goog.require("P.Module"),P.modules.LanguageMenu=P.Module.extend({}),goog.provide("P.modules.List"),goog.require("P.Module"),P.modules.List=P.Module.extend({}),goog.provide("P.modules.Login"),goog.require("P.Module"),goog.require("P.modules.LoginBase"),P.modules.Login=P.modules.LoginBase.extend({events:{"blur input[name=username_or_email]":"onBlurEmail","click .suggestionEmail":"onClickSuggestionEmail","click .forgotPassword":"onForgotPassword"},onBlurEmail:function(){if(this.extraData.showEmailSuggestion){var a=this.$inputEmail.val(),b=_.extend({},{email:a,email_filter:"allow_all"});
null==this.emailSuggestionResource&&(this.emailSuggestionResource=P.resourceFactory.create("EmailSuggestionResource",b));var c=this;this.emailSuggestionResource.options=b,this.emailSuggestionResource.callGet({success:function(b){var d=b.resource_response.data;d.length>0?(c.$inputEmail.val(d[0]),c.$suggestionEmail.text(a),c.$suggestion.slideDown()):c.$suggestion.slideUp()},error:function(){c.$suggestion.slideUp()}})}},onClickSuggestionEmail:function(a){var b=this.$suggestionEmail.text();this.$inputEmail.val(b),this.$suggestion.slideUp(),a.preventDefault()},onContentReady:function(){var a={},b=this.options.invite_follow_board,c=this.options.invite_follow_user;return c&&(b?a.invite_follow_board=c+"/"+b:a.invite_follow_user=c,P.SessionStorage.setItem(P.CONST.SESSION_KEY_INVITE_FOLLOW,a)),P.currentUser.isAuthenticated()&&!P.currentUser.get("autologin")?void this.redirect(a):(P.modules.LoginBase.prototype.onContentReady.apply(this,arguments),this.$suggestion=this.$(".suggestion"),this.$suggestionEmail=this.$(".suggestionEmail"),this.$inputEmail=this.$("input[name=username_or_email]"),this.getChildById("emailSignup")&&this.listen(this.getChildById("emailSignup"),P.CONST.EVENT_BUTTON_CLICK,this.onEmailSignup),this.getChildById("facebookSignup")&&this.listen(this.getChildById("facebookSignup"),P.CONST.EVENT_BUTTON_CLICK,this.onFacebookSignup),this.getChildById("twitterSignup")&&this.listen(this.getChildById("twitterSignup"),P.CONST.EVENT_BUTTON_CLICK,this.onTwitterSignup),this.getChildById("rakutenSignup")&&this.listen(this.getChildById("rakutenSignup"),P.CONST.EVENT_BUTTON_CLICK,this.onRakutenSignup),void P.trackRegisterAction("register_landing"))},onEmailSignup:function(){P.trackRegisterAction("register_email")},onFacebookSignup:function(a){a.stopPropagation(),P.trackRegisterAction("register_facebook_attempt"),this.facebookConnect(a)},onTwitterSignup:function(a){a.stopPropagation(),P.trackRegisterAction("register_twitter_attempt"),this.twitterConnect(a)},onRakutenSignup:function(a){a.stopPropagation(),P.trackRegisterAction("register_rakuten_attempt"),this.rakutenConnect(a)},onForgotPassword:function(a){window.location=$(a.target).attr("href")}}),goog.provide("P.modules.LoginPage"),goog.require("P.Module"),P.modules.LoginPage=P.Module.extend({onAddedToDom:function(){this.resizeWindow(),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_NAG_STATE,!1)},onRemovedFromDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_NAG_STATE,!0)},onContentReady:function(){this.resizeWindow()},resizeWindow:function(){this.contentReady&&this.inDom&&P.getWindowManager().contain(this.$el)}}),goog.provide("P.modules.ModernHeader"),goog.require("P.Module"),goog.require("P.modules.ButtonBase"),P.modules.ModernHeader=P.Module.extend({_currentActiveTab:null,onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_HEADER_ALT_STATE]=this.onHeaderAltStateChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,a),this.listen(P.router.get(),P.CONST.EVENT_ROUTE_MATCHED,this.onRouteMatched),this.listen(P.Updater.instance(),"new_pins_count",this.onNewPins),this.updateActiveTab(P.router.get().resolve(P.getCurrentUrl()))},onRouteMatched:function(a){var b=a.navigateData.currentModule||{};if("SearchPage"!==a.module&&"SearchPage"===b.className&&"Closeup"!==a.module){var c=this.getChildById("mainSearchTextbox");c.setTypeaheadValue("")}a.module===b.className?(this.triggerEvent(P.CONST.EVENT_SCROLL_TO_TOP,{},!0),"HomePage"===a.module&&this.getChildById("homeButton").clearBadge()):this.updateActiveTab(a)},updateActiveTab:function(a){var b,c=a.module;this._currentActiveTab&&this._currentActiveTab.setActiveStyle(!1),this.$(".headerButton.active").removeClass("active"),"HomePage"===c?b=this.getChildById("homeButton"):"CategoriesPage"===c?(b=this.getChildById("exploreCategoriesButton"),this.hideTutorial()):"InterestPage"===c?(b=this.getChildById("exploreInterestsButton"),this.hideTutorial()):"UserProfilePage"===c&&a.resource.options.username===P.currentUser.attributes.username&&(b=this.getChildById("profileButton")),b&&b.setActiveStyle(!0),this._currentActiveTab=b},onNewPins:function(a){if(a!==this._newPinsCount){this._newPinsCount=a;var b=Math.min(this._newPinsCount,99);this.getChildById("homeButton").setBadgeCount(b)}},show:function(){this.$el.show(),this.$el.removeClass("hidden")},onHeaderAltStateChange:function(a,b,c){this.$el.toggleClass("alt",c)},getHomeElement:function(){return this.getHomeButton().$el},getHomeButton:function(){return this.getChildById("homeButton")},getExploreButton:function(){return this.getChildById("exploreCategoriesButton")},getProfileButton:function(){return this.getChildById("profileButton")},getSearchBox:function(){return this.getChildById("mainSearchTextbox")},getMoreMenu:function(){return this.getChildById("moreMenu")},hideTutorial:function(){var a=this.getChildById("tutorial_shim_button");a&&a.hideTutorial()}}),goog.provide("P.modules.NagBase"),goog.require("P.Module"),P.modules.NagBase=P.Module.extend({events:{"click .nagClose":"onCloseButtonClick"},clickHandler:function(){return null},onCloseButtonClick:function(){this.destroy(),P.trackGAEvent("nag",P.CONST.GA_ACTION_CLICK_CLOSE,"type",this.extraData.type)},onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_NAG_UPDATED]=this.onActionSaved,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a)},onActionSaved:function(a,b,c){this.updateNagMessage(c)},updateNagMessage:function(a){this.$(".message").text(a)},resourceCall:function(a,b,c){var d=c.success,e=c.error;this.xhr=$.ajax({cache:!1,url:a,data:{},dataType:"json",type:"get"===b?"get":"post",success:d,error:e})}}),goog.provide("P.modules.NagEmail"),goog.require("P.Module"),goog.require("P.modules.NagBase"),P.modules.NagEmail=P.modules.NagBase.extend({events:{"click .message a":"handleLinkClick"},handleLinkClick:function(a){switch(a.target.id){case"cancelEmailUpdate":this.cancelEmailUpdate();break;case"editEmail":this.updateEmail();break;case"removeBounce":this.removeBounce();break;case"resendEmail":this.resendConfirmEmail();break;case"resendEmailUpdate":this.resendUpdatedEmailAddressEmail()}return!1},removeBounce:function(){var a=P.resourceFactory.create("UserSettingsResource",{email_bounced:!1}),b=this;a.callUpdate().done(function(){var a=P._("Got it! Make sure your inbox isn't full so that our emails can find their way to you.");b.updateNagMessage(a)})},updateEmail:function(){var a=this;this.showLoading();var b={name:"UserEditEmail",resource:{name:"UserSettingsResource",options:{}}};P.loadModule(b,function(b){a.hideLoading(),a.showInModal(b)})},handleResourceCall:function(a,b){var c=this,d=b||P.NOOP,e=function(a){c.log.debug(a)};this.resourceCall(a,"post",{success:d,error:e})},cancelEmailUpdate:function(){var a=this,b=function(b){var c;"success"===b.status?c=P._("Thanks! Your email address change was cancelled."):b.error&&(c=b.error),a.updateNagMessage(c)};this.handleResourceCall("/update_email/cancel/",b)},resendUpdatedEmailAddressEmail:function(){this.resendEmail("/update_email/resend/")},resendEmail:function(a){var b=this,c=function(a){if("success"===a.status){var c=P._("Thanks! You should receive a confirmation email soon.");b.updateNagMessage(c)}};this.handleResourceCall(a,c)},resendConfirmEmail:function(){this.resendEmail("/verify_email/resend/")}}),goog.provide("P.modules.NagNoScript"),goog.require("P.Module"),P.modules.NagNoScript=P.Module.extend({}),goog.provide("P.modules.NagPolicy"),goog.require("P.Module"),goog.require("P.modules.NagBase"),P.modules.NagPolicy=P.modules.NagBase.extend({events:{"click .policy":"clickHandler"},clickHandler:function(){var a=this,b={name:"ConfirmDialog",options:{template:"pin_policy"}};return P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,function(){a.savePolicyConfirmation()})}),!1},onActionSaved:function(){P.modules.NagBase.prototype.onActionSaved.apply(this,arguments);var a=this;P.setTimeout(function(){a.parent.render()},2e3)},savePolicyConfirmation:function(){var a=this,b=function(b){"success"===b.status?a.updateNagMessage("Thanks for confirming!"):a.log.debug(b)},c=function(b){a.log.debug(b)};this.resourceCall("/confirm_guidelines/","post",{success:b,error:c})}}),goog.provide("P.modules.NagSearch"),goog.require("P.Module"),P.modules.NagSearch=P.Module.extend({}),goog.provide("P.modules.NagSecurity"),goog.require("P.Module"),goog.require("P.modules.NagBase"),P.modules.NagSecurity=P.modules.NagBase.extend({events:{"click .resetPassword":"clickHandler"},clickHandler:function(){var a=this,b=function(){var b=P._("Thanks! You should receive a password reset email soon.");a.updateNagMessage(b)},c=P.resourceFactory.create("UserResetPasswordResource",{username_or_email:P.currentUser.attributes.username});return c.callCreate({error:P.NOOP}).done(b),!1}}),goog.provide("P.modules.NagSwitchToMobile"),goog.require("P.Module"),P.modules.NagSwitchToMobile=P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(a){"switchToMobileSite"===a.target.id&&(Cookie.unset(P.CONST.COOKIE_FORCE_DESKTOP),window.location.href="/")}}),goog.provide("P.modules.NagUnauth"),goog.require("P.Module"),P.modules.NagUnauth=P.modules.NagBase.extend({clearKeywords:function(){var a=this.getChildById("nag");a&&a.clearKeywords()}}),goog.provide("P.modules.NagUnauthBase"),goog.require("P.Module"),goog.require("P.fb"),P.modules.NagUnauthBase=P.modules.NagBase.extend({onContentReady:function(){var a=this;this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onNavigateButtonClick);var b={};b[P.CONST.PUBSUB_TOPIC_UNAUTH_NAG_TYPE]=this.onMessageTypeChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_UNAUTH_NAG,b),P.fb.ensureInit(function(b){b.getLoginStatus(function(b){a.showFacebookInfo(b)})}),$("html").hasClass("ie7")&&this.$el.removeClass("sticky"),P.trackRegisterAction("unauth_nag")},showFacebookInfo:function(a){var b=a.status;("connected"===b||"not_authorized"===b)&&this.$el.removeClass("fbHidden subMessageHidden")},onNavigateButtonClick:function(a){var b=a.target;"join"===b.id&&P.trackRegisterAction("register_from_nag")},onMessageTypeChange:function(a,b,c){return this.options.message_type===c?void this.log.debug("No need to re-render. Still message type: '"+c+"'"):(this.options.message_type=c,void this.render())},clearKeywords:function(){this.$el.hasClass("keywordsHidden")||(this.$el.addClass("keywordsHidden"),this.$el.hasClass("fbHidden")&&this.$el.addClass("subMessageHidden"),this.$(".keywords").remove())}}),goog.provide("P.modules.NagUnauthPersonal"),goog.require("P.Module"),P.modules.NagUnauthPersonal=P.modules.NagUnauthBase.extend({showFacebookInfo:function(a){return this.options&&"personalized"===this.options.type?void this.$el.removeClass("fbHidden"):void P.modules.NagUnauthBase.prototype.showFacebookInfo.call(this,a)}}),goog.provide("P.modules.NagUnauthSimple"),goog.require("P.Module"),P.modules.NagUnauthSimple=P.modules.NagUnauthBase.extend({}),goog.provide("P.modules.Nags"),goog.require("P.Module"),P.modules.Nags=P.Module.extend({onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_NAG_STATE]=this.onNagStateChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,a);var b={};b[P.CONST.PUBSUB_TOPIC_MAIN_MODULE_NEW]=this.onMainModuleChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_MAIN_MODULE,b)},onNagStateChange:function(a,b,c){this.$el.toggle(c)},onMainModuleChange:function(a,b,c){var d=c;this.options.main_module_name!==d.className&&(this.options.main_module_name=d.className,this.render())},clearKeywords:function(){var a=this.getChildById("unauthNag");a&&a.clearKeywords()}}),goog.provide("P.modules.NavigateButton"),goog.require("P.Module"),goog.require("P.modules.Button"),P.modules.NavigateButton=P.modules.Button.extend({getNavigateUrl:function(){return this.options.url},onClick:function(a){this.options.ga_category&&P.trackGAEvent(this.options.ga_category,P.CONST.GA_ACTION_CLICK),this._logContextEvent(a),a.stopPropagation(),a.preventDefault();var b=this.getNavigateUrl();P.modules.Button.prototype.onClick.call(this),this.options.safe_link?P.SafeLink.open(b,this.options.safe_link_pin_id):this.navigate(b,null,this.options.force_refresh)},moduleRenderer:new P.ModuleRendererLocal("app/desktop/modules/NavigateButton/NavigateButton.nunjucks")}),goog.provide("P.modules.NewPinsIndicator"),goog.require("P.Module"),P.modules.NewPinsIndicator=P.Module.extend({events:{click:"onClick"},render:function(a){var b=P._("1 new Pin");this.options.count&&(1!==this.options.count&&(b=this.options.count+" "+P._("new Pins")),this.$el.text(b),this.$el.append('<em class="arrows"></em>')),this.onContentReady(),this.onRendered(),a&&a()},onClick:function(){this.triggerEvent("click",null,!0)}}),goog.provide("P.modules.NotificationItems"),goog.require("P.Module"),P.modules.NotificationItems=P.Module.extend({}),goog.provide("P.modules.NotificationSettings"),goog.require("P.Module"),P.modules.NotificationSettings=P.Module.extend({onContentReady:function(){this.$form=this.$("form");var a=new P.Form(this.$form,[]);this.listen(a,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(){var a=this,b={},c={};this.$(".pushNotifSettings input[type=checkbox]").each(function(){var a=$(this),b=a.attr("name");c[b.substr(5)]=a.is(":checked")?"anyone":"none"}),b.push_settings=JSON.stringify(c),b.filter_settings=this.$("input[name=filter_settings]:checked").val();var d=P.resourceFactory.create("NotificationSettingsResource",b);return this.showLoading(!0),d.callUpdate({complete:function(){a.hideLoading()},success:function(){a.destroy()}}),!1}}),goog.provide("P.modules.Notifications"),goog.require("P.Module");var ACTOR_ID_ATTR="data-actor-id",MIN_THRESHOLD=300;P.modules.Notifications=P.Module.extend({events:{"mouseover .notifMessage a":"onActorMouseover","click .notifItem":"onNotificationClick","click .notifSettings":"onSettingsClick"},mixins:[P.Mixins.PreventScroll],onCreated:function(){this.onNotificationsScroll=_.bindFn(this.onNotificationsScroll,this),this.onNotificationsScroll=_.throttle(this.onNotificationsScroll,200)},onContentReady:function(){this.scrollableElement=this.$(".notifContent"),this._scrollListener=this.listen(this.scrollableElement,"scroll",this.onNotificationsScroll),this.startPreventScroll(this.scrollableElement,this.$(".NotificationItems")),this.listen(this.parent,P.CONST.EVENT_DROPDOWN_HIDE,this.onHide)},onHide:function(){this.$(".unseen").removeClass("unseen")},onSettingsClick:function(){var a=this,b={name:"NotificationSettings",resource:{name:"NotificationSettingsResource",options:{}}};return P.loadModule(b,function(b){a.showInModal(b)}),!1},onActorMouseover:function(a){var b=$(a.target),c=b.attr(ACTOR_ID_ATTR);this.setActiveUser(c,b.parents(".notifItem"))},onNotificationClick:function(a){var b=$(a.target),c=$(a.currentTarget),d=c.attr("data-url"),e=c.attr("data-conversation-id");if(b.is("a"))return!0;if(d)this.navigate(d);else if(e){var f=this,g={name:"Conversation",resource:{name:"ConversationResource",options:{conversation_id:e}}};P.loadModule(g,function(a){f.showInModal(a)})}},onNotificationsScroll:function(){if(!this.rendering){var a=this.$(".NotificationItems"),b=a.height()+a.position().top-this.scrollableElement.height();return b<=MIN_THRESHOLD&&this.fetchMore(),!1}},fetchMore:function(){if(!this.rendering){if(this.resource.atEnd())return void this.removeListener(this._scrollListener);var a=this;this.rendering=!0,this.getChildById("items").renderAppend(function(){a.rendering=!1})}},setActiveUser:function(a,b){b.find(".actorImage, .notifComment").each(function(){var b=$(this);b.toggleClass("active",b.attr(ACTOR_ID_ATTR)===a)})}}),goog.provide("P.modules.NuxImagesFeedPage"),goog.require("P.Module"),P.modules.NuxImagesFeedPage=P.Module.extend({}),goog.provide("P.modules.NuxPinCreate"),goog.require("P.Module"),P.modules.NuxPinCreate=P.Module.extend({}),goog.provide("P.modules.NuxTutorial"),goog.require("P.Module"),P.modules.NuxTutorial=P.Module.extend({}),goog.provide("P.modules.OAuthPage"),goog.require("P.modules.OAuthPageBase"),P.modules.OAuthPage=P.modules.OAuthPageBase.extend({events:{"click .authorizeApp":"onAuthorizeButtonClicked","click .joinButton":"onJoinButtonClicked"},onJoinButtonClicked:function(){P.navigate("/join/register/email/?next="+encodeURIComponent(P.getCurrentUrl()))}}),goog.provide("P.modules.PaddedPin"),goog.require("P.Module"),P.modules.PaddedPin=P.Module.extend({getLoggingObjectIdStr:function(){return this.resource.id}}),goog.provide("P.modules.PasswordResetOneClick"),goog.require("P.Module"),P.modules.PasswordResetOneClick=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onResetPassword)},onSuccess:function(){this.$(".message").hide(),this.$(".successMessage").show()},onResetPassword:function(){var a={username_or_email:this.options.username_or_email},b=P.resourceFactory.create("UserResetPasswordResource",a),c=this.getChildById("resetPasswordButton"),d=this;c.showLoading(),b.callCreate({error:P.NOOP}).done(function(){d.onSuccess()}).always(function(){c.hideLoading()})}}),goog.provide("P.modules.PersonalizedForYou"),goog.require("P.Module"),P.modules.PersonalizedForYou=P.Module.extend({}),goog.provide("P.modules.Pillow"),goog.require("P.Module"),P.modules.Pillow=P.Module.extend({}),goog.provide("P.modules.Pin"),goog.require("P.modules.PinBase");var PIN_EDIT_BUTTON_ID="editButton",PIN_CLASS_VISIBLE="visible",SCOPED_EVENT_NAME="mapPage",MOUSEENTER_EVENT_NAME="mouseenter."+SCOPED_EVENT_NAME,MOUSELEAVE_EVENT_NAME="mouseleave."+SCOPED_EVENT_NAME,VIEW_TYPES={DETAILED:"detailed",SUMMARY:"summary"},GRID_ACTION_BUTTON_WRAPPERS=[".likeEditButtonWrapper",".repinSendButtonWrapper"];P.modules.Pin=P.modules.PinBase.extend({events:{"mouseleave .pinImageSourceWrapper":"onPinMouseout","click .playIndicatorPill.gifType":"onGifClick"},onPinMouseout:function(){var a=this.getChildById("sendPinButton");if(a){var b=a.getDropdown();b&&b.isVisible()&&this.toggleActionButtons(!0)}},toggleActionButtons:function(a){this.$(GRID_ACTION_BUTTON_WRAPPERS.join(", ")).toggleClass(PIN_CLASS_VISIBLE,a)},onButtonClick:function(a){var b=a.target,c=b.id,d=this.options.pin_id;switch(c){case"expandGiraffe":this.onExpandGiraffeClick(a),b.destroy();break;case"seeOnMap":b.setHighlight(!0),this._forceSeeOnMap=!0,this.triggerEvent(P.CONST.EVENT_PIN_PLACE_CLICK,d,!0);break;case"pinItToMapButton":var e=this.extraData.image;this.showLoading(!0),this.triggerEvent(P.CONST.EVENT_PINIT_BUTTON_CLICKED,e,!0)}},getId:function(){return this.options.pin_id},onExpandGiraffeClick:function(){this.$(".pinImageWrapper").removeClass("collapsed"),this.triggerEvent(P.CONST.EVENT_DIMS_CHANGED,null,!0)},getSummaryImageUrl:function(){return this.data.images["236x"].url},getLink:function(){return this.data.link||null},showEditModal:function(){var a=this.getChildById(PIN_EDIT_BUTTON_ID);return a?(a.showModal(),!0):!1},getPinMedia:function(){var a=this._getViewType();switch(a){case"detailed":return this.$(this.isEmbed()&&!this.isGif()?"iframe":".PaddedPin img.pinImage");case"boardPinsGrid":return this.$("img");case"summary":return this.$(".pinHolder .pinImg");default:return this.log.error("requesting pin media for unsupported view_type:"+a),null}},isEmbed:function(){return this.data.embed&&this.data.embed.src},isGif:function(){return this.data.embed&&"gif"===this.data.embed.type},isVideo:function(){return this.data.is_video},getDominantColor:function(){return this.data.dominant_color||"#eee"},getDetailedImageDimensions:function(){var a={width:736,height:370},b={youtube:a,vimeo:a,soundcloud:{width:553,height:166}};if(this.data.is_playable&&(this.data.is_video||this.data.attribution&&this.data.attribution.embed)){if(this.data.attribution){var c=b[this.data.attribution.provider_name];if(c)return c}if(this.data.embed)return this.data.embed}return this.data.images["736x"]},_getViewType:function(){return this.options.view_type?this.options.view_type:VIEW_TYPES.SUMMARY},onContentReady:function(){P.modules.PinBase.prototype.onContentReady.call(this);var a=this.options.pin_id;if(a){var b={};b[P.CONST.PUBSUB_TOPIC_PIN_COMMENT_CREATED]=this.onPinCommentCreated,b[P.CONST.PUBSUB_TOPIC_PIN_COMMENT_DELETED]=this.onPinCommentDeleted,b[P.CONST.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,b[P.CONST.PUBSUB_TOPIC_PIN_LIKED]=this.onPinLiked,b[P.CONST.PUBSUB_TOPIC_PIN_UNLIKED]=this.onPinUnliked,b[P.CONST.PUBSUB_TOPIC_PIN_UPDATED]=this.onPinUpdated,this.pubsubSubscribe(a,b)}this.listen(this,P.CONST.EVENT_NAVIGATE,this.onNavigate),this.childListen(P.CONST.EVENT_NAVIGATE,this.onNavigate),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_DROPDOWN_SHOW,this.onDropdownShow),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.childListen(P.CONST.EVENT_LAZY_IMAGE_COMPLETE,this.onImageLoaded),this.childListen(P.CONST.EVENT_REQUIRES_AUTHENTICATION,function(a){a.data.contextualResource||(a.data.contextualResource=this.getContextualResource())}),this.listen(this,P.CONST.ADD_HOVER_LISTENER_FOR_MAP_MARKER,this.addHoverListenerForMapMarker),this.listen(this,P.CONST.REMOVE_HOVER_LISTENER_FOR_MAP_MARKER,this.removeHoverListenerForMapMarker)},closeAddToMapDropdownIfNeeded:function(){var a=this.getChildById("addToMap");a&&a.hideDropdown()},getContextualResource:function(){return P.resourceFactory.create("PinResource",{id:this.getId()})},onGifClick:function(a){a.preventDefault(),this.originalSrc||(this.originalSrc=this.$(".pinImg").attr("src"));var b=this.$(".playIndicatorPill.gifType");return this.isPlaying?(this.$(".pinImg").attr("src",this.originalSrc),b.removeClass("playing")):(this.$(".pinImg").attr("src",this.data.embed.src),b.addClass("playing")),this.isPlaying=!this.isPlaying,!1},addHoverListenerForMapMarker:function(){var a=this,b=this.$el,c=this.getId(),d=this.getChildById("seeOnMap");this.removeHoverListenerForMapMarker(),b.on(MOUSEENTER_EVENT_NAME,function(){a.triggerEvent(P.CONST.EVENT_PIN_MOUSE_IN,c,!0),d&&d.setHighlight(!0)}),b.on(MOUSELEAVE_EVENT_NAME,function(){a._forceSeeOnMap||(a.triggerEvent(P.CONST.EVENT_PIN_MOUSE_OUT,c,!0),d&&d.setHighlight(!1))})},removeHoverListenerForMapMarker:function(){var a=this.$el;a.off(MOUSEENTER_EVENT_NAME+" "+MOUSELEAVE_EVENT_NAME)},onDropdownShow:function(a){var b=a.target.options.view_type;"pickedForYou"===b?P.logFrontEndEvent("pickedForYouHoverShow"):"addToMap"===b?this.triggerEvent(P.CONST.EVENT_BOARD_CACHE_PIN_ID_TO_ADD_TO_MAP,this,!0):this.toggleActionButtons(!0)},onDropdownHide:function(){this.toggleActionButtons(!1)},onImageLoaded:function(a){a.stopPropagation();var b=this.$(".fadeContainer");if(b.length>0){var c=P.overlap.isOverlappingViewport(b,0);P.deferDomManipulation(function(){b.addClass("loaded"),c&&b.addClass("fade")})}},onNavigate:function(a){P.isOffsiteUrl(a.data.url)&&(a.data.pinId=this.options.pin_id),this.hideDropdowns()},hideDropdowns:function(){var a=this.getChildrenByModuleName("DropdownButton");_.each(a,function(a){a.getDropdown().hide()})},onPinCommentCreated:function(){this._getViewType()===VIEW_TYPES.SUMMARY&&this.render()},onPinCommentDeleted:function(){this._getViewType()===VIEW_TYPES.SUMMARY&&this.render()},onPinLiked:function(){this.triggerEvent(P.CONST.EVENT_PIN_LIKED,null,!0);var a=this.getChildById("likeButton");a&&a.setState(!0)},onPinUnliked:function(){this.triggerEvent(P.CONST.EVENT_PIN_UNLIKED,null,!0);var a=this.getChildById("likeButton");a&&a.setState(!1)},onPinUpdated:function(a,b,c){this.triggerEvent(P.CONST.EVENT_PIN_UPDATED,c,!0),this.render()},onPinDeleted:function(){this.triggerEvent(P.CONST.EVENT_PIN_DELETED,this,!0),this.destroy()},getSourceUrl:function(){return this.data.link||""}}),goog.provide("P.modules.PinBookmarklet"),goog.require("P.Module"),P.modules.PinBookmarklet=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate)},onContentReady:function(){this.resizeWindowToFit()},onChildRemoved:function(){this.children.length?this.resizeWindowToFit():window.close()},onChildNavigate:function(a){var b=!0;P.changeWindowLocation(a.data.url,b),window.close()},resizeWindowToFit:function(){P.getWindowManager().shrinkWrap()}}),goog.provide("P.modules.PinBookmarkletTooltip"),goog.require("P.Module"),goog.require("P.Experiences");var PLACEMENT_ID=P.Experiences.Placement.WEB_TOOLTIP,EXPERIENCE_ID=P.Experiences.Experience.WEB_PINIT_BOOKMARKLET;P.modules.PinBookmarkletTooltip=P.Module.extend({events:{"drag .pinBookmarkletButton":"onPinBookmarkletDrag","click .pinBookmarkletButton":"onPinBookmarkletClick"},onPinBookmarkletDrag:function(){this.completeExperience()},onPinBookmarkletClick:function(){var a={name:"ConfirmDialog",options:{template:"pinit_bookmarklet_prompt"}};P.loadModule(a,function(a){P.getModalManager().showInModal(a,{can_dismiss:!1})})},onAddedToModal:function(a){this.listen(a,P.CONST.EVENT_DISMISS,this.dismissExperience)},onContentReady:function(){this.viewExperience()},viewExperience:function(){P.trackGAEvent("pin_bookmarklet_tooltip","viewed");var a=P.ExperienceManager.instance();a.viewPlacedExperience(PLACEMENT_ID,EXPERIENCE_ID)},completeExperience:function(){P.trackGAEvent("pin_bookmarklet_tooltip","completed");var a=P.ExperienceManager.instance();a.completePlacedExperience(PLACEMENT_ID,EXPERIENCE_ID)},dismissExperience:function(){P.trackGAEvent("pin_bookmarklet_tooltip","dismissed");var a=P.ExperienceManager.instance();a.dismissPlacedExperience(PLACEMENT_ID,EXPERIENCE_ID)}}),goog.provide("P.modules.PinCloseupSettings"),goog.require("P.Module"),P.modules.PinCloseupSettings=P.Module.extend({}),goog.provide("P.modules.PinCloseupShare"),goog.require("P.Module"),P.modules.PinCloseupShare=P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(){this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0)}}),goog.provide("P.modules.PinComment"),goog.require("P.Module"),P.modules.PinComment=P.Module.extend({onCreated:function(){this.childListen("commentDeleteSuccess",this.onPinCommentDelete)},onPinCommentDelete:function(){var a=this;this.$el.slideUp(300,function(){a.destroy()})}}),goog.provide("P.modules.PinCommentList"),goog.require("P.Module"),goog.require("P.modules.PinCommentListBase"),P.modules.PinCommentList=P.modules.PinCommentListBase.extend({events:_.extend(P.modules.PinCommentListBase.prototype.events,{"mousedown .content":"onTextAreaMouseDown","keydown .content":"onTextAreaPossiblyResized","mouseup .content":"onTextAreaPossiblyResized"}),onTextAreaMouseDown:function(){this.commentContentHeight=this.$(".content").height()},onTextAreaPossiblyResized:function(){if(null!==this.commentContentHeight){var a=this.$(".content").height();this.commentContentHeight!==a&&(this.triggerEvent(P.CONST.EVENT_DIMS_CHANGED,null,!0),this.commentContentHeight=a)}}}),goog.provide("P.modules.PinCount"),goog.require("P.Module"),P.modules.PinCount=P.Module.extend({onContentReady:function(){if(this.options.can_update_count&&this.data.id){var a={};"UserResource"===this.resource.name&&(a[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onCountUpdated),a[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this.onCountUpdated,a[P.CONST.PUBSUB_TOPIC_PIN_DELETED]=this.onCountUpdated,this.pubsubSubscribe(this.data.id,a)}},onCountUpdated:function(a,b){var c=1e3;b===P.CONST.PUBSUB_TOPIC_PIN_DELETED&&(c=0),setTimeout(_.bindFn(this.render,this),c)}}),goog.provide("P.modules.PinCreate"),goog.require("P.Module");var PIN_CREATE_API_RESPONSE_CODE_SPAM_CONTENT=14;P.modules.PinCreate=P.Module.extend({onCreated:function(){this.onPinCreateSuccess=_.bindFn(this.onPinCreateSuccess,this)},onButtonClick:function(a){var b=a.target;switch(b.id){case"submitButton":P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_CLICK_SUBMIT);break;case"cancelButton":P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_CLICK_CANCEL),this.modal||this.destroy()}},onContentReady:function(){P.Module.prototype.onContentReady.apply(this,arguments),this.GACategory=this.isRepin()?"repin_create":"pin_create",this.pinForm=this.getChildById("pinForm"),this.listen(this.pinForm,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen("boardCreated",this.onBoardCreate),this.boardPicker=this.pinForm.getChildById("boardPicker");var a=this.pinForm.form;this.listen(this.boardPicker,P.CONST.EVENT_BOARD_SELECTED,_.bindFn(a.enableSubmitButtons,a)),this.boardPicker.getSelectedBoardId()||a.disableSubmitButtons()},onSubmitValidated:function(a){var b=a.data;b.errors[0]||this.createPin()},isRepin:function(){return!(!this.data||!this.data.id)},getPinResource:function(){var a="PinResource",b=_.extend(this.pinForm.getData(),_.pick(this.options,"method","is_video"));return this.isRepin()&&(a="RepinResource",b.pin_id=this.data.id),P.resourceFactory.create(a,b)},createPin:function(){this.showLoading(!0);var a=this,b=this.getPinResource();b.callCreate({success:this.onPinCreateSuccess,error:function(b){if(P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_ERROR),"create"===a.options.action&&b.api_error_code===PIN_CREATE_API_RESPONSE_CODE_SPAM_CONTENT){var c={name:"ConfirmDialog",options:{fluid:!0,template:"blocked_source"}};P.loadModule(c,function(b){b.render(function(){a.parent.appendChild(b),a.destroy()})})}else P.showError(b.message)},complete:function(){a.hideLoading()}})},onBoardCreate:function(a){this.log.debug("Created a board",a.data,a.target.getBoardCount()),a.target.getBoardCount()>=1&&(this.lastCreatedBoard=a.data)},onPinCreateSuccess:function(a){P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_SUCCESS);var b=this,c=a.resource_response.data,d=c.board,e=d.url,f=this.options.action,g=d.name,h=d.privacy,i=d.is_collaborative,j={id:"pinSuccess",name:"PinCreateSuccess",options:{action:f,board:g,board_url:e,domain:c.domain,pin_id:c.id,is_collaborative:i,privacy:h,method:this.options.method},resource:P.Resource.NOOP_RESOURCE};"pin_create_ignition"===this.options.action?j.options.auto_close=!1:this.lastCreatedBoard&&this.lastCreatedBoard.id===d.id&&(j={id:"pinSuccess",name:"PinCreateSuccessBoardEdit",resource:{name:"BoardResource",options:{board_id:d.id,field_set_key:"basic"}},options:{pinCreateInfo:j}}),this.showLoading(),P.loadModule(j,function(a){b.modal?b.modal.setModule(a):"pin_create_ignition"===b.options.action?b.showInModal(a,{}):a.render(function(){b.parent.appendChild(a),b.destroy()})}),this.triggerEvent(P.CONST.EVENT_PIN_CREATE,c),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_PIN_CREATED,c),P.pubsub.publish(c.board.id,P.CONST.PUBSUB_TOPIC_PIN_CREATED,c),P.pubsub.publish(P.currentUser.id,P.CONST.PUBSUB_TOPIC_PIN_CREATED)}}),goog.provide("P.modules.PinCreate2"),goog.require("P.Module");var API_RESPONSE_CODE_SPAM_CONTENT=14;P.modules.PinCreate2=P.Module.extend({onCreated:function(){this.onPinCreateSuccess=_.bindFn(this.onPinCreateSuccess,this),this.childListen(P.CONST.EVENT_CHANGE,this.onFacebookCheckboxChanged),this.networkToSelectorMap={},this.networkToSelectorMap[P.SocialConnect.FACEBOOK]='[name="share_facebook"]',this.networkToSelectorMap[P.SocialConnect.TWITTER]='[name="share_twitter"]'},onContentReady:function(){this.requestPending=!1,this.GACategory=this.isRepin()?"repin_create":"pin_create";var a={};this.$pinPreviewImg=this.$(".pinPreviewImg"),this.$pinDescription=this.$(".pinDescription"),a={description:[P.Validator.Required(),P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION})],boardName:[P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_TITLE})]},this.form=new P.Form(this.$("form"),a),this.boardPicker=this.getChildById("boardPicker2"),this.childListen(P.CONST.EVENT_BOARD_SELECTED,this.onBoardSelected),this.isRepin()||this._autofocusDescription()},_autofocusDescription:function(){this.$(".content[autofocus]:not(:focus)").eq(0).focus()},onBoardSelected:function(a){var b=a.data.boardId,c=a.data.boardName;if(b||c){var d=this;this.form.validate(function(){b?d.createPin(b):d.createBoardAndPin(c)
})}},onFacebookCheckboxChanged:function(){var a=this.getNetworkChecked(P.SocialConnect.FACEBOOK);if(a){var b=this;P.FbUtil.maybeRequestFbTimelinePermission({error:function(){b.setNetworkChecked(P.SocialConnect.FACEBOOK,!a)}})}},isRepin:function(){return!(!this.data||!this.data.id)},getDescription:function(){var a=this.getChildById("pinDescriptionField");return a.getValue()},setNetworkChecked:function(a,b){var c=this.networkToSelectorMap[a];c&&(this.$(c).prop("checked",b),this.$(c).trigger("click"))},getNetworkChecked:function(a){var b=this.networkToSelectorMap[a];if(b){var c=this.$(b);return c.length?c.is(":checked"):""}},createBoardAndPin:function(a){var b=this.boardPicker.getLoadingSpinTarget();this.showLoading(!1,b);var c=this;this.createBoard(a,{success:function(a){c.createPin(a)},complete:function(){c.hideLoading()}})},createBoard:function(a,b){b=b||{};var c=P.resourceFactory.create("BoardResource",{name:a}),d=this,e=function(a){if(a){var c=a.resource_response,e=c.data.id;d.boardPicker.setSelectedBoardId(e),b.success&&b.success(e)}else b.error&&b.error()},f=function(a){P.showError(a.message),b.error&&b.error()},g=function(){b.complete&&b.complete()};c.callCreate({success:e,error:f,complete:g})},getPinResource:function(){var a="PinResource",b={};this.extraData&&(b.link=this.extraData.link,b.is_video=this.extraData.isVideo,b.image_url=this.extraData.imageUrl),b=_.extend(b,_.pick(this.options,"method")),this.isRepin()&&(a="RepinResource",b.pin_id=this.data.id),b.description=this.getDescription();var c=this.getNetworkChecked(P.SocialConnect.TWITTER);b.share_twitter=""!==c?c:!1;var d=this.getNetworkChecked(P.SocialConnect.FACEBOOK);return b.share_facebook=""!==d?d:!1,P.resourceFactory.create(a,b)},createPin:function(a){if(!this.requestPending&&(!this.form||!this.form.hasErrors())&&(a=a||this.boardPicker.getSelectedBoardName())){var b=this.boardPicker.getLoadingSpinTarget();this.showLoading(!1,b);var c=this,d=this.getPinResource();d.options.board_id=a,this.requestPending=!0,d.callCreate({success:this.onPinCreateSuccess,error:function(a){if(P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_ERROR),"create"===c.options.action&&a.api_error_code===API_RESPONSE_CODE_SPAM_CONTENT){var b={name:"ConfirmDialog",options:{fluid:!0,template:"blocked_source"}};P.loadModule(b,function(a){a.render(function(){c.parent.appendChild(a),c.destroy()})})}else P.showError(a.message)},complete:function(){c.requestPending=!1,c.hideLoading()}})}},onPinCreateSuccess:function(a){P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_SUCCESS);var b=this,c=a.resource_response.data,d=c.board,e=d.url,f=this.options.action,g=d.name,h=d.privacy,i=d.is_collaborative,j={id:"pinSuccess",name:"PinCreateSuccess",options:{action:f,board:g,board_url:e,pin_id:c.id,domain:c.domain,is_collaborative:i,privacy:h},resource:P.Resource.NOOP_RESOURCE};P.loadModule(j,function(a){var c=b.modal;c?(c.setTransparentContent(!1),c.setModule(a)):a.render(function(){b.parent.appendChild(a),b.destroy()})}),this.triggerEvent(P.CONST.EVENT_PIN_CREATE,c),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_PIN_CREATED,c),P.pubsub.publish(c.board.id,P.CONST.PUBSUB_TOPIC_PIN_CREATED,c),P.pubsub.publish(P.currentUser.id,P.CONST.PUBSUB_TOPIC_PIN_CREATED)}}),goog.provide("P.modules.PinCreateSuccess"),goog.require("P.Module");var CLOSE_DELAY_DEFAULT=2e3,CLOSE_DELAY_WITH_RELATED_DATA=1e4,CLOSE_DELAY_AFTER_FOLLOW=1e3;P.modules.PinCreateSuccess=P.Module.extend({onContentReady:function(){var a=CLOSE_DELAY_DEFAULT,b=!1,c=this.getChildById("successBoard"),d=this.getChildById("successPins");if(c&&c.hasBoard()){a=CLOSE_DELAY_WITH_RELATED_DATA,b=!0;var e={};e[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onBoardFollow,this.pubsubSubscribe(c.getBoardId(),e)}d&&!d.isEmpty()&&(a=CLOSE_DELAY_WITH_RELATED_DATA,b=!0),b||this.$el.addClass("noBody"),P.ExperienceManager.instance().isPlacedExperience(P.Experiences.Placement.WEB_PIN_SUCCESS,P.Experiences.Experience.WEB_PIN_SUCCESS_EXTENSION_UPSELL)&&"bookmarklet"===this.options.method&&(a=CLOSE_DELAY_WITH_RELATED_DATA),this.options.auto_close!==!1&&this.closeOnDelay(a),P.ExperienceManager.instance().completePlacedExperience(P.Experiences.Placement.WEB_PIN_CLOSEUP,P.Experiences.Experience.WEB_PIN_CLOSEUP_LITE)},closeOnDelay:function(a){this.closeTimer&&clearTimeout(this.closeTimer);var b=this;this.closeTimer=P.setTimeout(function(){b.closeTimer=null,b.destroy()},a)},onBoardFollow:function(){this.closeOnDelay(CLOSE_DELAY_AFTER_FOLLOW)},onDestroyed:function(){"pin_create_ignition"===this.options.action&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_TUTORIAL,P.CONST.PUBSUB_TOPIC_TUTORIAL_NEXT)}}),goog.provide("P.modules.PinCreateSuccessBoard"),goog.require("P.Module"),P.modules.PinCreateSuccessBoard=P.Module.extend({onContentReady:function(){this.hasBoard||this.hide()},hasBoard:function(){return!!this.getChildById("board")},getBoardId:function(){return this.extraData.boardId}}),goog.provide("P.modules.PinCreateSuccessExtensionNag"),goog.require("P.Module"),goog.require("P.Experiences"),P.modules.PinCreateSuccessExtensionNag=P.Module.extend({events:{"click .getNewPinItButton":"onGetNewPinItButtonClick"},onGetNewPinItButtonClick:function(){this._completeExperience()},onContentReady:function(){this._viewExperience()},_viewExperience:function(){P.trackGAEvent("web_pin_success_extension_upsell","viewed");var a=P.ExperienceManager.instance();a.viewPlacedExperience(P.Experiences.Placement.WEB_PIN_SUCCESS,P.Experiences.Experience.WEB_PIN_SUCCESS_EXTENSION_UPSELL)},_completeExperience:function(){P.trackGAEvent("web_pin_success_extension_upsell","completed");var a=P.ExperienceManager.instance();a.completePlacedExperience(P.Experiences.Placement.WEB_PIN_SUCCESS,P.Experiences.Experience.WEB_PIN_SUCCESS_EXTENSION_UPSELL)}}),goog.provide("P.modules.PinCreateSuccessPins"),goog.require("P.Module"),P.modules.PinCreateSuccessPins=P.Module.extend({onContentReady:function(){this.isEmpty()&&this.hide()},isEmpty:function(){if(!this.contentReady)return!1;var a=this.getChildById("relatedPinsFeed");return!a||!a.hasItems()}}),goog.provide("P.modules.PinDeleteCommentButton"),goog.require("P.Module"),goog.require("P.modules.InlineHoverButton"),P.modules.PinDeleteCommentButton=P.modules.InlineHoverButton.extend({events:{click:"onClick"},showConfirmation:function(){var a=this,b={name:"ConfirmDialog",options:{template:"delete_comment"}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.onDeleteConfirm)})},onDeleteConfirm:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_CLICK_SUBMIT);var a={pin_id:this.options.pin_id,comment_id:this.options.comment_id},b=P.resourceFactory.create("PinCommentResource",a),c=this;b.callDelete({success:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_SUCCESS),c.triggerEvent("commentDeleteSuccess",this,!0),P.pubsub.publish(c.options.pin_id,P.CONST.PUBSUB_TOPIC_PIN_COMMENT_DELETED)},error:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_ERROR)}})},onClick:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_OPEN_MODAL),this.showConfirmation()}}),goog.provide("P.modules.PinDupWarning"),goog.require("P.Module"),P.modules.PinDupWarning=P.Module.extend({}),goog.provide("P.modules.PinEdit"),goog.require("P.Module"),goog.require("P.modules.PinEditBase"),P.modules.PinEdit=P.modules.PinEditBase.extend({removePlace:function(){var a=this.$(".placeWrapper");a.append('<input type="hidden" id="pinPlaceId" value="">'),a.fadeOut()},onButtonClick:function(a){var b=a.target;"removePlaceButton"===b.id&&this.removePlace()},showConfirmation:function(){var a=this,b={name:"ConfirmDialog",options:{template:"delete_pin",ga_category:P.CONST.GA_CATEGORY_PIN_DELETE}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.onDeleteConfirm)})},showPrivacyChangeConfirmation:function(){var a=this,b={name:"ConfirmDialog",options:{template:"change_pin_privacy"}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,function(){P.trackGAEvent(P.CONST.GA_CATEGORY_PIN_EDIT,P.CONST.GA_ACTION_CLICK_CONFIRM),a.savePin()})})}}),goog.provide("P.modules.PinEmail"),goog.require("P.Module"),P.modules.PinEmail=P.Module.extend({onContentReady:function(){var a={pin:[P.Validator.Required()],email:[P.Validator.Required(),P.Validator.Email()],recipient_name:[P.Validator.Required()]};this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),a),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(a){var b=a.target;b&&("submitButton"===b.id?P.trackGAEvent("pin_email",P.CONST.GA_ACTION_CLICK_SUBMIT):"cancelButton"===b.id&&P.trackGAEvent("pin_email",P.CONST.GA_ACTION_CLICK_CANCEL))},onSubmitValidated:function(a){a.errors[0]||this.sendEmail()},sendEmail:function(){var a=this.$("form").serializeArray(),b={},c=this.getChildById("submitButton"),d=this;_.each(a,function(a){b[a.name]=a.value}),c.showLoading();var e={name:"ConfirmDialog",options:{template:"email_pin",recipient_name:b.recipient_name}},f=P.resourceFactory.create("EmailPinResource",b);f.callCreate({success:function(){P.trackGAEvent("pin_email",P.CONST.GA_ACTION_SUCCESS),P.loadModule(e,function(a){d.showInModal(a),d.listen(a,P.CONST.EVENT_CONFIRM,d.destroy)})},error:function(a){P.trackGAEvent("pin_email",P.CONST.GA_ACTION_ERROR),P.showError(a.message)},complete:function(){c.hideLoading()}})}}),goog.provide("P.modules.PinFlagCommentButton"),goog.require("P.Module"),goog.require("P.modules.InlineHoverButton"),P.modules.PinFlagCommentButton=P.modules.InlineHoverButton.extend({events:{click:"onClick"},showReasonModal:function(){var a=this,b={name:"FlagComment",options:{pin_id:this.options.pin_id,comment_id:this.options.comment_id}};P.loadModule(b,function(b){a.showInModal(b)})},onClick:function(){P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_OPEN_MODAL),this.showReasonModal()}}),goog.provide("P.modules.PinShareButton"),goog.require("P.Module"),P.modules.PinShareButton=P.Module.extend({}),goog.provide("P.modules.PinUploader"),goog.require("P.Module");var PIN_UPLOADER_NEW_REPIN_FLOW=P.experiments.instance.inExperimentGroup("denzel_new_repin_flow2","enabled");P.modules.PinUploader=P.Module.extend({onContentReady:function(){var a=this.getChildById("uploader");this.listen(a,P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.listen(a,P.CONST.EVENT_UPLOAD_ERROR,this.onUploadError)},onUploadSuccess:function(a){P.trackGAEvent("pin_upload",P.CONST.GA_ACTION_SUCCESS),this.imageUrl=a.data.image_url,this.ensurePinCreate()},onUploadError:function(a){P.trackGAEvent("pin_upload",P.CONST.GA_ACTION_ERROR),P.showError(a.data)},ensurePinCreate:function(){var a=this,b={image_url:this.imageUrl,action:"upload",method:"uploaded",transparent_modal:PIN_UPLOADER_NEW_REPIN_FLOW};this.options.default_board_id&&(b.default_board_id=this.options.default_board_id);var c=PIN_UPLOADER_NEW_REPIN_FLOW?"PinCreate2":"PinCreate",d={};PIN_UPLOADER_NEW_REPIN_FLOW&&(d.container_class="pinCreate2Modal");var e={name:c,options:b,id:"pinCreate"};this.showLoading(),P.loadModule(e,function(b){a.hideLoading(),a.showInModal(b,d),a.triggerEvent(P.CONST.EVENT_PIN_CREATE_OPENED,null,!0),a.destroy()})}}),goog.provide("P.modules.Pinnable"),goog.require("P.modules.PinnableBase");var CLASS_DISABLED="disabled",CLASS_SELECTED_ITEM="selected",ADD_TO_MAP_VIEWTYPE="add_to_map",PINNABLE_NEW_REPIN_FLOW=P.experiments.instance.inExperimentGroup("denzel_new_repin_flow2","enabled");P.modules.Pinnable=P.modules.PinnableBase.extend({events:{"click a.pinImageWrapper":"onClick",click:"onClick"},enable:function(){this.$el.removeClass(CLASS_DISABLED)},disable:function(){this.$el.addClass(CLASS_DISABLED)},select:function(){this._setSelected(!0)},_setSelected:function(a){this.$el.toggleClass(CLASS_SELECTED_ITEM,a)},deselect:function(){this._setSelected(!1)},onClick:function(){if(this.options.view_type!==ADD_TO_MAP_VIEWTYPE)return this.createPin(),!1;var a=this.$("img").attr("src");this.triggerEvent(P.CONST.EVENT_PLACE_IMAGE_SELECTED,a,!0),this.select()},createPin:function(){var a={image_url:this.options.url,action:"create",method:"scraped",link:this.options.link,transparent_modal:PINNABLE_NEW_REPIN_FLOW},b=PINNABLE_NEW_REPIN_FLOW?"PinCreate2":"PinCreate",c={};PINNABLE_NEW_REPIN_FLOW&&(c.container_class="pinCreate2Modal");var d={name:b,options:a,id:"pinCreate"},e=this;P.loadModule(d,function(a){e.showInModal(a,c)})}}),goog.provide("P.modules.PlaceBoardHeader"),goog.require("P.Module"),goog.require("P.modules.BoardHeader"),P.modules.PlaceBoardHeader=P.modules.BoardHeader.extend({}),goog.provide("P.modules.PlaceBoardInfoBar"),goog.require("P.Module"),goog.require("P.modules.BoardInfoBar"),P.modules.PlaceBoardInfoBar=P.modules.BoardInfoBar.extend({}),goog.provide("P.modules.PlaceSelector"),goog.require("P.Module"),P.modules.PlaceSelector=P.Module.extend({events:{"blur .citySearch input":"onCitySearchBlur"},onCreated:function(){this.onCitySearchBlur=_.bindFn(this.onCitySearchBlur,this)},onContentReady:function(){this._placeChanged=!1,this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onItemSelected),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_TYPEAHEAD_SEARCH_START,this.onSearchStart),this.childListen(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onSearchEnd),this.childListen(P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onSearchEnd);var a=this.getChildById("placeField"),b=this.getChildById("cityField");b.setResourceOptionForTypeahead(P.CONST.SHOW_SEARCH_AROUND_WORLD,!0),a.setResourceOptionForTypeahead("show_search_specific_city",!0);var c=null,d=this.options.place;d&&(c=d.locality,c&&d.region&&(c=c+", "+d.region)),this.setSearchingAroundCity(c)},onButtonClick:function(a){var b=a.target,c=b.id;if("removePlaceButton"===c){var d=this.getChildById("placeField");if(!d)return;var e=this.getChildById("cityField");e.reset(),d.reset(),this._placeChanged=!0,d.enableInput(),this.$(".cityFieldWrapper").addClass("hidden"),e.enableInput(),this.triggerEvent(P.CONST.EVENT_HIDE_PLACE_FIELDS,null,!0)}},onSearchStart:function(a){var b=a.target.parent;b.showLoading()},onSearchEnd:function(a){var b=a.target.parent;b.hideLoading()},getSelectedPlace:function(){if(!this._placeChanged)return null;var a=this.getChildById("placeField");if(!a)return"0";var b=a.getTypeaheadSelectedItem();if(!b)return"0";var c=b.get("id");return c?c:"0"},focusPlaceField:function(){var a=this.getChildById("placeField");a.focus()},onItemSelected:function(a){a.stopPropagation();var b=a.target.options.tags,c=a.data.item,d=this.getChildById("cityField"),e=this.getChildById("placeField"),f=c.get("id");if("satw"===f||"sisc"===f)return this.$(".cityFieldWrapper").removeClass("hidden"),void("sisc"===f?d.focus():(this.setSearchingAroundCity(null),d.setValue(P._("Around the world")),e.focus(),e.search()));if("cities"===b){var g=c.get("name");this.setSearchingAroundCity(g),d.setValue(g),e.focus(),e.search()}"places"===b&&(this._placeChanged=!0,this.$el.addClass("hasPlaceTags"))},setSearchingAroundCity:function(a){var b=this.getChildById("placeField");b&&b.setResourceOptionForTypeahead("near",a)},onCitySearchBlur:function(a){var b=$(a.target),c=b.val();c&&this.setSearchingAroundCity(c)}}),goog.provide("P.modules.RecFeedHomePage"),goog.require("P.Module"),P.modules.RecFeedHomePage=P.Module.extend({onContentReady:function(){var a=this.getChildById("grid"),b="none";a&&!a.hasItems()&&(a.remove(),b="block"),this.$(".noResults").css("display",b)}}),goog.provide("P.modules.RecentContacts"),goog.require("P.Module"),P.modules.RecentContacts=P.Module.extend({}),goog.provide("P.modules.RelatedInterests"),goog.require("P.Module"),P.modules.RelatedInterests=P.Module.extend({}),goog.provide("P.modules.RelatedRecipe"),goog.require("P.Module"),P.modules.RelatedRecipe=P.Module.extend({}),goog.provide("P.modules.RemoveUserFromBoardDialog"),goog.require("P.Module"),goog.require("P.modules.ConfirmDialog"),P.modules.RemoveUserFromBoardDialog=P.modules.ConfirmDialog.extend({events:{"click [name=ban]":"onBanClick"},onContentReady:function(){this.returnData=["ban"],P.modules.ConfirmDialog.prototype.onContentReady.call(this)},onBanClick:function(a){var b=$(a.target),c=P._(b.is(":checked")?"Block Pinner":"Remove Pinner");this.setPrimaryButtonText(c)}}),goog.provide("P.modules.ReportBug"),goog.require("P.Module");var INPUT_METADATA_SELECTOR='[name="metadata"]';P.modules.ReportBug=P.Module.extend({getMetadata:function(){return this.$(INPUT_METADATA_SELECTOR).val()},onContentReady:function(){var a=this.getChildById("uploader");this.listen(a,P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.listen(a,P.CONST.EVENT_UPLOAD_ERROR,this.onUploadError),this.imageUrl=null;var b={title:[P.Validator.Required()],description:[P.Validator.Required()]};this.setMetadata(),this.form=new P.Form(this.$("form"),b),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(){this.reportBug()},setMetadata:function(){var a=window.navigator.userAgent,b=P.getCurrentUrl(),c=P.experiments.instance.getDebugInfo();this.$(INPUT_METADATA_SELECTOR).val("\n\n\n\n----------------------------------\nuserAgent: "+a+"\ncurrentURL: "+b+"\nexperiments: "+c+"\nusername: "+P.currentUser.get("username")+"\n\n")},reportBug:function(){var a=this,b=this.$("form").serializeArray(),c=this.getChildById("submitButton"),d={};_.each(b,function(a){d[a.name]=a.value}),d.description=d.description+this.getMetadata(),this.imageUrl&&(d.image_url=this.imageUrl),c.showLoading();var e=P.resourceFactory.create("ReportErrorResource",d);e.callCreate({success:function(b){var c=b.resource_response.data,d={name:"ConfirmDialog",options:{template:"report_bug",task_url:c,class_name:"reportBug"}};P.loadModule(d,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.destroy)})},error:function(a){P.showError(a.message)},complete:function(){c.hideLoading()}})},onUploadSuccess:function(a){this.imageUrl=a.data.image_url},onUploadError:function(){P.showError(P.string.common.defaultErrorMessage)}}),goog.provide("P.modules.RichPinDebugger"),goog.require("P.Module");var HIDDEN="hidden",SELECTED="selected";P.modules.RichPinDebugger=P.Module.extend({events:{"click .menu .main":"onShowMain","click .menu .scraped":"onShowScraped","click .menu .parsed":"onShowParsed"},onContentReady:function(){this.$form=this.$("form"),this.$main=this.$(".section.main"),this.$menus=this.$(".menu a"),this.$scraped=this.$(".section.scraped"),this.$sections=this.$(".section"),this.$parsed=this.$(".section.parsed"),this.form=new P.Form(this.$form,[]),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.retrieve)},retrieve:function(){var a=this,b=this.$form.serializeArray(),c=b[0].value,d={link:c},e=this.getChildById("submitButton"),f=P.resourceFactory.create("RichPinReindexResource",d),g=function(b){var d=encodeURIComponent(c);if(b&&!b.resource_response.error&&b.resource_response.data){var e=b.resource_response.data;d=encodeURIComponent(e.url)}a.navigate("?link="+d)};e.showLoading(),f.callCreate({success:g,complete:function(){e.hideLoading()}})},onShowMain:function(a){return this.hideAllMenus(),this.$main.removeClass(HIDDEN),$(a.target).addClass(SELECTED),!1},onShowParsed:function(a){return this.hideAllMenus(),this.$parsed.removeClass(HIDDEN),$(a.target).addClass(SELECTED),!1},onShowScraped:function(a){return this.hideAllMenus(),this.$scraped.removeClass(HIDDEN),$(a.target).addClass(SELECTED),!1},hideAllMenus:function(){this.$sections.addClass(HIDDEN),this.$menus.removeClass(SELECTED)}}),goog.provide("P.modules.RichPinDebuggerItem"),goog.require("P.Module"),P.modules.RichPinDebuggerItem=P.Module.extend({}),goog.provide("P.modules.RichPinHeading"),goog.require("P.Module"),P.modules.RichPinHeading=P.Module.extend({}),goog.provide("P.modules.ScrollToTop"),goog.require("P.Module");var VISIBLE_CLASS="visible",PADDING_PX=500;P.modules.ScrollToTop=P.Module.extend({events:{click:"onScrollToTopClick"},onCreated:function(){this.visible=!1,this.$scroller=null},setScroller:function(a){this.scrollListener&&(this.removeListener(this.scrollListener),this.scrollListener=null),this.$scroller=a,this.$scroller.length>0&&(this.updateButtonVisibility(),this.scrollListener=this.listen(this.$scroller,"scroll",this.updateButtonVisibility))},updateButtonVisibility:function(){var a=this.$scroller.scrollTop();a>PADDING_PX?this.showButton():this.hideButton()},onScrollToTopClick:function(){this.triggerEvent(P.CONST.EVENT_SCROLL_TO_TOP,{},!0),P.trackGAEvent("scroll_to_top",P.CONST.GA_ACTION_CLICK)},animateButtonIn:function(){var a=this;P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP_VISIBLE,null),P.deferDomManipulation(function(){a.$el.addClass(VISIBLE_CLASS)})},animateButtonOut:function(){var a=this;P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP_HIDDEN,null),P.deferDomManipulation(function(){a.$el.removeClass(VISIBLE_CLASS)})},showButton:function(){this.visible||(this.visible=!0,this.animateButtonIn())},hideButton:function(){this.visible&&(this.visible=!1,this.animateButtonOut())}}),goog.provide("P.modules.SearchFacetSelector"),goog.require("P.Module"),P.modules.SearchFacetSelector=P.Module.extend({}),goog.provide("P.modules.SearchInfoBar"),goog.require("P.Module"),goog.require("P.modules.InfoBarBase"),P.modules.SearchInfoBar=P.modules.InfoBarBase.extend({}),goog.provide("P.modules.SearchPage"),goog.require("P.Module"),P.modules.SearchPage=P.Module.extend({onCreated:function(){this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate)},_updateSearchOptions:function(){this.searchOptions=_.pick(this.options,"query","scope")},onChildNavigate:function(a){var b=a.data.url;if(!P.isOffsiteUrl(b)){var c=P.router.get().resolve(b);if(c&&"SearchPage"===c.module){var d=P.router.get().resolve(a.data.url).options;return this.setOptions(d),this.publishSearchChange(),void(a.data.handled=!0)}}},onAdded:function(){this.publishSearchChange()},publishSearchChange:function(){this._updateSearchOptions();var a=this.searchOptions||{};P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,a.query||""),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED,a.scope||"")}}),goog.provide("P.modules.SearchScopeSelector"),goog.require("P.Module"),P.modules.SearchScopeSelector=P.Module.extend({events:{'change input[name="scope"]':"onScopeChange",'change input[name="facet"]':"onFacetChange"},queryStringWithoutFacets:function(){var a=window.location.search;return a=a.replace(/&fc=[^&]*/,""),a=a.replace(/\?fc=[^&]*&?/,"?")},navigateToScope:function(a){var b=this.queryStringWithoutFacets();this.navigate("/search/"+a+"/"+b)},navigateToFacet:function(a,b){var c=this.queryStringWithoutFacets();b&&(c+=(""===c?"?":"&")+"fc="+b),this.navigate("/search/"+a+"/"+c)},onScopeChange:function(a){var b=$(a.currentTarget),c=b.val();if(c!==this.options.scope){var d=b.attr("data-url")||c;this.navigateToScope(d)}},onFacetChange:function(a){var b=$(a.currentTarget),c=b.val(),d=this;_.each(d.options.facets,function(a){_.each(a.constraints,function(b){return b.id===c?void d.navigateToFacet(a.scope,b.target):void 0})})}}),goog.provide("P.modules.ShowModalButton"),goog.require("P.Module"),goog.require("P.modules.Button"),goog.require("P.modules.ModalTrigger"),P.modules.ShowModalButton=P.modules.Button.extend({onClick:function(a){return this.isDisabled()?(a.preventDefault(),!1):this.options.require_auth&&!this.ensureAuthentication()?(a.preventDefault(),!1):(this.showModal(),!1)}}),_.extend(P.modules.ShowModalButton.prototype,P.modules.ModalTrigger.prototype),_.extend(P.modules.ShowModalButton.prototype,{getAuthRedirectUrl:function(){var a={};return this.options.require_auth_params&&_.extend(a,this.options.require_auth_params),P.getRegisterUrl(a)},toString:function(){return this.className+"(module="+this.options.submodule.name+")"},moduleRenderer:new P.ModuleRendererLocal("app/desktop/modules/ShowModalButton/ShowModalButton.nunjucks"),getLoggingObjectIdStr:function(){return this.parent?this.parent.getLoggingObjectIdStr():null}}),goog.provide("P.modules.SmartFeedPage"),goog.require("P.Module"),P.modules.SmartFeedPage=P.Module.extend({}),goog.provide("P.modules.SocialNetworkSettingsBase"),goog.require("P.Module");var FIND_FRIENDS_TRY_AGAIN_POLL_INTERVAL=1e3,FIND_FRIENDS_TRY_AGAIN_API_ERROR_CODE=110;P.modules.SocialNetworkSettingsBase=P.Module.extend({handleConnect:function(a,b,c){var d=this;if(b){var e={success:function(e){var f={network:a,data:e};d._internalConnectNetwork(b,f,c)},error:function(){P.showError(P.string.common.connectError),c.error&&c.error(),c.complete&&c.complete()}};this._externalConnectNetwork(a,b,e)}else{var f={network:a};this._internalConnectNetwork(b,f,c)}},_getResourceNameForNetworkFriends:function(a){var b=null;switch(a){case P.SocialConnect.FACEBOOK:b="UserFacebookFriendsResource";break;case P.SocialConnect.TWITTER:b="UserTwitterFriendsResource";break;case P.SocialConnect.GOOGLE:b="UserGmailFriendsResource";break;case P.SocialConnect.YAHOO:b="UserYahooFriendsResource";break;default:return}return b},pollForFriends:function(a,b){b=b||{};var c=b.resourceOptions||{},d=this._getResourceNameForNetworkFriends(a);if(d){var e=P.resourceFactory.create(d,c),f=this;e.callGet({success:function(){var a=b.success;a&&a(e)},error:function(c){if(c.api_error_code===FIND_FRIENDS_TRY_AGAIN_API_ERROR_CODE)P.setTimeout(function(){f.pollForFriends(a,b)},FIND_FRIENDS_TRY_AGAIN_POLL_INTERVAL);else{var d=b.error;d&&d()}}})}},_externalConnectNetwork:function(a,b,c){if(!b)return void(c.success&&c.success());var d=P.SocialConnect.instance();d.connect(a,c)},_internalConnectNetwork:function(a,b,c){var d=a?"create":"delete",e=P.resourceFactory.create("UserSocialNetworkResource",b),f=c.error;_.extend(c,{error:function(a){P.showError(a.message),f()}}),e.call(d,c)}}),goog.provide("P.modules.TextContainer"),goog.require("P.Module"),P.modules.TextContainer=P.Module.extend({}),goog.provide("P.modules.TrademarkForm"),goog.require("P.Module");var SELECTOR_AGENT_FIELDS=".agentFields",SELECTOR_TRANSFER_FIELD=".transferField";P.modules.TrademarkForm=P.Module.extend({onCreated:function(){this.onComplainantTypeChange=_.bindFn(this.onComplainantTypeChange,this),this.onTrademarkClaimSuccess=_.bindFn(this.onTrademarkClaimSuccess,this),this.onAddURLButtonClick=_.bindFn(this.onAddURLButtonClick,this)},onContentReady:function(){if(_.contains(["username","content","goods"],this.options.claim_type)){this.$("[name=complainant_type]").on("change",this.onComplainantTypeChange),this.$("[name=course_of_action]").on("change",this.onClaimTypeChange);var a=this.getChildById("addURL");a&&this.listen(a,P.CONST.EVENT_BUTTON_CLICK,this.onAddURLButtonClick),this.complainantType=null,this.claimType=null;var b=new Date;this.$("#trademarkSignatureDate").val(b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear()),this.setupForm()}},setupForm:function(){var a=this.$("form"),b={};this.form=new P.Form(a,b),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onComplainantTypeChange:function(a){var b=$(a.target);if(b.is(":checked")){var c=b.val();this.complainantType=c,"agent"===c?this.showAgentFields():this.hideAgentFields()}},onClaimTypeChange:function(a){var b=$(a.target);if(b.is(":checked")){var c=b.val();this.claimType=c,"transfer"===c?$(SELECTOR_TRANSFER_FIELD).show():$(SELECTOR_TRANSFER_FIELD).hide()}},onSubmitValidated:function(a){if(!a.errors[0]){var b=this.createResourceOptions(),c=this.getChildById("submitBtn");c.showLoading();var d=P.resourceFactory.create("TrademarkClaimResource",b);d.callCreate({success:this.onTrademarkClaimSuccess,complete:function(){c.hideLoading()}})}},onTrademarkClaimSuccess:function(a){var b=a.resource_response.data,c={name:"ConfirmDialog",options:{claim_id:b,template:"trademark_claim_success"}},d=this;P.loadModule(c,function(a){d.showInModal(a),d.listen(a,P.CONST.EVENT_DESTROYED,function(){this.navigate("/")})})},onAddURLButtonClick:function(){var a=this.$(".infringingURLs"),b=a.children().first().clone();b.find("input").removeAttr("id"),a.append(b)},showAgentFields:function(){this.$(SELECTOR_AGENT_FIELDS).show()},hideAgentFields:function(){this.$(SELECTOR_AGENT_FIELDS).hide()},createResourceOptions:function(){var a=_.omit(this.form.getData(),"complainant_type");a.claim_type=this.options.claim_type,a.is_owner="owner"===this.complainantType;var b=["infringing_content_urls","infringing_goods_urls"];return _.each(b,function(b){var c=a[b];_.isArray(c)&&(c=_.map(c,function(a){return $.trim(a)}),c=_.reject(c,function(a){return""===a}),a[b]=c.join(","))}),a}}),goog.provide("P.modules.TrademarkFormSelector"),goog.require("P.Module"),P.modules.TrademarkFormSelector=P.Module.extend({onContentReady:function(){this.$("[name=claim_type]").on("change",_.bindFn(this.onClaimTypeChange,this))},onClaimTypeChange:function(a){var b=$(a.target);if(b.is(":checked")){var c=b.val();this.navigate("/about/trademark/form/"+c+"/")}}}),goog.provide("P.modules.TweetButton"),goog.require("P.Module"),goog.require("P.modules.Button"),P.modules.TweetButton=P.modules.Button.extend({onClick:function(){var a=this.options.ga_category||"share_twitter";P.trackGAEvent(a,P.CONST.GA_ACTION_CLICK),this.openWebIntent(),this.triggerEvent(P.CONST.EVENT_BUTTON_CLICK,null,!0)},openWebIntent:function(){var a=this.getWindowUrl(),b=550,c=420;return P.getWindowManager().open(a,null,b,c)},getWindowUrl:function(){var a="https://twitter.com/intent/tweet?via=pinterest",b={};return this.options.tweet_path&&(b.url=encodeURIComponent(P.absolutify(this.options.tweet_path))),this.options.tweet_text&&(b.text=encodeURIComponent(this.options.tweet_text)),_.reduce(b,function(a,b,c){return a+"&"+c+"="+b},a)}}),goog.provide("P.modules.UnauthDiscoveryHomePage"),goog.require("P.Module"),P.modules.UnauthDiscoveryHomePage=P.Module.extend({onAddedToDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_HEADER_ALT_STATE,!0),this.searchForm&&this.searchForm.focus()},onContentReady:function(){P.isPlaceholderSupported&&(this.searchForm=this.getChildById("searchForm"),this.searchForm.focus()),P.trackRegisterAction("unauth_home")},onRemovedFromDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_HEADER_ALT_STATE,!1),P.Viewport.updateBodyColumns()}}),goog.provide("P.modules.UnauthFeedHomePage"),goog.require("P.Module"),P.modules.UnauthFeedHomePage=P.Module.extend({onContentReady:function(){this.options.blended_feed&&this.loadUnauthHomePageModal(),P.trackRegisterAction("unauth_home")},loadUnauthHomePageModal:function(){var a=this,b={name:"UnauthHomePage"};P.loadModule(b,function(b){var c={fixed:!0,position_point:"TOP_CENTER",can_dismiss:!1,mask_type:"dark"};a.showInModal(b,c)})}}),goog.provide("P.modules.UnauthHomePage"),goog.require("P.Module"),goog.require("P.modules.BackgroundImage"),P.modules.UnauthHomePage=P.Module.extend({onContentReady:function(){P.trackRegisterAction("unauth_home"),this.setupInspiredWall()},setupInspiredWall:function(){this.story=this.extraData.story,this.inspiredSearchContentWrapper=this.$(".inspiredSearchContentWrapper"),$(this.$el).bind("mousewheel",_.bindFn(this.onWheelScroll,this)),$(this.$el).bind("DOMMouseScroll",_.bindFn(this.onWheelScroll,this)),this.setInspiredStory()},onWheelScroll:function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1},setInspiredStory:function(){var a=this.getChildById("bgImage_"+this.story.story_id);a.setActive(!0),this.loadedBackgrounds||(this.loadedBackgrounds=!0,a.setNewImage(this.story.bg_color,this.story.bg_image),this.inspiredSearchContentWrapper.css("background-image","url("+this.story.bg_dialog_image+")"))}}),goog.provide("P.modules.UnauthSignupHomePage"),goog.require("P.Module"),goog.require("P.modules.UnauthHomePage"),P.modules.UnauthSignupHomePage=P.modules.UnauthHomePage.extend({}),goog.provide("P.modules.UnblockButton"),goog.require("P.Module"),P.modules.UnblockButton=P.Module.extend({events:{click:"onClick"},onUserUnblockSuccess:function(){var a=this,b={name:"ConfirmDialog",options:{template:"block_unblock_user_success",name:a.options.full_name,action:"unblocked"}};
_.extend(b.options,a.options.dialog_options),P.loadModule(b,function(b){a.showInModal(b,{can_dismiss:!1}),a.listen(b,P.CONST.EVENT_CONFIRM,a.onUnblockConfirm)})},onUnblockConfirm:function(){this.destroy()},onClick:function(){P.trackGAEvent("user_unblock",P.CONST.GA_ACTION_CLICK);var a=this,b=this.options.user_id;this.showLoading();var c={blocked_user_id:this.options.user_id},d=P.resourceFactory.create("UserBlockResource",c);d.callDelete({success:function(){P.trackGAEvent("user_unblock",P.CONST.GA_ACTION_SUCCESS),P.pubsub.publish(b,P.CONST.PUBSUB_TOPIC_USER_UNBLOCKED),a.onUserUnblockSuccess()},error:function(a){P.showError(a.message),P.trackGAEvent("user_unblock",P.CONST.GA_ACTION_ERROR)},complete:function(){a.hideLoading()}})}}),goog.provide("P.modules.User"),goog.require("P.Module");var VIEW_TYPE_FOLLOW_FRIENDS_ITEM="followFriendsItem";P.modules.User=P.Module.extend({events:{"click .dismiss":"onDismissClick",click:"onClick"},getLoadingSpinnerOptions:function(){var a=P.Module.prototype.getLoadingSpinnerOptions.call(this);return this.options.view_type===VIEW_TYPE_FOLLOW_FRIENDS_ITEM?_.extend(a,{size:P.Spinner.Size.SMALL}):a},getProfileImage:function(){var a;switch(this.options&&this.options.view_type){case"userSelect":a=this.$(".profileImage");break;default:return}return a.attr("src")},onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onUserFollow;var b=this.getUserId();this.pubsubSubscribe(b,a)},onUserFollow:function(){this.options.view_type===VIEW_TYPE_FOLLOW_FRIENDS_ITEM&&this.$el.addClass("contactConfirmed"),this.triggerEvent(P.CONST.EVENT_USER_FOLLOW,null,!0)},onDismissClick:function(){this.triggerEvent(P.CONST.EVENT_DISMISS,null,!0)},getUserId:function(){return this.data&&this.data.id},onClick:function(){"userSelect"===this.options.view_type&&this.triggerEvent(P.CONST.EVENT_USER_CLICK,null,!0)}}),goog.provide("P.modules.UserBadge"),goog.require("P.Module"),P.modules.UserBadge=P.Module.extend({}),goog.provide("P.modules.UserBlock"),goog.require("P.Module"),P.modules.UserBlock=P.Module.extend({events:{"click .cancelButton":"onCancelButtonClick"},onContentReady:function(){this.form=new P.Form(this.$("form"),[]),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(a){var b=a.target;if(b){var c=this.options.blocked_by_me?"user_unblock":"user_block";"cancelButton"===b.id?P.trackGAEvent(c,P.CONST.GA_ACTION_CLICK_CANCEL):"submitButton"===b.id&&P.trackGAEvent(c,P.CONST.GA_ACTION_CLICK_SUBMIT)}},onSubmitValidated:function(a){a.errors[0]||this.blockUser()},onUserBlockSuccess:function(){var a=this,b={name:"ConfirmDialog",options:{template:"block_unblock_user_success",name:a.options.full_name,action:"blocked"}};P.loadModule(b,function(b){a.showInModal(b,{can_dismiss:!1}),a.listen(b,P.CONST.EVENT_CONFIRM,a.onBlockConfirm)})},onBlockConfirm:function(){P.getModalManager().removeAllModals();var a=P.getCurrentUrl().split("/")||[];a[1]&&a[1]===this.options.username&&this.navigate("/")},blockUser:function(){var a=this,b=this.getChildById("submitButton"),c=this.options.user_id;b.showLoading();var d={blocked_user_id:c},e=this.options.blocked_by_me?"delete":"create",f=P.resourceFactory.create("UserBlockResource",d),g=this.options.blocked_by_me?"user_unblock":"user_block";f.call(e,{success:function(){P.trackGAEvent(g,P.CONST.GA_ACTION_SUCCESS),P.pubsub.publish(a.options.user_id,P.CONST.PUBSUB_TOPIC_USER_BLOCKED),a.onUserBlockSuccess()},error:function(a){P.showError(a.message),P.trackGAEvent(g,P.CONST.GA_ACTION_ERROR)},complete:function(){b.hideLoading()}})},onCancelButtonClick:function(){this.destroy()}}),goog.provide("P.modules.UserBoardInvites"),goog.require("P.Module"),P.modules.UserBoardInvites=P.Module.extend({onContentReady:function(){this.destroyIfEmpty(),this.pagedGrid=this.getChildById("pagedGrid"),this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.onChildContentChanged)},onChildRemoved:function(){this.destroyIfEmpty()},onChildContentChanged:function(){this.pagedGrid.hasItems()||this.pagedGrid.destroy()},isEmpty:function(){return!this.children.length}}),goog.provide("P.modules.UserChangePassword"),goog.require("P.Module");var changePasswordSubmitButtonId="changePasswordSubmit";P.modules.UserChangePassword=P.Module.extend({onContentReady:function(){this.$form=this.$("form");var a={"new":[P.Validator.Required(),P.Validator.ContainsOnlyAscii({message:P.string.common.asciiPasswordError}),P.Validator.Password()],new_confirm:[P.Validator.Required(),P.Validator.EqualTo({targetFieldName:"new",message:P._("Passwords don't match")})]};this.extraData.has_password&&(a.old=[P.Validator.Required()]),this.form=new P.Form(this.$form,a),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated);var b=this.getChildById("forgotPasswordButton");b&&this.listen(b,P.CONST.EVENT_BUTTON_CLICK,this.onForgotPasswordClick)},onSubmitValidated:function(a){var b=this.getChildById(changePasswordSubmitButtonId);a.errors[0]||(b.showLoading(!0),this.changePassword())},changePassword:function(){var a=this;this.hideLoading(!0);var b=function(){var b=a.getChildById(changePasswordSubmitButtonId);b.hideLoading()},c=function(){if(a.isInModal()){var b={name:"ConfirmDialog",options:{template:"change_password_success"}},c=function(){a.triggerEvent("success",a),a.destroy(),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_USER_CHANGED_PASSWORD,a.extraData.render_social_networks)};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,c)})}else a.navigate("/")},d=$("form",this.$el),e={"new":d.find("[name=new]").val(),new_confirm:d.find("[name=new_confirm]").val()};this.extraData.has_password&&(e.old=d.find("[name=old]").val());var f=P.resourceFactory.create("UserPasswordResource",e);f.callUpdate({success:c,complete:b})},onForgotPasswordClick:function(){var a=this;P.trackGAEvent("forgot_password",P.CONST.GA_ACTION_CLICK),this.showLoading();var b=P.resourceFactory.create("UserResetPasswordResource",{username_or_email:P.currentUser.attributes.username}),c=function(){P.trackGAEvent("forgot_password",P.CONST.GA_ACTION_SUCCESS);var b={name:"ConfirmDialog",options:{template:"change_password"}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.destroy)})},d=function(){a.hideLoading()},e=function(){P.trackGAEvent("forgot_password",P.CONST.GA_ACTION_ERROR)};b.callCreate({success:c,complete:d,error:e})}}),goog.provide("P.modules.UserContact"),goog.require("P.Module"),P.modules.UserContact=P.Module.extend({events:{"click .dismiss":"onDismissClick","click .contactWrapper":"onAction"},onDismissClick:function(){this.triggerEvent(P.CONST.EVENT_DISMISS,null,!0)},getUserId:function(){return this.user.hash_id},onContentReady:function(){this.user=this.options.contact_info},onInviteSuccess:function(a){a&&(this.triggerEvent(P.CONST.EVENT_INVITE_USER,null,!0),this.$el.addClass("contactConfirmed"))},onAction:function(){return"facebook"===this.user.network?P.Invite.userInviteFacebook(this.user,_.bindFn(this.onInviteSuccess,this)):"email"===this.user.id_type&&P.Invite.userInviteEmail(this.user.id,_.bindFn(this.onInviteSuccess,this)),!1}}),goog.provide("P.modules.UserDropdown"),goog.require("P.Module"),P.modules.UserDropdown=P.Module.extend({events:{"click .reportBug":"openReportBugModal","click .userMenuFindBoards":"openFindBoards"},getFindFriendsElement:function(){return this.$(".userMenuFindFriends").parent()},getMyBoardsElement:function(){return this.$(".myBoards").parent()},getFindBoardsElement:function(){return this.$(".userMenuFindBoards").parent()},openFindBoards:function(){var a=this,b={name:"FastFollow",resource:{name:"UserResource",options:{username:P.currentUser.get("username"),field_set_key:"fast_follow"}},options:{post_orientation:!0}};return this.showLoading(),P.loadModule(b,function(b){a.hideLoading(),a.showInModal(b,{can_dismiss:!0,container_class:"fastFollowContainer"})}),!1},openReportBugModal:function(a){a.preventDefault();var b=this,c={name:"ReportBug",options:{shrinkToFit:!0}};return this.showLoading(),P.loadModule(c,function(a){b.hideLoading(),b.showInModal(a)}),!1}}),goog.provide("P.modules.UserEdit"),goog.require("P.Module"),P.modules.UserEdit=P.Module.extend({onContentReady:function(){var a={first_name:[P.Validator.Required()],username:[P.Validator.Required()],about:[P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_USER_DESCRIPTION})]};this.data.is_partner&&(a.business_name=[P.Validator.Required()]),this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),a),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated);var b={};b[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onImageUploaded,this.pubsubSubscribe(this.options.user_id,b)},onImageUploaded:function(a,b,c){if(c&&c.data&&c.data.profile_image_url){var d=this.$(".profileImage");d.attr("src",c.data.profile_image_url),d.on("load",function(){d.toggleClass("restrictWidth",d.height()>d.width())})}},onSubmitValidated:function(a){a.errors[0]||this.saveProfile()},getFormData:function(){var a=this.$("form").serializeArray(),b={};return _.each(a,function(a){b[a.name]=a.value}),b},getSaveResource:function(a){return P.resourceFactory.create("UserSettingsResource",a)},saveProfile:function(){var a=this.getFormData(),b=this.getChildById("submitButton"),c=this,d=this.extraData.currentUsername,e=a.username&&d!==a.username;b.showLoading();var f=this.getSaveResource(a);f.callUpdate({success:function(d){var f;if(b.hideLoading(),d.resource_response.error)d.resource_response.message&&(f={message:d.resource_response.message});else{var g=c.isInModal()&&!e;if(g)P.pubsub.publish(c.options.user_id,P.CONST.PUBSUB_TOPIC_USER_UPDATED),c.destroy();else{var h="/"+a.username+"/";c.navigate(h)}}},error:function(a){P.showError(a.message)},complete:function(){b.hideLoading()}})}}),goog.provide("P.modules.UserEditEmail"),goog.require("P.Module"),P.modules.UserEditEmail=P.Module.extend({onContentReady:function(){this.$form=this.$("form"),this.form=new P.Form(this.$form,{email:[P.Validator.Required()]}),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(a){a.errors[0]||this.updateEmail()},updateEmail:function(){var a=this,b=function(b){if(b){var c=b.resource_response;if(c&&!c.error){if(a.isInModal()){var d;d=P._(c.data.email_changing_to?"Thanks! Your email update is pending. You should receive a confirmation email soon.":"Thanks! Your email has been updated. You should receive a confirmation email soon."),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_NAG_UPDATED,d),a.destroy()}return}}},c={},d=this.form.getValue("email");this.data.email.trim()!==d.trim()?c.email=d:c.email_bounced=!1;var e=P.resourceFactory.create("UserSettingsResource",c);e.callUpdate({success:b})}}),goog.provide("P.modules.UserEditVerifyWebsite"),goog.require("P.Module"),P.modules.UserEditVerifyWebsite=P.Module.extend({events:{'keyup input[name="website_url"]':"onInput",'input input[name="website_url"]':"onInput"},onContentReady:function(){this.originalWebsite=this.data.website_url;var a={};a[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a);var b=this.getChildById("verifyWebsite");this.listen(b,P.CONST.EVENT_BUTTON_CLICK,this.onClick)},onUserUpdated:function(){this.render()},onInput:function(a){var b=$(a.target).val(),c=this.getChildById("verifyWebsite"),d=this.options.domain_verified&&b===this.originalWebsite;this.$(".verifiedDomainContainer").toggleClass("hidden",!d),this.$(".verifyButton").toggleClass("hidden",d),b?c.enable():c.disable()},showModal:function(a){this.showLoading();var b=this,c={name:"DomainVerify",resource:{name:"DomainVerifyResource",options:{domain:a}},options:{domain:a}};P.loadModule(c,function(a){b.hideLoading();var c={show_api_error:!0};b.showInModal(a,c)})},onClick:function(){var a=this.$('input[name="website_url"]').val();if(a===this.originalWebsite)return void this.showModal(a);var b=this,c=this.getChildById("verifyWebsite");c.showLoading();var d=P.resourceFactory.create("UserSettingsResource",{website_url:a});d.callUpdate({success:function(){P.pubsub.publish(b.options.user_id,P.CONST.PUBSUB_TOPIC_USER_UPDATED),b.showModal(a)},error:function(a){P.showError(a.message)},complete:function(){c.hideLoading()}})}}),goog.provide("P.modules.UserInfoBar"),goog.require("P.Module"),goog.require("P.modules.InfoBarBase"),P.modules.UserInfoBar=P.modules.InfoBarBase.extend({}),goog.provide("P.modules.UserOptionsDropdown"),goog.require("P.Module"),P.modules.UserOptionsDropdown=P.Module.extend({events:{"click .editProfileButton":"openEditProfile"},openEditProfile:function(a){var b=this,c={name:"UserEdit",resource:{name:"UserSettingsResource"},options:{user_id:P.currentUser.id}};this.showLoading(),P.loadModule(c,function(a){b.hideLoading(),b.showInModal(a,{can_dismiss:!0})}),a.preventDefault()}}),goog.provide("P.modules.UserProfileContent"),goog.require("P.Module");var BOARDS_TAB="boards",PINS_TAB="pins";P.modules.UserProfileContent=P.Module.extend({onCreated:function(){var a={};a[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this.onPinAdded,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a)},addTutorials:function(){if(this.options.tab===BOARDS_TAB&&this.extraData.isOwnProfile){var a=P.ExperienceManager.instance(),b=P.Experiences.Placement.WEB_USER_PROFILE_TAKEOVER,c=a.getPlacedExperience(b);if(c){var d=P.ExperienceManager.Tutorials[c.experience_id];d&&(P.TutorialManager.instance().startTutorial(d),a.viewPlacedExperience(b,c.experience_id))}}},onContentReady:function(){if(!this.data.board_count&&!this.data.secret_board_count){var a={};a[P.CONST.PUBSUB_TOPIC_BOARD_CREATED]=this.onFirstBoardCreated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a)}this.addTutorials()},onFirstBoardCreated:function(){this.pubsubUnsubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_CREATED),this.render()},onPinAdded:function(a,b,c){if(this.options.tab===PINS_TAB&&c.board.privacy!==P.CONST.BOARD_PRIVACY_SECRET&&this.extraData.isOwnProfile){var d=this.getChildById("userPins");d?d.prependNewItems(1):this.render()}}}),goog.provide("P.modules.UserProfileHeader"),goog.require("P.Module"),P.modules.UserProfileHeader=P.Module.extend({onCreated:function(){this._resized=!1},_resizeTextIfReady:function(){!this._resized&&this.inDom&&this.contentReady&&this.$(".userProfileHeaderBio").overflowingText()},onContentReady:function(){if(this._resizeTextIfReady(),this.options.user_id){var a={};a[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(this.options.user_id,a)}if(this.options.report_user_spam&&!this.data.blocked_by_me){P.getModalManager().removeAllModals();var b={name:"FlagUser",options:{full_name:this.data.full_name,first_name:this.data.first_name,blocked_by_me:this.data.blocked_by_me,user_id:this.data.id,username:this.data.username,hide_other_field:!0}},c=this;P.loadModule(b,function(a){c.showInModal(a)})}},onAddedToDom:function(){this._resizeTextIfReady()},onUserUpdated:function(){this.render()}}),goog.provide("P.modules.UserProfileImageUploader"),goog.require("P.Module"),P.modules.UserProfileImageUploader=P.Module.extend({onCreated:function(){this.onUpdateSuccess=_.bindFn(this.onUpdateSuccess,this)},onContentReady:function(){var a=this.getChildById("uploader");this.listen(a,P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.listen(a,P.CONST.EVENT_UPLOAD_ERROR,this.onUploadError)},onUploadSuccess:function(a){P.trackGAEvent("user_profile_image_upload",P.CONST.GA_ACTION_SUCCESS),this.imageUrl=a.data.image_url,this.updateUserProfileImage()},onUploadError:function(a){P.trackGAEvent("user_profile_image_upload",P.CONST.GA_ACTION_ERROR);var b=a.data;P.showError(b)},getUserSettingsResource:function(){return P.resourceFactory.create("UserSettingsResource",{profile_image_url:this.imageUrl})},updateUserProfileImage:function(){var a=this.getUserSettingsResource();a.callUpdate({success:this.onUpdateSuccess})},onUpdateSuccess:function(a){var b=a.resource_response;b.data.profile_image_url=this.imageUrl,P.pubsub.publish(this.options.user_id,P.CONST.PUBSUB_TOPIC_USER_UPDATED,b),this.destroy()}}),goog.provide("P.modules.UserRecentActivity"),goog.require("P.Module"),P.modules.UserRecentActivity=P.Module.extend({events:{"mouseenter .username":"onUsernameMouseEnter","mouseout .username":"onUsernameMouseOut"},onContentReady:function(){this.destroyIfEmpty()},onAddedToDom:function(){_.each(this.$(".recentActivityRow"),function(a){var b=$(a),c=b.attr("href"),d=b.data("link_url");c!==d&&b.attr("href",d)}),this.destroyIfEmpty()},isEmpty:function(){return this.contentReady&&this.inDom&&!this.$(".recentActivityRow:visible").length},onUsernameMouseEnter:function(a){var b=$(a.target).parents("a");this._originalUrl=b.attr("href");var c=$(a.target),d=c.data("username");if(d){var e="/"+d+"/";b.attr("href",e)}},onUsernameMouseOut:function(a){var b=this,c=$(a.target).parents("a");c.attr("href",b._originalUrl)}}),goog.provide("P.modules.UserRegister"),goog.require("P.Module"),goog.require("P.modules.UserRegisterBase"),P.modules.UserRegister=P.modules.UserRegisterBase.extend({}),goog.provide("P.modules.UserRegisterPage"),goog.require("P.Module"),goog.require("P.modules.UserRegisterPageBase"),P.modules.UserRegisterPage=P.modules.UserRegisterPageBase.extend({onAddedToDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_NAG_STATE,!1)},onRemovedFromDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_NAG_STATE,!0)}}),goog.provide("P.modules.UserRegisterRestricted"),goog.require("P.Module"),P.modules.UserRegisterRestricted=P.Module.extend({onAddedToDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_NAG_STATE,!1)},onRemovedFromDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_NAG_STATE,!0)}}),goog.provide("P.modules.UserSettingsPage"),goog.require("P.Module"),goog.require("P.modules.Button");var CLASS_EMAIL_DISABLED="emailDisabled",CLASS_EMAIL_SETTINGS="emailSettings",FLOW=["confirm","delete"],MODULE_ID_EMAIL_GLOBAL_TOGGLE="emailGlobalToggle";P.modules.UserSettingsPage=P.Module.extend({onContentReady:function(){var a={email:[P.Validator.Email()]};this.data.is_partner&&(a.contact_name=[P.Validator.Required()]),this.$form=this.$("form"),this.form=new P.Form(this.$form,a),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_CHANGE,this.onChildChange);var b={};b[P.CONST.PUBSUB_TOPIC_USER_CHANGED_PASSWORD]=this.onPasswordChanged,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,b)},onPasswordChanged:function(a,b,c){var d=this.getChildById("userChangePasswordButton");if(d.options.submodule.options.has_password=!0,d.options.text=this.extraData.change_password_text,d.render(),c){var e=this.getChildById("userSocialNetworkSettings");e.render()}},onButtonClick:function(a){var b=a.target,c=b.id;switch(c){case"deleteAccount":this.step=0,this.deleteAccountFlow();break;case"clearRecentSearches":this.clearRecentSearches(a);break;case"clearSendPinHistory":this.clearRecentSentPinContacts(a)}},onChildChange:function(a){var b=a.target;b.id===MODULE_ID_EMAIL_GLOBAL_TOGGLE&&(b.isChecked()?this.enableEmails():this.confirmDisableEmails())},clearRecentSearches:function(a){var b=a.target;b.disable();var c=P.resourceFactory.create("TypeaheadClearRecentResource");c.callDelete({error:function(){b.enable()}})},clearRecentSentPinContacts:function(a){var b=a.target;b.disable();var c=P.resourceFactory.create("RecentContactsResource");c.callDelete({error:function(){b.enable()}})},deleteAccountFlow:function(){var a=FLOW[this.step];"delete"===a?this.deleteAccount():(this.showDeleteAccountStep(a),this.step++)},onSubmitValidated:function(a){a.errors[0]||this.save()},navigateToUserProfilePage:function(a){var b="/"+a+"/";this.navigate(b)},navigateToSettingsPage:function(){var a="/settings";this.navigate(a,!0)},save:function(){var a=this,b=this.$form.serializeArray(),c={};_.each(b,function(a){c[a.name]="on"===a.value||"off"===a.value?"on"===a.value:a.value}),this.$form.find("input[type=checkbox]").each(function(){var a=$(this);c[a.attr("name")]=a.is(":checked")});var d=this.getChildById("submitButton"),e=P.resourceFactory.create("UserSettingsResource",c),f=function(b){if(b&&!b.resource_response.error){var d=b.resource_response.data;if(a.data.email===c.email||!d.email_changing_to)return a.navigateToSettingsPage();a.showPendingEmailChange()}};d.showLoading(),e.callUpdate({success:f,complete:function(){d.hideLoading()}})},showPendingEmailChange:function(){var a=this,b=P.string.format(P._("To finish updating your address, look for the confirmation email we sent to {{ current_email }}."),{current_email:this.data.email}),c={name:"ConfirmDialog",options:{button_text:P._("Ok"),body_message:b,title:P._("You're almost done!"),template:"generic"}};P.loadModule(c,function(b){a.showInModal(b,{can_dismiss:!1}),a.listen(b,P.CONST.EVENT_CLOSE,a.navigateToSettingsPage),a.listen(b,P.CONST.EVENT_CONFIRM,a.navigateToSettingsPage)})},showDeleteAccountStep:function(a){var b=this,c="delete_account_"+a,d={name:"ConfirmDialog",options:{template:c,view_type:"wide"}};P.loadModule(d,function(a){b.showInModal(a),b.listen(a,P.CONST.EVENT_CONFIRM,b.deleteAccountFlow)})},deleteAccount:function(){var a=this;this.xhr=$.ajax({cache:!1,url:"/delete_user/",dataType:"json",type:"delete"}).done(function(b){"success"===b.status?a.showDeleteAccountStep("success"):P.showError(P.string.common.defaultErrorMessage)}).fail(function(){P.showError(P.string.common.defaultErrorMessage)})},confirmDisableEmails:function(){var a=this,b={name:"ConfirmDialog",options:{template:"disable_emails_confirm"}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,function(){a.disableEmails(),a.removeListener(c)});var c=a.listen(b,P.CONST.EVENT_DESTROYED,function(){var a=this.getChildById(MODULE_ID_EMAIL_GLOBAL_TOGGLE);a.setChecked(!0)})})},disableEmails:function(){this.setEmailsEnabled(!1)},enableEmails:function(){this.setEmailsEnabled(!0)},setEmailsEnabled:function(a){var b=P.resourceFactory.create("UserSettingsResource",{email_enabled:a}),c=this.$("."+CLASS_EMAIL_SETTINGS);c.toggleClass(CLASS_EMAIL_DISABLED,!a),b.callUpdate()}}),goog.provide("P.modules.UserSocialNetworkSettings"),goog.require("P.Module"),goog.require("P.modules.SocialNetworkSettingsBase"),P.modules.UserSocialNetworkSettings=P.modules.SocialNetworkSettingsBase.extend({FB_PUBLISH_ACTIONS_PERMISSION:"publish_actions",onCreated:function(){P.modules.SocialNetworkSettingsBase.prototype.onCreated.apply(this,arguments),this.childListen("change",this.onChildChange)},disconnectFromSocial:function(a,b,c){this.showLoading(!0);var d=this,e={success:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED),d.render()},error:function(){a.toggle()},complete:function(){d.hideLoading()}};c||"facebookTimelineToggle"!==a.id?this.handleConnect(c,b,e):(e.success=function(){},P.FbUtil.maybeRequestFbTimelinePermission(e,this.extraData.facebookId))},onChildChange:function(a){var b=a.target,c=b.isChecked(),d=null;switch(b.id){case"facebookToggle":if(!(c&&!this.extraData.facebookUrl||!c&&this.extraData.facebookUrl))return;d=P.SocialConnect.FACEBOOK,c||this.getChildById("facebookTimelineToggle").setChecked(!1);break;case"facebookTimelineToggle":var e={};e.facebook_timeline_enabled=!this.extraData.facebookTimelineEnabled;var f=P.resourceFactory.create("UserSettingsResource",e);if(f.callUpdate({}),!c||this.extraData.facebookTimelineEnabled)return void(this.extraData.facebookTimelineEnabled=!this.extraData.facebookTimelineEnabled);d=null;break;case"twitterToggle":if(!(c&&!this.extraData.twitterUrl||!c&&this.extraData.twitterUrl))return;d=P.SocialConnect.TWITTER;break;case"gplusToggle":if(!(c&&!this.extraData.gplusUrl||!c&&this.extraData.gplusUrl))return;d=P.SocialConnect.GPLUS;break;case"googleToggle":if(!(c&&!this.extraData.connected_to_google||!c&&this.extraData.connected_to_google))return;d=P.SocialConnect.GOOGLE;break;case"yahooToggle":if(!(c&&!this.extraData.connected_to_yahoo||!c&&this.extraData.connected_to_yahoo))return;d=P.SocialConnect.YAHOO;break;case"rakutenToggle":if(!(c&&!this.extraData.connected_to_rakuten||!c&&this.extraData.connected_to_rakuten))return;d=P.SocialConnect.RAKUTEN;break;default:return}if(c||this.extraData.has_password)this.disconnectFromSocial(b,c,d);else{var g=this,h={name:"UserChangePassword",options:{has_password:!1,render_social_networks:!1}},i=!1;P.loadModule(h,function(a){g.showInModal(a),g.listen(a,"destroyed",function(){i?g.disconnectFromSocial(b,c,d):(P.showError(P._("A password must be set before unlinking.")),b.toggle())}),g.listen(a,"success",function(){i=!0})})}}}),goog.provide("P.modules.VerifyWebsite"),goog.require("P.Module"),P.modules.VerifyWebsite=P.Module.extend({}),goog.provide("P.modules.YourWebsiteDropdown"),goog.require("P.Module"),P.modules.YourWebsiteDropdown=P.Module.extend({}),goog.provide("P.modules.reg.ContextualSignup"),goog.require("P.Module");var CONTEXTUAL_TYPE_TO_KEY={pin:"pin_to_create",board:"board_to_follow",user:"user_to_follow"},STEPS=["wallStep","optionsStep","signupStep"],ALL_STEPS=STEPS.join(" ");P.modules.reg.ContextualSignup=P.Module.extend({onContentReady:function(){this.loginButton=this.getChildById("loginButton"),this.joinButton=this.getChildById("joinButton"),this.facebookConnectButton=this.getChildById("facebookConnectButton"),this.emailButton=this.getChildById("emailButton"),this.$signupForm=this.$(".csSignupForm"),this.options.starting_step&&this.setStep(this.options.starting_step),this.listen(this.joinButton,P.CONST.EVENT_BUTTON_CLICK,this.onJoinClick),this.listen(this.emailButton,P.CONST.EVENT_BUTTON_CLICK,this.onEmailClick),this.listen(this.facebookConnectButton,P.CONST.FACEBOOK_LOGIN_FAILURE,this.onFacebookLoginFailure),this.childListen(P.CONST.EVENT_USER_REGISTER,this.onRegisterSuccess),this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate),this.listen(this,P.CONST.EVENT_NAVIGATE,this.onChildNavigate),P.trackRegisterAction(this.data&&this.data.type?"contextual_signup_"+this.data.type:"contextual_signup_no_context"),P.trackRegisterAction("register_landing")},onRegisterSuccess:function(a){this.options.open_new_window_on_success&&(a.stopPropagation(),P.changeWindowLocation("/",!0),window.close()),this.options.next&&"/"===this.options.next.charAt(0)&&(a.stopPropagation(),window.location=this.options.next)},onChildNavigate:function(a){if(this.options.next&&a.data&&-1!==a.data.url.indexOf("/login/")){var b=P.getQueryStringParams();b.next=this.options.next,a.data.url="/login/?"+$.param(b)}},setStep:function(a){this.$el.removeClass(ALL_STEPS),this.$el.addClass(a)},onJoinClick:function(a){return a.stopPropagation(),this.options.redirect_to_signup?void(window.location.href=P.absolutify("/join/","https:")):(this.setStep("optionsStep"),void P.trackRegisterAction("contextual_signup_join"))},onEmailClick:function(a){a.stopPropagation(),this.showSignupForm({}),P.trackRegisterAction("contextual_signup_join_email")},getContextualItem:function(){if(!this.data)return{};if("pinnable"===this.data.type)return{pin_to_create_url:this.data.link,pin_to_create_image_url:this.data.url};var a={},b=CONTEXTUAL_TYPE_TO_KEY[this.data.type];return b&&(a[b]=this.data.id),a},onFacebookLoginFailure:function(a){var b=this,c=a.data;a.stopPropagation(),P.trackRegisterAction("contextual_signup_join_facebook"),this.facebookConnectButton.showLoading(),P.UserRegistration.fetchNetworkData(P.SocialConnect.FACEBOOK).then(function(a){b.log.debug("FB data:",a),b.facebookConnectButton.hideLoading();var d={image_url:a.image_url,first_name:a.first_name,last_name:a.last_name,gender:a.gender,email:a.email,social_username:a.username,facebook_id:c.facebook_id,facebook_token:c.facebook_token};b.showSignupForm({form:d,network:P.SocialConnect.FACEBOOK,show_username:!1,show_email:!1,show_name:!1,show_password:!1,show_country:!1,show_gender:!1,show_facebook:!0})})},showSignupForm:function(a,b){a.contextualItem=this.getContextualItem();var c=this,d=function(){c.signupForm.setOptions(a),c.signupForm.render(b||P.NOOP)};if(this.signupForm)d();else{var e={name:"reg.SignupForm",options:a};P.loadModule(e,function(a){c.signupForm=a,c.insertChild(a,c.$signupForm),c.setStep("signupStep"),c.$signupForm.show(),d()})}}}),goog.provide("P.modules.reg.ContextualSignupSenderInfo"),goog.require("P.Module"),P.modules.reg.ContextualSignupSenderInfo=P.Module.extend({}),goog.provide("P.modules.reg.SignupForm"),goog.require("P.Module"),P.modules.reg.SignupForm=P.Module.extend({onContentReady:function(){this.setupForm()},onAddedToDom:function(){this.$("form input").first().focus()},setupForm:function(){if(!this.form){var a={first_name:[P.Validator.Required()],email:[P.Validator.Required(),P.Validator.Email()],gender:[P.Validator.Required()]};this.options.show_password!==!1&&(a.password=[P.Validator.Password()]),this.form=new P.Form(this.$("form"),a,{insertErrorsBefore:!0}),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.submitButton=this.getChildById("submitButton"),this.options.network||this.submitButton.disable()}},showFields:function(a){_.each(a,function(a){var b=this.$("form input[name="+a+"]");b.parents(".hidden").removeClass("hidden")})},onSubmitValidated:function(a){if(!a.errors||!a.errors.length){var b=this,c=_.extend({},this.options.form,this.options.contextualItem,this.form.getData());this.submitButton.showLoading(),P.UserRegistration.register(this.options.network,c).done(function(a){b.log.debug("Signup success:",a),b.triggerEvent(P.CONST.EVENT_USER_REGISTER,{},!0)&&(window.location="/")}).fail(function(){b.showFields(["email"]),b.submitButton.hideLoading()})}}}),goog.provide("P.modules.ui.ImageCrop"),goog.require("P.Module"),P.modules.ui.ImageCrop=P.Module.extend({events:{"mousedown .drag":"onStartDrag","touchstart .drag":"onStartDrag"},onAddedToDom:function(){this._positionIfReady()},onContentReady:function(){_.defaults(this.options,{size:{width:222,height:150},padding:60}),this.$holder=this.$(".holder"),this.$bg=this.$(".bg"),this.$help=this.$(".help"),this.$frame=this.$(".frame"),this.$mask=this.$(".mask"),this.$spinner=this.$(".spinner"),this.$holder.show().css("height",this.options.size.height+2*this.options.padding),this.options.help_text&&this.$help.html(this.options.help_text),this._positionIfReady()},_positionIfReady:function(){if(!this._positioned&&this.inDom&&this.contentReady){this._positioned=!0;var a=this._frameBounds={left:this.$holder.width()/2-this.options.size.width/2,width:this.options.size.width,top:this.options.padding,height:this.options.size.height};a.ratio=a.height/a.width,this.$frame.css(a);var b=this.$mask.children();b.eq(0).css({top:0,left:0,right:0,height:a.top}),b.eq(1).css({top:a.top,left:a.left+a.width,right:0,height:a.height}),b.eq(2).css({top:a.top+a.height,left:0,right:0,bottom:0}),b.eq(3).css({top:a.top,left:0,width:a.left,height:a.height}),this.options.image_url&&this.setImage(this.options.image_url)}},initImage:function(){if(!this.$img.height()||!this.$img.width())return void _.delay(_.bindFn(this.initImage,this),200);var a=this._imageBounds={nativeWidth:this.$img.width(),nativeHeight:this.$img.height()};a.ratio=a.nativeHeight/a.nativeWidth,this.$img.addClass("in"),this._fitImage(),this._centerImage(),this._hideSpinner()},onStartDrag:function(a){var b="touchstart"===a.type;this._mousePosition=b?{x:a.originalEvent.touches[0].pageX,y:a.originalEvent.touches[0].pageY}:{x:a.pageX,y:a.pageY},this._startPosition={x:parseInt(this.$bg.css("left"),10),y:parseInt(this.$bg.css("top"),10)},$("body").on({"mousemove.ui-ImageCrop touchmove.ui-ImageCrop":_.bindFn(this.onDragging,this),"mouseup.ui-ImageCrop touchend.ui-ImageCrop":this.onStopDragging}),a.preventDefault()
},onDragging:function(a){a.preventDefault();var b="touchmove"===a.type,c=b?a.originalEvent.changedTouches[0]:a,d=c.pageX-this._mousePosition.x,e=c.pageY-this._mousePosition.y,f={top:this._startPosition.y+e,left:this._startPosition.x+d};this._clampValues(f),this.$bg.css(f)},onStopDragging:function(){$("body").off("mousemove.ui-ImageCrop mouseup.ui-ImageCrop touchmove.ui-ImageCrop touchend.ui-ImageCrop")},_clampValues:function(a){a.top=Math.min(a.top,this._frameBounds.top),a.left=Math.min(a.left,this._frameBounds.left),a.top+this._imageBounds.height<this._frameBounds.top+this._frameBounds.height&&(a.top=this._frameBounds.top+this._frameBounds.height-this._imageBounds.height+1),a.left+this._imageBounds.width<this._frameBounds.left+this._frameBounds.width&&(a.left=this._frameBounds.left+this._frameBounds.width-this._imageBounds.width+1)},setImage:function(a){this._showSpinner();var b=this.$img=$("<img>",{src:a});this.$bg.empty().append(b),this.initImage()},_fitImage:function(){var a;a=this._imageBounds.ratio>=this._frameBounds.ratio?this._frameBounds.width/this._imageBounds.nativeWidth:this._frameBounds.height/this._imageBounds.nativeHeight,this._scaleImage(a)},_centerImage:function(){var a=this.$holder.height(),b=this.$holder.width();this.$bg.css({top:a/2-this.$bg.height()/2+1,left:b/2-this.$bg.width()/2+1})},_scaleImage:function(a){var b=this._imageBounds.width=this._imageBounds.nativeWidth*a,c=this._imageBounds.height=this._imageBounds.nativeHeight*a;this.$img.css({width:b,height:c})},_showSpinner:function(){this.$spinner.show()},_hideSpinner:function(){this.$spinner.hide()},getCropData:function(){var a={x:-1*(parseInt(this.$bg.css("left"),10)-this._frameBounds.left),y:-1*(parseInt(this.$bg.css("top"),10)-this._frameBounds.top)},b=this.$img.width()/this._imageBounds.nativeWidth,c={crop_x:a.x,crop_y:a.y,nativeHeight:this._imageBounds.nativeHeight,nativeWidth:this._imageBounds.nativeWidth,height:this.options.size.height,width:this.options.size.width,scale:b};return c}}),goog.provide("P.modules.ui.ImageUploader"),goog.require("P.Module");var IMAGE_UPLOADER_CLASS_SELECTED="selected";P.modules.ui.ImageUploader=P.Module.extend({onCreated:function(){this.onUploaderSubmit=_.bindFn(this.onUploaderSubmit,this),this.onUploaderComplete=_.bindFn(this.onUploaderComplete,this),this.onUploaderProgress=_.bindFn(this.onUploaderProgress,this),this.onUploaderError=_.bindFn(this.onUploaderError,this)},enable:function(){this.getButton().enable()},disable:function(){this.getButton().disable()},select:function(){this._setSelected(!0)},_setSelected:function(a){this.$el.toggleClass(IMAGE_UPLOADER_CLASS_SELECTED,a)},deselect:function(){this._setSelected(!1)},onContentReady:function(){this.ensureUploader()},getUploadUrl:function(){return P.absolutify("/upload-image/")},getFileNameElement:function(){return this.$fileName||(this.$fileName=this.$(".uploaderProgress").find("span")),this.$fileName},getButton:function(){return this.getChildById("upload")},ensureUploader:function(){if(this.uploader)return this.uploader;var a=this;return this.uploader=new qq.FineUploaderBasic({debug:P.DEBUG,button:this.getButton().$el.get(0),multiple:!1,request:{endpoint:this.getUploadUrl(),inputName:"img",forceMultipart:!0,customHeaders:{"X-CSRFToken":P.csrf.getCSRFToken()}},callbacks:{onUpload:this.onUploaderSubmit,onComplete:this.onUploaderComplete,onProgress:this.onUploaderProgress,onError:this.onUploaderError,showAlert:function(b){a.log.debug(b)}}}),this.uploader},onUploaderSubmit:function(){this.getButton().showLoading(),this.triggerEvent(P.CONST.EVENT_UPLOAD_START),this.log.debug("UploaderSubmit",arguments)},onUploaderComplete:function(a,b,c){c.success&&(this.getButton().hideLoading(),this.getButton().setStyles({primary:!1}),this.triggerEvent(P.CONST.EVENT_UPLOAD_SUCCESS,c,!0),this.getFileNameElement().text(c.filename),this.log.debug("UploaderComplete",arguments))},onUploaderProgress:function(a,b,c,d){var e=Math.round(c/d*100);this.triggerEvent(P.CONST.EVENT_UPLOAD_PROGRESS,{loaded:c,total:d,percent:e}),this.getFileNameElement().text(e+"%"),this.log.debug("UploaderProgress",arguments)},resetFileNameElement:function(){this.getFileNameElement().text("")},onUploaderError:function(a,b,c){this.getButton().hideLoading(),this.triggerEvent(P.CONST.EVENT_UPLOAD_ERROR,c),this.log.debug("UploaderError",arguments),P.showError(c),this.resetFileNameElement()}}),goog.provide("P.modules.ui.PinPreview"),goog.require("P.Module"),P.modules.ui.PinPreview=P.Module.extend({setImage:function(a){var b=this;this.showLoading(!0);var c=function(){b.hideLoading()},d=this.$("img").get(0);d&&(d.onerror=d.onload=c,d.src=a)}}),goog.provide("P.modules.ui.SearchForm"),goog.require("P.Module"),P.modules.ui.SearchForm=P.Module.extend({events:{"submit > form":"onSubmit",click:"onClick"},onChildItemSelected:function(a){var b=a.data.item,c=b.get("query")||"";P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,c);var d=b.get("url");return d?(this.options.navigate_on_search&&this.navigate(d),this.typeaheadField.blur(),!1):void 0},onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,a[P.CONST.PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED]=this.onSearchScopeUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,a),this.typeaheadField=this.getChildById("searchField"),this.selectedListener=this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.options.masthead_centered&&(this.childListen(P.CONST.EVENT_FOCUS,this.onFocus),this.childListen(P.CONST.EVENT_BLUR,this.onBlur),this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.onContentChanged),this.listen(P.Viewport,P.CONST.EVENT_RESIZE,this.onResize),this.typeaheadField.alignCenter())},onFocus:function(){this.$el.addClass("focus"),this.typeaheadField.alignLeft(),this._setOverflowShim("visible")},onBlur:function(){this.$el.removeClass("focus"),this.typeaheadField.alignCenter(),this._setOverflowShim("hidden")},onResize:function(){this.$el.hasClass("focus")||this.typeaheadField.alignCenter()},_setOverflowShim:function(a){var b=window.navigator.userAgent.match(/(G|g)ecko/gi),c=b&&b.length;if(c){var d=this;setTimeout(function(){d.$el.css("overflow",a)},300)}else this.$el.css("overflow",a)},onContentChanged:function(){this.$el.hasClass("focus")||this.typeaheadField.alignCenter()},onSearchQueryUpdated:function(a,b,c){var d=c||"";this.setTypeaheadValue(d)},onSearchScopeUpdated:function(a,b,c){var d=c||"pins";this.currentScope=d,this.typeaheadField.setAutocompleteScope(d)},setTypeaheadValue:function(a){this.typeaheadField.setValue(a)},_getTypeaheadHighlightedItem:function(){return this.typeaheadField.getTypeaheadHighlightedItem()},focus:function(){this.typeaheadField.focus()},onSubmit:function(){var a=this._getTypeaheadHighlightedItem();if(a)return!1;var b=this.typeaheadField.getValue();if(""===$.trim(b))return!1;var c=encodeURIComponent(b),d=this.currentScope||this.options.scope||"pins";return this.typeaheadField.setAutocompleteScope(d),this.options.navigate_on_search&&this.navigate("/search/"+d+"/?q="+c),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,b),this.typeaheadField.blur(),this.typeaheadField.abortSearch(),!1},onClick:function(){this.focus()}}),goog.provide("P.modules.ui.Typeahead"),goog.require("P.Module"),goog.require("P.modules.ui.TypeaheadBase"),P.modules.ui.Typeahead=P.modules.ui.TypeaheadBase.extend({}),goog.provide("P.modules.BoardInvites"),goog.require("P.Module"),goog.require("P.modules.BoardInvite"),P.modules.BoardInvites=P.Module.extend({onContentReady:function(){if(!this.options.pending){var a=this.resource.options.board_id,b={};b[P.CONST.PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE]=this.onApprovedCollaboratorInvite,this.pubsubSubscribe(a,b)}this.childListen(P.CONST.EVENT_BOARD_CREATE_USER_REMOVED,this.onInviteRemoved),this.selectedUserIds=[],this.selectedEmails=[]},getSelectedUserIds:function(){return this.selectedUserIds},hasSelectedUser:function(a){return _.contains(this.selectedUserIds,a)},_prependUserToTop:function(a){var b,c=this.options.view_type;"boardCreate"===c?(b={resource:{name:"UserResource",options:{user_id:a,field_set_key:"board_invite"}},options:{view_type:"boardCreate",user_id:a}},this.selectedUserIds.push(a)):b={resource:{name:"BoardInviteResource",options:{board_id:this.resource.options.board_id,invited_user_id:a,field_set_key:"boardEdit"}}};var d=new P.modules.BoardInvite(b),e=this.getChildById("boardInvitesPagedGrid");d.render(function(){e.prependChildItem(d)})},addUserInvite:function(a){var b=this;if(this.hasSelectedUser(a)){var c={name:"ConfirmDialog",options:{message:P._("That user has already been invited to pin on this board!")}};P.loadModule(c,function(a){b.showInModal(a)})}else this._prependUserToTop(a)},onApprovedCollaboratorInvite:function(a,b,c){this.addUserInvite(c.userId)},onInviteRemoved:function(a){a.data.user_id?this.selectedUserIds=_.without(this.selectedUserIds,a.data.user_id):a.data.email&&(this.selectedEmails=_.without(this.selectedEmails,a.data.email))},getSelectedEmails:function(){return this.selectedEmails},hasSelectedEmail:function(a){return _.contains(this.selectedEmails,a)},addEmailInvite:function(a){var b=this.getChildById("boardInvitesPagedGrid"),c=this,d=new P.modules.BoardInvite({options:{view_type:"email",email:a}});if(this.hasSelectedEmail(a)){var e={name:"ConfirmDialog",options:{message:P._("That email has already been invited to pin on this board!")}};P.loadModule(e,function(a){c.showInModal(a)})}else this.selectedEmails.push(a),d.render(function(){b.prependChildItem(d)})}}),goog.provide("P.modules.BoardPickerBase"),goog.require("P.Module"),goog.require("P.modules.PositionModule");var BOARD_COLLAB_ATTR="data-collaborative",BOARD_PLACE_ATTR="data-place",BOARD_ID_ATTR="data-id",BOARD_PRIVACY_ATTR="data-privacy",BOARD_SUGGESTION_ATTR="data-suggestion",CLASS_ACTIVE="active",CLASS_VISIBLE="visible";P.modules.BoardPickerBase=P.Module.extend({events:{"click .boardPickerOuter":"onOuterClick","click .boardPickerItem":"onItemClick","keydown .createBoardName":"onCreateBoardKeydown"},onCreateBoardKeydown:function(a){var b=P.keyCode;return a.keyCode===b.ENTER?(this.createBoard(),!1):void 0},onButtonClick:function(a){var b=a.target;b&&"createBoard"===b.id&&this.createBoard()},onCreated:function(){this.$boardOuter=null,this.$boardMenuWrapper=null,this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onItemClick:function(a){var b=$(a.target),c=b.attr(BOARD_SUGGESTION_ATTR);if(c)return this.createBoard(c),void a.stopImmediatePropagation();var d=b.attr(BOARD_ID_ATTR);if(!d)return void a.stopImmediatePropagation();this._selectedBoardId=d;var e=b.text(),f=b.attr(BOARD_PRIVACY_ATTR),g=!!b.attr(BOARD_COLLAB_ATTR),h="True"===b.attr(BOARD_PLACE_ATTR);this.setSelectedBoard(d,e,f,g,h),this.triggerEvent(P.CONST.EVENT_BOARD_SELECTED,{privacy:f},!0),this.closeMenu()},createBoard:function(a){function b(a){P.showError(a.message)}function c(a){if(a){var c=a.resource_response;if(c&&!c.error&&c.data&&c.data.url){var d=c.data;return g.options.default_board_id=d.id,g.render(),g.triggerEvent(P.CONST.EVENT_BOARD_SELECTED,null,!0),g.triggerEvent("boardCreated",d,!0),void P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_CREATED,d)}}b(a)}var d=this.getChildById("createBoard"),e=a||this.$(".createBoardName").val(),f=P.resourceFactory.create("BoardResource",{name:e}),g=this;d.showLoading(),f.callCreate({success:c,error:b,complete:function(){d.hideLoading()}})},getSelectedBoardName:function(){return this.$(".currentBoardName").text()},getPrivacy:function(){return this.$(".currentBoard").attr(BOARD_PRIVACY_ATTR)},getCollaborative:function(){return!!this.$(".currentBoard").attr(BOARD_COLLAB_ATTR)},getBoardCount:function(){return this.extraData.num_boards||0},setSelectedBoardAttributes:function(a,b,c){var d=$(".currentBoard",this.$boardOuter);d.attr(BOARD_PRIVACY_ATTR,a),d.attr(BOARD_COLLAB_ATTR,b),d.attr(BOARD_PLACE_ATTR,c)},setSelectedBoardIcons:function(a,b,c){var d=$(".currentBoard",this.$boardOuter),e=d.find(".secretIcon"),f=d.find(".collaborativeIcon"),g=d.find(".placeIcon"),h="hidden";e.toggleClass(h,!a),f.toggleClass(h,!b),g.toggleClass(h,!c)},setSelectedBoard:function(a,b,c,d,e){var f=this,g=$(".currentBoard",this.$boardOuter),h=d,i="secret"===c;this._selectedBoardId=a,this.setSelectedBoardAttributes(c,d,e),this.setSelectedBoardIcons(i,h,e),g.attr(BOARD_ID_ATTR,f._selectedBoardId),$(".currentBoardName",g).text(b)},onContentReady:function(){P.Module.prototype.onContentReady.apply(this,arguments),this.$boardOuter=this.$(".boardPickerOuter"),this.$boardMenuWrapper=this.$(".boardPickerInnerWrapper"),this.$(".createBoardName").placeholder(),this._selectedBoardId=this.$boardOuter.attr(BOARD_ID_ATTR)},onOuterClick:function(a){this.options.disabled||(this.noBoardsTooltip&&(this.noBoardsTooltip.destroy(),this.noBoardsTooltip=null),this._selectedBoardId=$(a.target).attr(BOARD_ID_ATTR),this.openMenu())},openMenu:function(){var a=this,b=$("<div></div>").addClass("boardPickerMask");this.$el.append(b);var c=this._selectedBoardId||this.$(".currentBoard").attr(BOARD_ID_ATTR),d=this.$(".boardPickerInner").find("["+BOARD_ID_ATTR+"="+c+"]");d.addClass(CLASS_ACTIVE),b.on("click.boardpicker",function(b){a.closeMenu(),b.stopPropagation(),b.stopImmediatePropagation()}),this.$boardMenuWrapper.addClass(CLASS_VISIBLE)},closeMenu:function(){var a=$(".boardPickerMask");a.off("click.boardpicker"),a.detach(),this.$(".boardPickerInner").find("."+CLASS_ACTIVE).removeClass(CLASS_ACTIVE),this.$boardMenuWrapper.removeClass(CLASS_VISIBLE)},getSelectedBoardId:function(){return $(".currentBoard",this.$boardOuter).attr(BOARD_ID_ATTR)},showNoBoardsTooltip:function(a){if(a.length){var b={name:"Dropdown",options:{anchor:a,class_name:"large aboveModal",fixed:!0,position_point:"TOP_CENTER",text:P._("<strong>You collect your Pins on boards</strong> so everything's nice and organized.")}},c=this;P.loadModule(b,function(a){var b=a;c.noBoardsTooltip=b,b.render(function(){c.appendChild(b),b.positionModule(),b.fadeIn()})})}}}),goog.provide("P.modules.Dropdown"),goog.require("P.modules.PositionModule");var CLASS_DROPDOWN_ACTIVE="active",DROPDOWN_CONTAINER_CLASS="dropdownContainer",DROPDOWN_MODULE_ID="dropdownModule";P.modules.Dropdown=P.modules.PositionModule.extend({onCreated:function(){P.modules.PositionModule.prototype.onCreated.apply(this,arguments),this.showing=!1,this.childListen(P.CONST.EVENT_DISMISS,this.hide),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE,this.hide),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE_NOT_PROPAGATE,this.hideWithoutTriggering),this.childListen(P.CONST.EVENT_NAVIGATE,this.hide),this.childListen(P.CONST.EVENT_EXTERNAL_CLICK,this.hide),this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.positionModule)},_positionIfReady:function(){this.inDom&&this.contentReady&&(this.positionModule(),this.ensureHoverIntent(),this.getPositionAnchor().initHovering())},onAdded:function(){this.options.prefetch&&(this.options.prefetch=!1,this.render())},onAddedToDom:function(){this._positionIfReady()},onContentReady:function(){this._positionIfReady()},getLoadingSpinnerOptions:function(){return _.extend(P.modules.PositionModule.prototype.getLoadingSpinnerOptions.call(this),{size:P.Spinner.Size.SMALL})},render:function(a){this.renderContainer();var b=this.$el;this.options.append_to_closeup?$(".Closeup").append(b):$("body").append(b);var c=_.bindFn(function(){this.contentReady=!0,this.onContentReady(),a&&a()},this),d=this.getPositionElement();this.options.title&&d.append('<h2 class="dropdownTitle">'+this.options.title+"</h2>"),this.options.text&&d.append('<p class="dropdownText">'+this.options.text+"</p>"),this.options.module?P.loadModule(this.options.module,_.bindFn(function(a){a.id=DROPDOWN_MODULE_ID,this.insertChild(a,this.getPositionElement()),a.render(c),this.options.display_while_loading&&c()},this)):c(),this.triggerEvent(P.CONST.EVENT_DROPDOWN_SHOW,null,!0)},setSticky:function(a){var b=_.clone(this.options);b.sticky=a,this.setOptions(b)},ensureHoverIntent:function(){var a=this;this.parent.isClickButton&&!this.parent.isClickButton()&&(this._hoverIntent||this.options.manually_close||(this._hoverIntent=new P.HoverIntent(this.$el,{exitDelay:500}),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE,function(){a.getPositionAnchor().isHovering()||a.hide()})))},_hide:function(){this.showing=!1,this.$el.removeClass(CLASS_DROPDOWN_ACTIVE),this._bodyListener&&(this.removeListener(this._bodyListener),this._bodyListener=null)},hideWithoutTriggering:function(){this._hide()},hide:function(){if(this._hide(),this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0),this.children.length){var a=this.children[0];a.trigger(P.CONST.EVENT_DROPDOWN_CONTAINER_HIDDEN,null)}},ensureModule:function(a){var b=this;return a=a||P.NOOP,this.rendering||this.getChildById(DROPDOWN_MODULE_ID)?a():(this.rendering=!0,void this.render(function(){return b.rendering=!1,a()}))},ensureOpenListeners:function(){this.options.sticky||(this._bodyListener=this.listen($("body"),"mousedown",function(a){$(a.target).closest(this.$el).length>0||$(a.target).closest(this.options.anchor).length>0||this.options.preserve_dropdown_on_body_mousedown||this.hide()}))},updateMaxHeight:function(){if(this.children.length){var a=this.children[0];if(this.options.constrain_height){var b=a.getHeight(!0),c=parseInt(this.$el.css("top"),10)||0,d=Math.max(P.Viewport.height-c-P.CONST.PIN_MARGIN,0);b>d&&a.getContent().css({"max-height":d,"overflow-y":"auto"})}}},show:function(a){this.showing=!0;var b=this;this.ensureOpenListeners(),this.ensureModule(function(){if(b.showing){if(b.$el.addClass(CLASS_DROPDOWN_ACTIVE),b.positionModule(),b.updateMaxHeight(),b.children.length){var c=b.children[0];c.trigger(P.CONST.EVENT_DROPDOWN_CONTAINER_SHOWN,null)}a&&a()}b.triggerEvent(P.CONST.EVENT_DROPDOWN_SHOW,null,!0)})},fadeIn:function(a,b){var c=this;this.show(function(){c.$el.addClass("fadeIn"),b&&b()})},getDropdown:function(){return this.$("."+DROPDOWN_CONTAINER_CLASS)},isVisible:function(){return this.$el.hasClass(CLASS_DROPDOWN_ACTIVE)},setVisible:function(a){return this.$el.toggleClass(CLASS_DROPDOWN_ACTIVE,a)},isHovering:function(){return this.$el.isHovering()},initHovering:function(){this.$el.initHovering()},getContentModule:function(){return this.children[0]}}),goog.provide("P.modules.DropdownButton"),goog.require("P.Module"),goog.require("P.modules.ButtonBase"),goog.require("P.modules.Dropdown");var TUTORIAL_DROPDOWN="tutorialDropdown",CLICK="click",HOVER="hover",OPEN_STRATEGY={};OPEN_STRATEGY[CLICK]=CLICK,OPEN_STRATEGY[HOVER]=HOVER,P.modules.DropdownButton=P.Module.extend({events:{click:"onClick","click .Button":"onChildButtonClick"},handleClick:function(a){if(this.openStrategy===HOVER)return!1;var b=this._dropdown.isVisible();b?this.hideDropdown():this.showDropdown(),a.stopPropagation(),a.stopImmediatePropagation()},onChildButtonClick:function(a){a.preventDefault()},_handleLinkClick:function(){},onClick:function(a){this.handleClick(a)},setHighlight:function(a){this.$el.toggleClass(P.CONST.CLASS_BUTTON_HIGHLIGHTED,a)},getDropdown:function(){return this.getChildById("dropdown")},getDropdownOptions:function(){return this.options.dropdown_options||{}},getDropdownModule:function(){return this.options.module},ensureDropdown:function(){if(this.getDropdown())return this._dropdown;var a,b=this.options.anchor_selector;b&&(a="."+b);var c={module:this.getDropdownModule(),anchor:a?a:this.$el};_.map(this.getDropdownOptions(),function(a,b){c[b]=a}),this._dropdown=new P.modules.Dropdown({options:c,id:"dropdown"}),this.listen(this._dropdown,P.CONST.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.addChild(this._dropdown)},onMouseEnterComplete:function(){this.isHoverEnabled()&&this.$el.isHovering()&&this.showDropdown()},getButton:function(){return this.getChildById("button")},showDropdown:function(a){this.setActiveStyle(!0),this.hideTutorial(),this._dropdown.show(a)},hideDropdown:function(){this.setActiveStyle(!1),this._dropdown.hide()},isDropdownVisible:function(){return this._dropdown.isVisible()},onMouseOutComplete:function(){this._dropdown.isHovering()||this.hideDropdown()},initListeners:function(){var a=this;this.openStrategy!==CLICK&&(!this._hoverIntent||this._hoverIntent.isElement(this.$el))&&(this._hoverIntent=new P.HoverIntent(this.$el,{enterDelay:5,exitDelay:200}),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_ENTER_COMPLETE,function(){a.onMouseEnterComplete()}),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE,function(){a.onMouseOutComplete()}))},onButtonClick:function(a){a.stopPropagation()},onContentReady:function(){this.ensureDropdown(),this.$el.initHovering(),this._dropdown.initHovering(),this.openStrategy=this.options.show_dropdown_on_hover?OPEN_STRATEGY[HOVER]:OPEN_STRATEGY[CLICK],this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_TUTORIAL_SHOW,this.showTutorial),this.initListeners(),this.options.tutorial&&this.options.tutorial.topic&&this.options.tutorial.show&&this.showTutorial()},onDropdownHide:function(){this.setActiveStyle(!1)},ensureTutorialDropdown:function(){if(!this.getChildById(TUTORIAL_DROPDOWN)){var a=_.extend({},this.options.dropdown_options,{title:this.options.tutorial.title,text:this.options.tutorial.text,anchor:this.$el,class_name:"tutorial",largeCaret:!1}),b=new P.modules.Dropdown({id:TUTORIAL_DROPDOWN,options:a});this.appendChild(b)}return this.getChildById(TUTORIAL_DROPDOWN)},onShowTutorial:function(){this.showTutorial()},isClickButton:function(){return this.openStrategy===CLICK},showTutorial:function(){if(this.options.tutorial){var a=this.ensureTutorialDropdown();a.fadeIn(1e3),this.setExperienceViewed()}},hideTutorial:function(){if(this.options.tutorial){var a=this.getChildById(TUTORIAL_DROPDOWN);a&&a.destroy(),this.setExperienceCompleted()}},setExperienceViewed:function(){if(this.options.tutorial.experienceId&&this.options.tutorial.placementId){var a=P.ExperienceManager.instance();a.viewPlacedExperience(this.options.tutorial.placementId,this.options.tutorial.experienceId)}},setExperienceCompleted:function(){if(this.options.tutorial.experienceId&&this.options.tutorial.placementId){var a=P.ExperienceManager.instance();a.completePlacedExperience(this.options.tutorial.placementId,this.options.tutorial.experienceId)}},setActiveStyle:function(a){var b=this.getChildByModuleName("Button");b?b.setActiveStyle(a):this.$el.toggleClass(P.CONST.CLASS_DROPDOWN_BUTTON_ACTIVE,a)},isHoverEnabled:function(){return(!this.options.button_options||this.options.button_options.disabled!==!0)&&this.openStrategy!==CLICK},moduleRenderer:new P.ModuleRendererLocal("app/common/modules/DropdownButton/DropdownButton.nunjucks")}),goog.provide("P.modules.GplusConnectButton"),goog.require("P.Module"),goog.require("P.modules.Button");var GPLUS_LOGIN_FAIL=P._("Oops! Log in with your Pinterest email and password first, then follow <a href='{{ help_link }}'>these instructions</a> to link your account to Google+."),GPLUS_ACCOUNT_NOT_LINKED=180,GPLUS_REDIRECT_URI="postmessage",SIGNUP_ACTION="signup";P.modules.GplusConnectButton=P.modules.Button.extend({onContentReady:function(){var a=this;this.readyForConnect=!1,P.gapi.get(function(b){b.signin.render(a.$el.get(0),{scope:a.extraData.gplusScope,clientid:a.extraData.gplusClientId,apppackagename:a.extraData.gplusAppPackageName,redirecturi:GPLUS_REDIRECT_URI,accesstype:"offline",cookiepolicy:"single_host_origin",callback:function(b){a.readyForConnect&&a.onSignInCallback(b),a.readyForConnect=!0}})})},onSignInCallback:function(a){var b=this,c=function(){b.showLoading(),b.onLoginSuccess(a)},d=function(c){b.onLoginError(c,a)},e={gplus_id_token:a.id_token},f=a.status;P.trackRegisterAction("register_gplus_attempt"),f.signed_in&&P.currentUser.login(e,c,d)},onLoginSuccess:function(){window.location.reload()},onLoginError:function(a,b){if(a.api_error_code===GPLUS_ACCOUNT_NOT_LINKED){var c=P.string.format(GPLUS_LOGIN_FAIL,{help_link:this.extraData.gplusErrorLink});P.showHtmlError(c)}else this.options.action===SIGNUP_ACTION&&(P.SessionStorage.setItem(P.CONST.SESSION_GPLUS_CODE,b.code),P.SessionStorage.setItem(P.CONST.SESSION_GPLUS_REDIRECT_URI,GPLUS_REDIRECT_URI),P.navigate("/join/register/gplus/"))}}),goog.provide("P.modules.Grid"),goog.require("P.Module"),goog.require("P.modules.GridFooter"),goog.require("P.modules.GridItems");var ERROR_CLASS="hasError";P.modules.Grid=P.Module.extend({events:{"click .gridFooter .gridError .Button":"onTryAgainClick"},onContentReady:function(){this.options.show_grid_footer&&(this.childListen(P.CONST.EVENT_ERROR,this.onError),this.childListen(P.CONST.EVENT_ERROR_RESOLVED,this.onErrorResolved),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_ITEMS_REQUEST_START,this.onItemsRequestStart),this.childListen(P.CONST.EVENT_ITEMS_REQUEST_SUCCESS,this.onItemsRequestSuccess),this.childListen(P.CONST.EVENT_ITEMS_END,this.onItemsEnd)),this.items=this.getChildByModuleName("GridItems"),this.footer=this.getChildByModuleName("GridFooter"),this.footer&&this.hasItems()&&this.footer.show()},onResize:function(){this.items.onResize()},hasItems:function(){return this.items.hasItems()},hasItemsOfType:function(a){return!!this.items.getChildrenByModuleName(a).length},hasMoreItems:function(){return this.items.hasMoreItems()},getGridItemsChildren:function(){var a=this.getGridItems();return a.getChildren()},requestMoreItems:function(){this.items.requestMoreItems()},emptyItems:function(){this.items.empty()},renderItems:function(a,b){this.items.render(a,b)},setPageSize:function(a){this.items.setPageSize(a)},getItemsResource:function(){return this.items.resource},setItemsResource:function(a){this.setResource(a),this.items&&this.items.setResource(a)},onError:function(){this.hasError=!0,this.$el.addClass(ERROR_CLASS),this.footer&&(this.footer.showError(),this.footer.hideGridLoading())},onErrorResolved:function(){this.hasError&&(this.hasError=!1,this.$el.removeClass(ERROR_CLASS))},onButtonClick:function(){return this.requestMoreItems(),!1},onItemsRequestStart:function(){this.footer&&this.footer.showGridLoading()},onItemsRequestSuccess:function(){this.footer&&this.footer.hideError()},onItemsEnd:function(){this.footer&&this.footer.hideGridLoading()},prependChildItem:function(a){this.getGridItems().prependChildItem(a)},prependNewItems:function(a,b){return this.getGridItems().prependNewItems(a,b)},getGridItems:function(){return this.items},getFirstGridItem:function(a){return this.getGridItems().getChildByModuleName(a)}}),goog.provide("P.modules.Modal"),goog.require("P.interfaces.Modal"),goog.require("P.Module"),goog.require("P.modules.PositionModule");var SHOW_CLASS="show";P.modules.Modal=P.modules.PositionModule.extend({events:{"click .modalScroller":"onModalScrollerClick","click .modalContainer":"onModalContainerClick","click .closeModal":"onCloseModalClick"},positionMode:P.CONST.PositionMode.VIEWPORT_MIDDLE,onCreated:function(){P.modules.PositionModule.prototype.onCreated.call(this),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onChildButtonClick)},render:function(a){this.empty();var b=this.options.mask_type||"",c=this.options.container_class||"";this.options.fullscreen&&(c+=" fullscreen"),this.options.is_mobile&&window.scrollTo(0,0),this.$el.append('<div class="modalMask '+b+'"></div><div class="modalScroller"><div class="modalContainer '+c+'"><span class="positionModuleCaret"></span><div class="modalContent"><div class="modalModule"></div></div></div></div>'),this.getCanDismiss()&&this.$(".modalContent").append('<button class="Button ButtonBase closeModal inModal cancelButton borderless"><em></em>&nbsp;</button>');var d=this.getModule();return d&&(this.addModuleToContainer(d),d.options.transparent_modal&&this.setTransparentContent()),a&&a.call(this),P.Promise.resolve(null)},addModuleToContainer:function(a){var b=this;a.id="modalModule",a.errorStrategy=P.CONST.ErrorStrategy.SHOW,this.insertChild(a,this.getModuleContainer()),a.contentReady?this.setupModule(a):(a.render(function(){b.setupModule(a)}),this.listen(a,P.CONST.EVENT_ERROR,function(a){var c=P.string.common.defaultErrorMessage;b.options.show_api_error&&a.data.message&&(c=a.data.message),P.showError(c),b.hide()}))},onChildRendered:function(a){this.setupModule(a)},setupModule:function(a){a.setModal(this),this.onRendered(),this.onContentReady()},show:function(){var a=this;this.render(function(){a.log.debug("success")})},hide:function(){this.destroy()},onAddedToDom:function(){P.Body.pushScrolling(!1)},onRemovedFromDom:function(){P.Body.pop()},getModule:function(){return this.options.module},getMinVerticalPadding:function(){return this.options.fullscreen?0:P.modules.PositionModule.prototype.getMinVerticalPadding.apply(this)},setFullscreenContent:function(a){if(a){var b=this.getContent();b.css({height:"100%",transform:"none"})}},setTransparentContent:function(a){this.getContent().toggleClass("transparent",a);var b=this.options.show_close_button;b&&(a=!1),this.$(".closeModal").toggle(!a)},getContent:function(){return this.$(".modalContent")},getModuleContainer:function(){return this.$(".modalModule")},getFullName:function(){var a=P.Module.prototype.getFullName.call(this);return this.moduleOpener&&(a=this.moduleOpener.getFullName()+"#"+a),a},getPositionElement:function(){return this.$(".modalContainer")},setModule:function(a){var b=this.getChildById("modalModule");b&&(b.id="",b.remove()),this.options.module=a,b=this.$(".modalModule"),b.empty(),this.addModuleToContainer(a)},onChildRemoved:function(){this.getChildById("modalModule")||this.hide()},onChildButtonClick:function(a){var b=a.target;if(b&&b.isCancelButton()){var c=this.options.module,d=c.GACategory;d||(d=c.options.ga_category),d&&P.trackGAEvent(d,P.CONST.GA_ACTION_CLICK_CANCEL),a.stopPropagation(),this.hide()}},onModalScrollerClick:function(a){a.target===a.currentTarget&&(a.stopPropagation(),this.getCanDismiss()&&this.hide())},onModalContainerClick:function(a){a.target===a.currentTarget&&(a.stopPropagation(),this.onModalScrollerClick(a))},onCloseModalClick:function(){this.triggerEvent(P.CONST.EVENT_DISMISS,null,!1),this.destroy()},onRendered:function(){var a=this.$el;this.options.fullscreen?(this.setFullscreenContent(!0),a.css({"margin-top":0})):this.positionModule(),a.addClass(SHOW_CLASS),this.options.transparent&&this.setTransparentContent(!0),P.modules.PositionModule.prototype.onRendered()},getCanDismiss:function(){var a=this.options.can_dismiss;return void 0===a||a}}),goog.provide("P.modules.OAuthAuthorizationPage"),goog.require("P.modules.OAuthPageBase"),P.modules.OAuthAuthorizationPage=P.modules.OAuthPageBase.extend({onContentReady:function(){this.tryRedirect(this.data),this.form=new P.Form(this.$("form"),{}),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.authorizeConsumer),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(a){return"cancelButton"===a.target.id?this.cancelAuthorization():void 0},authorizeConsumer:function(){var a=this.getChildById("submitButton");a.showLoading(),this.makeAuthorizationDecision(!0,a)},cancelAuthorization:function(){var a=this.getChildById("cancelButton");a.showLoading(),this.makeAuthorizationDecision(!1,a)}}),goog.provide("P.modules.PinLikeButtonBase"),goog.require("P.Module"),goog.require("P.modules.Button");var CLASS_UNLIKE="unlike";P.modules.PinLikeButtonBase=P.modules.Button.extend({onClick:function(){this.ensureAuthentication()&&this._toggle()},getAuthRedirectUrl:function(){return P.getRegisterUrl({action:"like"})},setState:function(a){var b=this.$el;this.options.liked=a,a?(b.addClass(CLASS_UNLIKE),this.$(".buttonText").html(b.data("text-unlike"))):(b.removeClass(CLASS_UNLIKE),this.$(".buttonText").html(b.data("text-like")))},getPinLikeResource:function(){var a="PinLikeResource2";return P.resourceFactory.create(a,{pin_id:this.options.pin_id})},_toggle:function(){var a,b,c;this.options.liked?(a="pin_unlike",b="delete",c=P.CONST.PUBSUB_TOPIC_PIN_UNLIKED):(a="pin_like",b="create",c=P.CONST.PUBSUB_TOPIC_PIN_LIKED),P.trackGAEvent(a,P.CONST.GA_ACTION_CLICK);
var d=this,e=this.getPinLikeResource();this.showLoading(),e.call(b,{success:function(){P.trackGAEvent(a,P.CONST.GA_ACTION_SUCCESS),d.setState(!d.options.liked),P.pubsub.publish(d.options.pin_id,c)},complete:function(){d.hideLoading()}})}}),goog.provide("P.modules.tutorials.ModalStepBase"),goog.require("P.interfaces.ModalTutorialStep"),goog.require("P.Module"),goog.require("P.modules.tutorials.StepBase");var CLASS_TUTORIAL_HIGHLIGHT="tutorialHighlight",CLASS_TUTORIAL_HIGHLIGHT_MASK="tutorialHighlightMask",LINK_HREF_ATTR="href";P.modules.tutorials.ModalStepBase=P.modules.tutorials.StepBase.extend({highlightedElements:{},initializeStep:function(){this.listen(P.Viewport,P.CONST.EVENT_RESIZE,_.bindFn(this.onResize,this))},disableCloneLinks:function(a){var b=a.find("a");_.each(b,function(a){var b=$(a),c=b.attr(LINK_HREF_ATTR);b.attr("data-href",c).removeAttr(LINK_HREF_ATTR)})},disableButtonCloneLinks:function(a){a.removeAttr(LINK_HREF_ATTR)},setModalPosition:function(a,b,c,d){var e="VIEWPORT_MIDDLE";a&&b&&(e="ANCHORED",this.modal.options.position_point=a,this.modal.options.anchor=b),this.modal.options.position_mode=e,void 0!==d&&(this.modal.options.fixed=d),this.modal.options.caret=!0,c&&this.modal.positionModule()},setCloneInteractions:function(a){var b=$("body"),c=$('<div class="'+CLASS_TUTORIAL_HIGHLIGHT_MASK+'"/>');c.addClass(CLASS_TUTORIAL_HIGHLIGHT),b.append(c),a.$mask=c,this.disableCloneLinks(a)},setCloneDimensions:function(a,b){a.css({width:b.outerWidth(),height:b.outerHeight(),"box-sizing":"border-box"})},ensurePath:function(a){window.location.pathname!==a&&this.navigate(a)},cleanHighlightedElements:function(){$("."+CLASS_TUTORIAL_HIGHLIGHT).remove(),this.highlightedElements={}},_getModuleChildById:function(a,b){var c=a._childrenIdMap[b];if(c)return c;for(var d,e=0,f=a.children.length;e<f;e++)if(d=a.children[e],c=this._getModuleChildById(d,b))return c},_getModuleChildrenByModuleName:function(a,b){var c=[],d=this;return _.each(a.children,function(a){a.className===b&&c.push(a),c=c.concat(d._getModuleChildrenByModuleName(a,b))}),c},_highlightModule:function(a,b){return this._highlightElement(a.cid,a.$el,b)},_highlightElement:function(a,b,c){var d;if(c){d=b.clone(),d.$origin=b,d.attr("id",a),d.addClass(CLASS_TUTORIAL_HIGHLIGHT),this.highlightedElements[a]=d;var e=$("body");e.append(d),this.setCloneInteractions(d),this.setCloneDimensions(d,b),this.positionClone(d)}else d=this.highlightedElements[a],d&&(d.remove(),delete this.highlightedElements[a]);return d},positionClone:function(a){var b=a.$origin.parents().addBack();b.css("animation-duration","0s"),_.defer(_.bindFn(function(){var c=a.$origin.offset();c={top:c.top,left:c.left};var d=c.top-$(window).scrollTop();d>0&&(c.top=d),a.css(c),a.$mask&&(a.$mask.css(c),a.$mask.css({height:a.outerHeight(),width:a.outerWidth()})),this.modal&&this.modal.positionModule(),b.css("animation-duration","")},this))},onResize:function(){_.each(this.highlightedElements,_.bindFn(this.positionClone,this))},onRemoved:function(){this.cleanHighlightedElements()}}),goog.provide("P.modules.tutorials.NewUserStepBase"),goog.require("P.Module"),goog.require("P.modules.tutorials.StepBase"),goog.require("P.modules.NuxProgress"),P.modules.tutorials.NewUserStepBase=P.modules.tutorials.StepBase.extend({onContentReady:function(){this.nuxProgress=P.app.getChildByModuleName("NuxProgress"),this.nuxProgress.initializeProgress({module:this})},hideStepHeader:function(){var a=this.$(".newUserStepHeader");a.addClass("hidden")}}),goog.provide("P.modules.AddAPlace"),goog.require("P.Module"),goog.require("P.modules.Pinnable"),goog.require("P.modules.GridItems");var PINIT_BUTTON_ID="pinitButton";P.modules.AddAPlace=P.Module.extend({events:{"keyup .description":"onDescriptionKeyup"},onDescriptionKeyup:function(){this._enableIfReady()},onContentReady:function(){var a=this.options.board_id;if(P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_SET_DRAG_MAP_REDO_SEARCH,!1),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.childListen(P.CONST.EVENT_PLACE_IMAGE_SELECTED,this.onPlaceImageSelected),this.focusDescription(),P.scrollbarWidth()>0){var b=this.getChildById("images");if(b){var c=b.getGridItems();c&&c.setHasScroll(!0)}}},onUploadSuccess:function(a){var b=this,c=a.data.image_url;this.setImage(c);var d={name:"Pinnable",options:{url:c,view_type:"add_to_map"}};P.loadModule(d).then(function(a){var c=a;a.render(function(){var d=b.getChildById("images").getGridItems();d.prependChildItem(a);var e=b.getImages();_.each(e,function(a){a.deselect()}),c.select()})})},setImage:function(a){this._image=a},onButtonClick:function(a){var b=a.target;if(b.id===PINIT_BUTTON_ID){a.stopPropagation();var c=this._image;if(!c)return void P.showError(P._("Please pick an image for this pin."));this._enableIfReady()&&(b.showLoading(),this.triggerEvent(P.CONST.EVENT_PINIT_BUTTON_CLICKED,c,!0))}},_enableIfReady:function(){var a=this.getChildById(PINIT_BUTTON_ID),b=this.hasValidDescription();return b?(this.removeErrorState(),this._image?(this.removeErrorState(),a.enable(),!0):!1):(this.addErrorState(),!1)},onPlaceImageSelected:function(a){var b=this.getImages();_.each(b,function(a){a.deselect()});var c=a.data;this._image=c,this.focusDescription()},onRemovedFromDom:function(){var a=this.options.board_id;P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_SET_DRAG_MAP_REDO_SEARCH,!0)},focusDescription:function(){this.$(".description").focus()},addErrorState:function(){this._setDescriptionError(!0),this.focusDescription()},_setDescriptionError:function(a){this.$(".description").toggleClass("hasError",a),this.$(".descriptionLabel").toggleClass("error",a),this.$(".required").toggleClass("visible",a)},removeErrorState:function(){this._setDescriptionError(!1)},getImages:function(){var a=this.getChildById("images").getGridItems(),b=a.children;return b},hasValidDescription:function(){var a=this.$(".description");return!!a.val().length}}),goog.provide("P.modules.AuthHomePage"),goog.require("P.Module"),goog.require("P.modules.NewPinsIndicator"),P.modules.AuthHomePage=P.Module.extend({onContentReady:function(){var a=P.currentUser.attributes.nags;a.length&&"write_banned"===a[0].type&&this.showWriteBanned(),this.extraData&&this.extraData.emailUpdated&&this.showUpdateEmailSuccess(),this._setUpFastFollow(),this.listen(P.Updater.instance(),"new_pins_count",this.onNewPins),this.setRecentPinId();var b={};b[P.CONST.PUBSUB_TOPIC_SCROLL_TO_TOP]=this.onScrollToTop,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_MAIN_MODULE,b)},showWriteBanned:function(){var a=this,b=P.string.format(P._("There's been some strange activity on your account, so we put it in safe mode to protect your Pins. To get going again, just reset your password.")),c={name:"ConfirmDialog",options:{button_text:P._("Reset Password"),body_message:b,title:P._("Your account's in safe mode"),template:"generic"}},d=function(){P.trackGAEvent("reset_password",P.CONST.GA_ACTION_CLICK),a.showLoading();var b=P.resourceFactory.create("UserResetPasswordResource",{username_or_email:P.currentUser.attributes.username}),c=function(){P.trackGAEvent("reset_password",P.CONST.GA_ACTION_SUCCESS);var b=P.string.format(P._("Email sent to {{ user_email }}!"),{user_email:P.currentUser.attributes.email}),c=P.string.format(P._("Check your inbox for instructions on how to reset your password. If you don't get the email, you can get in touch with us.")),d={name:"ConfirmDialog",options:{title:b,button_text:P._("Okay"),body_message:c,template:"generic"}};P.loadModule(d,function(b){a.showInModal(b)})},d=function(){a.hideLoading()},e=function(){P.trackGAEvent("reset_password",P.CONST.GA_ACTION_ERROR)};b.callCreate({error:P.NOOP}).done(c).fail(e).always(d)};P.loadModule(c,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,d)})},showUpdateEmailSuccess:function(){if(Cookie.get(P.CONST.COOKIE_EMAIL_ADDRESS_UPDATED)){if(Cookie.unset(P.CONST.COOKIE_EMAIL_ADDRESS_UPDATED),!this.extraData||!this.extraData.email)return;var a=this,b=P.string.format(P._("You updated your address! Now you just need to confirm it. Look for the message we sent to {{ new_email }}."),{new_email:this.extraData.email}),c={name:"ConfirmDialog",options:{button_text:P._("Ok"),body_message:b,title:P._("Email updated"),template:"generic"}};return void P.loadModule(c,function(b){a.showInModal(b)})}},_setUpFastFollow:function(){},addTutorials:function(){var a=P.ExperienceManager.instance(),b=P.Experiences.Placement.WEB_HOME_TAKEOVER,c=a.getPlacedExperience(b);if(c){c.experience_id===P.Experiences.Experience.WEB_BLANK_SESSION&&a.viewPlacedExperience(b,P.Experiences.Experience.WEB_BLANK_SESSION);var d=P.ExperienceManager.Tutorials[c.experience_id];d&&(P.TutorialManager.instance().startTutorial(d),a.viewPlacedExperience(b,c.experience_id))}},onBoardInteraction:function(){this.render()},onAddedToDom:function(){this._setUpFastFollow(),this.setRecentPinId(),this.addTutorials()},onRemovedFromDom:function(){P.Updater.instance().setRecentPinId(null)},setRecentPinId:function(){P.Updater.instance().setRecentPinId(this.getRecentPinId())},onNewPins:function(a){if(a){if(a===this._newPinsCount)return;if(this._newPinsCount=a,P.setTitlePrefix(a),!P.experiments.modernHeader){var b=this.ensureNewPinsIndicator();if(!this._newPinsCount&&!b.options.count)return;b.options.count=a,b.render(function(){a&&b.show()})}}},onScrollToTop:function(){var a=this,b=this._newPinsCount;this._newPinsCount=0,P.setTitlePrefix(null);var c=this.getChildById("feedGrid");c.prependNewItems(b,function(){a.setRecentPinId()})},onNewPinsClick:function(a){a.stopPropagation();var b=this.ensureNewPinsIndicator();b.hide(),this.triggerEvent(P.CONST.EVENT_SCROLL_TO_TOP,{},!0)},ensureNewPinsIndicator:function(){var a=this.getChildById("newPins");return a||(a=new P.modules.NewPinsIndicator({id:"newPins"}),this.listen(a,"click",this.onNewPinsClick),this.appendChild(a),a.hide()),a},getRecentPinId:function(){var a=this.getChildById("feedGrid");if(!a)return null;var b=a.getFirstGridItem("Pin");return b?b.getPinId():void 0},setUpBookmarkletDropdown:function(){if(this.extraData&&this.extraData.show_bookmarklet_dropdown){var a=this,b={name:"PinBookmarkletTooltip",options:{}};P.loadModule(b,function(b){var c={anchor:$(".bookmarkletAnchor"),class_name:"large",container_class:"pinBookmarkletTooltip",fixed:!0,mask_type:"transparent",position_point:"BOTTOM_RIGHT",position_mode:"ANCHORED"};a.showInModal(b,c,a)})}}}),goog.provide("P.modules.Board"),goog.require("P.Module"),goog.require("P.modules.BoardBase"),goog.require("P.modules.Dropdown");var CLASS_NO_SHADOW="noShadow",VIEW_TYPE_FOLLOW="follow_view";P.modules.Board=P.modules.BoardBase.extend({events:{"click .dismiss":"onDismissClick"},getOwnedScrollables:function(){return this.$(".pinGridWrapper")},onContentReady:function(){var a=this.getId();if(a){var b={};b[P.CONST.PUBSUB_TOPIC_BOARD_COVER_UPDATED]=this.onBoardCoverUpdated,b[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,b[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.pubsubSubscribe(a,b)}if("boardPinsGrid"===this.options.view_type){var c=this,d=this.getChildById("pinGrid");this.listen(d,P.CONST.EVENT_CONTENT_CHANGED,function(){var a=c.$el.css("max-height")||"0";a=a.replace(/[^0-9]/g,""),this.$el.outerHeight()<a&&this.$el.addClass(CLASS_NO_SHADOW)})}this.options.view_type===VIEW_TYPE_FOLLOW&&this.initHoverListeners()},onDismissClick:function(){this.dismissed=!0,this.triggerEvent(P.CONST.EVENT_DISMISS,null,!0)},onBoardHoverEnter:function(){this.$el.isHovering()&&this._dropdown.show()},onBoardHoverExit:function(){this._dropdown.isHovering()||this._dropdown.hide()},onBoardCoverUpdated:function(a,b,c){this.setBoardCover(c)},positionBoardPinsGrid:function(){var a=this.getChildById("pinGrid");a.$(".activeItem").focus()},toggleFollow:function(){this.getChildByModuleName("BoardFollowButton").toggleFollow()},initHoverListeners:function(){!this._hoverIntent&&this.options.use_flyout&&(this._hoverIntent=new P.HoverIntent(this.$el,{enterDelay:500,exitDelay:200}),this.listen(this,P.CONST.EVENT_NAVIGATE,this.onBoardHoverExit),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_ENTER_COMPLETE,this.onBoardHoverEnter),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE,this.onBoardHoverExit),this.isClickButton=function(){return!1},this._dropdown=new P.modules.Dropdown({options:{anchor:this.$el,class_name:"followViewHover underneathHeader",position_point:"RIGHT_TOP",module:{name:"Board",options:{view_type:"boardPinsGrid",scrollable:!0,prevent_default_scroll:!0,board_follow_button_options:{board_id:this.resource.options.board_id}},resource:{name:"BoardResource",options:{board_id:this.resource.options.board_id}}}}}),this.appendChild(this._dropdown),this.$el.initHovering(),this._dropdown.initHovering())},setBoardCover:function(a){var b=a.url,c=a.crop_x,d=a.crop_y,e=a.nativeHeight,f=a.nativeWidth,g=a.scale,h=this.$(".boardCoverWrapper img");h.attr("src",b).css({height:e*g,left:-c,"max-width":"none",position:"absolute",top:-d,width:f*g});var i=this.getChildById("boardCoverEditButton"),j=i.options.submodule.options;j.board_cover_edit_options.cover_pin_id=a.pin_id},disabledButtons:[],disable:function(){this.$el.find(".hoverMask").addClass("notNavigatable"),this.disabledButtons=[];var a=this;_.each(this.getChildrenByModuleName("ShowModalButton"),function(b){b.isDisabled()||(b.disable(),a.disabledButtons.push(b))})},enable:function(){this.$el.find(".hoverMask").removeClass("notNavigatable"),_.each(this.disabledButtons,function(a){a.enable()})},setFollowButtonState:function(a){var b=this.getChildByModuleName("BoardFollowButton");b&&b.setState(a)}}),goog.provide("P.modules.BoardCount"),goog.require("P.Module"),goog.require("P.modules.NavigateButton"),P.modules.BoardCount=P.modules.NavigateButton.extend({onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_BOARD_CREATED]=this.onBoardCountUpdate,a[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardCountUpdate,a[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardCountUpdate,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a),P.modules.NavigateButton.prototype.onContentReady.call(this)},onBoardCountUpdate:function(a,b,c){c.privacy!==P.CONST.BOARD_PRIVACY_SECRET&&this.render()}}),goog.provide("P.modules.BoardCoverEdit"),goog.require("P.Module"),goog.require("P.modules.ui.ImageCrop"),P.modules.BoardCoverEdit=P.Module.extend({pins:null,index:null,prefetchBuffer:10,events:{"click .previous":"previous","click .next":"next"},onCreated:function(){this.imageCrop=null,this.onKeyup=_.bindFn(this.onKeyup,this),this.next=_.bindFn(this.next,this),this.previous=_.bindFn(this.previous,this),this.$img=$("<img>")},_positionIfReady:function(){!this._positioned&&this.inDom&&this.contentReady&&(this._positioned=!0,this.imageCrop=this.getChildByModuleName("ui.ImageCrop"),this.listen($("body"),"keyup",this.onKeyup),this.coverPinId=this.options.cover_pin_id,this._initializePins(!0))},_initializePins:function(a){if(a&&null!==this.coverPinId){var b={id:this.coverPinId,field_set_key:"board_cover_picker"},c=P.resourceFactory.create("PinResource",b),d=this;c.callGet({success:function(a){d._appendPinsFromData([a.resource_response.data]),d._initializePins()},error:function(){d.coverPinId=null,d._initializePins()}})}else this._appendPinsFromData(this.data),this.setIndex(0),this.updateButtons()},_appendPinsFromData:function(a){this.pins||(this.pins=[]);var b=this;_.each(a,function(a){var c={id:a.id,url:a.images["236x"].url};c.id===b.coverPinId&&b.pins.length||b.pins.push(c)})},onAddedToDom:function(){this._positionIfReady()},onContentReady:function(){this._positionIfReady()},onKeyup:function(a){null!==this.index&&(a.keyCode===P.keyCode.LEFT?this.previous():a.keyCode===P.keyCode.RIGHT&&this.next())},requestMoreIfNeeded:function(){if(!(this.index+this.prefetchBuffer<this.pins.length)&&!this.resource.atEnd()){var a=this;this.resource.callGet({options:this.options,success:function(b){a.data=b.resource_response.data,a._appendPinsFromData(a.data)},error:function(){a.data=[]}})}},next:function(){if(this.requestMoreIfNeeded(),this.index===this.pins.length-1)return!1;var a=this.index+1;return this.setIndex(a),!1},previous:function(){var a=this.index-1;return this.setIndex(a),!1},setIndex:function(a){var b=this.pins[a];b&&(this.imageCrop.setImage(b.url),this.index=a,this.preload([this.index-2,this.index-1,this.index+1,this.index+2]),this.updateButtons())},preload:function(a){var b=this;_.each(a,function(a){var c=b.pins[a];c&&P.preloadImage(c.url)})},updateButtons:function(){var a=0<this.index;this.$(".previous").toggle(a);var b=this.index<this.pins.length-1||!this.resource.atEnd();this.$(".next").toggle(b)},getBoardCoverData:function(){var a=this.pins[this.index].id,b=this.pins[this.index].url,c=_.extend({},{pin_id:a,pin_image_url:b},this.imageCrop.getCropData());return c}}),goog.provide("P.modules.BoardPicker"),goog.require("P.Module"),goog.require("P.modules.BoardPickerBase"),P.modules.BoardPicker=P.modules.BoardPickerBase.extend({onContentReady:function(){if(P.modules.BoardPickerBase.prototype.onContentReady.apply(this,arguments),this.extraData&&this.extraData.no_boards){var a=this;_.defer(function(){var b=a.$(".createYourFirstBoard");a.showNoBoardsTooltip(b)})}}}),goog.provide("P.modules.BoardsToFollow"),goog.require("P.Module"),goog.require("P.modules.Board"),goog.require("P.modules.Dropdown");var NUM_BOARDS_IN_LIST=3,BOARDS_TO_FOLLOW_VIEW_TYPE_FOLLOW="follow_view";P.modules.BoardsToFollow=P.Module.extend({boardsUsed:[],boardsUnused:[],boardsToReplace:[],onCreated:function(){this.childListen(P.CONST.EVENT_DISMISS,this.onChildDismiss),this.childListen(P.CONST.EVENT_BOARD_FOLLOW,this.onChildBoardFollow)},onContentReady:function(){var a=this;this.boardsUnused=this.extraData.boardsUnused,this.list=a.getChildByModuleName("List"),a.requestMoreBoardsIfNeeded(),a.replaceBoardsWithUnused()},onChildDismiss:function(a){var b=a.target;this.dismissBoard(b)},onChildBoardFollow:function(a){var b=a.target.parent,c=this;b.options.view_type===BOARDS_TO_FOLLOW_VIEW_TYPE_FOLLOW&&window.setTimeout(function(){c.dismissBoard(b)},500)},getEditFeedButtonElement:function(){return this.$(".memoTitle")},requestMoreBoardsIfNeeded:function(){var a=this;a.boardsUnused.length>NUM_BOARDS_IN_LIST||this.resource.xhr||this.resource.callGet({success:function(b){var c=b.resource_response.data;a.boardsUnused=a.boardsUnused.concat(c),a.replaceBoardsWithUnused()}})},dismissBoard:function(a){if(a&&!a.dismissing){var b=this;a.dismissing=!0,b.requestMoreBoardsIfNeeded(),a.fadeOut(function(){b.replaceBoard(a)})}},getBoard:function(a){var b=new P.modules.Board({options:{show_board_context:!0,view_type:BOARDS_TO_FOLLOW_VIEW_TYPE_FOLLOW,size:"small"},resource:{name:"BoardResource",options:{board_id:a,field_set_key:"boards_to_follow"}}});return b},hideBoard:function(a){a&&(a._dropDown&&a._dropDown.hide(),a.destroy())},replaceBoardsWithUnused:function(){for(var a=this;a.boardsToReplace.length&&a.boardsUnused.length;){var b=a.boardsToReplace.shift();a.replaceBoard(b)}},replaceBoard:function(a){var b=this,c=this.boardsUnused.pop();if(c){var d=b.getBoard(c.id);d.render(function(){var c=$("<li></li>").appendTo(b.list.$el);b.list.insertChild(d,c),b.list.insertChild(d,c),b.hideBoard(a),d.show(),d.fadeIn()},function(){b.hideBoard(a),b.replaceBoard(d)}),this.boardsUsed.push(c)}}}),goog.provide("P.modules.CloseupSidebar"),goog.require("P.Module"),goog.require("P.modules.Board"),P.modules.CloseupSidebar=P.Module.extend({onContentReady:function(){if(this.data.id){var a={};a[P.CONST.PUBSUB_TOPIC_PIN_UPDATED]=this.onPinUpdated,this.pubsubSubscribe(this.data.id,a)}var b=this.getChildByModuleName("Board");b.positionBoardPinsGrid()},onPinUpdated:function(){this.render()},updateDomain:function(a){var b=this.getChildById("domain");if(!a)return void(b&&(b.destroy(),this.$(".domainContainerTitle").hide()));if(!b&&a){var c={name:"Domain",id:"domain",resource:{name:"DomainResource",options:{domain:a}}},d=this;return void P.loadModule(c,function(a){a.render(function(){d.$(".domainContainerTitle").show(),d.insertChild(a,d.$("#domainContainer"))})})}b.resource.set("domain",a),b.render(function(){b.fadeIn()})},updateRelatedRecipes:function(a){if(P.experiments.instance.inExperimentGroup("recipe_pages","enabled")){var b=this.getChildById("relatedRecipe");if(!a||0===a.length)return void(b&&b.destroy());if(!b&&a){var c={name:"RelatedRecipe",id:"relatedRecipe",options:{ingredients:a},resource:{name:"NoopResource",options:{}}},d=this;return void P.loadModule(c,function(a){a.render(function(){d.insertChild(a,d.$(".relatedRecipeContainer"))})})}b.options={ingredients:a},b.render(function(){b.fadeIn()})}}}),goog.provide("P.modules.FastFollow"),goog.require("P.Module"),goog.require("P.modules.Grid");var FAST_FOLLOW_CONTENT_CLASS="fastFollowContent",FAST_FOLLOW_HEADER_ID="fastFollowHeader",FAST_FOLLOW_GRID_ID="categoryBoardsGrid",FAST_FOLLOW_BOARD_MASK="wholeBoardMask",FAST_FOLLOW_MIN_HEIGHT=355,FAST_FOLLOW_MODAL_TOP_PADDING=102,FAST_FOLLOW_MODAL_BOTTOM_PADDING=56,NUM_REQUIRED_BOARDS=5,FastFollowSidebarActions={CATEGORY:0,SEARCH_TERM:1};P.modules.FastFollow=P.Module.extend({_boardsFollowed:[],_modalDisplayed:!1,_cachedGrids:{},_currentAction:FastFollowSidebarActions.CATEGORY,getOwnedScrollables:function(){return this.$(".fastFollowGridContainer")},_getBoardIdFromEvent:function(a){var b=a.data||{};return b.board_id},_onBoardFollow:function(a){var b=this._getBoardIdFromEvent(a),c=$.inArray(b,this._boardsFollowed);b&&-1===c&&(this._boardsFollowed.push(b),this._updateFollowedBoards(1),this._updateFollowedBoardMask(a,!0))},_onBoardUnfollow:function(a){var b=this._getBoardIdFromEvent(a);if(b){var c=$.inArray(b,this._boardsFollowed);-1!==c&&(this._boardsFollowed.splice(c,1),this._updateFollowedBoards(-1)),this._updateFollowedBoardMask(a,!1),this._boardsFollowed.length===NUM_REQUIRED_BOARDS-1&&this._setProgressCompletion(!1)}},_updateFollowedBoardMask:function(a,b){var c=this._getBoardIdFromEvent(a);if(c){var d=this.$("."+FAST_FOLLOW_BOARD_MASK+".mask"+c);b?d.show():d.hide()}},_onCategoryUpdate:function(a){var b=a.data,c={name:"CategoryBoardsResource",options:{category:b}};this._currentAction=FastFollowSidebarActions.CATEGORY,this._updateGridFromResource(c,b,b)},_onSearchQueryUpdate:function(a){var b=a.data,c={name:"SearchResource",options:{query:b,scope:"boards",search_context:"fast_follow"}};this._currentAction=FastFollowSidebarActions.SEARCH_TERM,this._updateGridFromResource(c,null,b)},_updateGridFromResource:function(a,b){this._currentGrid||(this._currentGrid=this.getChildById(FAST_FOLLOW_GRID_ID),this._cachedGrids[this._currentGrid.resource.options.category]=this._currentGrid),this._currentGrid.remove();var c=this._cachedGrids[b];c||(c=new P.modules.Grid({id:FAST_FOLLOW_GRID_ID,options:{centered:!1,layout:"fixed_height",show_grid_footer:!1,scrollable:!0,item_options:{allow_click_thru:!1,board_click_mask:!0}},resource:a}),c.render(),b&&(this._cachedGrids[b]=c));var d=this.$(".fastFollowGridContainer");this.$("."+FAST_FOLLOW_CONTENT_CLASS).scrollTop(0),this.insertChild(c,d),this._currentGrid=c},_updateBoardHeading:function(a){this.$(".heading").hide(),this._currentAction===FastFollowSidebarActions.CATEGORY?(a=this.$(".followPageSidebarCategory[data-category="+a+"]"),a=a?a.text():null,this.$(".categoryHeading").show()):this.$(".searchHeading").show();var b=this.$(".categoryOrQuery");b&&b.length&&a&&b.text(a)},_onProgressCompletion:function(){this._userRegisterTrackActionOrientationComplete(),this._setProgressCompletion(!0)},_onFastFollowCompletion:function(a){var b=a.target;b&&"tryOutYourFeedButton"===b.id&&(this.hide(),this.navigate("/",null,!0))},_userRegisterTrackActionOrientationComplete:function(){P.trackRegisterAction("orientation_complete")},_setProgressCompletion:function(a){var b=this.getChildById(FAST_FOLLOW_HEADER_ID);b&&(b.options.progress_completed=a,a?b.render():(b.options.num_boards_followed=this._boardsFollowed.length,b.render()))},_updateFollowedBoards:function(a){if(!this._modalDisplayed){var b=this.getChildById(FAST_FOLLOW_HEADER_ID);b&&b.stepProgress(a)}},onContentReady:function(){var a=this;_.each(this.extraData.followed_boards,function(b){a._boardsFollowed.push(b.id)}),this.childListen(P.CONST.EVENT_FAST_FOLLOW_CATEGORY_SELECTED,this._onCategoryUpdate),this.childListen(P.CONST.EVENT_FAST_FOLLOW_SEARCH_QUERY_UPDATED,this._onSearchQueryUpdate),this.childListen(P.CONST.EVENT_PROGRESS_COMPLETED,this._onProgressCompletion),this.childListen(P.CONST.EVENT_BOARD_FOLLOW,this._onBoardFollow,this),this.childListen(P.CONST.EVENT_BOARD_UNFOLLOW,this._onBoardUnfollow,this),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this._onFastFollowCompletion),this.listen(P.Viewport,P.CONST.EVENT_RESIZE,this.position),this.position()},position:function(){if(this.inDom&&this.contentReady){this.fastFollowHeaderHeight||(this.fastFollowHeaderHeight=this.$(".FastFollowHeader").outerHeight(!0));var a=FAST_FOLLOW_MODAL_TOP_PADDING+FAST_FOLLOW_MODAL_BOTTOM_PADDING,b=P.Viewport.height,c=b-a-this.fastFollowHeaderHeight,d=Math.max(FAST_FOLLOW_MIN_HEIGHT,c);this.$(".fastFollowContent").height(d)}},onDestroyed:function(){_.each(_.values(this._cachedGrids),function(a){a.destroy()})}}),goog.provide("P.modules.FindFriendsContent"),goog.require("P.Module"),goog.require("P.modules.SocialNetworkSettingsBase"),P.modules.FindFriendsContent=P.modules.SocialNetworkSettingsBase.extend({onCreated:function(){P.modules.SocialNetworkSettingsBase.prototype.onCreated.apply(this,arguments),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),P.ExperienceManager.instance().refreshPlacedExperiences()},onButtonClick:function(a){var b=a.target,c=null;switch(b.id){case"facebookConnectButton":c=P.SocialConnect.FACEBOOK;break;case"twitterConnectButton":c=P.SocialConnect.TWITTER;break;default:return}b.showLoading(!0);var d=this,e={success:function(){var a={username:d.options.username},b={success:function(a){d.resource=a,d.render()},error:function(){d.hideLoading(),d.render()},resourceOptions:a};d.pollForFriends(c,b)},error:function(){d.hideLoading()}};this.handleConnect(c,!0,e)}}),goog.provide("P.modules.FollowerCount"),goog.require("P.Module"),goog.require("P.modules.NavigateButton"),P.modules.FollowerCount=P.modules.NavigateButton.extend({onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onFollowerChange,a[P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onFollowerChange,this.pubsubSubscribe(this.data.id,a),P.modules.NavigateButton.prototype.onContentReady.call(this)},onFollowerChange:function(){this.render()}}),goog.provide("P.modules.FramedSignupContent"),goog.require("P.Module"),goog.require("P.modules.UnauthHomePage"),P.modules.FramedSignupContent=P.modules.UnauthHomePage.extend({events:{},onContentReady:function(){this.container=window.parent,this.childListen(P.CONST.EVENT_USER_REGISTER,this.onRegisterComplete),P.modules.UnauthHomePage.prototype.onContentReady.call(this)},onNavigateEvent:function(a){a.stopPropagation(),P.modules.UnauthHomePage.prototype.onNavigateEvent.call(this,a),this.postMessage({event:"navigate",url:a.data.url})},onRegisterComplete:function(a){a.stopPropagation(),this.postMessage({event:"userRegister"})},onFastTrackSuccess:function(){this.log.debug("onFastTrackSuccess"),this.postMessage({event:"userRegister"})},onLoginSuccess:function(){this.log.debug("onLoginSuccess"),this.postMessage({event:"userLogin"})},onFastTrackError:function(){this.log.debug("onFastTrackError"),this.postMessage({event:"finishRegistration"})},trackRegisterAction:function(){P.trackRegisterAction(this.options.track_key||"framed_signup")},getExtraFastTrackSocialRegistrationOptions:function(){return{skip_nux:this.options.skip_nux}},postMessage:function(a){return this.container.postMessage?void this.container.postMessage(JSON.stringify(a),"http://"+this.options.domain):void this.log.error("Browser doesn't support postMessage!")}}),goog.provide("P.modules.FriendsToFollow"),goog.require("P.Module"),goog.require("P.modules.User"),P.modules.FriendsToFollow=P.Module.extend({friendIdsUsed:[],friendsUnused:[],usersToReplace:[],usersDismissing:[],onContentReady:function(){this.friendIdsUsed=this.extraData.friendIdsUsed,this.invite_mode="invites"===this.options.mode,this.list=this.getChildByModuleName("List"),this.destroyIfEmpty()||(this.childListen(P.CONST.EVENT_DISMISS,this.onChildDismiss),this.childListen(P.CONST.EVENT_USER_FOLLOW,this.onChildActionTaken),this.childListen(P.CONST.EVENT_INVITE_USER,this.onChildActionTaken)),this.invite_mode&&P.fb.ensureInit(P.NOOP)},onChildDismiss:function(a){var b,c=a.target;this.invite_mode?(b=P.resourceFactory.create("UserInviteSuggestionResource",{}),b.set("hash_id",c.getUserId())):(b=P.resourceFactory.create("UserFriendSuggestionResource",{}),b.set("user_id",c.getUserId())),b.callDelete(),this.dismissUser(c)},onChildActionTaken:function(a){var b=a.target,c=this;window.setTimeout(function(){if(c.dismissUser(b),c.invite_mode){var a=P.resourceFactory.create("UserInviteSuggestionResource",{});a.set("hash_id",b.getUserId()),a.callDelete()}},500)},requestMoreFriendsIfNeeded:function(){var a=this.friendsUnused,b=this.usersDismissing.length+this.usersToReplace.length;if(!(a.length>=b||this.resource.xhr)){var c=this;this.resource.resetBookmark(),this.invite_mode?this.resource.options.excluded_hash_ids=this.friendIdsUsed:this.resource.options.excluded_user_ids=this.friendIdsUsed,this.resource.callGet({success:function(a){var b=a.resource_response.data;for(c.friendsUnused=b;c.usersToReplace.length;){var d=c.usersToReplace.shift();c.replaceUser(d)}}})}},dismissUser:function(a){if(a){var b=this;this.usersDismissing.push(a),a.fadeOut(function(){b.usersDismissing=_.without(b.usersDismissing,a),b.friendsUnused.length?b.replaceUser(a):(b.usersToReplace.push(a),b.requestMoreFriendsIfNeeded())})}},getHeaderElement:function(){return this.$(".memoTitle")},replaceUser:function(a){var b=a.$el.parent(),c=this.friendsUnused.pop(),d=this;return c?(this.invite_mode?(a.options.contact_info=c,this.friendIdsUsed.push(c.hash_id)):(a.resource.options.user_id=c.id,this.friendIdsUsed.push(c.id)),void a.render(function(){a.show(),d.list.removeChild(a),b.remove(),d.list.$el.append(b),d.list.insertChild(a,b),a.fadeIn()})):(d.list.removeChild(a),void b.remove())}}),goog.provide("P.modules.Header"),goog.require("P.Module"),goog.require("P.modules.ButtonBase"),goog.require("P.modules.ui.SearchForm"),goog.require("P.router"),P.modules.Header=P.Module.extend({events:{},onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_HEADER_ALT_STATE]=this.onHeaderAltStateChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,a),this.listen(P.router.get(),P.CONST.EVENT_ROUTE_MATCHED,this.onRouteMatched)},onRouteMatched:function(a){var b=a.navigateData.currentModule||{},c="SearchPage";if(a.module!==c&&b.className===c&&"Closeup"!==a.module){var d=this.getChildById("mainSearchTextbox");d.setTypeaheadValue("")}},onHeaderAltStateChange:function(a,b,c){this.$el.toggleClass("alt",c)},getHeight:function(){return this.$(".headerBackground").height()},getUserMenu:function(){return this.getChildById("userMenu")},getHomeElement:function(){return this.$(".logo")},show:function(){this.$el.show(),this.$el.removeClass("hidden")}}),goog.provide("P.modules.IncrementingNavigateButton"),goog.require("P.Module"),goog.require("P.modules.NavigateButton");var INCREMENTING_NAVIGATE_BUTTON_CLASS_HIDDEN="hidden";P.modules.IncrementingNavigateButton=P.modules.NavigateButton.extend({onContentReady:function(){this.listen(this,P.CONST.EVENT_INCREMENT_BUTTON_CREATE,this.makeVisible),this.listen(this,P.CONST.EVENT_INCREMENT_BUTTON_DESTROY,this.makeInvisible)},getValue:function(){if(this.extraData&&this.extraData.actionCount)return this.extraData.actionCount;var a=$.trim(this.$el.text()),b=parseInt(a,10);return b},setValue:function(a){this.extraData.actionCount=a,this.$el.text(a)},isHidden:function(){return this.$el.hasClass(INCREMENTING_NAVIGATE_BUTTON_CLASS_HIDDEN)
},makeVisible:function(){var a=this.isHidden();a&&this.$el.removeClass(INCREMENTING_NAVIGATE_BUTTON_CLASS_HIDDEN)},makeInvisible:function(){var a=this.isHidden();a||this.$el.addClass(INCREMENTING_NAVIGATE_BUTTON_CLASS_HIDDEN)},increment:function(){var a=this,b=this.getValue();isNaN(b)&&(b=0),this.triggerEvent(P.CONST.EVENT_INCREMENT_BUTTON_CREATE,a.options.siblingButtonId,!0),b+=1,this.setValue(b)},decrement:function(){var a=this,b=this.getValue();return b-=1,0===b?void this.triggerEvent(P.CONST.EVENT_INCREMENT_BUTTON_DESTROY,a.options.siblingButtonId,!0):void this.setValue(b)},moduleRenderer:new P.ModuleRendererLocal("app/desktop/modules/IncrementingNavigateButton/IncrementingNavigateButton.nunjucks")}),goog.provide("P.modules.JoinButton"),goog.require("P.Module"),goog.require("P.modules.NavigateButton"),P.modules.JoinButton=P.modules.NavigateButton.extend({getNavigateUrl:function(){return P.getRegisterUrl({action:"join"})}}),goog.provide("P.modules.LoginButton"),goog.require("P.Module"),goog.require("P.modules.NavigateButton"),P.modules.LoginButton=P.modules.NavigateButton.extend({getNavigateUrl:function(){return P.getLoginUrl({action:"login"})}}),goog.provide("P.modules.MultiInviter"),goog.require("P.Module"),goog.require("P.typeaheadProvider"),goog.require("P.modules.SocialNetworkSettingsBase");var MIN_SCROLL_THRESHOLD=2500;P.modules.MultiInviter=P.modules.SocialNetworkSettingsBase.extend({events:{"click .inviteAllLabel":"_onClickInviteAll","click .inviteButton":"_onClickInvite","click .cancelButton":"_onClickCancel",'keyup input[type="text"]':"_onTextChange"},onCreated:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this._onButtonClick)},onContentReady:function(){if(P.Module.prototype.onContentReady.apply(this,arguments),this.options.network)this.scrollableElement=this.$(".inviteContent"),this._scrollListener=this.listen(this.scrollableElement,"scroll",this._onInviteScroll),this.emailList=this.getChildById("emailList"),this.emptyResultsFooter=this.$(".emptyResults"),this.sendButton=this.getChildById("inviteButton"),this.inviteAllCheck=this.getChildById("inviteAllCheck"),this._reset();else{this.gmailConnect=this.getChildById("gmailConnect"),this.yahooConnect=this.getChildById("yahooConnect");var a={email:[P.Validator.Required(),P.Validator.Email()]};this.form=new P.Form(this.$("form"),a),this.formListener&&this.removeListener(this.formListener),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this._onSubmitValidated),this.emailInviteButton=this.getChildById("invite")}},_onSubmitValidated:function(a){if(!a.errors[0]){this.emailInviteButton.showLoading();var b=this.form.getValue("email");this.$(".emailInput").val("");var c=this;P.Invite.userInviteEmail(b,function(){c.emailInviteButton.hideLoading(),c._showConfirmation()})}},_onButtonClick:function(a){var b=a.target,c=null;switch(b.id){case"gmailConnect":c=P.SocialConnect.GOOGLE;break;case"yahooConnect":c=P.SocialConnect.YAHOO;break;default:return}b.showLoading(!0);var d=this,e={success:function(){var a={username:P.currentUser.attributes.username,filter:"not_on_pinterest"},e={success:function(a){d.resource=a,d.options.network=c,d.render()},error:function(){b.hideLoading()},resourceOptions:a};d.pollForFriends(c,e)},error:function(){b.hideLoading()}};this.handleConnect(c,!0,e)},_reset:function(){if(this.options.network){this.sendButton.setEnabled(!1),this.checkedEmails={},this.childListen(P.CONST.EVENT_CHANGE,this._onChange),this._onInviteScroll=_.bindFn(this._onInviteScroll,this),this._onInviteScroll=_.throttle(this._onInviteScroll,200);var a={name:"invite",view_type:"emailContactItem",tags:this.options.network,count:50};this.typeahead=new P.TypeaheadProvider(a),this.typeahead.prefetch(),this.listen(this.typeahead,P.CONST.EVENT_DATA,this._onTypeaheadData)}},_getSearchText:function(){return this.$("input[type='text']").val().toLowerCase()},_searchIsEmpty:function(){var a=this._getSearchText();return!a||""===a},_inviteAllChecked:function(){return this.inviteAllCheck.isChecked()},_onTypeaheadData:function(a){var b=this;if(!this._searchIsEmpty()&&this._getSearchText()===a.term){var c=[];_.each(a.items,function(a){var d={};d.id=a.id,d.name=a.name,d.id_type="email",b.checkedEmails[d.id]|=b._inviteAllChecked(),d.checked=b.checkedEmails[d.id],c.push(d)}),this.emailList.options.items=c,this.emailList.resource=null,this.emailList.render(),c.length?this.emptyResultsFooter.hide():this.emptyResultsFooter.show()}},_onInviteScroll:function(){if(!this.rendering&&this._searchIsEmpty()){var a=this.$(".List");if(a.position()){var b=a.height()+a.position().top-this.scrollableElement.height();b<=MIN_SCROLL_THRESHOLD&&this._fetchMore()}return!1}},_fetchMore:function(){var a=this;return this.emailList.options.item_options.checkedAll=this._inviteAllChecked(),this.resource.atEnd()?void this.removeListener(this._scrollListener):(this.rendering=!0,void this.getChildById("emailList").renderAppend(function(){a.rendering=!1}))},_onChange:function(a){var b=a.target;if("inviteAllCheck"===b.id)this._onToggleInviteAll(a);else{for(var c=0,d=0;d<this.emailList.children.length;d++){var e=this.emailList.children[d];this.checkedEmails[e.getEmail()]=e.isChecked(),c+=e.isChecked()?1:0}this._searchIsEmpty()&&this.inviteAllCheck.setChecked(c===this.emailList.children.length,!1);var f=0;for(var g in this.checkedEmails)this.checkedEmails[g]&&f++;this.sendButton.setEnabled(f>0)}},_onClickInviteAll:function(){this.inviteAllCheck.setChecked(!this._inviteAllChecked()),this._onToggleInviteAll()},_onClickCancel:function(){this.parent.destroy()},_onToggleInviteAll:function(){var a=this;this._getSearchText()?(this.$("input[type='text']").val(""),this._filterResults(function(){a._toggleInviteAll()})):a._toggleInviteAll()},_toggleInviteAll:function(){var a=this,b=this._inviteAllChecked(),c=this.getChildById("emailList").children;_.each(c,function(c){a.checkedEmails[c.getEmail()]=b,c.setChecked(b)}),this.sendButton.setEnabled(b)},_onClickInvite:function(){var a;if(this._inviteAllChecked())a=P.resourceFactory.create("BulkNetworkInviteResource",{network:this.options.network});else{var b=[];for(var c in this.checkedEmails)this.checkedEmails[c]&&b.push(c);a=P.resourceFactory.create("UserMultiInviteResource",{emails:b})}this.sendButton.showLoading();var d=this;a.callCreate().then(function(){d.sendButton.hideLoading(),d._showConfirmation()})},_showConfirmation:function(){var a=this;this.$(".inviteConfirm").show(),P.setTimeout(function(){a.$(".inviteConfirm").addClass("fadeOut"),a._reset(),a.render()},2e3)},_onTextChange:function(){this.options.network&&this._filterResults()},_filterResults:function(a){var b=this;this._searchIsEmpty()?(this.emailList.resource||this.emailList.renderAbort(),this.emptyResultsFooter.hide(),this.emailList.resource=this.resource,delete this.emailList.options.items,this.emailList.render().then(function(){b._searchIsEmpty()&&(_.each(b.emailList.children,function(a){a.setChecked(b.checkedEmails[a.getEmail()],!1)}),a&&a())})):this.typeahead.search(this._getSearchText(),function(){})}}),goog.provide("P.modules.NotificationsButton"),goog.require("P.Module"),goog.require("P.modules.DropdownButton"),P.modules.NotificationsButton=P.modules.DropdownButton.extend({getDropdownModule:function(){return this.getNotificationsModule()},getNotificationsModule:function(){var a=Math.max(this.unseenCount||10,20);return{name:"Notifications",resource:{name:"NotificationsResource",options:{count:a}}}},onContentReady:function(){var a=this;P.modules.DropdownButton.prototype.onContentReady.call(this),this.unseenCount=0,this.data&&(this.unseenCount=this.data,this.getButton().setBadgeCount(this.data)),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.childListen(P.CONST.EVENT_DROPDOWN_SHOW,this.onDropdownShow),this.listen(P.Updater.instance(),"notifications_count",function(b){a.unseenCount=b,a.getButton().setBadgeCount(b)})},onDropdownHide:function(){if(this.shouldClearDropdown){var a=this.getDropdown();a&&a.empty()}this.shouldClearDropdown=!1,this.setActiveStyle(!1)},onDropdownShow:function(){this.getButton().clearBadge()},clearDropdown:function(){var a=this.getDropdown();a&&(a.isVisible()?this.shouldClearDropdown=!0:a.empty())}}),goog.provide("P.modules.PinActionBar"),goog.require("P.Module"),goog.require("P.modules.IncrementingNavigateButton");var ACTION_LEFT_ROUNDED_CLASS="leftRounded",LIKES_BUTTON_ID="likesButton",REPINS_BUTTON_ID="repinsButton",PIN_IT_BUTTON_ID="pinItButton";P.modules.PinActionBar=P.Module.extend({onContentReady:function(){P.Module.prototype.onContentReady.apply(this,arguments);var a=this.options.pin_id;if(a){var b={};b[P.CONST.PUBSUB_TOPIC_PIN_LIKED]=this.onPinLiked,b[P.CONST.PUBSUB_TOPIC_PIN_UNLIKED]=this.onPinUnliked,this.pubsubSubscribe(a,b)}var c={};c[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this.onPinRepinned,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,c),this.childListen(P.CONST.EVENT_INCREMENT_BUTTON_DESTROY,this.onCloseupIncrementButtonHide),this.childListen(P.CONST.EVENT_INCREMENT_BUTTON_CREATE,this.onCloseupIncrementButtonShow),this.childListen(P.CONST.EVENT_REQUIRES_AUTHENTICATION,function(a){a.data.contextualResource||(a.data.contextualResource=this.getContextualResource())}),this.extraData&&this.extraData.showPinTip&&this.showSavePinTooltip()},removeDropdowns:function(){var a=this.getDropdowns();_.each(a,function(a){a.hide()})},showSavePinTooltip:function(){var a=this.getChildById("pinItButton"),b={name:"Dropdown",options:{anchor:a.$el,class_name:"large",fixed:!1,position_point:"BOTTOM_LEFT",text:P._("<strong>Want to save this Pin for yourself?</strong> Go ahead and Pin It.")}},c=this;P.loadModule(b,function(a){a.render(function(){c.appendChild(a),a.positionModule(),a.fadeIn()})})},getDropdowns:function(){var a=this.getChildrenByModuleName("DropdownButton"),b=this.getChildrenByModuleName("Dropdown")||[];return _.map(a,function(a){var c=a.getDropdown();b.push(c)}),b},getContextualResource:function(){return P.resourceFactory.create("PinResource",{id:this.options.pin_id})},showRepinModal:function(){var a=this.getChildById(PIN_IT_BUTTON_ID);a.showModal()},getLoadingSpinnerOptions:function(){return null},onPinRepinned:function(a,b,c){var d=this.getChildById(REPINS_BUTTON_ID);c.board&&"secret"!==c.board.privacy&&d&&d.increment()},onPinLiked:function(){var a=this.getChildById(LIKES_BUTTON_ID);a&&a.increment()},onPinUnliked:function(){var a=this.getChildById(LIKES_BUTTON_ID);a&&a.decrement()},onCloseupIncrementButtonHide:function(a){var b=a.data,c=this.getChildById(b);c.$el.removeClass(ACTION_LEFT_ROUNDED_CLASS)},onCloseupIncrementButtonShow:function(a){var b=a.data,c=this.getChildById(b);c.$el.addClass(ACTION_LEFT_ROUNDED_CLASS)},setDropdownsFixed:function(a){var b=this.getDropdowns();_.each(b,function(b){var c=_.clone(b.options);c.fixed=a,b.setOptions(c),b.positionModule()})},updateSticky:function(a){this._sticky||(this._sticky=new P.Sticky(this.$el,a),this.listen(this._sticky,P.CONST.EVENT_STICKY_FIXED,function(a){this.setDropdownsFixed(a)}))},unsticky:function(){this._sticky&&this._sticky.unSticky()},getLoggingObjectIdStr:function(){return this.options.pin_id},moduleRenderer:new P.ModuleRendererLocal("app/desktop/modules/PinActionBar/PinActionBar.nunjucks")}),goog.provide("P.modules.PinForm"),goog.require("P.Module"),goog.require("P.modules.UserSocialNetworkSettings");var FB_KEY=P.SocialConnect.FACEBOOK,TW_KEY=P.SocialConnect.TWITTER,SECRET="secret",SHARE_SOCIAL_WRAPPER_SELECT=".socialShareWrapper";P.modules.PinForm=P.modules.UserSocialNetworkSettings.extend({events:{'change [name="share_facebook"]':"onFacebookCheckboxChanged"},onCreated:function(){P.modules.UserSocialNetworkSettings.prototype.onCreated.apply(this,arguments),this.networkToSelectorMap={},this.networkToSelectorMap[FB_KEY]='[name="share_facebook"]',this.networkToSelectorMap[TW_KEY]='[name="share_twitter"]'},onFacebookCheckboxChanged:function(){var a=this.getNetworkChecked(P.SocialConnect.FACEBOOK);if(a){var b=this;P.FbUtil.maybeRequestFbTimelinePermission({error:function(){b.setNetworkChecked(P.SocialConnect.FACEBOOK,!a)}})}},onContentReady:function(){var a={description:[P.Validator.Required(),P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION})]};this.form=new P.Form(this.$("form"),a),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BOARD_SELECTED,this.onBoardSelected),this.childListen(P.CONST.EVENT_HIDE_PLACE_FIELDS,this.onHidePlaceFields),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this._boardPicker=this.getBoardPicker(),this._boardPicker.getPrivacy()===SECRET&&this.hideSocialExplicitSharing();var b=this.getChildById("uploader");b&&this.listen(b,P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess)},onHidePlaceFields:function(){var a=this.$(".fields"),b=this.getChildById("addPlaceButton");b&&(b.setText(P._("Add location to this Pin")),b.show()),a.addClass("hidden")},onButtonClick:function(a){var b=a.target,c=b.id;if("addPlaceButton"===c){a.target.hide(),this.$(".fields").removeClass("hidden");var d=this.getChildById("placeSelector");d&&d.focusPlaceField()}},onBoardSelected:function(a){a.data.privacy===SECRET?this.hideSocialExplicitSharing():this.showSocialExplicitSharing()},hideSocialExplicitSharing:function(){this.$(SHARE_SOCIAL_WRAPPER_SELECT).hide()},showSocialExplicitSharing:function(){this.$(SHARE_SOCIAL_WRAPPER_SELECT).show()},onSubmitValidated:function(a){this.triggerEvent(P.CONST.EVENT_SUBMIT_VALIDATED,a,!0)},onUploadSuccess:function(a){var b=a.data.image_url,c=this.getChildById("pinPreview");c.setImage(b),this.options.image_url=b},getBoardPicker:function(){return this.getChildById("boardPicker")},getBoardId:function(){return this._boardPicker.getSelectedBoardId()},getDescription:function(){return this.getChildById("pinDescriptionField").getValue()},setNetworkChecked:function(a,b){var c=this.networkToSelectorMap[a];c&&this.$(c).prop("checked",b)},getNetworkChecked:function(a){var b=this.networkToSelectorMap[a];if(b){var c=this.$(b);return c.length?c.is(":checked"):""}},getImageUrl:function(){return this.options.image_url},getLink:function(){return this.$("#pinFormLink").val()||""},getData:function(){var a={board_id:this.getBoardId(),description:this.getDescription(),link:this.getLink()},b=this.getNetworkChecked(P.SocialConnect.TWITTER);""!==b&&(a.share_twitter=b),b=this.getNetworkChecked(P.SocialConnect.FACEBOOK),""!==b&&(a.share_facebook=b);var c=this.getImageUrl();if(c&&(a.image_url=c,P.beginsWith(c,"//"))){var d=document.referrer;if(d){var e;P.beginsWith(d,"http://")?e="http:":P.beginsWith(d,"https://")&&(e="https:"),e&&(a.image_url=e+a.image_url)}}var f=P.experiments.instance.inExperimentGroups("web_place_repin_form",["enabled","enabled2"]);if(f){var g=this.getChildById("placeSelector");if(g){var h=g.getSelectedPlace();h&&(a.place=h)}}else{var i=this.$("#pinPlaceId");i.length&&(a.place=i.val())}return a}}),goog.provide("P.modules.PinLikeButton"),goog.require("P.Module"),goog.require("P.modules.PinLikeButtonBase"),P.modules.PinLikeButton=P.modules.PinLikeButtonBase.extend({moduleRenderer:new P.ModuleRendererLocal("app/desktop/modules/PinLikeButton/PinLikeButton.nunjucks")}),goog.provide("P.modules.PresenterButton"),goog.require("P.modules.DropdownButton"),P.modules.PresenterButton=P.modules.DropdownButton.extend({}),goog.provide("P.modules.UserMenu"),goog.require("P.Module"),goog.require("P.modules.DropdownButton"),P.modules.UserMenu=P.modules.DropdownButton.extend({onContentReady:function(){var a=this.extraData.userId;if(a){var b={};b[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(this.extraData.userId,b)}P.modules.DropdownButton.prototype.onContentReady.apply(this,arguments)},onUserUpdated:function(){this.render()},setSticky:function(a){this.getDropdown().setSticky(a)}}),goog.provide("P.modules.UserNews"),goog.require("P.Module"),goog.require("P.modules.FriendsToFollow");var NETWORK_TO_RESOURCE_NAME={google:"UserGmailFriendsResource",yahoo:"UserYahooFriendsResource"};P.modules.UserNews=P.Module.extend({events:{"click .sendInvite":"showBulkInviteBox"},onContentReady:function(){this.destroyIfEmpty()},onChildRemoved:function(){this.destroyIfEmpty()||this.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},getEditFeedButton:function(){var a=this.getChildByModuleName("BoardsToFollow");return a.getEditFeedButtonElement()},getFriendsToFollowButton:function(){var a=this.getChildByModuleName("FriendsToFollow");return a.getHeaderElement()},showBulkInviteBox:function(){var a=this.options.email_invite_network,b={name:"MultiInviter"};a&&(b.resource={name:NETWORK_TO_RESOURCE_NAME[a],options:{username:P.currentUser.id,filter:"not_on_pinterest",network:a}},b.options={network:a}),P.loadModule(b,function(a){P.getModalManager().showInModal(a)})}}),goog.provide("P.modules.UserSelectBase"),goog.require("P.Module"),goog.require("P.modules.ui.TypeaheadField"),goog.require("P.modules.UserSocialNetworkSettings");var USER_SELECT_BASE_CLASS_ACTIVE="active",USER_SELECT_BASE_CLASS_ANIMATE="animate",USER_SELECT_BASE_CLASS_HIDDEN="hidden",SEND_DELAY=2600,CONNECT_SUCCESS_DELAY=2600,ACTIVATE_DELAY=400;P.modules.UserSelectBase=P.modules.UserSocialNetworkSettings.extend({events:{"click .undoUserSelect":"hideFakeSuccess","click .userSelectEmailConnect":"onEmailUserPress","keyup .field":"onFieldKeyup"},sendDelay:SEND_DELAY,onCreated:function(){P.modules.UserSocialNetworkSettings.prototype.onCreated.apply(this,arguments),this._selectedItem=null},getSelectedItem:function(){return this._selectedItem},clearSelectedItem:function(){this._selectedItem=null},onAddedToDom:function(){this._messageShowing=!1,this._hasQueriedTypeahead=!1,this._gplusButtonLoaded=!1},onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,a),this.$staticResults=this.$(".staticResults"),this.$message=this.$('input[name="message"]'),this.$beforeSend=this.$(".userSelectBeforeSend"),this.$afterSend=this.$(".userSelectAfterSend"),this.$afterConnect=this.$(".userSelectAfterConnect"),this.$userSelectMessageWrapper=this.$(".userSelectMessageWrapper"),this.$emailButtonWrapper=this.$(".emailButtonWrapper"),this.$gmailButtonWrapper=this.$(".gmailButtonWrapper"),this.$facebookButtonWrapper=this.$(".facebookButtonWrapper"),this.$yahooButtonWrapper=this.$(".yahooButtonWrapper"),this.$findFriend=this.$('input[name="userSelectFriendSearch"]'),this.$gplusButtonWrapper=this.$(".gplusButtonWrapper"),this.sendEmailButton=this.getChildById("sendEmail"),this.gplusButton=this.$(".userSelectGplusConnect")[0],this.typeaheadField=this.getChildById("userSelectField"),this.childListen("enterPressed",this.onChildEnterPressed),this.listen(this.parent,P.CONST.EVENT_DROPDOWN_SHOW,this.onEventDropdownShow),this.listen(this.parent,P.CONST.EVENT_DROPDOWN_HIDE,this.onHide),this.buttonListener&&this.removeListener(this.buttonListener),this.buttonListener=this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(P.CONST.EVENT_USER_CLICK,this.onUserClick),this.childListen(P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onTypeaheadResultsReturned),this.childListen(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onNoTypeaheadResultsReturned),this.childListen(P.CONST.EVENT_TYPEAHEAD_RENDER_DONE,this.onTypeaheadRenderDone),this.$message.placeholder(),this.$findFriend.placeholder(),this.loadGplusButton()},onChildEnterPressed:function(){this.onEmailUserPress()},onTypeaheadRenderDone:function(){},enableGplusShareButton:function(a,b,c){var d=this.$("."+a)[0],e=this;P.gapi.get(function(f){var g={contenturl:b,clientid:e.extraData.gplusClientId,cookiepolicy:"single_host_origin",prefilltext:P._("Join me on Pinterest!"),calltoactionurl:b,recipients:a,calltoactionlabel:c};f.interactivepost.render(d,g)})},onEventDropdownShow:function(){this.focusFriendTypeahead()},onNoTypeaheadResultsReturned:function(){this.showStaticResults(),this.showStaticSocialOptions(),this.showSendEmailButton(),this.focusFriendTypeahead()},onTypeaheadResultsReturned:function(a){var b=a.data.count;this._hasQueriedTypeahead=!0,b?(this.showStaticResults(),this.showSendEmailButton(),this.hideStaticSocialOptions()):this.showStaticSocialOptions()},loadGplusButton:function(){var a=this;P.gapi.get(function(b){this._gplusButtonLoaded||(this._gplusButtonLoaded=!0,b.signin.render(this.gplusButton,{clientid:a.extraData.gplusClientId,accesstype:"offline",cookiepolicy:"single_host_origin",scope:"https://www.googleapis.com/auth/userinfo.email",apppackagename:"com.pinterest",callback:function(b){a.onGplusAuth(b)}}))})},onGplusAuth:function(a){if(a.code&&"none"!==a.prompt){var b={},c={};c.one_time_code=a.code,b.data=c,b.network="gplus";var d=P.resourceFactory.create("UserSocialNetworkResource",b),e=this;d.callCreate().done(function(){e.showConnectSuccess("gplus"),P.trackGAEvent("user_connect_gplus",P.CONST.GA_ACTION_SUCCESS)})}},showGplusConnectButton:function(){this.loadGplusButton(),this.$gplusButtonWrapper.removeClass(USER_SELECT_BASE_CLASS_HIDDEN)},hideGplusConnectButton:function(){this.$gplusButtonWrapper.addClass(USER_SELECT_BASE_CLASS_HIDDEN)},hideGmailConnectButton:function(){this.$gmailButtonWrapper.addClass(USER_SELECT_BASE_CLASS_HIDDEN)},showGmailConnectButton:function(){this.$gmailButtonWrapper.removeClass(USER_SELECT_BASE_CLASS_HIDDEN)},hideFacebookConnectButton:function(){this.$facebookButtonWrapper.addClass(USER_SELECT_BASE_CLASS_HIDDEN)},showFacebookConnectButton:function(){this.$facebookButtonWrapper.removeClass(USER_SELECT_BASE_CLASS_HIDDEN)},hideYahooConnectButton:function(){this.$yahooButtonWrapper.addClass(USER_SELECT_BASE_CLASS_HIDDEN)},showYahooConnectButton:function(){this.$yahooButtonWrapper.removeClass(USER_SELECT_BASE_CLASS_HIDDEN)},hideSendEmailButton:function(){this.$emailButtonWrapper.addClass(USER_SELECT_BASE_CLASS_HIDDEN)},showSendEmailButton:function(){this.$emailButtonWrapper.removeClass(USER_SELECT_BASE_CLASS_HIDDEN)},hideStaticSocialOptions:function(){this.hideFacebookConnectButton(),this.hideGplusConnectButton(),this.hideGmailConnectButton(),this.hideYahooConnectButton()},showStaticSocialOptions:function(){this.showSendEmailButton(),this.showFacebookConnectButton(),this.showGplusConnectButton(),this.showGmailConnectButton(),this.showYahooConnectButton()},hideStaticResults:function(){this.$staticResults.addClass(USER_SELECT_BASE_CLASS_HIDDEN)},showStaticResults:function(){this.$staticResults.removeClass(USER_SELECT_BASE_CLASS_HIDDEN)},focusAddMessageField:function(){this.$message.focusWithoutScrolling()},focusFriendTypeahead:function(){this.$findFriend.focusWithoutScrolling()},setEmailButtonText:function(a,b){var c=P._("Email to {{ email_address }}"),d=P.string.format(c,{email_address:a});this.sendEmailButton.setText(d);var e=!b;this.$(".sendEmailError").text(b).toggleClass("hidden",e)},onHide:function(){var a=this;this._timeout&&this._selectedItem&&(this.onSendAction(),this.reset(),clearTimeout(a._timeout))},onFieldKeyup:function(a){var b=P.keyCode;if(a.keyCode!==b.ENTER&&a.keyCode!==b.NUMPAD_ENTER)if(this.$findFriend.val().length>0){this.sendEmailButton.show();var c=this.$findFriend.val();this.setEmailButtonText(c,"")}else this.sendEmailButton.hide()},onEmailUserPress:function(){var a=this,b=new P.Validator(this.$findFriend,[P.Validator.Length({min:1}),P.Validator.Email()]);b.validate(function(b){if(b.errors.length>0){var c=a.$findFriend.val(),d=b.errors[0];a.setEmailButtonText(c,d)}else a._selectedItem={full_name:a.$findFriend.val(),email:a.$findFriend.val(),type:"emailtypeahead"},a.showSuccess()})},hideSendMessage:function(){this.$userSelectMessageWrapper.addClass(USER_SELECT_BASE_CLASS_ANIMATE)},showSendMessage:function(){this.$userSelectMessageWrapper.removeClass(USER_SELECT_BASE_CLASS_ANIMATE)},onShowMessageClick:function(a){this.showSendMessage();var b=a.target;return b.hide(),this.focusAddMessageField(),!1},removeMessageContent:function(){this.$message.val("")},onUserClick:function(a){var b=a.target.data,c=a.target;b&&(this._selectedItem=b,b.image_medium_url||(this._selectedItem.image_medium_url=c.getProfileImage()),this.showSuccess())},onButtonClick:function(a){var b=a.target;if(b){var c,d=b.id;if("addMessage"===d)return void this.onShowMessageClick(a);switch(d){case"connectFacebook":c=P.SocialConnect.FACEBOOK;break;case"connectGmail":c=P.SocialConnect.GOOGLE;break;case"connectGplus":c=P.SocialConnect.GPLUS;break;case"connectYahoo":c=P.SocialConnect.YAHOO;break;default:return}this.connectToNetwork(c)}},isEmailType:function(a){return"emailcontact"===a||"emailtypeahead"===a||"email"===a},connectToNetwork:function(a){if(a!==P.SocialConnect.GPLUS){var b=this;this.handleConnect(a,!0,{success:function(){b.showConnectSuccess(a),P.trackGAEvent("user_connect_"+a,P.CONST.GA_ACTION_SUCCESS)}})}},hideNetworkConnectButton:function(a){switch(a){case P.SocialConnect.FACEBOOK:this.hideFacebookConnectButton();break;case P.SocialConnect.GPLUS:this.hideGplusConnectButton();break;case P.SocialConnect.YAHOO:this.hideYahooConnectButton()}},showAndHideItem:function(a,b){b.addClass(USER_SELECT_BASE_CLASS_ANIMATE),P.supportCSSTransitions()?window.setTimeout(function(){a.addClass(USER_SELECT_BASE_CLASS_ACTIVE)},ACTIVATE_DELAY):a.addClass(USER_SELECT_BASE_CLASS_ACTIVE)},showConnectSuccess:function(a){var b=this;this.showAndHideItem(this.$afterConnect,this.$beforeSend);var c,d={facebook:"Facebook",google:"Gmail",gplus:"Google+",yahoo:"Yahoo"};a in d?c=d[a]:(P.Logger.getLogger("UserSelectBase").error("Unknown network "+a),c=a),this.$(".userConnectedNetworkName").text(c),this.$(".userSelectConnectSuccessMug").addClass(a+"ConnectSuccessMug"),this._timeout=P.setTimeout(function(){b.resetUserSelect()},CONNECT_SUCCESS_DELAY)},resetUserSelect:function(){this.showAndHideItem(this.$beforeSend,this.$afterConnect),this.reset(),this.render(),this.focusFriendTypeahead(),clearTimeout(this._timeout)},showSuccess:function(){var a=this,b=this._selectedItem,c=b.full_name||b.first_name,d=b.image_medium_url;this.showAndHideItem(this.$afterSend,this.$beforeSend),this.$(".receiverName").text(c),this.$(".userSelectSuccessMug").attr("src",d),this._timeout=P.setTimeout(function(){a.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0)},SEND_DELAY)},reset:function(){this.hideFakeSuccess(),this.hideSendMessage(),this.setMessageValue(""),this.typeaheadField.clear(),this.typeaheadField.closeTypeahead(),this.getChildById("addMessage").show(),this.hideSendEmailButton()},hideFakeSuccess:function(){var a=this;this.$beforeSend.removeClass(USER_SELECT_BASE_CLASS_HIDDEN+" "+USER_SELECT_BASE_CLASS_ANIMATE),this.$afterSend.removeClass(USER_SELECT_BASE_CLASS_ACTIVE+" "+USER_SELECT_BASE_CLASS_ANIMATE),clearTimeout(a._timeout),this._timeout=null},getMessageValue:function(){return $.trim(this.$(".message").val())},setMessageValue:function(a){return $.trim(this.$(".message").val(a))},showTypeaheadResults:function(){var a=this.getChildByModuleName("ui.Typeahead");a.show()},isValidItemType:function(a){return"user"===a||"email"===a||"emailcontact"===a},onChildItemSelected:function(a){a.stopPropagation();var b=a.data.item.attributes;if(this.isValidItemType(b.type))return this._selectedItem=b,this.showSuccess(),!1},onSearchQueryUpdated:function(a,b,c){var d=c||"";this.typeaheadField.setValue(d)},onSendAction:function(){}}),goog.provide("P.modules.UserSelectFriendsInvite"),goog.require("P.Module"),goog.require("P.modules.UserSelectBase");var CLASS_HIDDEN="hidden";P.modules.UserSelectFriendsInvite=P.modules.UserSelectBase.extend({onContentReady:function(){P.modules.UserSelectBase.prototype.onContentReady.call(this),P.fb.ensureInit(P.NOOP)},onChildItemSelected:function(a){a.stopPropagation();var b=a.data.item.attributes;return"facebook_non_pinner"===b.type?(P.Invite.userInviteFacebook(b),void this.resetForNextInvite()):b.type===P.CONST.TYPEAHEAD_TYPE_GPLUS_NON_PINNER?(P.Invite.trackInvite("gplus",!0),void this.resetForNextInvite()):void P.modules.UserSelectBase.prototype.onChildItemSelected.call(this,a)},onSendAction:function(){var a=this.getSelectedItem();"user"===a.type?this.userFollow(a):this.isEmailType(a.type)?P.Invite.userInviteEmail(a.email):P.showError(P.string.common.defaultErrorMessage),this.resetForNextInvite()},onTypeaheadRenderDone:function(a){var b=P.absolutify("/"+P.currentUser.get("username"));this.enableGplusShareButton(a.data,b,"VISIT")},userFollow:function(a){var b=P.resourceFactory.create("UserFollowResource",{user_id:a.id});b.call("create").done(function(){P.Invite.trackInvite("pinterest",!0)}).fail(function(){P.Invite.trackInvite("pinterest",!1)})},resetForNextInvite:function(){this.parent&&this.parent.show(),this.reset(),this.$(".inviteFriends").addClass(CLASS_HIDDEN),this.$(".inviteMoreFriends").removeClass(CLASS_HIDDEN)},showSuccess:function(){var a=this.getSelectedItem(),b=this.$(".inviteSent"),c=this.$(".followSent");"user"===a.type?(b.addClass(CLASS_HIDDEN),c.removeClass(CLASS_HIDDEN)):(b.removeClass(CLASS_HIDDEN),c.addClass(CLASS_HIDDEN)),P.modules.UserSelectBase.prototype.showSuccess.call(this)}}),goog.provide("P.modules.UserSelectPinSend"),goog.require("P.Module"),goog.require("P.modules.UserSelectBase"),P.modules.UserSelectPinSend=P.modules.UserSelectBase.extend({onContentReady:function(){P.modules.UserSelectBase.prototype.onContentReady.call(this),P.fb.ensureInit(P.NOOP)},sendPinUser:function(a){var b=this,c=this.options.pin_id;if(a){var d=a.id,e=a.full_name||a.first_name;e||(e="");var f={pin:c,recipient_name:e,user_id:d},g=this.getMessageValue();g&&(f.message=g);var h;h=P.resourceFactory.create("SharePinResource",f),h.callCreate({success:function(){b.clearSelectedItem()},error:function(){P.showError(P.string.common.defaultErrorMessage)}}),this.clearSelectedItem()}},_sendPinFacebookUserId:function(){var a=P.resourceFactory.create("SendPinFacebookResource",{pin:this.options.pin_id});return a.callCreate()},sendPinFacebook:function(a){var b=this;P.fb.ensureLoggedIn(function(){b._sendPinFacebook(a)})},_sendPinFacebook:function(a){var b=this;this._sendPinFacebookUserId().done(function(c){var d,e=c.resource_response.data;d=_.isString(e)?e:e.share_url,P.FacebookDialog.open({type:"send",picture:b.options.pin_image.url,path:d,to:a.id,callback:function(a){a&&a.success&&P.trackGAEvent("pin_send_facebook",P.CONST.GA_ACTION_SUCCESS)}}),P.trackGAEvent("pin_send_facebook",P.CONST.GA_ACTION_OPEN_MODAL)}).fail(function(){P.trackGAEvent("pin_send_facebook",P.CONST.GA_ACTION_ERROR)}),this.reset()},sendPinEmail:function(a){var b=a.email||a.email_address,c=a.full_name||a.first_name,d={pin:this.options.pin_id,email:b,recipient_name:c||b},e=this.getMessageValue();e&&(d.message=e);var f=P.resourceFactory.create("EmailPinResource",d);f.callCreate({success:function(){P.trackGAEvent("pin_email",P.CONST.GA_ACTION_SUCCESS)},error:function(a){P.trackGAEvent("pin_email",P.CONST.GA_ACTION_ERROR),P.showError(a.message)}})},onTypeaheadRenderDone:function(a){var b=P.absolutify("/pin/"+this.options.pin_id);this.enableGplusShareButton(a.data,b,"PIN_IT")},onButtonClick:function(a){P.modules.UserSelectBase.prototype.onButtonClick.call(this,a)},logThirdPartySendPin:function(a,b){var c={userid:P.currentUser.id,send_method:b,recipient_email:null,recipient_name:a.name,recipient_id:null,pin:this.options.pin_id,message:null,time:jQuery.now()},d={topic:"send_pin",content:c},e=P.resourceFactory.create("EventLoggingResource",d);e.callCreate({error:P.NOOP})},onChildItemSelected:function(a){a.stopPropagation();var b=a.data.item.attributes;return"facebook_non_pinner"===b.type?(this.sendPinFacebook(b),this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0),void this.logThirdPartySendPin("facebook")):b.type===P.CONST.TYPEAHEAD_TYPE_GPLUS_NON_PINNER?(this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0),void this.logThirdPartySendPin("gplus")):void P.modules.UserSelectBase.prototype.onChildItemSelected.call(this,a)},onSendAction:function(){var a=this.getSelectedItem();
"user"===a.type?this.sendPinUser(a):this.isEmailType(a.type)?this.sendPinEmail(a):P.showError(P.string.common.defaultErrorMessage)}}),goog.provide("P.modules.tutorials.ModalCategorySearchIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalCategorySearchIntro=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this._getHighlightedElementForModule("categoriesDropdownButton"),c=this._getHighlightedElementForModule("exploreCategoriesButton"),d=this._getHighlightedElementForModule("exploreInterestsButton"),e=this._getHighlightedElementForModule("mainSearchTextbox"),f=b||c||d||e;f&&(this.setModalPosition("BOTTOM_LEFT",f,!0),f.addClass("categorySearchIntroHighlight")),a&&a()},_getHighlightedElementForModule:function(a){var b=this._getModuleChildById(P.app,a);return b?this._highlightModule(b,!0):null},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_CATEGORY_SEARCH_USER_ED}}),goog.provide("P.modules.tutorials.ModalExploreButton"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalExploreButton=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){this.module=this._getModuleChildById(P.app,"categoriesDropdownButton")||this._getModuleChildById(P.app,"headerExploreButton")||this._getModuleChildById(P.app,"exploreCategoriesButton");var b;this.module&&(b=this._highlightModule(this.module,!0)),b&&this.setModalPosition("BOTTOM_LEFT",b,!0),a&&a()},onButtonClick:function(a){var b=a.target;"nextButton"===b.id&&("DropdownButton"===this.module.className?this.module.showDropdown():this.navigate("/explore/"))},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_EXPLORE_BUTTON_USER_ED}}),goog.provide("P.modules.tutorials.ModalExploreCheckBack"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalExploreCheckBack=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b,c=this._getModuleChildById(P.app,"header");b="ModernHeader"!==c.className?"categoriesDropdownButton":"exploreCategoriesButton";var d=c.getChildById(b),e=this._highlightModule(d,!0);this.setModalPosition("BOTTOM_LEFT",e,!0),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_EXPLORE_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_EXPLORE_PAGE_USER_ED}}),goog.provide("P.modules.tutorials.ModalExploreInterest"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalExploreInterest=P.modules.tutorials.ModalStepBase.extend({highlightChildState:1,onEnter:function(a){this.ensurePath("/explore/"),a&&a()},onShow:function(a){var b=this,c=this._getModuleChildById(P.app,"interestGrid"),d=this._getModuleChildrenByModuleName(c,"Interest");if(d=_.filter(d,function(a){return a.state===b.highlightChildState}),d.length){var e=d[0];1===this.highlightChildState&&d.length>=3&&(e=d[3]);var f=this._highlightModule(e,!0),g=$(window).width(),h="RIGHT_TOP";f.offset().left+f.width()>g/2&&(h="LEFT_TOP"),this.setModalPosition(h,f,!0),a&&a()}}}),goog.provide("P.modules.tutorials.ModalExplorePage"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalExplorePage=P.modules.tutorials.ModalStepBase.extend({onEnter:function(a){this.ensurePath("/explore/"),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_EXPLORE_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_EXPLORE_PAGE_USER_ED}}),goog.provide("P.modules.tutorials.ModalFastFollowIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalFastFollowIntro=P.modules.tutorials.ModalStepBase.extend({onCreated:function(){P.modules.tutorials.ModalStepBase.prototype.onCreated.apply(this,arguments),this.listen(this,P.CONST.EVENT_NEXT,_.bindFn(this.onNextClicked,this))},onNextClicked:function(){var a=this._getMenu(),b=a.getDropdown().getContentModule();b.openFindBoards()},onShow:function(a){var b=this,c=this._getMenu();c.getDropdown().setSticky(!0),c.showDropdown(_.bindFn(function(){var d=c.getDropdown().getContentModule(),e=d.getFindBoardsElement(),f=this._highlightElement("highlightContainer",e,!0);f.addClass("fastFollowIntroHighlight"),f.on("click",function(){b.triggerEvent(P.CONST.EVENT_NEXT,null,!0)}),this.setModalPosition("LEFT_TOP",f,!0),a&&a()},this))},_getMenu:function(){return this._getModuleChildById(P.app,"userMenu")||this._getModuleChildById(P.app,"moreMenu")},onExit:function(a){if(P.app){var b=this._getMenu();b.getDropdown().setSticky(!1),b.hideDropdown()}a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_FAST_FOLLOW_USER_ED}}),goog.provide("P.modules.tutorials.ModalFindFriendsIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalFindFriendsIntro=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){this.highlightFindFriendsInMenu(a)},onExit:function(a){if(P.app){var b=this._getMenu();b.getDropdown().setSticky(!1),b.hideDropdown()}a&&a()},highlightFindFriendsInMenu:function(a){var b=this,c=this._getMenu();c.getDropdown().setSticky(!0),c.showDropdown(_.bindFn(function(){var d=c.getDropdown().getContentModule(),e=d.getFindFriendsElement(),f=this._highlightElement("highlightContainer",e,!0);f.addClass("findFriendsIntroHighlightMenu"),f.on("click",function(){b.triggerEvent(P.CONST.EVENT_NEXT,null,!0)});var g="LEFT_TOP";P.experiments.modernHeader&&(g="CENTER_TOP"),this.setModalPosition(g,f,!0),a&&a()},this))},_getMenu:function(){return this._getModuleChildById(P.app,"userMenu")||this._getModuleChildById(P.app,"moreMenu")},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_FIND_FRIENDS_USER_ED}}),goog.provide("P.modules.tutorials.ModalFirstBoardIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalFirstBoardIntro=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){$("html, body").scrollTop(0);var b=!1,c=this._getModuleChildrenByModuleName(P.app,"UserProfileContent");if(c&&c[0]){var d=c[0].data,e=d.board_count+d.secret_board_count;b=e>0}var f,g;b?(f=this.$(".hasBoardsTitle"),g=this.$(".hasBoardsContent")):(f=this.$(".hasNoBoardsTitle"),g=this.$(".hasNoBoardsContent")),f.show(),g.show(),this.highlightBoard(),a&&a()},highlightBoard:function(){if(this.board=this.getTargetBoard(),this.board){var a=this._highlightModule(this.board,!0);a.on("click",_.bindFn(this.onBoardClicked,this)),a.addClass("firstBoardIntroHighlight");var b,c=$(window).height();b=a.offset().top+a.height()>c?"TOP_LEFT":"RIGHT_TOP",this.setModalPosition(b,a,!0)}},setCloneInteractions:function(a){this.disableCloneLinks(a)},getTargetBoard:function(){var a,b=this._getModuleChildrenByModuleName(P.app,"Grid")[0];if(b){var c=b.getGridItems();a=c.getChildModuleAtIndex(0,"BoardCreateRep")}return a},onBoardClicked:function(a){return a.preventDefault(),this.triggerEvent(P.CONST.EVENT_PREVIOUS,null,!0),this.board.showModal(),!1},getPlacementId:function(){return P.Experiences.Placement.WEB_USER_PROFILE_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_FIRST_BOARD_USER_ED}}),goog.provide("P.modules.tutorials.ModalFirstPinIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalFirstPinIntro=P.modules.tutorials.ModalStepBase.extend({onCreated:function(){P.modules.tutorials.ModalStepBase.prototype.onCreated.apply(this,arguments),this.listen(P.Viewport,P.CONST.EVENT_BODY_COLUMN_CHANGE,_.bindFn(this.onBodyColumnChange,this))},onShow:function(a){this.highlightPin(),a&&a()},highlightPin:function(){if(this.pin=this.getTargetPin(),this.pin){var a=this._highlightModule(this.pin,!0);this.$repinButton=a.find(".repinSmall"),this.$repinButton.on("click",_.bindFn(this.onRepinClicked,this)),this.modal.$el.addClass("modalPinIntro"),this.setModalPosition("LEFT_TOP",this.$repinButton,!0),a.addClass("firstPinIntroHighlight")}},setCloneInteractions:function(a){this.disableCloneLinks(a)},getTargetPin:function(){var a=this._getModuleChildrenByModuleName(P.app,"Grid")[0];if(a){var b=a.getGridItems(),c=Math.ceil(P.Viewport.numColumns/2);return b.getChildModuleAtIndex(c,"Pin")}},onBodyColumnChange:function(){this.$repinButton.off(),this.$repinButton=null,this.cleanHighlightedElements(),this.highlightPin()},onRepinClicked:function(){this.triggerEvent(P.CONST.EVENT_PREVIOUS,null,!0);var a=this.pin.getChildById("pinItButton");a.showModal()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_FIRST_PIN_USER_ED}}),goog.provide("P.modules.tutorials.ModalHomeFeedPinIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase");var MODAL_HOME_FEED_LOGO_STEP_BACKGROUND_CLASS="pinterestLogoStepBackground";P.modules.tutorials.ModalHomeFeedPinIntro=P.modules.tutorials.ModalStepBase.extend({onEnter:function(a){this.ensurePath("/"),a&&a()},onShow:function(a){var b=this._getModuleChildById(P.app,"header"),c=b.getHomeElement(),d=this._highlightElement("homeButton",c,!0),e=$("<div>");e.addClass(MODAL_HOME_FEED_LOGO_STEP_BACKGROUND_CLASS),e.css({top:d.offset().top-60,left:d.offset().left}),$("body").append(e),a&&a()},onExit:function(a){$("."+MODAL_HOME_FEED_LOGO_STEP_BACKGROUND_CLASS).remove(),a&&a()}}),goog.provide("P.modules.tutorials.ModalModernHeaderExplore"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalModernHeaderExplore=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this._getModuleChildById(P.app,"header"),c=b.getExploreButton().$el,d=this._highlightElement("exploreButton",c,!0);d&&(this.setModalPosition("BOTTOM_LEFT",d,!0),d.addClass("modernHeaderExploreHighlight")),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_MODERN_HEADER_USER_ED}}),goog.provide("P.modules.tutorials.ModalModernHeaderHome"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalModernHeaderHome=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this._getModuleChildById(P.app,"header"),c=b.getHomeButton().$el,d=this._highlightElement("homeButton",c,!0);d&&(this.setModalPosition("BOTTOM_LEFT",d,!0),d.addClass("modernHeaderHomeHighlight")),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_MODERN_HEADER_USER_ED}}),goog.provide("P.modules.tutorials.ModalModernHeaderIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalModernHeaderIntro=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this._getModuleChildById(P.app,"header").$el,c=this._highlightElement("header",b,!0);c&&c.addClass("modernHeaderIntroHighlight"),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_MODERN_HEADER_USER_ED}}),goog.provide("P.modules.tutorials.ModalModernHeaderMore"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalModernHeaderMore=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this._getModuleChildById(P.app,"header"),c=b.getMoreMenu().$el,d=this._highlightElement("moreMenu",c,!0);d&&(this.setModalPosition("BOTTOM_RIGHT",d,!0),d.addClass("modernHeaderMoreHighlight")),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_MODERN_HEADER_USER_ED}}),goog.provide("P.modules.tutorials.ModalModernHeaderProfile"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalModernHeaderProfile=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this._getModuleChildById(P.app,"header"),c=b.getProfileButton().$el,d=this._highlightElement("profileButton",c,!0);d&&(this.setModalPosition("BOTTOM_LEFT",d,!0),d.addClass("modernHeaderProfileHighlight")),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_MODERN_HEADER_USER_ED}}),goog.provide("P.modules.tutorials.ModalModernHeaderSearch"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalModernHeaderSearch=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this._getModuleChildById(P.app,"header"),c=b.getSearchBox().$el,d=this._highlightElement("searchBox",c,!0);d&&(this.setModalPosition("BOTTOM_CENTER",d,!0),d.addClass("modernHeaderSearchHighlight")),a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_MODERN_HEADER_USER_ED}}),goog.provide("P.modules.tutorials.ModalPinIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase");var SAMPLE_PIN_CLASS="samplePinTutorialStep";P.modules.tutorials.ModalPinIntro=P.modules.tutorials.ModalStepBase.extend({onEnter:function(a){this.ensurePath("/"),$("body").append('<div class="'+SAMPLE_PIN_CLASS+'">&nbsp;</div>'),a&&a()},onShow:function(a){var b=$("."+SAMPLE_PIN_CLASS);this.setModalPosition("RIGHT_TOP",b,!0),a&&a()},onExit:function(a){$("."+SAMPLE_PIN_CLASS).remove(),a&&a()}}),goog.provide("P.modules.tutorials.ModalPlacePinsAddBase"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalPlacePinsAddBase=P.modules.tutorials.ModalStepBase.extend({onShow:function(){this.highlightAddButton()},highlightAddButton:function(){if(this.button=this.getTargetModule(),this.button){var a=this._highlightModule(this.button,!0);this.setModalPosition("RIGHT_TOP",a,!0)}},getTargetModule:function(){var a=this._getModuleChildrenByModuleName(P.app,"BoardPage")[0];if(a){var b=this._getModuleChildrenByModuleName(a,"DropdownButton");if(!_.isEmpty(b)){var c=_.find(b,function(a){return a.$el.hasClass("addPlaceContainer")});return c}}}}),goog.provide("P.modules.tutorials.ModalPlacePinsAddEmpty"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalPlacePinsAddBase"),P.modules.tutorials.ModalPlacePinsAddEmpty=P.modules.tutorials.ModalPlacePinsAddBase.extend({getPlacementId:function(){return P.Experiences.Placement.WEB_EMPTY_PLACES_BOARD_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_EMPTY_PLACES_BOARD_USER_ED},onNextButtonClicked:function(){this.button.$el.click()}}),goog.provide("P.modules.tutorials.ModalPlacePinsAddFilled"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalPlacePinsAddBase"),P.modules.tutorials.ModalPlacePinsAddFilled=P.modules.tutorials.ModalPlacePinsAddBase.extend({getPlacementId:function(){return P.Experiences.Placement.WEB_FILLED_PLACES_BOARD_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_FILLED_PLACES_BOARD_USER_ED}}),goog.provide("P.modules.tutorials.ModalPlacePinsEdit"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalPlacePinsEdit=P.modules.tutorials.ModalStepBase.extend({onShow:function(){$("html, body").scrollTop(0),this.highlightEditButton()},highlightEditButton:function(){var a=this.getTargetModule();if(a){var b=this._highlightModule(a,!0);this.setModalPosition("RIGHT_CENTER",b,!0)}},getTargetModule:function(){var a=this._getModuleChildrenByModuleName(P.app,"PlaceBoardInfoBar")[0];if(a){var b=this._getModuleChildById(a,"editButton");if(b)return b}},getPlacementId:function(){return P.Experiences.Placement.WEB_FILLED_PLACES_BOARD_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_FILLED_PLACES_BOARD_USER_ED}}),goog.provide("P.modules.tutorials.ModalPlacePinsIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalPlacePinsIntro=P.modules.tutorials.ModalStepBase.extend({onShow:function(){this.pageName=this.getPageName(),this.highlightEditButton()},highlightEditButton:function(){var a=this.getTargetModule();if(a){var b=this._highlightModule(a,!0);if("BoardPage"===this.pageName)this.setModalPosition("BOTTOM_CENTER",b,!0);else if("UserProfilePage"===this.pageName){var c,d=$(window).height();c=b.offset().top+b.height()>d?"TOP_CENTER":"RIGHT_CENTER",this.setModalPosition(c,b,!0)}}},getTargetModule:function(){var a;if("BoardPage"===this.pageName){if(a=this._getModuleChildrenByModuleName(P.app,"BoardInfoBar")[0],!a)return;var b=a.getChildrenByModuleName("ShowModalButton"),c=_.find(b,function(a){return a.$el.hasClass("boardEditButton")});return c}return"UserProfilePage"===this.pageName?this._getModuleChildrenByModuleName(P.app,"Board")[0]:void 0},onPreviousButtonClicked:function(){this.triggerEvent(P.CONST.EVENT_NEXT,null,!0),P.navigate("/places/examples/")},getPageName:function(){var a=this._getModuleChildrenByModuleName(P.app,"BoardPage");return _.isEmpty(a)&&(a=this._getModuleChildrenByModuleName(P.app,"UserProfilePage")),_.isEmpty(a)||1!==a.length?void 0:a[0].className},getPlacementId:function(){return"BoardPage"===this.pageName?P.Experiences.Placement.WEB_BOARD_TAKEOVER:"UserProfilePage"===this.pageName?P.Experiences.Placement.WEB_USER_PROFILE_TAKEOVER:void 0},getExperienceId:function(){return P.Experiences.Experience.WEB_PLACE_PINS_TOOLTIP}}),goog.provide("P.modules.tutorials.ModalPlacePinsSearch"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),goog.require("P.modules.AddPinToMap"),P.modules.tutorials.ModalPlacePinsSearch=P.modules.tutorials.ModalStepBase.extend({onShow:function(){this.highlightAddPinToMap()},highlightAddPinToMap:function(){var a=this.getTargetModule();if(a){var b=this._highlightModule(a,!0);this.setModalPosition("RIGHT_TOP",b,!0)}},getTargetModule:function(){var a=this._getModuleChildrenByModuleName(P.app,"AddPinToMap")[0];return a?a:null},onPreviousButtonClicked:function(){P.modules.tutorials.ModalStepBase.prototype.onPreviousButtonClicked.call(this),this.clickCloseButton()},clickCloseButton:function(){var a=this._getModuleChildrenByModuleName(P.app,"BoardPage")[0],b=a.getChildById("closeAddToMap");b.$el.click()},getPlacementId:function(){return P.Experiences.Placement.WEB_EMPTY_PLACES_BOARD_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_EMPTY_PLACES_BOARD_USER_ED}}),goog.provide("P.modules.tutorials.ModalPlacePinsShow"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalPlacePinsShow=P.modules.tutorials.ModalStepBase.extend({onShow:function(){this.highlightAddPlace()},highlightAddPlace:function(){var a=this.getTargetPin(),b=this._getModuleChildById(a,"addToMap");if(b||(b=this._getModuleChildById(a,"seeOnMap")),b){var c=b.$el,d=c.offset().top,e=c.height(),f=P.Viewport.height,g=$(".headerBackground").height(),h=d-f/2-g/2+e/2;this.$("."+b.id).show(),$(window).scrollTop(h);var i=this._highlightModule(b,!0);this.setModalPosition("RIGHT_CENTER",i,!0,!0)}},getTargetPin:function(){var a=this._getModuleChildrenByModuleName(P.app,"Grid")[0];if(a){var b=a.getGridItems();return b.getChildModuleAtIndex(0,"Pin")}},getPlacementId:function(){return P.Experiences.Placement.WEB_FILLED_PLACES_BOARD_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_FILLED_PLACES_BOARD_USER_ED}}),goog.provide("P.modules.tutorials.ModalSeeProfileIntro"),goog.require("P.Module"),goog.require("P.modules.tutorials.ModalStepBase"),P.modules.tutorials.ModalSeeProfileIntro=P.modules.tutorials.ModalStepBase.extend({onShow:function(a){var b=this;if(P.experiments.modernHeader){var c=this._getModuleChildById(P.app,"profileButton"),d=this._highlightElement("highlightContainer",c.$el,!0);d.addClass("seeProfileIntroHighlight"),d.on("click",function(){b.triggerEvent(P.CONST.EVENT_NEXT,null,!0)}),this.setModalPosition("BOTTOM_LEFT",d,!0),a&&a()}else{var e=this._getModuleChildrenByModuleName(P.app,"UserMenu")[0];e.setSticky(!0),e.showDropdown(_.bindFn(function(){var c=e.getDropdown().getChildByModuleName("UserDropdown").getMyBoardsElement(),d=this._highlightElement("highlightContainer",c,!0);d.addClass("seeProfileIntroHighlight"),d.on("click",function(){b.triggerEvent(P.CONST.EVENT_NEXT,null,!0)}),this.setModalPosition("LEFT_TOP",d,!0),a&&a()},this))}},onExit:function(a){if(P.app&&!P.experiments.modernHeader){var b=this._getModuleChildrenByModuleName(P.app,"UserMenu")[0];b.setSticky(!1),b.hideDropdown()}a&&a()},getPlacementId:function(){return P.Experiences.Placement.WEB_HOME_TAKEOVER},getExperienceId:function(){return P.Experiences.Experience.WEB_YOUR_BOARDS_USER_ED}}),goog.provide("P.modules.tutorials.NewUserInterestSearch"),goog.require("P.Module"),goog.require("P.modules.tutorials.NewUserStepBase");var SELECTOR_TOOLTIP_CLOSER_LOOK=".tooltipCloserLook",NEW_USER_INTEREST_SEARCH_CLASS_VISIBLE="visible",EXIT_TOUR_TIME=15e3,FORCE_EXIT_TIME=48e4,MIN_SEARCHES=1,SEARCH_ITEM_OPTIONS={show_pinner:!0,show_board:!0,lite:!0,show_via:!1,show_pinned_from:!1};P.modules.tutorials.NewUserInterestSearch=P.modules.tutorials.NewUserStepBase.extend({onAddedToDom:function(){this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate)},onButtonClick:function(a){var b=a.target.id;"previous"===b&&this.triggerInterest()},initializeStep:function(){this.childListen(P.CONST.EVENT_NAVIGATE,P.NuxUtils.preventNavigationIfNecessary),this.numSearches=0,this.endTourTooltip=null;var a={};a[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this._onRepinned,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a)},onChildNavigate:function(a){var b=P.router.get().resolve(a.data.url);"FeedPage"===b.module?(this.triggerCategory(b.options.feed),a.data.handled=!0):"SearchPage"===b.module?(this.triggerPinSearch(b.options.query),a.data.handled=!0):"Closeup"===b.module&&this._closeTooltip(),a.data.handled&&a.stopPropagation()},onEnter:function(a){var b=this,c={name:"ConfirmDialog",options:{template:"new_user_ready"}};this.forceExit=window.setTimeout(function(){P.loadModule(c,function(a){b.showInModal(a,{mask_type:"dark",can_dismiss:!1}),b.listen(a,P.CONST.EVENT_CONFIRM,function(){this.nuxProgress.triggerEvent(P.CONST.EVENT_NEXT)}),P.ExperienceManager.instance().completePlacedExperience(P.Experiences.Placement.WEB_HOME_TAKEOVER,P.Experiences.Experience.WEB_MANDATORY_AUTOBAHN),P.trackRegisterAction("autobahn_force_exit")})},FORCE_EXIT_TIME),this.autoEnableExit=window.setTimeout(function(){b._enableExitTour()},EXIT_TOUR_TIME),a&&a()},_onRepinned:function(){this._enableExitTour(),this.pubsubUnsubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_PIN_CREATED),P.trackRegisterAction("autobahn_repinned")},onContentReady:function(){P.modules.tutorials.NewUserStepBase.prototype.onContentReady.call(this),this.grid=this.getChildById("grid"),this.$previousButton=this.$(".previous"),this.endTourButton=this.nuxProgress.getNextButton(),this.endTourButton.disable();var a=this.extraData?this.extraData.showAutobahnV3Tooltip:!1;a===!0&&this.showEndTourTip()},showEndTourTip:function(){if(this.endTourButton){var a={name:"Dropdown",options:{anchor:this.endTourButton.$el,class_name:"endTourTooltip",position_point:"BOTTOM_RIGHT",sticky:!0,text:P._("Try a pin search below. <br>(The more specific, the better!)"),title:P._("Psst! Before you leave...")}},b=this;P.loadModule(a,function(a){b.endTourTooltip=a,a.render(function(){b.endTourButton.appendChild(a),a.positionModule(),a.fadeIn()})})}},hideEndTourTip:function(){this.endTourTooltip&&this.endTourTooltip.fadeOut()},showPrevious:function(){this.togglePrevious(!0),this._toggleTooltip(!0),this._handleSearchCount()},hidePrevious:function(){this.togglePrevious(!1),this._toggleTooltip(!1)},togglePrevious:function(a){this.$previousButton.toggleClass("visible",a)},_handleSearchCount:function(){this.numSearches=1,this.numSearches===MIN_SEARCHES&&(P.trackRegisterAction("autobahn_user_search"),this._enableExitTour())},triggerCategory:function(a){this.grid.options.layout="variable_height",this.grid.options.item_options=SEARCH_ITEM_OPTIONS,this.grid.resource=P.resourceFactory.create("CategoryFeedResource",{feed:a}),this.grid.empty(),this.grid.render(_.bindFn(this.showPrevious,this))},triggerInterest:function(){this.grid.options.layout="fixed_height",this.grid.resource=P.resourceFactory.create("AllCategoriesResource",{field_set_key:"grid_item"}),this.grid.render(_.bindFn(this.hidePrevious,this))},triggerPinSearch:function(a){return""===$.trim(a)?this.triggerInterest():(this.grid.resource=P.resourceFactory.create("SearchResource",{query:a,scope:"pins"}),this.grid.options.layout="variable_height",this.grid.options.item_options=SEARCH_ITEM_OPTIONS,this.grid.empty(),void this.grid.render(_.bindFn(this.showPrevious,this)))},_enableExitTour:function(){this.endTourButton.enable(),this.hideEndTourTip()},onExit:function(a){clearTimeout(this.forceExit),clearTimeout(this.autoEnableExit),a&&a()},_toggleTooltip:function(a){var b=this.$(SELECTOR_TOOLTIP_CLOSER_LOOK);b&&b.toggleClass(NEW_USER_INTEREST_SEARCH_CLASS_VISIBLE,a)},_closeTooltip:function(){var a=this.$(SELECTOR_TOOLTIP_CLOSER_LOOK);a&&a.remove()}}),goog.provide("P.modules.tutorials.NewUserPin"),goog.require("P.Module"),goog.require("P.modules.tutorials.NewUserStepBase");var FACEBOOK_SCRIPT_ID="fb_pixel",FACEBOOK_PIXEL_CONFIGURATION={pixel_id:"6011522978142",value:"0.00",currency:"USD"};P.modules.tutorials.NewUserPin=P.modules.tutorials.NewUserStepBase.extend({onContentReady:function(){window.fb_param=FACEBOOK_PIXEL_CONFIGURATION,P.script.load([],"//connect.facebook.net/en_US/fp.js",FACEBOOK_SCRIPT_ID),P.modules.tutorials.NewUserStepBase.prototype.onContentReady.call(this)}}),goog.provide("P.modules.tutorials.NewUserPinCreate"),goog.require("P.Module"),goog.require("P.modules.tutorials.NewUserStepBase"),P.modules.tutorials.NewUserPinCreate=P.modules.tutorials.NewUserStepBase.extend({onContentReady:function(){P.modules.tutorials.NewUserStepBase.prototype.onContentReady.call(this),this.nextStepButton=this.nuxProgress.getNextButton(),this.nextStepButton.disable()}}),goog.provide("P.modules.tutorials.NewUserPinSearch"),goog.require("P.Module"),goog.require("P.modules.tutorials.NewUserStepBase");var MIN_BOTTOM_GUTTER=-220,MIN_REQUESTED_ITEMS=3,NEW_USER_SELECTOR_TOOLTIP_CLOSER_LOOK=".tooltipCloserLook",NEW_USER_CLASS_VISIBLE="visible",INTERVAL_TIME=5e3,NEW_USER_EXIT_TOUR_TIME=15e3,NEW_USER_FORCE_EXIT_TIME=48e4,TEMPLATE_SUGGESTIONS="<% _.each(suggestions, function(suggestion) { %><li><%= suggestion %></li><% }) %>";P.modules.tutorials.NewUserPinSearch=P.modules.tutorials.NewUserStepBase.extend({events:{"click .searchSuggestions li":"_onSuggestionClick","click .searchInterestField":"stopInterval","submit .searchInterest":"_onSubmit"},initializeStep:function(){this.currentQuestion=0,this._requestedItems=0,this._startCountingRequestedItems=!1,this.childListen(P.CONST.EVENT_NAVIGATE,P.NuxUtils.preventNavigationIfNecessary),this._onScrollHandle=this.listen($(window),"scroll",_.debounce(_.bindFn(this._onScroll,this),50)),this.childListen(P.CONST.EVENT_ITEMS_REQUEST_SUCCESS,this._onRequestItemSuccess);var a={};a[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this._onRepinned,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a)},onContentReady:function(){this.$searchTitle=this.$(".searchTitle"),this.$searchSuggestions=this.$(".searchSuggestions ul"),this.$searchField=this.$(".searchInterestField"),this.endTourButton=this.getChildById("nextButton"),this.interestGrid=this.getChildById("interestGrid"),this.interval=P.setInterval(_.bindFn(this._nextQuestion,this),INTERVAL_TIME),this.$searchField.placeholder(),this.endTourButton.setText(this.extraData.nextButtonText),this.endTourButton.disable(),this.siteWideNags=P.app.getChildByModuleName("Nags"),this.header=P.app.getChildById("header")},onEnter:function(a){var b=this,c={name:"ConfirmDialog",options:{template:"new_user_ready"}};this.forceExit=window.setTimeout(function(){P.loadModule(c,function(a){b.showInModal(a,{mask_type:"dark",can_dismiss:!1}),b.listen(a,P.CONST.EVENT_CONFIRM,function(){b._endMandatoryFlow()}),P.ExperienceManager.instance().completePlacedExperience(P.Experiences.Placement.WEB_HOME_TAKEOVER,P.Experiences.Experience.WEB_MANDATORY_AUTOBAHN),P.trackRegisterAction("autobahn_force_exit")})},NEW_USER_FORCE_EXIT_TIME),this.autoEnableExit=window.setTimeout(function(){b._enableExitTour()},NEW_USER_EXIT_TOUR_TIME),a&&a()},_onRepinned:function(){this._enableExitTour(),this.pubsubUnsubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_PIN_CREATED),P.trackRegisterAction("autobahn_repinned")},setInterest:function(a,b){a=$.trim(a),b?(this.$searchField.val(""),this.$searchField.attr("placeholder",a)):(this.$searchField.val(a),this._onRequestItemSuccess(),P.trackRegisterAction("autobahn_user_search")),this.$searchField.placeholder();var c=this.$searchField.val(),d=this.$searchSuggestions.children("li");_.each(d,function(b){var d=$(b),e=d.text().toLowerCase()===a.toLowerCase(),f=d.text().toLowerCase()===c.toLowerCase();d.toggleClass("highlight",f||e)}),this.interestGrid.resource.options.interest=a,this.renderGrid()},renderGrid:_.debounce(function(){this.interestGrid.render()},250),stopInterval:function(){clearInterval(this.interval)},onRemovedFromDom:function(){this._closeTooltip(),this.stopInterval()},_closeTooltip:function(){var a=this.$(NEW_USER_SELECTOR_TOOLTIP_CLOSER_LOOK);a&&(a.remove(),this.removeListener(this._onScrollHandle))},_nextQuestion:function(){this.currentQuestion++;var a=this.extraData.search_suggestions.length;this.currentQuestion===a&&(this.currentQuestion=0),this._refreshQuestion()},_previousQuestion:function(){this.currentQuestion--;var a=this.extraData.search_suggestions.length;this.currentQuestion<0&&(this.currentQuestion=a-1),this._refreshQuestion()},_refreshQuestion:function(){var a=this.extraData.search_suggestions,b=a[this.currentQuestion];if(b){var c=b.suggestions[0],d=_.template(TEMPLATE_SUGGESTIONS,b);this.$searchTitle.html(b.title),this.$searchSuggestions.html(d),this.setInterest(c,!0)}},_search:function(){this.setInterest(this.$searchField.val(),!1)},_onButtonClick:function(a){this.stopInterval();var b=a.target.id;"next"===b?this._nextQuestion():"prev"===b?this._previousQuestion():"search"===b?this._search():("close"===b||"nextButton"===b)&&this._endMandatoryFlow()},_endMandatoryFlow:function(){if(clearTimeout(this.forceExit),clearTimeout(this.autoEnableExit),P.ExperienceManager.instance().isPlacedExperience(P.Experiences.Placement.WEB_HOME_TAKEOVER,P.Experiences.Experience.WEB_MANDATORY_AUTOBAHN)){var a=this;P.ExperienceManager.instance().completePlacedExperience(P.Experiences.Placement.WEB_HOME_TAKEOVER,P.Experiences.Experience.WEB_MANDATORY_AUTOBAHN,function(){a.triggerEvent(P.CONST.EVENT_NEXT,null,!0),a._endMandatoryFlowRender()})}else this.triggerEvent(P.CONST.EVENT_NEXT,null,!0),this._endMandatoryFlowRender()},_endMandatoryFlowRender:function(){this.header&&this.header.render(),this.siteWideNags&&this.siteWideNags.render()},_onRequestItemSuccess:function(){this._requestedItems===MIN_REQUESTED_ITEMS&&(this._enableExitTour(),P.trackRegisterAction("autobahn_search_done")),this._requestedItems++},_enableExitTour:function(){this.endTourButton.enable()},_onScroll:function(){this.stopInterval();var a=this.$(".newUserStepHeader"),b=this.$(NEW_USER_SELECTOR_TOOLTIP_CLOSER_LOOK),c=a.offset().top+a.height();if(b){var d=c+MIN_BOTTOM_GUTTER;b.toggleClass(NEW_USER_CLASS_VISIBLE,$(window).scrollTop()>d)}},_onSubmit:function(a){a.preventDefault(),this._search()
},_onSuggestionClick:function(a){this.stopInterval(),this.setInterest($(a.target).text(),!1)}}),goog.provide("P.modules.tutorials.NewUserPinSource"),goog.require("P.Module"),goog.require("P.modules.tutorials.NewUserStepBase"),P.modules.tutorials.NewUserPinSource=P.modules.tutorials.NewUserStepBase.extend({}),goog.provide("P.modules.tutorials.NewUserPinUsage"),goog.require("P.Module"),goog.require("P.modules.tutorials.NewUserStepBase"),P.modules.tutorials.NewUserPinUsage=P.modules.tutorials.NewUserStepBase.extend({}),goog.provide("P.modules.tutorials.NewUserPinVideo"),goog.require("P.Module"),goog.require("P.modules.tutorials.NewUserStepBase");var TEXT_TRANSITION_MS=500,VIDEO_LENGTH=13,VIDEO_WAIT_MS=50;P.modules.tutorials.NewUserPinVideo=P.modules.tutorials.NewUserStepBase.extend({events:{"click .scrubberMarkers li":"scrubberSelect"},onAddedToDom:function(){var a=this;this.$pinStoryVideoWrapper=this.$(".pinStoryVideoWrapper"),this.$scrubbers=this.$(".scrubbers"),this.player=videojs("pin-story"),this.player.ready(function(){a.player.play(),a.player.on("timeupdate",function(){a.player.currentTime()>VIDEO_WAIT_MS/1e3&&(a.$pinStoryVideoWrapper.removeClass("loading"),a.$scrubbers.removeClass("hidden")),a.onVideoUpdate(a.player.currentTime())}),a.player.on("pause",function(){a.player.currentTime()<VIDEO_LENGTH&&a.player.play()})})},onRemovedFromDom:function(){this.player.dispose()},onContentReady:function(){P.modules.tutorials.NewUserStepBase.prototype.onContentReady.call(this),this.$pinStoryTextElem=this.$(".pinStoryText"),this.pinStoryTexts=this.extraData.pinStoryTexts,this.currentPinStoryText="",this.nextStepButton=this.nuxProgress.getNextButton(),this.nextStepButton.disable(),this.hideStepHeader(),this.nextStepButtonText=this.extraData?this.extraData.nextButtonText:"",this.videoCompleted=!1},onVideoUpdate:function(a){var b="",c="",d=this,e=0;for(var f in this.pinStoryTexts){var g=this.pinStoryTexts[f];if(!(g.seconds<=a))break;b=g.title,c=g.scrubberClass,e+=1}b!==this.currentPinStoryText&&(this.$pinStoryTextElem.fadeTo(TEXT_TRANSITION_MS,0,function(){d.$pinStoryTextElem.text(b),d.$pinStoryTextElem.fadeTo(TEXT_TRANSITION_MS,1)}),this.currentPinStoryText=b,c&&_.each(this.pinStoryTexts,function(a,b){d.$(a.scrubberClass).toggleClass("active",b<e)}));var h=0;a>=h?this.onVideoComplete():this.player.paused()&&this.player.play()},onVideoComplete:function(){this.videoCompleted||(this.videoCompleted=!0,this.nextStepButton.enable(),this.nextStepButton.setText(this.nextStepButtonText))},scrubberSelect:function(a){if(a&&a.target){var b=a.target.getAttribute("scrubberIndex");if(b&&(b=parseInt(b,10),b>=0&&b<this.pinStoryTexts.length)){var c=this.pinStoryTexts[b].seconds;this.player.currentTime(c),this.player.play()}}}}),goog.provide("P.modules.ui.FollowButton"),goog.require("P.Module"),goog.require("P.modules.FollowButtonBase"),goog.require("P.modules.Dropdown");var MEMO_DROPDOWN="memoDropdown";P.modules.ui.FollowButton=P.modules.FollowButtonBase.extend({hideMemo:function(){if(this.options.memo){var a=this.getChildById(MEMO_DROPDOWN);a&&a.fadeOut(function(){a.destroy()})}},showMemo:function(){var a=this.options.memo&&this.options.memo.show;if(a&&!this.getChildById(MEMO_DROPDOWN)){this.isClickButton=function(){return!1};var b={title:this.options.memo.title,anchor:this.$el,position_point:"RIGHT_CENTER",class_name:"autoFollowMemo",largeCaret:!1},c=new P.modules.Dropdown({id:MEMO_DROPDOWN,options:b});this.appendChild(c);var d=this;c.fadeIn(10,function(){P.setTimeout(function(){d.hideMemo()},2e3)})}}}),goog.provide("P.modules.AuxiliarySiteHeaderButtonDropdown"),goog.require("P.Module"),goog.require("P.modules.DropdownButton"),P.modules.AuxiliarySiteHeaderButtonDropdown=P.modules.DropdownButton.extend({onContentReady:function(){P.modules.DropdownButton.prototype.onContentReady.apply(this,arguments);var a=this.$el.width();$(".headerDropdown").width(a)}}),goog.provide("P.modules.BoardEditBase"),goog.require("P.Module"),goog.require("P.modules.BoardCollaboratorInvitesBase"),goog.require("P.modules.BoardInvites"),P.modules.BoardEditBase=P.modules.BoardCollaboratorInvitesBase.extend({onCreated:function(){P.modules.BoardCollaboratorInvitesBase.prototype.onCreated.call(this),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},setupForm:function(){this.$form=this.$("form");var a={},b=this.extraData;if(this._isOwner()){var c=b.errorMessages.name.required;a={name:[P.Validator.Required({message:c}),P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_TITLE})],description:[P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION})]}}this.form=new P.Form(this.$form,a),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onContentReady:function(){this.setupForm()},onButtonClick:function(a){var b=a.target;if(b){var c=this._getGACategory();"submitButton"===b.id?P.trackGAEvent(c,P.CONST.GA_ACTION_CLICK_SUBMIT):"cancelButton"===b.id&&P.trackGAEvent(c,P.CONST.GA_ACTION_CLICK_CANCEL)}},onSubmitValidated:function(a){a.errors[0]||this.saveBoard()},getBoardId:function(){return this.data&&this.data.id},_getGACategory:function(){return this.getBoardId()?"board_edit":"board_create"},isMakePublic:function(a){return this.data&&"secret"===this.data.privacy&&"public"===a},getFieldValues:function(){var a=this.$("form"),b={},c=a.find("[name=name]");c.length&&(b.name=c.val());var d=this.getChildById("boardCategory");d&&(b.category=d.getValue());var e=a.find("[name=description]");e.length&&(b.description=e.val());var f=this.getChildById("secretCheckbox");f&&(b.privacy=f.isChecked()?"secret":"public");var g=this.getChildById("emailCheckbox");g&&(b.collab_board_email=g.isChecked());var h=this.getChildById("placeLayoutCheckbox");return h&&(b.layout=h.isChecked()?"places":"default"),b},_isOwner:function(){return this.extraData&&this.extraData.isOwner},saveBoard:function(){var a=this,b=this.getChildById("submitButton");b.showLoading();var c=this.getFieldValues(),d=this.getBoardId(),e=_.clone(c);d&&(e.board_id=d);var f;if(this._isOwner()){f=P.resourceFactory.create("BoardResource",e);var g={success:_.bindFn(this.onSaveSuccess,this),error:_.bindFn(this.onSaveError,this),complete:function(){b.hideLoading()}};d?f.callUpdate(g):f.callCreate(g)}else f=P.resourceFactory.create("BoardSettingsResource",e),f.callUpdate({complete:function(){b.hideLoading(),a.destroy()}})},onSaveError:function(a){P.trackGAEvent(this._getGACategory(),P.CONST.GA_ACTION_ERROR);var b=this.$(".formFooter"),c=this.$(".inlineError");c.length?c.empty():c=$("<p></p>").addClass("inlineError"),c.text(a.message),c.insertBefore(b)},_isNewBoard:function(){var a=this.getBoardId();return!a},onSaveSuccess:function(a){var b,c,d=this.getChildById("boardInvites");d&&(b=d.getSelectedUserIds(),c=d.getSelectedEmails());var e=this.getBoardId(),f=this._isNewBoard();if(P.trackGAEvent(this._getGACategory(),P.CONST.GA_ACTION_SUCCESS),a){var g=a.resource_response;if(g&&!g.error&&g.data){var h=g.data;return e?(P.pubsub.publish(e,P.CONST.PUBSUB_TOPIC_BOARD_UPDATED,h),this.isMakePublic(h.privacy)&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_UPDATED,P.CONST.PUBSUB_MESSAGE_BOARD_SET_PUBLIC)):P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_CREATED,h),void(!f&&this.isInModal()?this.destroy():(this.navigate(h.url),b&&this.inviteUsers(h.id,b),c&&this.inviteEmail(h.id,c)))}}},displayFacebookDialog:function(a,b){var c=a.join();P.FacebookDialog.open({type:"send",picture:this.data.image_cover_url,path:b,to:c})},inviteUsers:function(a,b){var c={board_id:a,invited_user_ids:b};if(b&&b.length>0){var d=P.resourceFactory.create("BoardInviteResource",c);d.callCreate()}},inviteEmail:function(a,b){var c={board_id:a,emails:b};if(b&&b.length>0){var d=P.resourceFactory.create("BoardEmailInviteResource",c);d.callCreate()}}}),goog.provide("P.modules.UserBoardsBase"),goog.require("P.Module"),goog.require("P.modules.Board");var USER_BOARDS_BASE_SECRET_BOARD_TYPE=P.CONST.BOARD_PRIVACY_SECRET,USER_BOARDS_BASE_MODULE_ID_PUBLIC_BOARDS_GRID="publicBoardsGrid",USER_BOARDS_BASE_MODULE_ID_SECRET_BOARDS_GRID="secretBoardsGrid";P.modules.UserBoardsBase=P.Module.extend({onContentReady:function(){var a={};a[P.CONST.PUBSUB_TOPIC_BOARD_CREATED]=this.onBoardCreated,a[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,a[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.extraData.isOwnProfile&&(a[P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf),this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,a)},onBoardCreated:function(a,b,c){var d=c,e=d.id,f=d.privacy,g=f===USER_BOARDS_BASE_SECRET_BOARD_TYPE?USER_BOARDS_BASE_MODULE_ID_SECRET_BOARDS_GRID:USER_BOARDS_BASE_MODULE_ID_PUBLIC_BOARDS_GRID,h=this.getChildById(g),i=new P.modules.Board({options:{show_board_context:!1},resource:{name:"BoardResource",options:{board_id:e}}});h.items.appendChild(i),i.render()},onBoardDeleted:function(){},onBoardUpdated:function(a,b,c){c===P.CONST.PUBSUB_MESSAGE_BOARD_SET_PUBLIC&&this.render()},onBoardRemovedSelf:function(){this.render()}}),goog.provide("P.modules.App"),goog.require("P.HistoryManager"),goog.require("P.interfaces.HistoryManagerProvider"),goog.require("P.modules.AppBase"),goog.require("P.interfaces.IModalManager"),goog.require("P.modules.Grid"),goog.require("P.modules.Header"),goog.require("P.modules.Modal");var CLASS_SHOWING_PLACE_BOARD="showingPlaceBoard",PROMPT_VIEWS_COOKIE="prompt_views",PROMPT_SEEN_COOKIE="prompt_seen",PROMPT_EXCLUDE_MODULES=["LoginPage","HomePage"],PROMPTED_SIGNUP_ENABLED=P.experiments.instance.inExperimentGroupActiveOrTriggerable("prompted_signup","enabled"),PROMPTED_SIGNUP_CONTROL=P.experiments.instance.inExperimentGroupActiveOrTriggerable("prompted_signup","control");P.modules.App=P.modules.AppBase.extend({events:{},onCreated:function(){P.modules.AppBase.prototype.onCreated.call(this),this.modalManager=null,this.promptedSignup=PROMPTED_SIGNUP_ENABLED||PROMPTED_SIGNUP_CONTROL},onAddedToDom:function(){P.modules.AppBase.prototype.onAddedToDom.apply(this,arguments),P.DeepLink.setup(P.CONTEXT.ios_deep_link),this.childListen(P.CONST.EVENT_MODAL,this.onChildModal),this.childListen(P.CONST.EVENT_CLOSE,this.onChildClose),this.modalManager||(this.modalManager=P.getModalManager())},_startTutorials:function(){P.TutorialManager.instance().resumeTutorial()},isTutorialActive:function(){return P.TutorialManager.instance().isTutorialActive()},_getGAPageviewOptions:function(){return{streaming:Pc.pageStreaming,scriptLoadMethod:Pc.scriptLoadMethod}},_adjustScrollToTopPositionIfNeeded:function(){var a=this._getCurrentMainModule();if(a)return"BoardPage"===a.className&&a.isPlaceBoard()?void this.$el.addClass(CLASS_SHOWING_PLACE_BOARD):void this.$el.removeClass(CLASS_SHOWING_PLACE_BOARD)},onContentReady:function(){P.modules.AppBase.prototype.onContentReady.apply(this,arguments),P.requestPushNotifications()},_getScrollToTopModule:function(){var a=this.getChildById("scrollToTop");return a},updateScrollWatchers:function(a){var b=this._getScrollToTopModule();b&&b.setScroller(a.getScrollableElement())},maybeShowSignupPrompt:function(a){if(!a||P.currentUser.isAuthenticated())return!1;if(!this.promptedSignup||Cookie.get(PROMPT_SEEN_COOKIE))return!1;var b=_.contains(PROMPT_EXCLUDE_MODULES,a.module),c=_.contains(PROMPT_EXCLUDE_MODULES,this._getCurrentMainModule().className);if(b||c)return!1;var d=parseInt(Cookie.get(PROMPT_VIEWS_COOKIE),10)||0;if(d>2){if(Cookie.set(PROMPT_SEEN_COOKIE,"1"),PROMPTED_SIGNUP_ENABLED)P.UserRegistration.showSignupModal(null,{redirect_to_signup:!0});else if(PROMPTED_SIGNUP_CONTROL){var e=P.resourceFactory.create("ActivateExperimentResource",{experiment_name:"prompted_signup",add_to_experiment:!0});e.callCreate({error:P.NOOP})}return!0}return!1},onChildNavigate:function(a){var b=a.data.url;if(!P.currentUser.isAuthenticated()&&this.promptedSignup){if(!Cookie.get(PROMPT_SEEN_COOKIE)){var c=parseInt(Cookie.get(PROMPT_VIEWS_COOKIE),10)||0;Cookie.set(PROMPT_VIEWS_COOKIE,String(c+1))}if(this.maybeShowSignupPrompt(P.router.get().resolve(b)))return a.stopPropagation(),void(this.midNavigate=!1)}P.modules.AppBase.prototype.onChildNavigate.call(this,a)},onChildModal:function(a){this.log.debug("Got modal event from child",a.target,"for module:",a.data.module),a.stopPropagation(),this.modalManager.showInModal(a.data.module,a.data.extraOptions||{},a.target)},onChildClose:function(){this.historyManager.closeCurrentModule()},removeAllModals:function(){this.isTutorialActive()||this.modalManager.removeAllModals(!0)},debugNumGridItems:function(){for(var a,b=this,c=[],d=[this];d.length>0;)a=d.pop(),"GridItems"===a.className&&c.push(a),d=d.concat(a.children);return _.each(c,function(a,c){for(var d=a.parent,e=a.className+" has "+a.children.length+" children";d;)e=d.className+"->"+e,d=d.parent;b.log.debug(c+1+": "+e)}),0===c.length&&this.log.debug("There are no grids in the page."),":)"},updateNavigationBar:function(){var a=P.app.getChildByModuleName("Nags"),b=P.app.getChildById("header");b&&(b.render(),b.show()),a&&a.render()},getHistoryManager:function(){return this.historyManager}}),P.Errors.wrap(P.modules.App.prototype,["initialize","onAddedToDom","onChildNavigate","onChildModal","onContentReady","onRoute","onRouteNotFound"]),goog.provide("P.modules.BoardCreate"),goog.require("P.Module"),goog.require("P.modules.BoardEditBase"),goog.require("P.modules.BoardInvites"),P.modules.BoardCreate=P.modules.BoardEditBase.extend({_clearInviteForm:function(){var a=this.getChildById("boardInviteForm");a.clearTypeahead()},onChildInviteUser:function(a){var b=this.getChildById("boardInvites"),c=a.data.userId;b.addUserInvite(c),this._clearInviteForm()},onChildInviteEmail:function(a){var b=this.getChildById("boardInvites"),c=a.data.email;b.addEmailInvite(c),this._clearInviteForm()}}),goog.provide("P.modules.BoardFollowButton"),goog.require("P.Module"),goog.require("P.modules.ui.FollowButton"),P.modules.BoardFollowButton=P.modules.ui.FollowButton.extend({getResourceId:function(){return this.options.board_id},getFollowResource:function(){return P.resourceFactory.create("BoardFollowResource",{board_id:this.getResourceId()})},getFollowClass:function(){return this.options.follow_class},getContextualResource:function(){return P.resourceFactory.create("BoardResource",{board_id:this.getResourceId(),field_set_key:"grid_item"})},onContentReady:function(){if(this.options.user_id){var a={};a[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onFollowUser,a[P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onUnfollowUser,this.pubsubSubscribe(this.options.user_id,a)}var b={};b[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this._onFollow,b[P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW]=this._onUnfollow,this.pubsubSubscribe(this.getResourceId(),b),this.showMemo()},_onFollow:function(){var a={board_id:this.getResourceId()};this.triggerEvent(P.CONST.EVENT_BOARD_FOLLOW,a,!0)},_onUnfollow:function(){var a={board_id:this.getResourceId()};this.triggerEvent(P.CONST.EVENT_BOARD_UNFOLLOW,a,!0),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_UNFOLLOW,!0)},onFollowUser:function(){this.setState(!0)},onUnfollowUser:function(){this.setState(!1)}}),goog.provide("P.modules.BusinessGetStarted"),goog.require("P.Module"),goog.require("P.modules.BoardCreate"),P.modules.BusinessGetStarted=P.Module.extend({events:{"click .partnerCreateBoard":"createBoard"},createBoard:function(){return P.trackGAEvent("board_create",P.CONST.GA_ACTION_OPEN_MODAL),this.showBoardCreateModal(),!1},showBoardCreateModal:function(){var a=new P.modules.BoardCreate({options:{}});this.showInModal(a)}}),goog.provide("P.modules.Closeup"),goog.require("P.Module"),goog.require("P.modules.CloseupBottom"),goog.require("P.modules.CloseupContent"),goog.require("P.modules.CloseupSidebar"),goog.require("P.modules.Pin"),goog.require("P.modules.PinActionBar");var MODULE_ID_ACTION_BAR="actions",MODULE_ID_CONTENT="content",MODULE_ID_SIDEBAR="sidebar",MODULE_ID_BOTTOM="bottom",SELECTOR_CLOSEUP_ACTION_BAR=".closeupActionBarContainer",FIXED_IMAGE_WIDTH=736,ACTIONBAR_HEIGHT=57,DEFAULT_PADDING=40,PIN_MARGIN=14,CLOSEUP_CONTENT_WIDTH=1e3,CLOSE_BUTTON_VISIBLE_CLASS="visible";P.modules.Closeup=P.Module.extend({events:{click:"_onClick","click button.close":"onCloseButtonClick"},getOwnedScrollables:function(){return this.options.can_close?this.$el:$()},onCreated:function(){this.closeDiv=$('<button class="Button ButtonBase borderless close"><em></em>&nbsp;</button>')},onKeyup:function(a){var b=P.getModalManager();this.options.can_close&&!b.hasModals()&&a.keyCode===P.keyCode.ESCAPE&&this._close()},_close:function(){this.triggerEvent(P.CONST.EVENT_CLOSE,this,!0)},_unsticky:function(){this._actionBar&&this._actionBar.unsticky()},_updateSticky:function(){if(this.parent&&this.inDom&&this._actionBar){var a=this.$(".PaddedPin"),b=this.getScrollableElement(),c=0;this.options.can_close||(c=$(".headerBackground").height()),this._actionBar.updateSticky({$boundTo:a,$scrollable:b,headerHeight:c})}},resetCloseButton:function(){this.$close.removeClass(CLOSE_BUTTON_VISIBLE_CLASS)},onAddedToDom:function(){var a=this;this._positionActionBar(),this.options.can_close&&$("body").on("keyup.closeup",function(b){a.onKeyup(b)}),this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate);var b=P.scrollbarWidth();this.$close||(this.$close=this.$(".close")),this.$close.css("right",b+PIN_MARGIN+"px").addClass(CLOSE_BUTTON_VISIBLE_CLASS)},_positionActionBar:function(){this._actionBar&&this.inDom&&this.contentReady&&this._updateSticky()},onContentReady:function(){this._actionBar=this.getChildById(MODULE_ID_ACTION_BAR),this.options.show_repin?(this.showRepinModal(),delete this.options.show_repin):this.options.show_edit&&(this.extraData.canEdit&&this.showEditModal(),delete this.options.show_edit),this._positionActionBar(),this.extraData&&this.extraData.showContextualReg&&P.UserRegistration.showSignupModal(this.resource,{sent_pin:!0,sender:this.options.sender,redirect_to_signup:!0})},onChildRemoved:function(a){"CloseupContent"===a.className&&(this.options.can_close?this._close():(this.destroy(),this.navigate("/")))},_removeTransitionImage:function(){this.transitionPinImage&&(this.transitionPinImage.remove(),this.transitionPinImage=null)},onRemovedFromDom:function(){this._actionBar&&this._actionBar.removeDropdowns(),this._unsticky(),this.options.can_close&&$("body").off("keyup.closeup"),this._removeListeners()},render:function(){if(!this.options.can_close)try{return P.Module.prototype.render.apply(this,arguments)}catch(a){throw console.error(a),a}this.$el.empty().addClass("canClose");var b=P.ExperienceManager.instance().getPlacedExperience(P.Experiences.Placement.WEB_PIN_CLOSEUP),c=b&&(b.experience_id===P.Experiences.Experience.WEB_PIN_CLOSEUP_LITE||b.experience_id===P.Experiences.Experience.WEB_PIN_CLOSEUP_AUTOBAHN);c&&this.$el.addClass("lite"),this.$el.append(this.closeDiv),this.$el.append('<div class="closeupActionBarContainer" data-component-type="'+P.ContextLogging.ComponentType.MODAL_PIN+'"></div><div class="closeupContainer"></div><div class="closeupBottom"></div>');var d=!!this.transitionPinImage;d&&this.$el.append(this.transitionPinImage);var e=this,f=P.resourceFactory.clone(this.resource),g=this.resource.options.id,h=P.resourceFactory.clone(this.resource);h.options.field_set_key="detailed";var i=new P.modules.CloseupContent({id:MODULE_ID_CONTENT,resource:h}),j=e.$(SELECTOR_CLOSEUP_ACTION_BAR),k=new P.modules.PinActionBar({id:MODULE_ID_ACTION_BAR,options:{pin_id:g},resource:f});k.render(),this._actionBar=k,this.insertChild(k,j);var l=this.$(".closeupContainer"),m=P.resourceFactory.clone(this.resource);m.options.field_set_key="closeup_sidebar";var n=new P.modules.CloseupSidebar({id:MODULE_ID_SIDEBAR,resource:m});n.render(function(){e.insertChild(n,l)});var o=i.render().then(function(){if(e.insertChild(i,l),d){var a=i.getPin(),b=a.getPinMedia(),f=b.attr("src");b.load(_.bindFn(e._removeTransitionImage,e)),b.error(_.bindFn(e._removeTransitionImage,e)),b.attr("src",f),b[0]&&b[0].complete&&e._removeTransitionImage()}e.contentReady=!0,e.onContentReady();var g=new P.modules.CloseupBottom({id:MODULE_ID_BOTTOM,options:{pin_id:e.resource.options.id}});if(!c){var h=e.$(".closeupBottom");g.render(function(){e.insertChild(g,h)})}});return d?P.Promise.resolve(null):o},setCloseupBottomMinHeight:function(){var a=this.$(".closeupContainer").height(),b=this.getScrollableElement().scrollTop(),c=this.getChildById(MODULE_ID_BOTTOM);if(c){var d=P.Viewport.height,e=b+d-a;c.setMinHeight(e)}},removeCloseupBottomMinHeight:function(){var a=this.getChildById(MODULE_ID_BOTTOM);a&&a.setMinHeight(null)},showRepinModal:function(){this._actionBar&&P.currentUser.isAuthenticated()&&this._actionBar.showRepinModal()},showEditModal:function(){var a=this.getChildById(MODULE_ID_CONTENT);return a.showEditModal()},setAsMainModule:function(a,b,c){var d=this,e=this.getChildById(MODULE_ID_CONTENT),f=this.getChildById(MODULE_ID_SIDEBAR),g=this.getChildById(MODULE_ID_BOTTOM),h=b.options.id;if(!e||!f||!g)return P.Module.prototype.setAsMainModule.apply(this,arguments);if(this._removeTransitionImage(),a.can_close?0===this.closeDiv.parent().length&&(this.$el.prepend(this.closeDiv),this.$el.addClass("canClose")):this.closeDiv.parent().length>0&&(this.closeDiv.remove(),this.$el.removeClass("canClose")),this.options.can_close=a.can_close,this.hasSameOptions(a,b)&&this.contentReady&&!this._forceRefreshRequested(c))return P.Promise.resolve(null);this.setOptions(a),this.setResource(b),c.evt&&c.evt.currentTarget&&"Closeup"===c.evt.currentTarget.className||e.empty();var i={name:b.name,options:_.extend({},b.options)},j=P.resourceFactory.clone(this.resource),k=new P.modules.PinActionBar({id:MODULE_ID_ACTION_BAR,options:{pin_id:h},resource:j});return i.options.field_set_key="detailed",e.setResource(i),this.setCloseupBottomMinHeight(),k.render(),e.render().then(function(){var a=d.$(SELECTOR_CLOSEUP_ACTION_BAR);d.insertChild(k,a),d._actionBar&&d._actionBar.destroy(),d._actionBar=k,d._positionActionBar(),g.setOptions({pin_id:h}),g.render(function(){d.removeCloseupBottomMinHeight()}),f.updateDomain(e.data.domain),f.updateRelatedRecipes(e.data.rich_recipe_top_ingredients)})},onChildNavigate:function(a){if(P.NuxUtils.preventNavigationIfNecessary(a),this.log.debug("Closeup got navigate event from child",a.target,"for url:",a.data.url),!P.isOffsiteUrl(a.data.url)){var b=this.getChildById(MODULE_ID_SIDEBAR);return b===a.currentTarget&&"Pin"===a.target.className&&(a.data.handled=!0),!1}},onCloseButtonClick:function(){return this._close(),this.resetCloseButton(),!1},_onClick:function(a){if(this.options.can_close){var b=a.target;(b&&(b===this.$el[0]||b===this.$(".closeupContainer")[0])||b===this.$(".closeupBottom")[0])&&(a.stopPropagation(),this._close())}},performTransition:function(a){var b=a.evt&&a.evt.target||null,c=a.evt&&a.evt.currentTarget||null;return b&&"Pin"===b.className&&"summary"===b._getViewType()&&"Closeup"!==c.className&&(this.transitionPinImage=this._getTransitionPinImage(b)),this.render()},_getTransitionPinImage:function(a){var b=a.getPinMedia();if(!b)return null;var c=b.clone(),d=a.getSourceUrl()||a.getImageUrl(P.CONST.IMAGE_SIZE_ORIG),e=$("<a class='transitionImage' href='"+d+"'></a>").append(c);c[0].onload=null;var f,g=a.getDetailedImageDimensions(),h=g.height,i=g.width;if(i<FIXED_IMAGE_WIDTH){var j=Math.round((FIXED_IMAGE_WIDTH-i)/2);f=j<DEFAULT_PADDING?j+ACTIONBAR_HEIGHT:DEFAULT_PADDING+ACTIONBAR_HEIGHT}else f=ACTIONBAR_HEIGHT;var k=2*PIN_MARGIN,l=(P.Viewport.width-CLOSEUP_CONTENT_WIDTH+PIN_MARGIN)/2,m=(FIXED_IMAGE_WIDTH-i)/2,n={height:h,padding:f+"px "+m+"px "+(f-ACTIONBAR_HEIGHT)+"px",left:l,top:k};return a.isVideo()&&a.data.attribution&&(n.padding=ACTIONBAR_HEIGHT+"px 0px 0px"),e.css(n),c.css({height:h,width:i}),e},getPin:function(){return this.getChildById(MODULE_ID_CONTENT).getPin()},getLoggingObjectIdStr:function(){return this.resource.options.id}}),goog.provide("P.modules.SendBase"),goog.require("P.Module"),goog.require("P.modules.UserSelectBase"),P.modules.SendBase=P.modules.UserSelectBase.extend({_EMAIL_RESOURCE_NAME:"",_GA_TOPIC_EMAIL:"send_base_email",_GA_TOPIC_SEND_FACEBOOK:"send_base_facebook",_GPLUS_SHARE_LABEL:"",_OBJECT_ID_NAME:"",_SEND_RESOURCE_NAME:"",_SEND_FACEBOOK_RESOURCE_NAME:"",_logThirdPartySend:function(){},onChildItemSelected:function(a){a.stopPropagation();var b=a.data.item.attributes;return"facebook_non_pinner"===b.type?(this._sendViaFacebook(b),this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0),void this._logThirdPartySend("facebook")):b.type===P.CONST.TYPEAHEAD_TYPE_GPLUS_NON_PINNER?(this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0),void this._logThirdPartySend("gplus")):void P.modules.UserSelectBase.prototype.onChildItemSelected.call(this,a)},onContentReady:function(){P.modules.UserSelectBase.prototype.onContentReady.call(this),P.fb.ensureInit(P.NOOP)},onSendAction:function(){var a=this.getSelectedItem();"user"===a.type?this._sendViaUser(a):this.isEmailType(a.type)?this._sendViaEmail(a):P.showError(P.string.common.defaultErrorMessage)},onTypeaheadRenderDone:function(a){this.enableGplusShareButton(a.data,P.absolutify(this.options.object_url,"http",P.CONST.CANONICAL_MAIN_DOMAIN),this._GPLUS_SHARE_LABEL)},_sendViaEmail:function(a){var b=this,c=a.email||a.email_address,d=a.full_name||a.first_name,e={email:c,recipient_name:d||c};e[this._OBJECT_ID_NAME]=this.options.object_id;var f=this.getMessageValue();f&&(e.message=f),P.resourceFactory.create(b._EMAIL_RESOURCE_NAME,e).call("create",{error:P.NOOP}).done(function(){P.trackGAEvent(b._GA_TOPIC_EMAIL,P.CONST.GA_ACTION_SUCCESS)}).fail(function(a){P.trackGAEvent(b._GA_TOPIC_EMAIL,P.CONST.GA_ACTION_ERROR),P.showError(a.message)}),this.reset()},_sendViaUser:function(a){if(a){var b={user_id:a.id};b[this._OBJECT_ID_NAME]=this.options.object_id;var c=this.getMessageValue();c&&(b.message=c),P.resourceFactory.create(this._SEND_RESOURCE_NAME,b).call("create",{error:P.NOOP}).done(_.bindFn(function(){this.clearSelectedItem()},this)).fail(_.bindFn(function(a){P.showError(a.message)},this)),this.clearSelectedItem()}},_sendViaFacebook:function(a){var b=this;P.fb.ensureLoggedIn(function(){b._sendToFacebook(a)})},_sendToFacebook:function(a){var b=this,c={};c[this._OBJECT_ID_NAME]=this.options.object_id,c.send_type="facebook_no_user",P.resourceFactory.create(this._SEND_FACEBOOK_RESOURCE_NAME,c).call("create",{error:P.NOOP}).done(function(d){var e,f=d.resource_response.data;e=_.isString(e)?f:f.share_url,P.FacebookDialog.open({type:"send",picture:b.options.object_image_url,path:e,to:a.id,callback:function(a){if(a&&a.success){P.trackGAEvent(b._GA_TOPIC_SEND_FACEBOOK,P.CONST.GA_ACTION_SUCCESS);var d=P.resourceFactory.create("ConversationObjectSentResource",c);d.callCreate()}}}),P.trackGAEvent(b._GA_TOPIC_SEND_FACEBOOK,P.CONST.GA_ACTION_OPEN_MODAL)}).fail(function(){P.trackGAEvent(b._GA_TOPIC_SEND_FACEBOOK,P.CONST.GA_ACTION_ERROR)}),this.reset()}}),goog.provide("P.modules.SendBoard"),goog.require("P.modules.SendBase"),P.modules.SendBoard=P.modules.SendBase.extend({_EMAIL_RESOURCE_NAME:"EmailBoardResource",_GA_TOPIC_EMAIL:"board_email",_GA_TOPIC_SEND_FACEBOOK:"board_send_facebook",_GPLUS_SHARE_LABEL:"FOLLOW",_OBJECT_ID_NAME:"board",_SEND_FACEBOOK_RESOURCE_NAME:"SendBoardFacebookResource",_SEND_RESOURCE_NAME:"ShareBoardResource"}),goog.provide("P.modules.SendPin"),goog.require("P.modules.SendBase"),P.modules.SendPin=P.modules.SendBase.extend({_EMAIL_RESOURCE_NAME:"EmailPinResource",_GA_TOPIC_EMAIL:"pin_email",_GA_TOPIC_SEND_FACEBOOK:"pin_send_facebook",_GPLUS_SHARE_LABEL:"PIN_IT",_OBJECT_ID_NAME:"pin",_SEND_FACEBOOK_RESOURCE_NAME:"SendPinFacebookResource",_SEND_RESOURCE_NAME:"SharePinResource",_logThirdPartySend:function(a,b){var c={userid:P.currentUser.id,send_method:b,recipient_email:null,recipient_name:a.name,recipient_id:null,pin:this.options.object_id,message:null,time:jQuery.now()},d={topic:"send_pin",content:c},e=P.resourceFactory.create("EventLoggingResource",d);e.callCreate({error:P.NOOP})}}),goog.provide("P.modules.SendPinner"),goog.require("P.modules.SendBase"),P.modules.SendPinner=P.modules.SendBase.extend({_EMAIL_RESOURCE_NAME:"EmailUserResource",_GA_TOPIC_EMAIL:"user_email",_GA_TOPIC_SEND_FACEBOOK:"user_send_facebook",_GPLUS_SHARE_LABEL:"FOLLOW",_OBJECT_ID_NAME:"shared_user",_SEND_FACEBOOK_RESOURCE_NAME:"SendUserFacebookResource",_SEND_RESOURCE_NAME:"ShareUserResource"}),goog.provide("P.modules.UserBoards"),goog.require("P.modules.Board"),goog.require("P.modules.BoardCreateRep"),goog.require("P.modules.UserBoardsBase");var SECRET_BOARD_TYPE=P.CONST.BOARD_PRIVACY_SECRET,MODULE_ID_PUBLIC_BOARDS_GRID="publicBoardsGrid";P.modules.UserBoards=P.modules.UserBoardsBase.extend({onContentReady:function(){P.modules.UserBoardsBase.prototype.onContentReady.call(this),this.extraData.isOwnProfile&&this.initializePublicBoardsSortManager()},addCreateBoardRep:function(a,b,c){if(!c.items.getChildById(a)){var d=new P.modules.BoardCreateRep({id:a,options:{secret:b===SECRET_BOARD_TYPE}});d.render(function(){c.items.appendChild(d)})}},initializePublicBoardsSortManager:function(){var a=this.getChildById(MODULE_ID_PUBLIC_BOARDS_GRID),b=this,c=function(b){var c=b.find(".Board"),d=a.items.getChildByElement(c);d.disable()},d=function(b){var c=b.find(".Board"),d=a.items.getChildByElement(c);d.enable()},e={cancel:".BoardCreateRep",start:function(a,b){c(b.item)},stop:function(a,b){P.setTimeout(function(){d(b.item)},5)},over:function(a,b){var c=30,d=$(window).scrollTop(),e=b.offset.top-d,f=b.item.height(),g=e<0,h=e>P.Viewport.height-f;h&&(c*=-1),(g||h)&&$(window).scrollTop(d-c)},update:function(a,c){b.onPublicBoardsSortUpdate(a,c)}};a.items.initializeSortManager(e,"Board",function(a){return a.data&&a.data.id})},onPublicBoardsSortUpdate:function(){var a=this.getChildById(MODULE_ID_PUBLIC_BOARDS_GRID);this.saveBoardOrder(a.items.getSortOrder())},saveBoardOrder:function(a){var b="BoardsReorderResource",c={board_ids:a},d=P.resourceFactory.create(b,c),e="user_boards_reorder";d.callUpdate({success:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_SUCCESS)},error:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_ERROR)}})}}),goog.provide("P.modules.UserFollowButton"),goog.require("P.Module"),goog.require("P.modules.ui.FollowButton"),P.modules.UserFollowButton=P.modules.ui.FollowButton.extend({getResourceId:function(){return this.options.user_id},getFollowResource:function(){return P.resourceFactory.create("UserFollowResource",{user_id:this.getResourceId()})},getFollowClass:function(){return this.options.follow_class},onContentReady:function(){this.showMemo()},getContextualResource:function(){return P.resourceFactory.create("UserResource",{user_id:this.getResourceId(),field_set_key:"grid_item"})}}),goog.provide("P.modules.BoardEditActionBase"),goog.require("P.Module"),goog.require("P.modules.BoardEditBase"),goog.require("P.modules.BoardInvites"),P.modules.BoardEditActionBase=P.modules.BoardEditBase.extend({onCreated:function(){P.modules.BoardEditBase.prototype.onCreated.call(this),this.childListen(P.CONST.EVENT_CHANGE,this.onChildChange)},onContentReady:function(){P.modules.BoardEditBase.prototype.onContentReady.call(this);var a={};a[P.CONST.PUBSUB_TOPIC_BOARD_BANNED_COLLABORATOR]=this.onBannedUser,a[P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf,this.pubsubSubscribe(this.data.id,a)},onSubmitValidated:function(){var a=this;if(!this._showSecretBoardStatusChangeConfirmation)return void a.saveBoard();var b={name:"ConfirmDialog",options:{template:"make_public"}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.saveBoard)})},onChildChange:function(a){if("secretCheckbox"===a.target.id){var b=!a.target.isChecked();this._showSecretBoardStatusChangeConfirmation=b?!0:!1}},onChildInviteUser:function(a){var b=this.getChildById("boardInviteForm");b.showLoading();var c,d,e=this,f=a.data.userId,g=a.data.pending,h=a.data.type,i=this.getBoardId(),j=this.getChildById(g?"boardPendingInvites":"boardInvites");"user"===h?(c={board_id:i,invited_user_id:f},d=P.resourceFactory.create("BoardInviteResource",c),d.callCreate({error:P.NOOP}).done(function(){P.trackGAEvent("collaborator_invite_user",P.CONST.GA_ACTION_SUCCESS),j.addUserInvite(f),b.clearTypeahead()
}).fail(function(a){P.showError(a.message),P.trackGAEvent("collaborator_invite_user",P.CONST.GA_ACTION_ERROR)}).always(function(){b.hideLoading()})):"facebook_non_pinner"===h&&(d=P.resourceFactory.create("BoardFacebookInviteResource",{board_id:this.getBoardId()}),d.callCreate({error:P.NOOP}).done(function(a){var c=a.resource_response.data;b.hideLoading(),e.displayFacebookDialog([f],c)}).fail(function(a){b.hideLoading(),P.showError(a.message)}))},onChildInviteEmail:function(a){var b=this,c=this.getChildById("boardInviteForm");c.showLoading();var d=a.data.email,e={board_id:this.getBoardId(),emails:[d]},f=P.resourceFactory.create("BoardEmailInviteResource",e);f.callCreate({success:function(){P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_SUCCESS);var a=P.string.format(P.string.common.successInviteSentToEmail,{email:d});c.clearTypeahead();var e=$("<div class='alert'>"+a+"</div>");b.insertAfterModule(e,c).then(function(){e.fadeIn(function(){e.delay(5e3).fadeOut(function(){e.remove()})})})},error:function(a){P.showError(a.message),P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_ERROR)},complete:function(){c.hideLoading()}})},deleteBoard:function(){var a=this,b=this.getBoardId(),c=this.getFieldValues(),d=c.privacy,e=P.resourceFactory.create("BoardResource",{board_id:b}),f=function(a){P.showError(a.message),P.trackGAEvent("board_delete",P.CONST.GA_ACTION_ERROR)},g=function(c){if(P.trackGAEvent("board_delete",P.CONST.GA_ACTION_SUCCESS),c){var e=c.resource_response;if(e&&!e.error)return void a.handleDelete(b,d)}f(c)};this.showLoading(),e.callDelete({success:g,error:f,complete:function(){a.hideLoading()}})},handleDelete:function(){},redirectAfterDelete:function(){var a=this.data.owner?"/"+this.data.owner.username+"/":"/";window.location.href!==a&&this.navigate(a)},onBoardRemovedSelf:function(){this.destroy()},onBannedUser:function(){var a=this.getChildById("boardInvites");a.render();var b=this.getChildById("boardPendingInvites");b&&b.render()}}),goog.provide("P.modules.BoardEdit"),goog.require("P.Module"),goog.require("P.modules.BoardEditActionBase"),P.modules.BoardEdit=P.modules.BoardEditActionBase.extend({handleDelete:function(a,b){this.isInModal()?(P.pubsub.publish(a,P.CONST.PUBSUB_TOPIC_BOARD_DELETED),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_DELETED,{privacy:b}),this.destroy()):this.redirectAfterDelete()},onButtonClick:function(a){P.modules.BoardEditBase.prototype.onButtonClick.call(this,a);var b=a.target;"deleteBoardButton"===b.id&&this.onDeleteClick()},onDeleteClick:function(){P.trackGAEvent("board_delete",P.CONST.GA_ACTION_OPEN_MODAL),this.showConfirmation()},onDeleteConfirm:function(){P.trackGAEvent("board_delete",P.CONST.GA_ACTION_CLICK_SUBMIT),this.deleteBoard()},showConfirmation:function(){var a=this,b={name:"ConfirmDialog",options:{template:"delete_board"}};P.loadModule(b,function(b){a.showInModal(b),a.listen(b,P.CONST.EVENT_CONFIRM,a.onDeleteConfirm)})}}),goog.provide("P.modules.PinCreateSuccessBoardEdit"),goog.require("P.Module"),goog.require("P.modules.BoardEditActionBase"),P.modules.PinCreateSuccessBoardEdit=P.modules.BoardEditActionBase.extend({onContentReady:function(){P.modules.BoardEditActionBase.prototype.onContentReady.call(this);var a=this.getChildById("doneButton");a&&this.listen(a,P.CONST.EVENT_BUTTON_CLICK,this.onDone)},onDone:function(){this.showLoading();var a={board_id:this.data&&this.data.id},b=this.getChildById("placeLayoutCheckbox");b&&(a.layout=b.isChecked()?"places":"default");var c=this,d=P.resourceFactory.create("BoardResource",a),e=this.options.pinCreateInfo,f=function(){e&&P.loadModule(e,function(a){c.showInModal(a),c.hideLoading(),c.destroy()})};d.callUpdate({error:P.NOOP}).always(f)}}),function(){goog.provide("P.main"),goog.require("P.logger"),goog.require("P.start"),goog.require("P.adTracking"),goog.require("P.string");var a=P.Logger.getLogger("Main"),b=function(a,c){_.each(a,function(a,d){a.prototype?a.prototype.className=c+d:"object"===typeof a&&b(a,c+d+".")})};P.start.ready(function(a){b(P.modules,""),P.CONST.CANONICAL_MAIN_DOMAIN=a.canonicalMainDomain,window.videojs&&(videojs.options.flash.swf=a.videojsSwfUrl),P.string.initializeCommonStrings();var c=a.tree,d=P.ModuleTree.fromPlainObject(c);P.moduleFactory.create(d).then(function(a){P.app=a},function(a){throw a}),P.AdTracking.trackConversions(),a.canDebug&&$(document).on("keypress",function(a){var b=P.getWindowManager();b&&"|"===String.fromCharCode(a.which)&&b.open("/_/_/debug/","debug",800,800)}),P.start.finishStart()}),$(document).ready(function(){var b=$("#jsInit");b.length||a.error("jsInit block at bottom of page failed to load")})}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/bizface/modules/BreadcrumbNavigation/BreadcrumbNavigation.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n\n";var i;f=2,g=30,i=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["breadcrumbs",[]]),c.set("breadcrumbs",i),c.parent||(b.setVariable("breadcrumbs",i),b.addExport("breadcrumbs")),h+="\n",c=c.push();var j=i;if(j)for(var k=0;k<j.length;k++){var l=j[k];c.set("breadcrumb",l),c.set("loop.index0",k),h+="\n    <a\n        ",0==d.memberLookup(d.contextOrFrameLookup(b,c,"loop"),"index0",a.autoesc)&&(h+='class="firstCrumb"'),h+='\n        href="',h+=d.suppressValue(d.memberLookup(l,"link",a.autoesc),a.autoesc),h+='">',h+=d.suppressValue(d.memberLookup(l,"title",a.autoesc),a.autoesc),h+="</a>\n"}c=c.pop(),h+="\n\n",e(null,h)}catch(m){e(d.handleError(m,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/bizface/modules/bizface/Test/Test.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<h1>I am bizface</h1>\n<h2>test image</h2>\n<div class="testImage"></div>\n<h2>test sprite</h2>\n<div class="testSprite"></div>\n<h2>JavaScript</h2>\n<ul>\n    <li>\n        ',h+=d.suppressValue((f=8,g=15,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"callLib",options:{text:"Click to call a lib"}})])),a.autoesc),h+="\n    <li>\n        ",h+=d.suppressValue((f=16,g=15,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"rerender",options:{text:"Click to re-render"}})])),a.autoesc),h+="\n    </li>\n</ul>    \n",e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/BoardPickerBase/BoardPickerBase.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n",a.getTemplate("templates/macros/boardpicker.nunjucks",function(i,j){return i?void e(i):void j.getExported(function(i,j){if(i)return void e(i);if(!j.hasOwnProperty("icon_wrapper"))return void e(new Error("cannot import 'icon_wrapper'"));var k=j.icon_wrapper;b.setVariable("icon_wrapper",k),h+="\n\n",h+="\n";var l;l="places",c.set("LAYOUT_PLACES",l),c.parent||(b.setVariable("LAYOUT_PLACES",l),b.addExport("LAYOUT_PLACES")),h+="\n";var m;m=d.contextOrFrameLookup(b,c,"data"),c.set("boards",m),c.parent||(b.setVariable("boards",m),b.addExport("boards")),h+="\n";var n;n=0==a.getFilter("length").call(b,m),c.set("no_boards",n),c.parent||(b.setVariable("no_boards",n),b.addExport("no_boards")),h+="\n\n",h+=d.suppressValue((f=14,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",[a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"size",a.autoesc),"")])),a.autoesc),h+="\n",d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"disabled",a.autoesc)&&(h+="\n    ",h+=d.suppressValue((f=16,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["disabled"])),a.autoesc),h+="\n"),h+="\n\n";var o=d.makeMacro(["board"],[],function(e,h){c=c.push(),h=h||{},c.set("board",e);var i="";i+="\n    ";var j;j=a.getFilter("default").call(b,d.memberLookup(e,"privacy",a.autoesc),"public"),c.set("privacy",j),c.parent||(b.setVariable("privacy",j),b.addExport("privacy")),i+="\n    ";var m;m="secret"==j,c.set("is_secret",m),c.parent||(b.setVariable("is_secret",m),b.addExport("is_secret")),i+="\n    ";var n;n=d.memberLookup(e,"layout",a.autoesc)==l,c.set("is_place",n),c.parent||(b.setVariable("is_place",n),b.addExport("is_place")),i+="\n    ";var o;o=d.memberLookup(e,"is_collaborative",a.autoesc),c.set("is_collaborative",o),c.parent||(b.setVariable("is_collaborative",o),b.addExport("is_collaborative")),i+="\n\n    ",i+="\n    ",i+="\n    ";var p;return p="",c.set("is_collaborative_string",p),c.parent||(b.setVariable("is_collaborative_string",p),b.addExport("is_collaborative_string")),i+="\n    ",o&&(i+="\n        ",p="1",c.set("is_collaborative_string",p),c.parent||(b.setVariable("is_collaborative_string",p),b.addExport("is_collaborative_string")),i+="\n    "),i+='\n\n    <div class="currentBoard"\n        data-id="',i+=d.suppressValue(d.memberLookup(e,"id",a.autoesc),a.autoesc),i+='"\n        data-privacy="',i+=d.suppressValue(j,a.autoesc),i+='"\n        data-collaborative="',i+=d.suppressValue(p,a.autoesc),i+='">\n            ',i+=d.suppressValue((f=37,g=25,d.callWrap(k,"icon_wrapper",[m,o,n,!0])),a.autoesc),i+='\n        <span class="currentBoardName">',i+=d.suppressValue(a.getFilter("e").call(b,d.memberLookup(e,"name",a.autoesc)),a.autoesc),i+="</span>\n    </div>\n",c=c.pop(),new d.SafeString(i)});b.addExport("current_board"),b.setVariable("current_board",o),h+="\n\n",b.getBlock("board_picker")(a,b,c,d,function(a,b){return a?void e(a):(h+=b,h+="\n",void e(null,h))})})})}catch(i){e(d.handleError(i,f,g))}}function b(a,b,c,d,e){var f=null,g=null,h="";try{if(h+="\n    ",h+=d.suppressValue((f=43,g=15,d.callWrap(d.contextOrFrameLookup(b,c,"extra_data"),"extra_data",[{num_boards:a.getFilter("length").call(b,d.contextOrFrameLookup(b,c,"boards"))}])),a.autoesc),h+="\n    ",d.contextOrFrameLookup(b,c,"no_boards")){h+="\n        ",h+=d.suppressValue((f=45,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["no_boards"])),a.autoesc),h+="\n        ",h+=d.suppressValue((f=46,g=19,d.callWrap(d.contextOrFrameLookup(b,c,"extra_data"),"extra_data",[{no_boards:d.contextOrFrameLookup(b,c,"no_boards")}])),a.autoesc),h+="\n        ";var i;i=[(f=48,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Places to Visit"])),(f=49,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Stuff to Buy"])),(f=50,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Projects to Try"])),(f=51,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Things to Wear"])),(f=52,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Recipes to Cook"])),(f=53,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Ideas for the House"]))],c.set("board_name_suggestions",i),c.parent||(b.setVariable("board_name_suggestions",i),b.addExport("board_name_suggestions")),h+="\n    "}else h+="\n        ",i=[],c.set("board_name_suggestions",i),c.parent||(b.setVariable("board_name_suggestions",i),b.addExport("board_name_suggestions")),h+="\n    ";h+='\n\n    <div class="boardPickerInnerWrapper">\n        <div class="createBoard">\n            ',h+=d.suppressValue((f=60,g=19,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"createBoard",options:{class_name:"createBoardButton",text:(f=64,g=29,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Create"]))}})])),a.autoesc),h+="\n            ";var j;f=67,g=37,j=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Create New Board"]),c.set("placeholder_text",j),c.parent||(b.setVariable("placeholder_text",j),b.addExport("placeholder_text")),h+="\n            ",d.contextOrFrameLookup(b,c,"no_boards")&&(h+="\n                ",f=69,g=41,j=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Create a Board"]),c.set("placeholder_text",j),c.parent||(b.setVariable("placeholder_text",j),b.addExport("placeholder_text")),h+="\n            "),h+='\n            <div class="createBoardNameContainer">\n                <input type="text" name="name" class="createBoardName" placeholder="',h+=d.suppressValue(j,a.autoesc),h+='">\n            </div>\n        </div>\n            <div class="boardPickerInner">\n            <ul>\n                ',d.contextOrFrameLookup(b,c,"no_boards")&&(h+='\n                    <li class="boardPickerHeader">\n                        <h2>\n                            ',h+=d.suppressValue((f=80,g=30,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Feeling stuck? Try one of these:"])),a.autoesc),h+="\n                        </h2>\n                    </li>\n                "),h+="\n\n                ",c=c.push();var k=i;if(k)for(var l=0;l<k.length;l++){var m=k[l];c.set("board",m),h+='\n                    <li class="boardPickerItem" data-suggestion="',h+=d.suppressValue(m,a.autoesc),h+='">\n                        ',h+=d.suppressValue(m,a.autoesc),h+="\n                    </li>\n                "}c=c.pop(),h+="\n\n                ",c=c.push();var n=d.contextOrFrameLookup(b,c,"boards");if(n)for(var o=0;o<n.length;o++){var p=n[o];c.set("board",p),h+="\n                    ";var q;q=d.memberLookup(p,"privacy",a.autoesc),c.set("privacy",q),c.parent||(b.setVariable("privacy",q),b.addExport("privacy")),h+="\n                    ";var r;r=d.memberLookup(p,"is_collaborative",a.autoesc),c.set("is_collaborative",r),c.parent||(b.setVariable("is_collaborative",r),b.addExport("is_collaborative")),h+="\n                    ";var s;s=d.memberLookup(p,"layout",a.autoesc)==d.contextOrFrameLookup(b,c,"LAYOUT_PLACES"),c.set("is_place",s),c.parent||(b.setVariable("is_place",s),b.addExport("is_place")),h+="\n                    ";var t;t="",c.set("is_collaborative_string",t),c.parent||(b.setVariable("is_collaborative_string",t),b.addExport("is_collaborative_string")),h+="\n                    ",r&&(h+="\n                        ",t="1",c.set("is_collaborative_string",t),c.parent||(b.setVariable("is_collaborative_string",t),b.addExport("is_collaborative_string")),h+="\n                    "),h+="\n                    ";var u;u="secret"==q,c.set("is_secret",u),c.parent||(b.setVariable("is_secret",u),b.addExport("is_secret")),h+='\n                    <li class="boardPickerItem"\n                        data-id="',h+=d.suppressValue(d.memberLookup(p,"id",a.autoesc),a.autoesc),h+='"\n                        data-place="',h+=d.suppressValue(s,a.autoesc),h+='"\n                        data-privacy="',h+=d.suppressValue(q,a.autoesc),h+='"\n                        data-collaborative="',h+=d.suppressValue(t,a.autoesc),h+='">\n                            ',h+=d.suppressValue((f=105,g=41,d.callWrap(d.contextOrFrameLookup(b,c,"icon_wrapper"),"icon_wrapper",[u,r,s,!1])),a.autoesc),h+="\n                            ",h+=d.suppressValue(a.getFilter("e").call(b,d.memberLookup(p,"name",a.autoesc)),a.autoesc),h+="\n                    </li>\n                "}if(c=c.pop(),h+="\n            </ul>\n        </div>\n    </div>\n\n    ",d.contextOrFrameLookup(b,c,"no_boards"))h+='\n        <div class="boardPickerOuter primary createYourFirstBoard">\n            ',h+=d.suppressValue((f=118,g=14,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Create your first board","Button text that invites the user to create one board"])),a.autoesc),h+="\n        </div>\n    ";else{h+='\n        <div class="boardPickerOuter">\n            ';var v;if(v=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"default_board_id",a.autoesc),c.set("default_board_id",v),c.parent||(b.setVariable("default_board_id",v),b.addExport("default_board_id")),h+="\n            ",v){h+="\n                ",c=c.push();var w=d.contextOrFrameLookup(b,c,"boards");if(w)for(var x=0;x<w.length;x++){var y=w[x];c.set("board",y),h+="\n                    ",v==d.memberLookup(y,"id",a.autoesc)&&(h+="\n                        ",h+=d.suppressValue((f=126,g=38,d.callWrap(d.contextOrFrameLookup(b,c,"current_board"),"current_board",[y])),a.autoesc),h+="\n                    "),h+="\n                "}c=c.pop(),h+="\n            "}else{h+="\n                ";var z;z=a.getFilter("first").call(b,d.contextOrFrameLookup(b,c,"boards")),c.set("board",z),c.parent||(b.setVariable("board",z),b.addExport("board")),h+="\n                ",h+=d.suppressValue((f=131,g=30,d.callWrap(d.contextOrFrameLookup(b,c,"current_board"),"current_board",[z])),a.autoesc),h+="\n            "}h+="\n        </div>\n    "}h+="\n",e(null,h)}catch(A){e(d.handleError(A,f,g))}}return{b_board_picker:b,root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/ButtonBase/ButtonBase.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n\n",h+="\n";var i;i=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"element_type",a.autoesc),"button"),c.set("element_type",i),c.parent||(b.setVariable("element_type",i),b.addExport("element_type")),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"ellipsis",a.autoesc)||"button"!=i||(h+=d.suppressValue((f=36,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"tag_name"),"tag_name",["button"])),a.autoesc)),"a"==d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"element_type",a.autoesc)&&d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"url",a.autoesc)&&(h+="\n    ",h+=d.suppressValue((f=40,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({href:d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"url",a.autoesc)})])),a.autoesc)),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"cancelButton",a.autoesc)&&(h+=d.suppressValue((f=44,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["cancelButton"])),a.autoesc)),"div"!=i&&"button"!=i&&(h+=d.suppressValue((f=48,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"tag_name"),"tag_name",[i])),a.autoesc)),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"disabled",a.autoesc)&&(h+=d.suppressValue((f=52,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({disabled:"disabled"})])),a.autoesc),h+="\n    ",h+=d.suppressValue((f=53,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["disabled"])),a.autoesc)),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"borderless",a.autoesc)?h+=d.suppressValue((f=57,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["borderless"])),a.autoesc):(h+=d.suppressValue((f=59,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["btn"])),a.autoesc),a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"rounded",a.autoesc),!0)&&(h+=d.suppressValue((f=61,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["rounded"])),a.autoesc))),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"size",a.autoesc)&&(h+=d.suppressValue((f=66,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",[d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"size",a.autoesc)])),a.autoesc));var j;j=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"color",a.autoesc),"default"),c.set("color",j),c.parent||(b.setVariable("color",j),b.addExport("color")),"default"!=j&&(h+=d.suppressValue((f=71,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",[j])),a.autoesc)),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"primary_on_hover",a.autoesc)&&(h+=d.suppressValue((f=75,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["primaryOnHover"])),a.autoesc)),(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"log_element_type",a.autoesc)||0==d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"log_element_type",a.autoesc))&&(h+=d.suppressValue((f=79,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[{"data-element-type":d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"log_element_type",a.autoesc)}])),a.autoesc)),h+=d.suppressValue((f=82,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",[a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"class_name",a.autoesc),"")])),a.autoesc),h+="\n",h+=d.suppressValue((f=83,g=5,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({type:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"type",a.autoesc),"button")})])),a.autoesc),h+="\n";var k;k=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"has_icon",a.autoesc),c.set("has_icon",k),c.parent||(b.setVariable("has_icon",k),b.addExport("has_icon")),h+="\n";var l;if(l=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"icon_on_right",a.autoesc),c.set("icon_on_right",l),c.parent||(b.setVariable("icon_on_right",l),b.addExport("icon_on_right")),k&&!l&&(h+="<em></em>\n"),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"text",a.autoesc)){var m;m=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"text",a.autoesc),c.set("text",m),c.parent||(b.setVariable("text",m),b.addExport("text"));var n;n=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_text",a.autoesc),!0),c.set("show_text",n),c.parent||(b.setVariable("show_text",n),b.addExport("show_text")),m&&n?(h+='<span class="buttonText">',h+=d.suppressValue(m,a.autoesc),h+="</span>\n        ",h+=d.suppressValue((f=96,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["hasText"])),a.autoesc)):(h+='<span class="accessibilityText">',h+=d.suppressValue(m,a.autoesc),h+="</span>")}else h+="\n    &nbsp;";h+="\n",k&&l&&(h+="\n    <em></em>"),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"supports_badge",a.autoesc)&&(h+="<span class='buttonBadge'></span>"),e(null,h)}catch(o){e(d.handleError(o,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/DropdownButton/DropdownButton.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n\n",h+=d.suppressValue((f=12,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",[a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"class_name",a.autoesc),"")])),a.autoesc),h+="\n",h+="\n",h+=d.suppressValue((f=14,g=7,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"button",options:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"button_options",a.autoesc),{})})])),a.autoesc),h+="\n",e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/Map/addToMapToast.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<div class="addToMapToast">\n    ',d.contextOrFrameLookup(b,c,"image")&&(h+="\n        <div class=\"imageWrapper\">\n            <img class='popupToastPinImage' src='",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"image"),a.autoesc),h+="'>\n        </div>\n    "),h+="\n    <h3 class='toastPlaceName'>",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"name"),a.autoesc),h+='</h3>\n    <p class="toastAddedToMap">',h+=d.suppressValue((f=7,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Added to your map!"])),a.autoesc),h+="</p>\n</div>\n",e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/Map/marker.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<div class="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"markerWrapperClassName"),a.autoesc),h+='">\n    <div class="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"markerClassName"),a.autoesc),h+='">\n        <div class="imageContainer">\n            ',d.contextOrFrameLookup(b,c,"pinImage")&&""!=d.contextOrFrameLookup(b,c,"pinImage")&&(h+='\n                <img src="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"pinImage"),a.autoesc),h+='" alt="">\n            '),h+="\n        </div>\n    </div>\n</div>\n",e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/Map/markerCluster.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<div class="markerCluster">\n    <div class="imageContainerClustered">\n        <img src="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"markerClusterPinImage"),a.autoesc),h+='" alt="">\n    </div>\n    <em class="clusterChildCount">\n        ',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"clusterChildCount"),a.autoesc),h+="\n    </em>\n</div>\n",e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/Map/markerPopup.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i;i=d.memberLookup(d.contextOrFrameLookup(b,c,"place"),"region",a.autoesc),c.set("region",i),c.parent||(b.setVariable("region",i),b.addExport("region")),h+="\n";var j;j=d.memberLookup(d.contextOrFrameLookup(b,c,"place"),"category",a.autoesc),c.set("category",j),c.parent||(b.setVariable("category",j),b.addExport("category")),h+="\n";var k;k=d.memberLookup(d.contextOrFrameLookup(b,c,"place"),"locality",a.autoesc),c.set("locality",k),c.parent||(b.setVariable("locality",k),b.addExport("locality")),h+="\n";var l;l=d.memberLookup(d.contextOrFrameLookup(b,c,"place"),"street",a.autoesc),c.set("street",l),c.parent||(b.setVariable("street",l),b.addExport("street")),h+="\n";var m;m=d.memberLookup(d.contextOrFrameLookup(b,c,"place"),"phone",a.autoesc),c.set("phone",m),c.parent||(b.setVariable("phone",m),b.addExport("phone")),h+="\n";var n;n=d.memberLookup(d.contextOrFrameLookup(b,c,"place"),"url",a.autoesc)||d.memberLookup(d.contextOrFrameLookup(b,c,"place"),"source_url",a.autoesc),c.set("url",n),c.parent||(b.setVariable("url",n),b.addExport("url")),h+="\n\n";var o;o=!l&&(k||i),c.set("show_just_locality",o),c.parent||(b.setVariable("show_just_locality",o),b.addExport("show_just_locality")),h+='\n\n<div class="popupContentWrapper" itemscope itemtype="http://schema.org/Place">\n    <h3 class="placeName" itemprop="name">\n        ',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"name"),a.autoesc),h+="\n    </h3>\n    ",(j||o)&&(h+='\n        <p class="categoryLocation">\n            ',j&&(h+="\n                <strong>",h+=d.suppressValue(j,a.autoesc),h+="</strong>\n            "),h+="\n            ",o&&(h+='\n                <span itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">\n                    ',j&&(h+=d.suppressValue((f=20,g=35,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["in"])),a.autoesc)),h+='\n                    <span itemprop="addressLocality">',h+=d.suppressValue(k,a.autoesc),h+="</span>",i&&(h+=', <span itemprop="addressRegion">',h+=d.suppressValue(i,a.autoesc),h+="</span>"),h+="\n                </span>\n            "),h+="\n        </p>\n    "),h+="\n    ",l&&(h+='\n        <h4 class="heading">',h+=d.suppressValue((f=30,g=30,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Address"])),a.autoesc),h+='</h4>\n        <p class="address" itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">\n            ',l&&(h+='<span itemprop="streetAddress">',h+=d.suppressValue(l,a.autoesc),h+="</span><br>"),h+='\n                <span itemprop="addressLocality">',h+=d.suppressValue(k,a.autoesc),h+="</span>",i&&(h+=', <span itemprop="addressRegion">',h+=d.suppressValue(i,a.autoesc),h+="</span>"),h+="\n        </p>\n    "),h+="\n    ",m&&(h+='\n        <h4 class="heading">',h+=d.suppressValue((f=42,g=30,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Contact Information"])),a.autoesc),h+='</h4>\n        <p class="address" itemprop="telephone">\n            ',h+=d.suppressValue(m,a.autoesc),h+="\n        </p>\n    "),h+="\n\n    ",n&&(h+='\n        <div class="sourceLinkWrapper">\n            <a href="',h+=d.suppressValue(n,a.autoesc),h+='" target="_blank" class="Button btn rounded sourceLink" rel="nofollow">',h+=d.suppressValue((f=50,g=99,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Learn More"])),a.autoesc),h+="</a>\n        </div>\n    "),h+="\n</div>\n",e(null,h)}catch(p){e(d.handleError(p,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/PinLikeButtonBase/PinLikeButtonBase.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n";var i;f=8,g=18,i=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Like"]),c.set("like_text",i),c.parent||(b.setVariable("like_text",i),b.addExport("like_text")),h+="\n";var j;f=9,g=20,j=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Unlike"]),c.set("unlike_text",j),c.parent||(b.setVariable("unlike_text",j),b.addExport("unlike_text")),h+="\n";var k;k=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"liked",a.autoesc)?j:i,c.set("button_text",k),c.parent||(b.setVariable("button_text",k),b.addExport("button_text")),h+="\n\n",h+=d.suppressValue((f=12,g=5,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["Button"])),a.autoesc),h+="\n",h+=d.suppressValue((f=13,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"describe"),"describe",[d.makeKeywordArgs({text:k,has_icon:d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"has_icon",a.autoesc)})])),a.autoesc),h+="\n\n",h+="\n",a.getTemplate("app/desktop/modules/Button/Button.nunjucks",function(k,l){return k?void e(k):void l.render(b.getVariables(),c.push(),function(k,l){return k?void e(k):(h+=l,h+="\n\n",d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"liked",a.autoesc)&&(h+="\n    ",h+=d.suppressValue((f=19,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["unlike"])),a.autoesc),h+="\n"),h+="\n\n",h+=d.suppressValue((f=22,g=5,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[{"data-text-like":i,"data-text-unlike":j,"data-element-type":d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"PIN_LIKE_BUTTON",a.autoesc)}])),a.autoesc),h+="\n",void e(null,h))})})}catch(l){e(d.handleError(l,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/ui/Checkbox/Checkbox.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n";var i;i=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"id",a.autoesc),c.set("id",i),c.parent||(b.setVariable("id",i),b.addExport("id")),h+="\n";var j;j=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"name",a.autoesc),""),c.set("name",j),c.parent||(b.setVariable("name",j),b.addExport("name"));var k;k=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"value",a.autoesc),""),c.set("value",k),c.parent||(b.setVariable("value",k),b.addExport("value"));var l;l=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"checked",a.autoesc),!1),c.set("checked",l),c.parent||(b.setVariable("checked",l),b.addExport("checked"));var m;m=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"disabled",a.autoesc),!1),c.set("disabled",m),c.parent||(b.setVariable("disabled",m),b.addExport("disabled"));var n;n=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"view_type",a.autoesc),""),c.set("view_type",n),c.parent||(b.setVariable("view_type",n),b.addExport("view_type"));var o;if(o=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"class_name",a.autoesc),c.set("class_name",o),c.parent||(b.setVariable("class_name",o),b.addExport("class_name")),o&&(h+="\n    ",h+=d.suppressValue((f=24,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",[o])),a.autoesc),h+="\n"),h+="\n\n",("fancyToggle"==n||"fancyCheckbox"==n)&&(h+="\n    ",n&&(h+="\n        ",h+=d.suppressValue((f=29,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",[n])),a.autoesc),h+="\n    "),h+="\n\n    ",l&&(h+=d.suppressValue((f=33,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["on"])),a.autoesc),h+="\n    "),m&&(h+=d.suppressValue((f=37,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["disabled"])),a.autoesc),h+="\n    ")),h+="\n\n","fancyToggle"==n){var p;
p=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"on_text",a.autoesc),(f=42,g=44,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Yes"]))),c.set("on_text",p),c.parent||(b.setVariable("on_text",p),b.addExport("on_text"));var q;q=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"off_text",a.autoesc),(f=43,g=46,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["No"]))),c.set("off_text",q),c.parent||(b.setVariable("off_text",q),b.addExport("off_text")),h+='<div class="slider"></div>\n    <p class="onText status">',h+=d.suppressValue(p,a.autoesc),h+='</p>\n    <p class="offText status">',h+=d.suppressValue(q,a.autoesc),h+="</p>\n    ",h+=d.suppressValue((f=48,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.Checkbox",d.makeKeywordArgs({options:{checked:l,disabled:m,name:j,value:k}})])),a.autoesc),h+="\n"}else"fancyCheckbox"==n?(h+='\n    <span class="visibleCheck"></span\n    >',h+=d.suppressValue((f=55,g=12,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.Checkbox",d.makeKeywordArgs({options:{checked:l,disabled:m,name:j,value:k,id:i}})])),a.autoesc),h+="\n"):(h+=d.suppressValue((f=62,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"tag_name"),"tag_name",["input"])),a.autoesc),h+="\n    ",h+=d.suppressValue((f=63,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({type:"checkbox"})])),a.autoesc),h+="\n    ",i&&(h+=d.suppressValue((f=65,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({id:i})])),a.autoesc),h+="\n    "),j&&(h+=d.suppressValue((f=68,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({name:j})])),a.autoesc),h+="\n    "),k&&(h+=d.suppressValue((f=71,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({value:k})])),a.autoesc),h+="\n    "),l&&(h+=d.suppressValue((f=74,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({checked:"checked"})])),a.autoesc),h+="\n    "),m&&(h+=d.suppressValue((f=77,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({disabled:"disabled"})])),a.autoesc),h+="\n    "));e(null,h)}catch(r){e(d.handleError(r,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/ui/TextField/TextField.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="<textarea",d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"id",a.autoesc)&&(h+=' id="',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"id",a.autoesc),a.autoesc),h+='"'),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"name",a.autoesc)&&(h+=' name="',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"name",a.autoesc),a.autoesc),h+='"'),h+=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"disabled",a.autoesc)?' disabled class="disabled content"':' class="content"',d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"autofocus",a.autoesc)&&(h+=' autofocus="autofocus"'),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"rows",a.autoesc)&&(h+=' rows="',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"rows",a.autoesc),a.autoesc),h+='"'),h+='\n    placeholder="',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"placeholder",a.autoesc),a.autoesc),h+='"\n>',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"value",a.autoesc),a.autoesc),h+="</textarea>\n",e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/ui/TypeaheadBase/add_pin_to_map.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i;i="typeaheadResultEmphasized",c.set("emphasized_classname",i),c.parent||(b.setVariable("emphasized_classname",i),b.addExport("emphasized_classname")),h+="\n";var j;j="typeaheadResultMetaData",c.set("meta_classname",j),c.parent||(b.setVariable("meta_classname",j),b.addExport("meta_classname")),h+='\n\n<a>\n    <div class="addToMap">\n        <p class="Button btn rounded addToMap">\n            ',h+=d.suppressValue((f=6,g=14,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Map it"])),a.autoesc),h+='\n        </p>\n    </div>\n    <h4 class="',h+=d.suppressValue(i,a.autoesc),h+='">\n        ',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"label"),a.autoesc),h+="\n    </h4>\n\n    ",h+="\n    ",a.getTemplate("app/desktop/modules/AddPinToMap/pinFormMetadata.nunjucks",function(a,d){return a?void e(a):void d.render(b.getVariables(),c.push(),function(a,b){return a?void e(a):(h+=b,h+="\n</a>\n",void e(null,h))})})}catch(k){e(d.handleError(k,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/ui/TypeaheadBase/default_item.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="<a ",d.contextOrFrameLookup(b,c,"class_name")&&(h+='class="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"class_name"),a.autoesc),h+='"'),h+=">\n    ",d.contextOrFrameLookup(b,c,"image")&&(h+='\n        <span class="typeaheadImg">\n            <img src="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"image"),a.autoesc),h+='">\n        </span>\n    '),h+="\n    ","recent_queries"==d.contextOrFrameLookup(b,c,"tag")&&(h+='\n        <button data-query="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"query"),a.autoesc),h+='" class="remove">',h+=d.suppressValue((f=7,g=54,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Remove"])),a.autoesc),h+="</button>\n    "),h+="\n\n    ";var i;i="pins",c.set("search_mode",i),c.parent||(b.setVariable("search_mode",i),b.addExport("search_mode")),h+="\n    ";var j;j=d.contextOrFrameLookup(b,c,"type"),c.set("autocomplete_type",j),c.parent||(b.setVariable("autocomplete_type",j),b.addExport("autocomplete_type")),h+="\n    ","board_search"==d.contextOrFrameLookup(b,c,"type")?(h+="\n        ",i="boards",c.set("search_mode",i),c.parent||(b.setVariable("search_mode",i),b.addExport("search_mode")),h+="\n        ",j="query",c.set("autocomplete_type",j),c.parent||(b.setVariable("autocomplete_type",j),b.addExport("autocomplete_type")),h+="\n    "):"people_search"==d.contextOrFrameLookup(b,c,"type")&&(h+="\n        ",i="users",c.set("search_mode",i),c.parent||(b.setVariable("search_mode",i),b.addExport("search_mode")),h+="\n        ",j="query",c.set("autocomplete_type",j),c.parent||(b.setVariable("autocomplete_type",j),b.addExport("autocomplete_type")),h+="\n    "),h+='\n    <span class="typeaheadName"\n        data-element-type="',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"AUTOCOMPLETE_SUGGESTION",a.autoesc),a.autoesc),h+='"\n        ',h+='\n        data-aux=\'{\n            "result_index": ',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"resultIndex"),a.autoesc),h+=',\n            "entered_query": "',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"enteredQuery"),a.autoesc),h+='",\n            "selected_query": "',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"label"),a.autoesc),h+='",\n            "autocomplete_type": "',h+=d.suppressValue(j,a.autoesc),h+='",\n            "search_mode": "',h+=d.suppressValue(i,a.autoesc),h+="\"\n        }'>\n        ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"label"),a.autoesc),h+="\n    </span>\n</a>\n",e(null,h)}catch(k){e(d.handleError(k,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/ui/TypeaheadBase/place.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{a.getTemplate("templates/macros/image.nunjucks",function(i,j){return i?void e(i):void j.getExported(function(i,j){if(i)return void e(i);if(!j.hasOwnProperty("image_tag"))return void e(new Error("cannot import 'image_tag'"));var k=j.image_tag;b.setVariable("image_tag",k),h+="\n\n<a",d.contextOrFrameLookup(b,c,"class_name")&&(h+=' class="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"class_name"),a.autoesc),h+='"'),h+=">\n    ",d.contextOrFrameLookup(b,c,"image")&&(h+="\n        ",h+=d.suppressValue((f=4,g=18,d.callWrap(k,"image_tag",[d.makeKeywordArgs({src:d.contextOrFrameLookup(b,c,"image"),class_name:"iconGlyph"})])),a.autoesc),h+="\n    "),h+='\n    <div class="content',d.contextOrFrameLookup(b,c,"image")&&(h+=" hasImage "),h+='">\n        <h4 class="typeaheadResultEmphasized">\n            ',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"label"),a.autoesc),h+='\n        </h4>\n\n        <p class="typeaheadResultMetaData">\n            <span class="typeaheadPlace">\n                ',d.contextOrFrameLookup(b,c,"sublabel")&&(h+="\n                    ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"sublabel"),a.autoesc),h+="\n                "),h+="\n                ",d.contextOrFrameLookup(b,c,"street")&&(h+="\n                    ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"street"),a.autoesc),h+="\n                "),h+="\n                ",d.contextOrFrameLookup(b,c,"hideLocalityAndRegion")||(h+="\n                    ",d.contextOrFrameLookup(b,c,"street")&&d.contextOrFrameLookup(b,c,"locality")&&(h+="&bull;"),h+="\n                    ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"locality"),a.autoesc),d.contextOrFrameLookup(b,c,"locality")&&d.contextOrFrameLookup(b,c,"region")&&(h+=", "),h+="\n                    ",d.contextOrFrameLookup(b,c,"region")&&(h+="\n                        ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"region"),a.autoesc),h+="\n                    "),h+="\n                "),h+="\n            </span>\n        </p>\n    </div>\n</a>\n",e(null,h)})})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/common/modules/ui/TypeaheadBase/send_pin.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i;i="",c.set("element_type",i),c.parent||(b.setVariable("element_type",i),b.addExport("element_type")),h+="\n",d.contextOrFrameLookup(b,c,"is_pinner")?(h+="\n    ",h+="\n    ",i=204,c.set("element_type",i),c.parent||(b.setVariable("element_type",i),b.addExport("element_type")),h+="\n"):"facebook_non_pinner"==d.contextOrFrameLookup(b,c,"type")?(h+="\n    ",h+="\n    ",i=202,c.set("element_type",i),c.parent||(b.setVariable("element_type",i),b.addExport("element_type")),h+="\n"):"gplus_non_pinner"==d.contextOrFrameLookup(b,c,"type")&&(h+="\n    ",h+="\n    ",i=203,c.set("element_type",i),c.parent||(b.setVariable("element_type",i),b.addExport("element_type")),h+="\n"),h+="\n\n<a ",d.contextOrFrameLookup(b,c,"id")&&(h+='class="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"id"),a.autoesc),h+='"'),h+=" ",i&&(h+='data-element-type="',h+=d.suppressValue(i,a.autoesc),h+='"'),h+=">\n    ",d.contextOrFrameLookup(b,c,"send_pin_image")&&(h+='\n        <span class="typeaheadImg">\n            <img src="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"send_pin_image"),a.autoesc),h+='" alt="">\n        </span>\n    '),h+='\n    <p class="typeaheadName">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"label"),a.autoesc),h+='</p>\n    <div class="titleWrapper">\n        <i class="titleIcon ',d.contextOrFrameLookup(b,c,"is_pinner")&&(h+="isPinner "),"facebook_non_pinner"==d.contextOrFrameLookup(b,c,"type")&&(h+="isFacebook "),"gplus_non_pinner"==d.contextOrFrameLookup(b,c,"type")&&(h+="isGplus "),h+='"></i>\n        <p class="title">\n            ',d.contextOrFrameLookup(b,c,"is_pinner")?(h+="\n                ",h+=d.suppressValue((f=23,g=18,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Fellow Pinner"])),a.autoesc),h+="\n            "):d.contextOrFrameLookup(b,c,"email")?(h+="\n                ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"email"),a.autoesc),h+="\n            "):"facebook_non_pinner"==d.contextOrFrameLookup(b,c,"type")?(h+="\n                ",h+=d.suppressValue((f=27,g=18,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Facebook"])),a.autoesc),h+="\n            "):"gplus_non_pinner"==d.contextOrFrameLookup(b,c,"type")?(h+="\n                ",h+=d.suppressValue((f=29,g=18,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Google"])),a.autoesc),h+="\n            "):(h+="\n                ",h+=d.suppressValue((f=31,g=18,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Enter an email address"])),a.autoesc),h+="\n            "),h+="\n        </p>\n    </div>\n</a>\n",e(null,h)}catch(j){e(d.handleError(j,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/AddPinToMap/pinFormMetadata.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<p class="typeaheadResultMetaData">\n    ',d.contextOrFrameLookup(b,c,"category")&&(h+='\n        <strong class="typeaheadPlaceType">\n            ',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"category"),a.autoesc),h+="\n        </strong>\n        ",(d.contextOrFrameLookup(b,c,"street")||d.contextOrFrameLookup(b,c,"locality")||d.contextOrFrameLookup(b,c,"region"))&&(h+="\n            &bull;\n        "),h+="\n    "),h+='\n    <span class="typeaheadPlaceDistrict">\n        ',d.contextOrFrameLookup(b,c,"street")&&(h+="\n            ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"street"),a.autoesc),h+=" \n        "),h+="\n        ",d.contextOrFrameLookup(b,c,"hideLocalityAndRegion")||(h+="\n                ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"locality"),a.autoesc),d.contextOrFrameLookup(b,c,"locality")&&d.contextOrFrameLookup(b,c,"region")&&(h+=", "),h+="\n            ",d.contextOrFrameLookup(b,c,"region")&&(h+="\n                ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"region"),a.autoesc),h+="\n            "),h+="\n        "),h+="\n    </span>\n</p>\n",e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/AddPinToMap/selectedPinHeader.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{if(h+="\n<div class='selectedPlace'>\n    <form>\n        <h2 class=\"placeName\">\n            ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"placeName"),a.autoesc),h+='\n        </h2>\n        <p class="categoryCity">\n            ',d.contextOrFrameLookup(b,c,"locality")&&d.contextOrFrameLookup(b,c,"region")){h+="\n                ";var i=d.makeMacro([],[],function(e){c=c.push(),e=e||{};var h,i="";return h={category:d.contextOrFrameLookup(b,c,"category"),locality:d.contextOrFrameLookup(b,c,"locality"),region:d.contextOrFrameLookup(b,c,"region")},c.set("__dict",h),c.parent||b.setVariable("__dict",h),i+=d.suppressValue((f=11,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"_interpolate"),"_interpolate",[(f=11,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["{{ category }} in {{ locality }}, {{ region }}"])),h])),a.autoesc),c=c.pop(),new d.SafeString(i)});b.setVariable("_doTranslation",i),h+=d.suppressValue((f=11,g=17,d.callWrap(i,"_doTranslation",[])),a.autoesc),h+="\n            "}else if(d.contextOrFrameLookup(b,c,"locality")||d.contextOrFrameLookup(b,c,"region")){h+="\n                ";var j;j=d.contextOrFrameLookup(b,c,"locality")||d.contextOrFrameLookup(b,c,"region"),c.set("display_location",j),c.parent||(b.setVariable("display_location",j),b.addExport("display_location")),h+="\n                ";var k=d.makeMacro([],[],function(e){c=c.push(),e=e||{};var h,i="";return h={category:d.contextOrFrameLookup(b,c,"category"),display_location:j},c.set("__dict",h),c.parent||b.setVariable("__dict",h),i+=d.suppressValue((f=14,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"_interpolate"),"_interpolate",[(f=14,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["{{ category }} in {{ display_location }}"])),h])),a.autoesc),c=c.pop(),new d.SafeString(i)});b.setVariable("_doTranslation",k),h+=d.suppressValue((f=14,g=17,d.callWrap(k,"_doTranslation",[])),a.autoesc),h+="\n            "}else h+="\n                ",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"category"),a.autoesc),h+="\n            ";h+="\n        </p>\n        <div class='descriptionContainer'>\n            <textarea name=\"description\" class='description' placeholder='";var l=d.makeMacro([],[],function(e){c=c.push(),e=e||{};var h,i="";return h={placeName:d.contextOrFrameLookup(b,c,"placeName")},c.set("__dict",h),c.parent||b.setVariable("__dict",h),i+=d.suppressValue((f=20,g=75,d.callWrap(d.contextOrFrameLookup(b,c,"_interpolate"),"_interpolate",[(f=20,g=75,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Why do you like {{ placeName }}"])),h])),a.autoesc),c=c.pop(),new d.SafeString(i)});b.setVariable("_doTranslation",l),h+=d.suppressValue((f=20,g=75,d.callWrap(l,"_doTranslation",[])),a.autoesc),h+="?'></textarea>\n        </div>\n    </form>\n</div>\n",e(null,h)}catch(m){e(d.handleError(m,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/AddPinToMap/uploadedImage.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+='<div class="imageWrapper selected">\n    <img class="uploadedImage" src="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"image_url"),a.autoesc),h+='">\n    <div class="hoverSelectedStateIconWrapper">\n    <em class="icon"></em>\n    </div>\n</div>\n',e(null,h)}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/BoardPicker/BoardPicker.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+=d.suppressValue((f=0,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["BoardPickerBase"])),a.autoesc),a.getTemplate("app/common/modules/BoardPickerBase/BoardPickerBase.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/BoardPicker2/BoardPicker2.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{a.getTemplate("templates/macros/boardpicker.nunjucks",function(i,j){return i?void e(i):void j.getExported(function(i,j){if(i)return void e(i);if(!j.hasOwnProperty("icon_wrapper"))return void e(new Error("cannot import 'icon_wrapper'"));var k=j.icon_wrapper;b.setVariable("icon_wrapper",k),h+="\n",a.getTemplate("templates/macros/image.nunjucks",function(i,j){return i?void e(i):void j.getExported(function(i,j){if(i)return void e(i);if(!j.hasOwnProperty("image_tag"))return void e(new Error("cannot import 'image_tag'"));var l=j.image_tag;b.setVariable("image_tag",l),h+="\n\n";var m;f=3,g=43,m=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["has_social_share_options",!0]),c.set("has_social_share_options",m),c.parent||(b.setVariable("has_social_share_options",m),b.addExport("has_social_share_options")),h+="\n";var n;f=4,g=34,n=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["pinned_to_board",{}]),c.set("pinned_to_board",n),c.parent||(b.setVariable("pinned_to_board",n),b.addExport("pinned_to_board")),h+="\n";var o;f=5,g=34,o=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["autofocus_board",!0]),c.set("autofocus_board",o),c.parent||(b.setVariable("autofocus_board",o),b.addExport("autofocus_board")),h+="\n";var p;p="places",c.set("LAYOUT_PLACES",p),c.parent||(b.setVariable("LAYOUT_PLACES",p),b.addExport("LAYOUT_PLACES")),h+="\n\n",m||(h+="\n    ",h+=d.suppressValue((f=9,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["noSocialShareOptions"])),a.autoesc),h+="\n"),h+="\n\n";var q=d.makeMacro(["board"],[],function(e,h){c=c.push(),h=h||{},c.set("board",e);var i="";i+="\n    <li>\n        ";var j;f=14,g=33,j=d.callWrap(d.memberLookup(e,"get",a.autoesc),'board["get"]',["id"]),c.set("board_id",j),c.parent||(b.setVariable("board_id",j),b.addExport("board_id")),i+="\n        ";var m;f=15,g=31,m=d.callWrap(d.memberLookup(e,"get",a.autoesc),'board["get"]',["recommendation_reason"]),c.set("reason",m),c.parent||(b.setVariable("reason",m),b.addExport("reason")),i+="\n        ";var n;n=m,c.set("subtext",n),c.parent||(b.setVariable("subtext",n),b.addExport("subtext")),i+="\n        ";var o;o="boardListItem",c.set("board_list_item_class",o),c.parent||(b.setVariable("board_list_item_class",o),b.addExport("board_list_item_class")),i+="\n        ",j||(i+="\n            ",o+=" createBoard hidden",c.set("board_list_item_class",o),c.parent||(b.setVariable("board_list_item_class",o),b.addExport("board_list_item_class")),i+="\n            ",f=20,g=28,n=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Create a new board"]),c.set("subtext",n),c.parent||(b.setVariable("subtext",n),b.addExport("subtext")),i+="\n        "),i+='\n        <div class="',i+=d.suppressValue(o,a.autoesc),i+='" data-id="',i+=d.suppressValue(j,a.autoesc),i+='">\n            ',j?(i+='\n                <div class="boardImgContainer">\n                    ',i+=d.suppressValue((f=27,g=30,d.callWrap(l,"image_tag",[d.makeKeywordArgs({src:(f=28,g=37,d.callWrap(d.memberLookup(e,"get",a.autoesc),'board["get"]',["image_cover_url"])),class_name:"boardImg"})])),a.autoesc),i+="\n                </div>\n            "):i+='\n                <span class="createBoardIcon"></span>\n            ',i+="\n            ";var q;q="boardNameWrapper",c.set("board_name_wrapper_class",q),c.parent||(b.setVariable("board_name_wrapper_class",q),b.addExport("board_name_wrapper_class")),i+="\n            ",n&&(i+="\n                ",q+=" withSubtext",c.set("board_name_wrapper_class",q),c.parent||(b.setVariable("board_name_wrapper_class",q),b.addExport("board_name_wrapper_class")),i+="\n            "),i+='\n            <span class="',i+=d.suppressValue(q,a.autoesc),i+='">\n                <span class="boardName">\n                    ',i+=d.suppressValue((f=38,g=30,d.callWrap(d.memberLookup(e,"get",a.autoesc),'board["get"]',["name"])),a.autoesc),i+="\n                </span>\n                ",n&&(i+='\n                    <span class="boardSubtext">',i+=d.suppressValue(n,a.autoesc),i+="</span>\n                "),i+="\n            </span>\n            ";var r;r="secret"==d.memberLookup(e,"privacy",a.autoesc),c.set("is_secret",r),c.parent||(b.setVariable("is_secret",r),b.addExport("is_secret")),i+="\n            ";var s;f=45,g=45,s=d.callWrap(d.memberLookup(e,"get",a.autoesc),'board["get"]',["is_collaborative"]),c.set("is_collaborative",s),c.parent||(b.setVariable("is_collaborative",s),b.addExport("is_collaborative")),i+="\n            ";var t;return f=46,g=37,t=d.callWrap(d.memberLookup(e,"get",a.autoesc),'board["get"]',["layout"])==p,c.set("is_place",t),c.parent||(b.setVariable("is_place",t),b.addExport("is_place")),i+="\n            ",j&&(i+="\n                ",i+=d.suppressValue((f=48,g=29,d.callWrap(k,"icon_wrapper",[r,s,t,!1])),a.autoesc),i+="\n            "),i+='\n\n            <div class="buttonWrapper">\n                ',i+=d.suppressValue((f=52,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({options:{class_name:"repinSmall pinIt",type:"submit",show_text:!1,text:(f=57,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pin it"])),has_icon:!0,color:"primary"}})])),a.autoesc),i+="\n            </div>\n        </div>\n    </li>\n",c=c.pop(),new d.SafeString(i)});b.addExport("board_list_item"),b.setVariable("board_list_item",q),h+="\n\n";var r;f=65,g=32,r=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"get",a.autoesc),'data["get"]',["boards_shortlist",[]]),c.set("boards_shortlist",r),c.parent||(b.setVariable("boards_shortlist",r),b.addExport("boards_shortlist")),h+="\n",h+="\n";var s;f=67,g=26,s=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"get",a.autoesc),'data["get"]',["all_boards",[]]),c.set("all_boards",s),c.parent||(b.setVariable("all_boards",s),b.addExport("all_boards")),h+="\n",n&&(h+="\n    ",h+=d.suppressValue((f=69,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["PinDupWarning",d.makeKeywordArgs({data:{pinned_to_board:n}})])),a.autoesc),h+="\n"),h+='\n<div class="boardPickerTypeaheadSelector">\n    <span class="enterInstructions hidden">\n        ',h+=d.suppressValue((f=74,g=10,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Hit 'Enter' to pin"])),a.autoesc),h+="\n    </span>\n    ";var t;if(f=76,g=24,t=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Type a board name"]),c.set("placeholder",t),c.parent||(b.setVariable("placeholder",t),b.addExport("placeholder")),h+='\n    <input type="text"\n        name="boardName"\n        class="boardSelectorInput"\n        placeholder="',h+=d.suppressValue(t,a.autoesc),h+='"\n        ',h+='\n        autocomplete="off"\n        ',o&&(h+='\n            autofocus="autofocus"\n        '),h+="/>\n</div>\n",h+='\n<div class="boardPickerListItems',n&&(h+=" hasPinDupWarning"),h+='" tabindex="0">\n    ',a.getFilter("length").call(b,r)>0){h+='\n        <ul class="boardsShortlist">\n            ',c=c.push();var u=r;if(u)for(var v=0;v<u.length;v++){var w=u[v];c.set("board",w),h+="\n                ",h+=d.suppressValue((f=94,g=32,d.callWrap(q,"board_list_item",[w])),a.autoesc),h+="\n            "}c=c.pop(),h+="\n        </ul>\n    "}h+="\n\n    ",a.getFilter("length").call(b,s)>0&&(h+='\n        <h2 class="allBoardsHeader">',h+=d.suppressValue((f=100,g=38,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["All boards"])),a.autoesc),h+="</h2>\n    "),h+='\n    <ul class="allBoardsList">\n        ',c=c.push();var x=s;if(x)for(var y=0;y<x.length;y++){var z=x[y];c.set("board",z),h+="\n            ",h+=d.suppressValue((f=104,g=28,d.callWrap(q,"board_list_item",[z])),a.autoesc),h+="\n        "}c=c.pop(),h+="\n\n        ",h+=d.suppressValue((f=107,g=24,d.callWrap(q,"board_list_item",[{}])),a.autoesc),h+="\n\n    </ul>\n</div>\n",e(null,h)})})})})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/Button/Button.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+=d.suppressValue((f=0,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["ButtonBase"])),a.autoesc),a.getTemplate("app/common/modules/ButtonBase/ButtonBase.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/FacebookShareButton/FacebookShareButton.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n",h+=d.suppressValue((f=8,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"describe"),"describe",[{text:(f=9,g=23,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["text",(f=9,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Facebook"]))])),has_icon:!0,class_name:(f=11,g=29,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["class_name","facebook"]))}])),a.autoesc),h+=d.suppressValue((f=8,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["Button"])),a.autoesc),a.getTemplate("app/desktop/modules/Button/Button.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/IncrementingNavigateButton/IncrementingNavigateButton.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n\n";var i;i=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"actionCount",a.autoesc),0),c.set("actionCount",i),c.parent||(b.setVariable("actionCount",i),b.addExport("actionCount")),h+="\n",i||(h+="\n    ",h+=d.suppressValue((f=14,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["hidden"])),a.autoesc),h+="\n"),h+="\n\n",h+=d.suppressValue((f=17,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"extra_data"),"extra_data",[{actionCount:i}])),a.autoesc),h+="\n\n",h+=d.suppressValue((f=20,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["NavigateButton"])),a.autoesc),a.getTemplate("app/desktop/modules/NavigateButton/NavigateButton.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(j){e(d.handleError(j,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/NavigateButton/NavigateButton.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"force_refresh",a.autoesc)&&(h+="\n    ",h+=d.suppressValue((f=1,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[{"data-force-refresh":1}])),a.autoesc)),d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"nofollow",a.autoesc)&&(h+="\n    ",h+=d.suppressValue((f=4,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({rel:"nofollow"})])),a.autoesc)),h+="\n\n",h+=d.suppressValue((f=7,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["Button"])),a.autoesc),a.getTemplate("app/desktop/modules/Button/Button.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/PinActionBar/PinActionBar.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i;i=d.contextOrFrameLookup(b,c,"data"),c.set("pin",i),c.parent||(b.setVariable("pin",i),b.addExport("pin")),h+="\n";var j;j=d.memberLookup(i,"id",a.autoesc),c.set("pin_id",j),c.parent||(b.setVariable("pin_id",j),b.addExport("pin_id")),h+="\n";var k;k=d.memberLookup(i,"link",a.autoesc),c.set("link",k),c.parent||(b.setVariable("link",k),b.addExport("link")),h+="\n";var l;l=a.getFilter("default").call(b,d.memberLookup(i,"images",a.autoesc),{}),c.set("images",l),c.parent||(b.setVariable("images",l),b.addExport("images")),h+="\n";var m;m=a.getFilter("default").call(b,d.memberLookup(l,"236x",a.autoesc),{}),c.set("grid_pin_image",m),c.parent||(b.setVariable("grid_pin_image",m),b.addExport("grid_pin_image")),h+="\n";var n;n=!1,c.set("has_fullsize_image",n),c.parent||(b.setVariable("has_fullsize_image",n),b.addExport("has_fullsize_image")),h+="\n";var o;o=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"view_type",a.autoesc),c.set("view_type",o),c.parent||(b.setVariable("view_type",o),b.addExport("view_type")),h+="\n\n";var p;f=8,g=64,p=d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"experiences",a.autoesc),"is_placed_experience",a.autoesc),'context["experience"]["is_placed_"]',["WEB_PIN_CLOSEUP","WEB_PIN_CLOSEUP_LITE"]),c.set("first_pin_create",p),c.parent||(b.setVariable("first_pin_create",p),b.addExport("first_pin_create")),h+="\n";var q;f=9,g=67,q=d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"experiences",a.autoesc),"is_placed_experience",a.autoesc),'context["experience"]["is_placed_"]',["WEB_PIN_CLOSEUP","WEB_PIN_CLOSEUP_AUTOBAHN"]),c.set("autobahn_pin_create",q),c.parent||(b.setVariable("autobahn_pin_create",q),b.addExport("autobahn_pin_create")),h+="\n";var r;f=10,g=70,r=d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"experiences",a.autoesc),"is_placed_experience",a.autoesc),'context["experience"]["is_placed_"]',["WEB_PIN_SUCCESS","WEB_FIRST_PIN_SUCCESS"]),c.set("show_first_pin_success",r),c.parent||(b.setVariable("show_first_pin_success",r),b.addExport("show_first_pin_success")),h+="\n";
var s;s=!1,c.set("show_pin_tip",s),c.parent||(b.setVariable("show_pin_tip",s),b.addExport("show_pin_tip")),h+="\n";var t;t=p||q,c.set("pin_lite",t),c.parent||(b.setVariable("pin_lite",t),b.addExport("pin_lite")),h+="\n",t&&(h+="\n    ",(r||p)&&(h+="\n        ",s=!0,c.set("show_pin_tip",s),c.parent||(b.setVariable("show_pin_tip",s),b.addExport("show_pin_tip")),h+="\n    "),h+="\n    ",h+=d.suppressValue((f=17,g=15,d.callWrap(d.contextOrFrameLookup(b,c,"extra_data"),"extra_data",[{lite:!0,showPinTip:s}])),a.autoesc),h+="\n    ",h+=d.suppressValue((f=18,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["lite"])),a.autoesc),h+="\n"),h+="\n\n",k||(h+="\n    ",d.memberLookup(i,"images",a.autoesc)&&d.memberLookup(d.memberLookup(i,"images",a.autoesc),"orig",a.autoesc)&&(h+="\n        ",k=d.memberLookup(d.memberLookup(d.memberLookup(i,"images",a.autoesc),"orig",a.autoesc),"url",a.autoesc),c.set("link",k),c.parent||(b.setVariable("link",k),b.addExport("link")),h+="\n    "),h+="\n    ",k&&(h+="\n        ",n=!0,c.set("has_fullsize_image",n),c.parent||(b.setVariable("has_fullsize_image",n),b.addExport("has_fullsize_image")),h+="\n    "),h+="\n"),h+="\n";var u;u=d.memberLookup(i,"repin_count",a.autoesc),c.set("repin_count",u),c.parent||(b.setVariable("repin_count",u),b.addExport("repin_count")),h+="\n";var v;v=d.memberLookup(i,"like_count",a.autoesc),c.set("like_count",v),c.parent||(b.setVariable("like_count",v),b.addExport("like_count")),h+="\n\n";var w;if(f=32,g=62,w=d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"experiments",a.autoesc),"in_experiment_groups",a.autoesc),'context["experiment"]["in_experim"]',["denzel_new_repin_flow2",["enabled","repin_only"]]),c.set("new_repin_flow",w),c.parent||(b.setVariable("new_repin_flow",w),b.addExport("new_repin_flow")),h+="\n",w){h+="\n    ";var x;x="PinCreate2",c.set("submodule_name",x),c.parent||(b.setVariable("submodule_name",x),b.addExport("submodule_name")),h+="\n    ";var y;y="repin2",c.set("submodule_field_set_key",y),c.parent||(b.setVariable("submodule_field_set_key",y),b.addExport("submodule_field_set_key")),h+="\n    ";var z;z=!0,c.set("transparent_modal",z),c.parent||(b.setVariable("transparent_modal",z),b.addExport("transparent_modal")),h+="\n    ";var A;A={container_class:"pinCreate2Modal"},c.set("extra_options",A),c.parent||(b.setVariable("extra_options",A),b.addExport("extra_options")),h+="\n"}else h+="\n    ",x="PinCreate",c.set("submodule_name",x),c.parent||(b.setVariable("submodule_name",x),b.addExport("submodule_name")),h+="\n    ",y="repin",c.set("submodule_field_set_key",y),c.parent||(b.setVariable("submodule_field_set_key",y),b.addExport("submodule_field_set_key")),h+="\n    ",z=!1,c.set("transparent_modal",z),c.parent||(b.setVariable("transparent_modal",z),b.addExport("transparent_modal")),h+="\n    ",A={},c.set("extra_options",A),c.parent||(b.setVariable("extra_options",A),b.addExport("extra_options")),h+="\n";h+='\n\n<div class="repinLike">\n    ';var B;B=" pinActionBarButton",c.set("pin_action_bar_button_classname",B),c.parent||(b.setVariable("pin_action_bar_button_classname",B),b.addExport("pin_action_bar_button_classname")),h+="\n    ";var C;C="medium",c.set("action_bar_button_size",C),c.parent||(b.setVariable("action_bar_button_size",C),b.addExport("action_bar_button_size")),h+="\n    ";var D;D="repinLikeNavigateButton ",c.set("baseIncrementButtonClass",D),c.parent||(b.setVariable("baseIncrementButtonClass",D),b.addExport("baseIncrementButtonClass")),h+="\n    ";var E;E=D,c.set("repinIncrementButtonClass",E),c.parent||(b.setVariable("repinIncrementButtonClass",E),b.addExport("repinIncrementButtonClass")),h+="\n    ";var F;F=D,c.set("likeIncrementButtonClass",F),c.parent||(b.setVariable("likeIncrementButtonClass",F),b.addExport("likeIncrementButtonClass")),h+="\n\n    ";var G;G="repin",c.set("repin_class_name",G),c.parent||(b.setVariable("repin_class_name",G),b.addExport("repin_class_name")),h+="\n    ",u&&!t&&(h+="\n        ",G+=" leftRounded",c.set("repin_class_name",G),c.parent||(b.setVariable("repin_class_name",G),b.addExport("repin_class_name")),h+="\n    "),h+="\n\n    ";var H;H="primary",c.set("repin_color",H),c.parent||(b.setVariable("repin_color",H),b.addExport("repin_color")),h+="\n    ";var I;I=!0,c.set("repin_primary_on_hover",I),c.parent||(b.setVariable("repin_primary_on_hover",I),b.addExport("repin_primary_on_hover")),h+="\n    ";var J;J=!1,c.set("repin_show_text",J),c.parent||(b.setVariable("repin_show_text",J),b.addExport("repin_show_text")),h+="\n    ";var K;if(f=61,g=23,K=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pin it"]),c.set("repin_text",K),c.parent||(b.setVariable("repin_text",K),b.addExport("repin_text")),h+="\n    ",d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc)&&"ja"==d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"locale",a.autoesc)&&(h+="\n        ",J=!0,c.set("repin_show_text",J),c.parent||(b.setVariable("repin_show_text",J),b.addExport("repin_show_text")),h+="\n    "),h+="\n\n    ",E+=G,c.set("repinIncrementButtonClass",E),c.parent||(b.setVariable("repinIncrementButtonClass",E),b.addExport("repinIncrementButtonClass")),h+="\n    ",h+="\n\n    ",h+=d.suppressValue((f=69,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ShowModalButton",d.makeKeywordArgs({id:"pinItButton",options:{ga_category:"repin_create_closeup",class_name:G+B,color:H,primary_on_hover:I,has_icon:!0,show_text:J,text:K,require_auth:!0,require_auth_params:{action:"pinit"},size:C,log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"PIN_REPIN_BUTTON",a.autoesc),extra_options:A,submodule:{name:x,resource:{name:"PinResource",options:{id:j,field_set_key:y}},options:{action:"repin",is_video:d.memberLookup(i,"is_video",a.autoesc),transparent_modal:z},error_strategy:d.memberLookup(d.contextOrFrameLookup(b,c,"ErrorStrategy"),"SHOW",a.autoesc)}}})])),a.autoesc),h+="\n\n    ",h+=d.suppressValue((f=104,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["IncrementingNavigateButton",d.makeKeywordArgs({id:"repinsButton",options:{url:"/pin/"+j+"/repins/",color:H,actionCount:u,class_name:"repinLikeNavigateButton"+B,siblingButtonId:"pinItButton",size:"medium",text:u,log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"REPINS_BUTTON",a.autoesc)}})])),a.autoesc),h+="\n\n    ",v){h+="\n        ";var L;L="like leftRounded",c.set("like_class_name",L),c.parent||(b.setVariable("like_class_name",L),b.addExport("like_class_name")),h+="\n    "}else h+="\n        ",L="like",c.set("like_class_name",L),c.parent||(b.setVariable("like_class_name",L),b.addExport("like_class_name")),h+="\n    ";h+="\n    ",F+=L,c.set("likeIncrementButtonClass",F),c.parent||(b.setVariable("likeIncrementButtonClass",F),b.addExport("likeIncrementButtonClass")),h+="\n    ",h+="\n    ";var M;if(M=d.memberLookup(i,"liked_by_me",a.autoesc),c.set("liked",M),c.parent||(b.setVariable("liked",M),b.addExport("liked")),h+="\n    ",h+=d.suppressValue((f=127,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["PinLikeButton",d.makeKeywordArgs({id:"likeButton",options:{class_name:L+B,liked:M,size:C,has_icon:!M,pin_id:j}})])),a.autoesc),h+="\n    ",h+=d.suppressValue((f=138,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["IncrementingNavigateButton",d.makeKeywordArgs({id:"likesButton",options:{siblingButtonId:"likeButton",actionCount:v,url:"/pin/"+j+"/likes/",class_name:F+B,text:v,size:"medium",log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"LIKES_BUTTON",a.autoesc)}})])),a.autoesc),h+="\n\n    ",k&&(h+="\n        ",h+=d.suppressValue((f=153,g=15,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["NavigateButton",d.makeKeywordArgs({id:"viewPinSource",options:{class_name:"website"+B,element_type:"a",has_icon:!0,size:C,text:n?(f=161,g=25,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Image"])):(f=161,g=63,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Visit Site"])),safe_link:!0,safe_link_pin_id:j,url:k,log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"WEBSITE_BUTTON",a.autoesc),nofollow:!0}})])),a.autoesc),h+="\n    "),h+='\n</div>\n\n<div class="shareGear">\n    ',"secret"!=d.memberLookup(i,"privacy",a.autoesc)){if(h+="\n        ",d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc)&&(h+="\n            ",h+=d.suppressValue((f=174,g=19,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["DropdownButton",d.makeKeywordArgs({data:d.contextOrFrameLookup(b,c,"data"),options:{button_options:{size:C,class_name:"send"+B,has_icon:!0,text:(f=182,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Send"])),log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"PIN_SEND_BUTTON",a.autoesc)},dropdown_options:{largeCaret:!0,manually_close:!0,fixed:!1,position_point:"BOTTOM_RIGHT",view_type:"closeupShare",display_while_loading:!0},module:{name:"SendPin",options:{object_id:j,object_image_url:d.memberLookup(m,"url",a.autoesc),object_description:d.memberLookup(i,"description",a.autoesc),object_url:"/pin/"+j+"/"},resource:{name:"RecentContactsResource",options:{field_set_key:"default"}}}}})])),a.autoesc),h+="\n        "),h+="\n\n        ",f=212,g=52,d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"experiments",a.autoesc),"in_experiment_groups",a.autoesc),'context["experiment"]["in_experim"]',["denzel_pin_closeup_fb_sharing",["enabled","employees"]])){h+="\n            ";var N;N="/pin/"+j+"/",c.set("pin_url",N),c.parent||(b.setVariable("pin_url",N),b.addExport("pin_url")),h+="\n            ";var O;f=214,g=70,O=d.callWrap(d.memberLookup((f=214,g=54,d.callWrap(d.memberLookup((f=214,g=36,d.callWrap(d.memberLookup(i,"get",a.autoesc),'pin["get"]',["images",{}])),"get",a.autoesc),'the return value of (pin["get"])["get"]',["236x",{}])),"get",a.autoesc),'the return value of (the return value of (pin["get"])["get"])["get"]',["url"]),c.set("pin_image",O),c.parent||(b.setVariable("pin_image",O),b.addExport("pin_image")),h+="\n            ";var P;f=215,g=42,P=d.callWrap(d.memberLookup(i,"get",a.autoesc),'pin["get"]',["description"]),c.set("pin_description",P),c.parent||(b.setVariable("pin_description",P),b.addExport("pin_description")),h+="\n\n            ",h+="\n            ",h+="\n            ",h+=d.suppressValue((f=219,g=19,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["FacebookShareButton",d.makeKeywordArgs({options:{object_id:j,text:(f=223,g=29,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Share"])),dialog_options:{object_type:"pin",object_id:j,description:d.memberLookup(i,"description",a.autoesc),path:N,name:(f=229,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pinterest"])+""),picture:O},ga_category:"pin_share_facebook",class_name:"facebookShare"+B,size:"medium"}})])),a.autoesc),h+="\n        "}else h+="\n            ",h+=d.suppressValue((f=238,g=19,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["DropdownButton",d.makeKeywordArgs({options:{button_options:{size:C,class_name:"share"+B,has_icon:!0,show_text:!1,text:(f=246,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Share"])),log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"PIN_SHARE_BUTTON",a.autoesc)},dropdown_options:{largeCaret:!0,fixed:!1,position_point:"BOTTOM_RIGHT",view_type:"closeupShare"},module:{name:"PinCloseupShare",options:{},resource:{name:"PinResource",options:{id:j,field_set_key:"closeup_share"}}}}})])),a.autoesc),h+="\n        ";h+="\n    "}h+="\n</div>\n",e(null,h)}catch(Q){e(d.handleError(Q,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/PinCreate/PinCreate.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n";var i;i=d.contextOrFrameLookup(b,c,"data")||{},c.set("pin",i),c.parent||(b.setVariable("pin",i),b.addExport("pin")),h+="\n";var j;j=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"action",a.autoesc),c.set("action",j),c.parent||(b.setVariable("action",j),b.addExport("action")),h+="\n";var k;k=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"description",a.autoesc),c.set("description",k),c.parent||(b.setVariable("description",k),b.addExport("description")),h+="\n\n","fluid"==d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"view_type",a.autoesc)&&(h+="\n    ",h+=d.suppressValue((f=21,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["fluid","inModal"])),a.autoesc),h+="\n"),h+="\n\n";var l;if(l=!0,c.set("show_cancel_button",l),c.parent||(b.setVariable("show_cancel_button",l),b.addExport("show_cancel_button")),h+="\n","create"==j&&k){h+="\n    ",h+="\n    ";var m;m=500,c.set("MAX_DESCRIPTION_LENGTH",m),c.parent||(b.setVariable("MAX_DESCRIPTION_LENGTH",m),b.addExport("MAX_DESCRIPTION_LENGTH")),h+="\n    ";var n;n=m-3,c.set("TRUNCATE_AT",n),c.parent||(b.setVariable("TRUNCATE_AT",n),b.addExport("TRUNCATE_AT")),h+="\n    ",k=a.getFilter("truncate").call(b,k,n),c.set("description",k),c.parent||(b.setVariable("description",k),b.addExport("description")),h+="\n"}else"pin_create_ignition"==j&&(h+="\n    ",l=!1,c.set("show_cancel_button",l),c.parent||(b.setVariable("show_cancel_button",l),b.addExport("show_cancel_button")),h+="\n");h+="\n\n",h+="\n";var o;o=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"is_video",a.autoesc),c.set("is_video_option",o),c.parent||(b.setVariable("is_video_option",o),b.addExport("is_video_option")),h+="\n";var p;p=d.memberLookup(i,"is_video",a.autoesc)||o&&"false"!=o,c.set("is_video",p),c.parent||(b.setVariable("is_video",p),b.addExport("is_video")),h+="\n\n",h+=d.suppressValue((f=41,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"include_data"),"include_data",["id"])),a.autoesc),h+="\n\n",h+=d.suppressValue((f=43,g=7,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["PinForm",d.makeKeywordArgs({data:i,id:"pinForm",options:{cancel_text:(f=47,g=24,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Close"])),description:a.getFilter("default").call(b,k,""),heading:(f=49,g=20,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pick a board"])),image_url:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"image_url",a.autoesc),""),default_board_id:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"default_board_id",a.autoesc),""),is_video:p,link:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"link",a.autoesc),""),show_uploader:!1,pin_it_script_button:!0,show_cancel_button:l},resource:d.contextOrFrameLookup(b,c,"resource"),error_strategy:d.memberLookup(d.contextOrFrameLookup(b,c,"ErrorStrategy"),"BUBBLE",a.autoesc)})])),a.autoesc),h+="\n",e(null,h)}catch(q){e(d.handleError(q,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/PinCreate2/PinCreate2.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{a.getTemplate("templates/macros/image.nunjucks",function(i,j){return i?void e(i):void j.getExported(function(i,j){if(i)return void e(i);if(!j.hasOwnProperty("image_tag"))return void e(new Error("cannot import 'image_tag'"));var k=j.image_tag;b.setVariable("image_tag",k),h+="\n\n";var l;if(l=d.contextOrFrameLookup(b,c,"data")||{},c.set("pin",l),c.parent||(b.setVariable("pin",l),b.addExport("pin")),h+="\n\n",l){h+="\n    ";var m;m=!0,c.set("autofocus_board",m),c.parent||(b.setVariable("autofocus_board",m),b.addExport("autofocus_board")),h+="\n    ";var n;n=!1,c.set("autofocus_description",n),c.parent||(b.setVariable("autofocus_description",n),b.addExport("autofocus_description")),h+="\n"}else h+="\n    ",m=!1,c.set("autofocus_board",m),c.parent||(b.setVariable("autofocus_board",m),b.addExport("autofocus_board")),h+="\n    ",n=!0,c.set("autofocus_description",n),c.parent||(b.setVariable("autofocus_description",n),b.addExport("autofocus_description")),h+="\n";h+="\n\n";var o;f=12,g=26,o=d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["description"])||(f=13,g=15,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["description",""])),c.set("description",o),c.parent||(b.setVariable("description",o),b.addExport("description")),h+="\n";var p;f=14,g=19,p=d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["link"])||(f=15,g=15,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["link",""])),c.set("link",p),c.parent||(b.setVariable("link",p),b.addExport("link")),h+="\n";var q;f=16,g=34,q=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["is_video"]),c.set("is_video_option",q),c.parent||(b.setVariable("is_video_option",q),b.addExport("is_video_option")),h+="\n";var r;f=17,g=23,r=d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["is_video"])||q&&"false"!=q,c.set("is_video",r),c.parent||(b.setVariable("is_video",r),b.addExport("is_video")),h+="\n";var s;f=19,g=58,s=d.callWrap(d.memberLookup((f=19,g=42,d.callWrap(d.memberLookup((f=19,g=24,d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["images",{}])),"get",a.autoesc),'the return value of (pin["get"])["get"]',["236x",{}])),"get",a.autoesc),'the return value of (the return value of (pin["get"])["get"])["get"]',["url"])||(f=20,g=15,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["image_url"])),c.set("image_url",s),c.parent||(b.setVariable("image_url",s),b.addExport("image_url")),h+="\n";var t;f=21,g=30,t=d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["pinned_to_board",{}]),c.set("pinned_to_board",t),c.parent||(b.setVariable("pinned_to_board",t),b.addExport("pinned_to_board")),h+="\n\n",h+="\n";var u;f=24,g=35,u=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["show_suggestions",!1]),c.set("show_suggestions",u),c.parent||(b.setVariable("show_suggestions",u),b.addExport("show_suggestions")),h+="\n";var v;v=l?(f=25,g=37,d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["id"])):d.contextOrFrameLookup(b,c,"none"),c.set("pin_id_for_suggestions",v),c.parent||(b.setVariable("pin_id_for_suggestions",v),b.addExport("pin_id_for_suggestions")),h+="\n",u||(h+="\n    ",v=d.contextOrFrameLookup(b,c,"none"),c.set("pin_id_for_suggestions",v),c.parent||(b.setVariable("pin_id_for_suggestions",v),b.addExport("pin_id_for_suggestions")),h+="\n"),h+="\n\n",h+=d.suppressValue((f=30,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"include_data"),"include_data",["id"])),a.autoesc),h+="\n",h+=d.suppressValue((f=31,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"extra_data"),"extra_data",[{link:p,isVideo:r,imageUrl:s}])),a.autoesc),h+="\n\n","fluid"==(f=36,g=15,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["view_type"]))&&(h+="\n    ",h+=d.suppressValue((f=37,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["fluid","inModal"])),a.autoesc),h+="\n"),h+="\n\n";var w;w=85,c.set("image_width",w),c.parent||(b.setVariable("image_width",w),b.addExport("image_width")),h+="\n";var x;x=85,c.set("image_height",x),c.parent||(b.setVariable("image_height",x),b.addExport("image_height")),h+="\n";var y;f=42,g=63,y=d.callWrap(d.memberLookup((f=42,g=47,d.callWrap(d.memberLookup((f=42,g=29,d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["images",{}])),"get",a.autoesc),'the return value of (pin["get"])["get"]',["236x",{}])),"get",a.autoesc),'the return value of (the return value of (pin["get"])["get"])["get"]',["width"]),c.set("original_width",y),c.parent||(b.setVariable("original_width",y),b.addExport("original_width")),h+="\n";var z;f=43,g=64,z=d.callWrap(d.memberLookup((f=43,g=48,d.callWrap(d.memberLookup((f=43,g=30,d.callWrap(d.memberLookup(l,"get",a.autoesc),'pin["get"]',["images",{}])),"get",a.autoesc),'the return value of (pin["get"])["get"]',["236x",{}])),"get",a.autoesc),'the return value of (the return value of (pin["get"])["get"])["get"]',["height"]),c.set("original_height",z),c.parent||(b.setVariable("original_height",z),b.addExport("original_height")),h+="\n",y&&z&&(h+="\n    ",y>z?(h+="\n        ",x=z*w/y,c.set("image_height",x),c.parent||(b.setVariable("image_height",x),b.addExport("image_height")),h+="\n    "):(h+="\n        ",w=y*x/z,c.set("image_width",w),c.parent||(b.setVariable("image_width",w),b.addExport("image_width")),h+="\n    "),h+="\n"),h+="\n\n";var A;if(A=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_url",a.autoesc)||d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"twitter_url",a.autoesc),c.set("has_social_share_options",A),c.parent||(b.setVariable("has_social_share_options",A),b.addExport("has_social_share_options")),h+='\n\n<form>\n    <h1 class="title">',h+=d.suppressValue((f=55,g=24,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pick a board"])),a.autoesc),h+='</h1>\n    <div class="pinPreview">\n        <div class="pinPreviewImg">\n            ',h+=d.suppressValue((f=58,g=22,d.callWrap(k,"image_tag",[d.makeKeywordArgs({src:s,height:x,width:w})])),a.autoesc),h+='\n        </div>\n        <div class="pinDescShare">\n            <div class="pinDescription">\n                ',h+=d.suppressValue((f=62,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.TextField",d.makeKeywordArgs({id:"pinDescriptionField",options:{id:"pinDescriptionField",name:"description",value:o,placeholder:(f=68,g=40,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Add a short description to your pin"])),autofocus:n,mentions:!0}})])),a.autoesc),h+="\n            </div>\n            ",A){if(h+='\n                <div class="socialShareOptions">\n                    ',d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_url",a.autoesc)&&d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"twitter_url",a.autoesc)){h+='\n                        <span class="shareText">',h+=d.suppressValue((f=77,g=50,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Share: "])),a.autoesc),h+="</span>\n                        ";var B;B="Facebook",c.set("facebook_label",B),c.parent||(b.setVariable("facebook_label",B),b.addExport("facebook_label")),h+="\n                        ";var C;C="Twitter",c.set("twitter_label",C),c.parent||(b.setVariable("twitter_label",C),b.addExport("twitter_label")),h+="\n                    "}else d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_url",a.autoesc)?(h+="\n                        ",f=81,g=47,B=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Share on Facebook"]),c.set("facebook_label",B),c.parent||(b.setVariable("facebook_label",B),b.addExport("facebook_label")),h+="\n                    "):d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"twitter_url",a.autoesc)&&(h+="\n                        ",f=83,g=46,C=d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Share on Twitter"]),c.set("twitter_label",C),c.parent||(b.setVariable("twitter_label",C),b.addExport("twitter_label")),h+="\n                    ");if(h+="\n                    ",d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_url",a.autoesc)){h+="\n                        ";var D;D=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_publish_stream_enabled",a.autoesc),c.set("facebook_stream_enabled",D),c.parent||(b.setVariable("facebook_stream_enabled",D),b.addExport("facebook_stream_enabled")),h+='\n                        <label class="facebookInput">\n                            ',h+=d.suppressValue((f=88,g=35,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.Checkbox",d.makeKeywordArgs({options:{name:"share_facebook",checked:D,view_type:"fancyCheckbox"}})])),a.autoesc),h+="\n                            <span>",h+=d.suppressValue(B,a.autoesc),h+="</span>\n                        </label>\n                    "}if(h+="\n                    ",d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"twitter_url",a.autoesc)){h+="\n                        ";var E;E=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"twitter_publish_enabled",a.autoesc),c.set("twitter_publish_enabled",E),c.parent||(b.setVariable("twitter_publish_enabled",E),b.addExport("twitter_publish_enabled")),h+='\n                        <label class="twitterInput">\n                            ',h+=d.suppressValue((f=98,g=35,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.Checkbox",d.makeKeywordArgs({options:{name:"share_twitter",checked:E,view_type:"fancyCheckbox"}})])),a.autoesc),h+="\n                            <span>",h+=d.suppressValue(C,a.autoesc),h+="</span>\n                        </label>\n                    "}h+="\n                </div>\n            "}h+="\n        </div>\n    </div>\n    ",h+=d.suppressValue((f=109,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["BoardPicker2",d.makeKeywordArgs({id:"boardPicker2",resource:(f=111,g=34,d.callWrap(d.contextOrFrameLookup(b,c,"create_resource"),"create_resource",["BoardPickerBoardsResource",d.makeKeywordArgs({options:{username:d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"username",a.autoesc),filter:(f=114,g=43,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["board_filter","all"])),default_board_id:(f=115,g=53,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["default_board_id"])),field_set_key:"board_picker2",pin_id_for_suggestions:v}})])),options:{has_social_share_options:A,pinned_to_board:t,autofocus_board:m},error_strategy:d.memberLookup(d.contextOrFrameLookup(b,c,"ErrorStrategy"),"BUBBLE",a.autoesc)})])),a.autoesc),h+="\n</form>\n",e(null,h)})})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/PinCreateSuccessBoardEdit/PinCreateSuccessBoardEdit.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+=d.suppressValue((f=0,g=13,d.callWrap(d.contextOrFrameLookup(b,c,"include_data"),"include_data",["id","board","owner","privacy"])),a.autoesc),h+="\n",h+="\n";var i;f=3,g=57,i=d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"experiments",a.autoesc),"activate_experiment",a.autoesc),'context["experiment"]["activate_e"]',["collab_invite_on_board_create"]),c.set("throw_away",i),c.parent||(b.setVariable("throw_away",i),b.addExport("throw_away")),h+='\n\n<div class="standardForm">\n    <h1>';var j=d.makeMacro([],[],function(e){c=c.push(),e=e||{};var h,i="";return h={name:d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"name",a.autoesc)},c.set("__dict",h),c.parent||b.setVariable("__dict",h),i+=d.suppressValue((f=6,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"_interpolate"),"_interpolate",[(f=6,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["<span>You just made a new board:</span> {{ name }}"])),h])),a.autoesc),c=c.pop(),new d.SafeString(i)});b.setVariable("_doTranslation",j),h+=d.suppressValue((f=6,g=9,d.callWrap(j,"_doTranslation",[])),a.autoesc),h+='</h1>\n\n    <ul>\n        <li>\n            <h3><label for="place">',h+=d.suppressValue((f=10,g=37,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Add a map?"])),a.autoesc),h+="</label></h3>\n            <div>\n                ",h+=d.suppressValue((f=12,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.Checkbox",d.makeKeywordArgs({id:"placeLayoutCheckbox",options:{name:"layout",checked:d.contextOrFrameLookup(b,c,"map_view_checked"),disabled:!1,view_type:"fancyToggle"}})])),a.autoesc),h+="\n            </div>\n        </li>\n        <li>\n            <h3>\n                <label>",h+=d.suppressValue((f=25,g=25,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Invite friends to Pin"])),a.autoesc),h+='</label>\n                <a href="',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"settings"),"HELP_BOARD_INVITE_URL",a.autoesc),a.autoesc),h+='" class="learnMore learnAboutBoardInvites">\n                    ',h+=d.suppressValue((f=27,g=22,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Learn more"])),a.autoesc),h+="\n                </a>\n            </h3>\n            <div>\n                ",h+=d.suppressValue((f=31,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["BoardInviteForm",d.makeKeywordArgs({id:"boardInviteForm",options:{board_id:d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"id",a.autoesc),email_supported:!0,fillWidth:!0,pending:d.contextOrFrameLookup(b,c,"invites_will_be_pending")}})])),a.autoesc),h+='\n                <div class="boardInvites">\n                    ',h+=d.suppressValue((f=41,g=27,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["BoardInvites",d.makeKeywordArgs({id:"boardInvites",resource:(f=43,g=48,d.callWrap(d.contextOrFrameLookup(b,c,"create_resource"),"create_resource",["BoardInvitesResource",d.makeKeywordArgs({options:{board_id:d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"id",a.autoesc),sort:"viewer_first",field_set_key:"boardEdit",status_filters:"new,accepted",include_inactive:!0}})])),async:d.contextOrFrameLookup(b,c,"async")})])),a.autoesc),h+='\n                </div>\n            </div>\n        </li>\n    </ul>\n\n    <div class="formFooter">\n        <div class="formFooterButtons">\n            ',h+=d.suppressValue((f=61,g=19,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"doneButton",options:{color:"primary",size:"small",cancelButton:!0,text:(f=67,g=29,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Done"]))}})])),a.autoesc),h+="\n        </div>\n    </div>\n</div>\n",e(null,h)}catch(k){e(d.handleError(k,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/PinDupWarning/PinDupWarning.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{a.getTemplate("templates/macros/link.nunjucks",function(i,j){return i?void e(i):void j.getExported(function(i,j){if(i)return void e(i);if(!j.hasOwnProperty("link_markup"))return void e(new Error("cannot import 'link_markup'"));var k=j.link_markup;b.setVariable("link_markup",k),h+="\n\n";var l;if(l=d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"pinned_to_board",a.autoesc),c.set("board",l),c.parent||(b.setVariable("board",l),b.addExport("board")),h+="\n",l){h+='\n    <div class="pinnedToBoardWarning">\n        <strong>',h+=d.suppressValue((f=5,g=18,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pssst!"])),a.autoesc),h+="</strong>\n        ";var m=d.makeMacro([],[],function(e){c=c.push(),e=e||{};var h,i="";return h={link:(f=6,g=31,d.callWrap(k,"link_markup",[d.memberLookup(l,"url",a.autoesc),d.memberLookup(l,"name",a.autoesc)]))},c.set("__dict",h),c.parent||b.setVariable("__dict",h),i+=d.suppressValue((f=6,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"_interpolate"),"_interpolate",[(f=6,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Looks like this is already on {{ link }}."])),h])),a.autoesc),c=c.pop(),new d.SafeString(i)});b.setVariable("_doTranslation",m),h+=d.suppressValue((f=6,g=9,d.callWrap(m,"_doTranslation",[])),a.autoesc),h+="\n    </div>\n"}h+="\n",e(null,h)})})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/PinForm/PinForm.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n\n";var i;i=d.contextOrFrameLookup(b,c,"data")||{},c.set("pin",i),c.parent||(b.setVariable("pin",i),b.addExport("pin")),h+="\n";
var j;j=d.memberLookup(i,"id",a.autoesc),c.set("pin_id",j),c.parent||(b.setVariable("pin_id",j),b.addExport("pin_id")),h+="\n";var k;if(k=!1,c.set("should_show_place_in_pin_form",k),c.parent||(b.setVariable("should_show_place_in_pin_form",k),b.addExport("should_show_place_in_pin_form")),h+="\n",h+=d.suppressValue((f=27,g=5,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[{"data-component-type":"MODAL_REPIN"}])),a.autoesc),h+="\n",i){h+="\n    ";var l;l=d.memberLookup(i,"description",a.autoesc),c.set("description",l),c.parent||(b.setVariable("description",l),b.addExport("description")),h+="\n    ",h+="\n    ";var m;m=d.memberLookup(i,"images",a.autoesc)&&d.memberLookup(d.memberLookup(i,"images",a.autoesc),"236x",a.autoesc)&&d.memberLookup(d.memberLookup(d.memberLookup(i,"images",a.autoesc),"236x",a.autoesc),"url",a.autoesc),c.set("image_url",m),c.parent||(b.setVariable("image_url",m),b.addExport("image_url")),h+="\n    ";var n;n=d.memberLookup(i,"is_video",a.autoesc),c.set("is_video",n),c.parent||(b.setVariable("is_video",n),b.addExport("is_video")),h+="\n    ";var o;o=d.memberLookup(i,"link",a.autoesc),c.set("link",o),c.parent||(b.setVariable("link",o),b.addExport("link")),h+="\n    ";var p;p=d.memberLookup(i,"place",a.autoesc)||{},c.set("place",p),c.parent||(b.setVariable("place",p),b.addExport("place")),h+=" ",h+="\n    ",f=35,g=81,k=d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"experiments",a.autoesc),"in_experiment_groups",a.autoesc),'context["experiment"]["in_experim"]',["web_place_repin_form",["enabled","enabled2"]]),c.set("should_show_place_in_pin_form",k),c.parent||(b.setVariable("should_show_place_in_pin_form",k),b.addExport("should_show_place_in_pin_form")),h+="\n"}else h+="\n    ",l=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"description",a.autoesc),""),c.set("description",l),c.parent||(b.setVariable("description",l),b.addExport("description")),h+="\n    ",m=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"image_url",a.autoesc),""),c.set("image_url",m),c.parent||(b.setVariable("image_url",m),b.addExport("image_url")),h+="\n    ",n=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"is_video",a.autoesc),!1),c.set("is_video",n),c.parent||(b.setVariable("is_video",n),b.addExport("is_video")),h+="\n    ",o=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"link",a.autoesc),""),c.set("link",o),c.parent||(b.setVariable("link",o),b.addExport("link")),h+="\n    ",p={},c.set("place",p),c.parent||(b.setVariable("place",p),b.addExport("place")),h+="\n";h+="\n\n";var q;q=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_link",a.autoesc),c.set("show_link",q),c.parent||(b.setVariable("show_link",q),b.addExport("show_link")),h+="\n";var r;r=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_place",a.autoesc),k)&&i,c.set("show_place",r),c.parent||(b.setVariable("show_place",r),b.addExport("show_place")),h+="\n";var s;s=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"writable",a.autoesc),!0),c.set("writable",s),c.parent||(b.setVariable("writable",s),b.addExport("writable")),h+="\n";var t;if(t=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_place",a.autoesc)&&i&&s,c.set("can_delete_place",t),c.parent||(b.setVariable("can_delete_place",t),b.addExport("can_delete_place")),h+="\n",d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc)){h+="\n    ";var u;u=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_id",a.autoesc),c.set("facebook_id",u),c.parent||(b.setVariable("facebook_id",u),b.addExport("facebook_id")),h+="\n    ";var v;v=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_url",a.autoesc),c.set("facebook_url",v),c.parent||(b.setVariable("facebook_url",v),b.addExport("facebook_url")),h+="\n    ";var w;w=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_timeline_enabled",a.autoesc),c.set("facebook_timeline_enabled",w),c.parent||(b.setVariable("facebook_timeline_enabled",w),b.addExport("facebook_timeline_enabled")),h+="\n    ";var x;x=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"facebook_publish_stream_enabled",a.autoesc),c.set("facebook_stream_enabled",x),c.parent||(b.setVariable("facebook_stream_enabled",x),b.addExport("facebook_stream_enabled")),h+="\n    ";var y;y=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"twitter_url",a.autoesc),c.set("twitter_url",y),c.parent||(b.setVariable("twitter_url",y),b.addExport("twitter_url")),h+="\n    ";var z;z=d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"twitter_publish_enabled",a.autoesc),c.set("twitter_publish_enabled",z),c.parent||(b.setVariable("twitter_publish_enabled",z),b.addExport("twitter_publish_enabled")),h+="\n    ",h+=d.suppressValue((f=56,g=15,d.callWrap(d.contextOrFrameLookup(b,c,"extra_data"),"extra_data",[{facebookId:u,facebookUrl:v,facebookTimelineEnabled:w,facebookStreamEnabled:x,twitterUrl:y,twitterPublishEnabled:z}])),a.autoesc),h+="\n"}h+='\n\n<form class="standardForm" method="post">\n    <h1 class="pinFormHeader">',h+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"heading",a.autoesc),a.autoesc),h+="</h1>\n\n    ";var A;if(A=d.memberLookup(i,"pinned_to_board",a.autoesc),c.set("pinned_to_board",A),c.parent||(b.setVariable("pinned_to_board",A),b.addExport("pinned_to_board")),h+="\n    ",A&&(h+="\n        ",h+=d.suppressValue((f=70,g=15,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["PinDupWarning",d.makeKeywordArgs({data:{pinned_to_board:A},resource:(f=74,g=36,d.callWrap(d.contextOrFrameLookup(b,c,"create_resource"),"create_resource",["PinResource",d.makeKeywordArgs({options:{id:j,field_set_key:"faster_repin"}})]))})])),a.autoesc),h+="\n    "),h+="\n\n    ",h+=d.suppressValue((f=83,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.PinPreview",d.makeKeywordArgs({id:"pinPreview",options:{image_url:m,is_video:n}})])),a.autoesc),h+="\n\n    <ul>\n        ",d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_pinner",a.autoesc)){h+="\n            <li>\n                <h3><label>",h+=d.suppressValue((f=94,g=29,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pinner"])),a.autoesc),h+="</label></h3>\n                <div>\n                    ";var B;B=d.memberLookup(i,"pinner",a.autoesc),c.set("pinner",B),c.parent||(b.setVariable("pinner",B),b.addExport("pinner")),h+="\n                    ";var C;C="/"+d.memberLookup(B,"username",a.autoesc)+"/",c.set("pinner_url",C),c.parent||(b.setVariable("pinner_url",C),b.addExport("pinner_url")),h+='\n                    <a href="',h+=d.suppressValue(C,a.autoesc),h+='">\n                        <img src="',h+=d.suppressValue(d.memberLookup(B,"image_small_url",a.autoesc),a.autoesc),h+='" />\n                    </a>\n                    <a href="',h+=d.suppressValue(C,a.autoesc),h+='">\n                        ',h+=d.suppressValue(d.memberLookup(B,"full_name",a.autoesc),a.autoesc),h+="\n                    </a>\n                </div>\n            </li>\n        "}h+='\n        <li class="boardWrapper">\n            <h3><label>',h+=d.suppressValue((f=108,g=25,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Board"])),a.autoesc),h+="</label></h3>\n            <div>\n                ";var D;if(D=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"default_board_id",a.autoesc),c.set("default_board_id",D),c.parent||(b.setVariable("default_board_id",D),b.addExport("default_board_id")),h+="\n                ",D){h+="\n                    ";var E;E="alphabetical",c.set("board_sort",E),c.parent||(b.setVariable("board_sort",E),b.addExport("board_sort")),h+="\n                "}else h+="\n                    ",E=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"board_sort",a.autoesc),"board_picker"),c.set("board_sort",E),c.parent||(b.setVariable("board_sort",E),b.addExport("board_sort")),h+="\n                ";if(h+="\n                ",q){h+="\n                    ";var F;F="large",c.set("size",F),c.parent||(b.setVariable("size",F),b.addExport("size")),h+="\n                "}else h+="\n                    ",F="medium",c.set("size",F),c.parent||(b.setVariable("size",F),b.addExport("size")),h+="\n                ";if(h+="\n                ",h+=d.suppressValue((f=121,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["BoardPicker",d.makeKeywordArgs({id:"boardPicker",options:{default_board_id:a.getFilter("default").call(b,D,""),size:F,disabled:!s},resource:(f=128,g=44,d.callWrap(d.contextOrFrameLookup(b,c,"create_resource"),"create_resource",["BoardsResource",d.makeKeywordArgs({options:{username:d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"username",a.autoesc),filter:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"board_filter",a.autoesc),"all"),field_set_key:"board_picker",sort:E,default_board_id:d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"default_board_id",a.autoesc)}})])),error_strategy:d.memberLookup(d.contextOrFrameLookup(b,c,"ErrorStrategy"),"BUBBLE",a.autoesc)})])),a.autoesc),h+='\n            </div>\n        </li>\n        <li>\n            <h3><label for="pinFormDescription">',h+=d.suppressValue((f=142,g=50,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Description"])),a.autoesc),h+="</label></h3>\n            <div>\n                ",h+=d.suppressValue((f=144,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.TextField",d.makeKeywordArgs({id:"pinDescriptionField",options:{id:"pinFormDescription",name:"description",value:l,disabled:!s,placeholder:(f=151,g=40,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["What's this Pin all about?"])),mentions:!0,pin_id:j}})])),a.autoesc),h+="\n            </div>\n        </li>\n        ",q&&(h+="\n            ",h+=d.suppressValue((f=158,g=21,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["showLink"])),a.autoesc),h+='\n            <li>\n                <h3><label for="pinFormLink">',h+=d.suppressValue((f=160,g=47,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Source"])),a.autoesc),h+='</label></h3>\n                <div>\n                    <input type="url"\n                        name="link"\n                        id="pinFormLink"\n                        value="',h+=d.suppressValue(d.memberLookup(i,"link",a.autoesc),a.autoesc),h+='"\n                        ',s||(h+='disabled class="disabled"'),h+=" />\n                </div>\n            </li>\n        "),h+="\n\n        ",t&&!k&&p&&(h+='\n            <li class="placeWrapper">\n                    <h3><label>',h+=d.suppressValue((f=173,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Place"])),a.autoesc),h+='</label></h3>\n                    <div>\n                        <input type="text"\n                            disabled\n                            class="disabled"\n                            value="',h+=d.suppressValue(a.getFilter("default").call(b,d.memberLookup(p,"name",a.autoesc),""),a.autoesc),h+='">\n                    </div>\n                    ',h+=d.suppressValue((f=180,g=27,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"removePlaceButton",options:{borderless:!0,class_name:"removePlaceButton",text:(f=185,g=37,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Remove Place"]))}})])),a.autoesc),h+="\n            </li>\n        "),h+="\n    </ul>\n\n    ",r&&k){h+='\n        <ul class="placeFormWrapper">\n            <li>\n                <h3>\n                    <label>',h+=d.suppressValue((f=196,g=29,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Place"])),a.autoesc),h+="</label>\n                </h3>\n                ";var G;if(G="addPlace",c.set("button_class_name",G),c.parent||(b.setVariable("button_class_name",G),b.addExport("button_class_name")),h+="\n                ",p){h+="\n                    ",G+="  hidden",c.set("button_class_name",G),c.parent||(b.setVariable("button_class_name",G),b.addExport("button_class_name")),h+="\n                    ";var H;if(H=d.memberLookup(p,"name",a.autoesc),c.set("text_to_display",H),c.parent||(b.setVariable("text_to_display",H),b.addExport("text_to_display")),h+="\n                    ",d.memberLookup(p,"locality",a.autoesc)||d.memberLookup(p,"region",a.autoesc)){h+="\n                        ";var I;I=d.memberLookup(p,"locality",a.autoesc),c.set("locality",I),c.parent||(b.setVariable("locality",I),b.addExport("locality")),h+="\n                        ";var J;J=d.memberLookup(p,"region",a.autoesc),c.set("region",J),c.parent||(b.setVariable("region",J),b.addExport("region")),h+="\n                        ",I&&(h+="\n                            ",H=H+", "+I,c.set("text_to_display",H),c.parent||(b.setVariable("text_to_display",H),b.addExport("text_to_display")),h+="\n                        "),h+="\n                        ",J&&(h+="\n                            ",I&&(h+="\n                                ",H+=", ",c.set("text_to_display",H),c.parent||(b.setVariable("text_to_display",H),b.addExport("text_to_display")),h+="\n                            "),h+="\n                            ",H+=J,c.set("text_to_display",H),c.parent||(b.setVariable("text_to_display",H),b.addExport("text_to_display")),h+="\n                        "),h+="\n                    "}h+="\n                    ",h+=d.suppressValue((f=215,g=27,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"addPlaceButton",options:{borderless:!0,has_icon:!0,class_name:"addPlace",log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"REPIN_EDIT_PLACE_BUTTON",a.autoesc),text:H,show_text:!0}})])),a.autoesc),h+="\n                "}else h+="\n                    ",h+=d.suppressValue((f=227,g=27,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"addPlaceButton",options:{borderless:!0,has_icon:!0,log_element_type:d.memberLookup(d.contextOrFrameLookup(b,c,"ElementType"),"REPIN_ADD_PLACE_BUTTON",a.autoesc),class_name:G,text:(f=234,g=37,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Add location to this Pin"])),show_text:!0}})])),a.autoesc),h+="\n                ";h+='\n                <div class="fields hidden">\n                    ',h+=d.suppressValue((f=240,g=27,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["PlaceSelector",d.makeKeywordArgs({id:"placeSelector",options:{place:p}})])),a.autoesc),h+="\n                </div>\n            </li>\n        </ul>\n    "}h+='\n\n    <div class="formFooter">\n        ';var K;K=a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_explicit_share",a.autoesc),!0),c.set("show_explicit_share",K),c.parent||(b.setVariable("show_explicit_share",K),b.addExport("show_explicit_share")),h+="\n        ",K&&(h+='\n            <div class="socialShareWrapper">\n                ',v&&!w&&(h+='\n                    <label class="facebookInput">\n                        ',h+=d.suppressValue((f=257,g=31,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.Checkbox",d.makeKeywordArgs({options:{name:"share_facebook",checked:x,view_type:d.contextOrFrameLookup(b,c,"none")}})])),a.autoesc),h+="\n                        <span>",h+=d.suppressValue((f=261,g=32,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Post to Facebook"])),a.autoesc),h+="</span>\n                    </label>\n                "),h+="\n                ",y&&(h+='\n                    <label class="twitterInput">\n                        ',h+=d.suppressValue((f=266,g=31,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.Checkbox",d.makeKeywordArgs({options:{name:"share_twitter",checked:z,view_type:d.contextOrFrameLookup(b,c,"none")}})])),a.autoesc),h+="\n                        <span>",h+=d.suppressValue((f=270,g=32,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Post to Twitter"])),a.autoesc),h+="</span>\n                    </label>\n                "),h+="\n            </div>\n        "),h+="\n        ",d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_delete",a.autoesc)?(h+='\n            <div class="formFooterDelete">\n                ',h+=d.suppressValue((f=277,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"deleteButton",options:{class_name:"deleteButton",text:(f=281,g=33,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Delete Pin"])),ga_category:"pin_delete"}})])),a.autoesc),h+="\n            </div>\n        "):d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_uploader",a.autoesc)&&(h+="\n            ",h+=d.suppressValue((f=288,g=22,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["ui.ImageUploader",d.makeKeywordArgs({id:"uploader",options:{placeholder:m,button_options:{text:(f=293,g=37,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Choose File"])),class_name:"leftRounded",size:"large",element_type:"div",rounded:!1}}})])),a.autoesc),h+="\n        "),h+='\n\n        <div class="formFooterButtons">\n            ';var L;L=!s,c.set("disabled",L),c.parent||(b.setVariable("disabled",L),b.addExport("disabled")),h+="\n            ";var M;M="submitButton",c.set("submit_button_id",M),c.parent||(b.setVariable("submit_button_id",M),b.addExport("submit_button_id")),h+="\n            ";var N;N="primary",c.set("button_color",N),c.parent||(b.setVariable("button_color",N),b.addExport("button_color")),h+="\n            ";var O;if(O="submit",c.set("button_type",O),c.parent||(b.setVariable("button_type",O),b.addExport("button_type")),h+="\n            ",d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"pin_it_script_button",a.autoesc))h+="\n                ",P={class_name:"repinSmall pinIt",type:O,show_text:!1,text:(f=321,g=37,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Pin it"])),has_icon:!0,disabled:L,color:N},c.set("button_options",P),c.parent||(b.setVariable("button_options",P),b.addExport("button_options")),h+="\n            ";else{h+="\n                ";var P;P={class_name:"savePinButton",color:N,disabled:L,text:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"submit_text",a.autoesc),(f=314,g=65,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Save Changes"]))),type:O},c.set("button_options",P),c.parent||(b.setVariable("button_options",P),b.addExport("button_options")),h+="\n            "}h+="\n\n            ",h+=d.suppressValue((f=327,g=19,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:M,options:P})])),a.autoesc),h+="\n\n            ",a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"show_cancel_button",a.autoesc),!0)&&(h+="\n                ",h+=d.suppressValue((f=331,g=23,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["Button",d.makeKeywordArgs({id:"cancelButton",options:{cancelButton:!0,text:a.getFilter("default").call(b,d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"cancel_text",a.autoesc),(f=335,g=61,d.callWrap(d.contextOrFrameLookup(b,c,"_"),"_",["Cancel"])))}})])),a.autoesc),h+="\n            "),h+="\n        </div>\n    </div>\n\n    ",q||(h+='\n        <input type="hidden" name="link" id="pinFormLink" value="',h+=d.suppressValue(o,a.autoesc),h+='">\n    '),h+="\n</form>\n",e(null,h)}catch(Q){e(d.handleError(Q,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/PinLikeButton/PinLikeButton.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+=d.suppressValue((f=0,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["PinLikeButtonBase"])),a.autoesc),a.getTemplate("app/common/modules/PinLikeButtonBase/PinLikeButtonBase.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n\n",h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/ShowModalButton/ShowModalButton.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+=d.suppressValue((f=0,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["Button"])),a.autoesc),a.getTemplate("app/desktop/modules/Button/Button.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/desktop/modules/ui/PinPreview/PinPreview.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{a.getTemplate("templates/macros/image.nunjucks",function(i,j){return i?void e(i):void j.getExported(function(i,j){if(i)return void e(i);if(!j.hasOwnProperty("image_tag"))return void e(new Error("cannot import 'image_tag'"));var k=j.image_tag;b.setVariable("image_tag",k),h+="\n\n";var l;l=d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"image_url",a.autoesc),c.set("image_url",l),c.parent||(b.setVariable("image_url",l),b.addExport("image_url")),h+="\n\n",h+=d.suppressValue((f=4,g=10,d.callWrap(k,"image_tag",[d.makeKeywordArgs({src:l,class_name:"pinPreviewImg"})])),a.autoesc),h+="\n\n",h+="\n",d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"is_video",a.autoesc)&&(h+="\n    <div class='videoIndicator'></div>\n"),h+="\n",e(null,h)})})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/internal/modules/internal/LogLevel/LogLevel.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=d.makeMacro(["log","levels"],[],function(b,e,f){c=c.push(),f=f||{},c.set("log",b),c.set("levels",e);var g="";g+="\n<li>\n    ",g+=d.suppressValue(d.memberLookup(b,"name",a.autoesc),a.autoesc),g+="\n    <select>\n        ",c=c.push();var h=e;if(h)for(var i=0;i<h.length;i++){var j=h[i];c.set("level",j),g+="\n             <option value=",g+=d.suppressValue(d.memberLookup(b,"name",a.autoesc)+"_"+d.memberLookup(j,1,a.autoesc),a.autoesc),g+="\n             ",d.memberLookup(b,"logLevel",a.autoesc)==d.memberLookup(j,1,a.autoesc)&&(g+="\n                 selected\n             "),g+="\n             >",g+=d.suppressValue(d.memberLookup(j,0,a.autoesc),a.autoesc),g+="</option>\n        "}return c=c.pop(),g+="\n    </select>\n</li>\n",c=c.pop(),new d.SafeString(g)});b.addExport("single_log"),b.setVariable("single_log",i),h+='\n\n<div class="header">\n    <h1>Choose the log level you want for each logger</h1>\n    <a href="#" class="refreshButton">Refresh list</a>&nbsp;\n    <a href="/_/_/debug/">Back to Debug</a>\n</div>\n<div class="changeAll">\n    Change all to\n    ',c=c.push();var j=d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"levels",a.autoesc);if(j)for(var k=0;k<j.length;k++){var l=j[k];c.set("level",l),h+='\n         <a class="switch" data-val="',h+=d.suppressValue(d.memberLookup(l,1,a.autoesc),a.autoesc),h+='">',h+=d.suppressValue(d.memberLookup(l,0,a.autoesc),a.autoesc),h+="</a>&nbsp;\n    "}c=c.pop(),h+="\n</div>\n<div>\n    ",c=c.push();var m=d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"loggerColumns",a.autoesc);if(m)for(var n=0;n<m.length;n++){var o=m[n];c.set("loggerColumn",o),h+="\n        <ul>\n            ",c=c.push();var p=o;if(p)for(var q=0;q<p.length;q++){var r=p[q];c.set("logItem",r),h+="\n                ",h+=d.suppressValue((f=30,g=27,d.callWrap(i,"single_log",[d.makeKeywordArgs({log:r,levels:d.memberLookup(d.contextOrFrameLookup(b,c,"data"),"levels",a.autoesc)})])),a.autoesc),h+="\n            "}c=c.pop(),h+="\n        </ul>\n    "}c=c.pop(),h+="\n</div>\n",e(null,h)}catch(s){e(d.handleError(s,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/mobile/modules/Button/Button.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+=d.suppressValue((f=0,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["ButtonBase"])),a.autoesc),a.getTemplate("app/common/modules/ButtonBase/ButtonBase.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/mobile/modules/Header/Header.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n\n";var i;i="a",c.set("header_button_element_type",i),c.parent||(b.setVariable("header_button_element_type",i),b.addExport("header_button_element_type")),h+="\n";var j;j="small",c.set("header_button_size",j),c.parent||(b.setVariable("header_button_size",j),b.addExport("header_button_size")),h+="\n";var k;k=!1,c.set("header_button_rounded",k),c.parent||(b.setVariable("header_button_rounded",k),b.addExport("header_button_rounded")),h+="\n";var l;l=!1,c.set("header_button_show_text",l),c.parent||(b.setVariable("header_button_show_text",l),b.addExport("header_button_show_text")),h+="\n";var m;m=!0,c.set("header_button_has_icon",m),c.parent||(b.setVariable("header_button_has_icon",m),b.addExport("header_button_has_icon")),h+="\n\n";var n;f=10,g=30,n=d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["main_module",{}]),c.set("main_module",n),c.parent||(b.setVariable("main_module",n),b.addExport("main_module")),h+="\n\n";var o;f=12,g=39,o=d.callWrap(d.memberLookup(n,"get",a.autoesc),'main_module["get"]',["className",(f=12,g=68,d.callWrap(d.memberLookup(n,"get",a.autoesc),'main_module["get"]',["name",""]))]),c.set("main_module_name",o),c.parent||(b.setVariable("main_module_name",o),b.addExport("main_module_name")),h+="\n";var p;f=13,g=42,p=d.callWrap(d.memberLookup(n,"get",a.autoesc),'main_module["get"]',["options",{}]),c.set("main_module_options",p),c.parent||(b.setVariable("main_module_options",p),b.addExport("main_module_options")),h+="\n";var q;if(q="logo",c.set("header_highlight",q),c.parent||(b.setVariable("header_highlight",q),b.addExport("header_highlight")),h+="\n","PinBookmarklet"==o){h+="\n    ";var r;r=!0,c.set("logo_only",r),c.parent||(b.setVariable("logo_only",r),b.addExport("logo_only")),h+="\n    ",d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc)&&(h+="\n        ",h+=d.suppressValue((f=18,g=17,d.callWrap(d.contextOrFrameLookup(b,c,"addclass"),"addclass",["sticky"])),a.autoesc),h+="\n    "),h+="\n"}else h+="\n    ",r=!1,c.set("logo_only",r),c.parent||(b.setVariable("logo_only",r),b.addExport("logo_only")),h+="\n    ",h+="\n    ","ExplorePage"==o||"FeedPage"==o||"SearchPage"==o?(h+="\n        ",q="explore",c.set("header_highlight",q),c.parent||(b.setVariable("header_highlight",q),b.addExport("header_highlight")),h+="\n    "):("UserProfilePage"==o&&(f=29,g=24,d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"get",a.autoesc),'context["user"]["get"]',["username"])==(f=29,g=63,d.callWrap(d.memberLookup(p,"get",a.autoesc),'main_module_options["get"]',["username"])))||"JoinSplashPage"==o||"LoginPage"==o)&&(h+="\n        ",q="profile",c.set("header_highlight",q),c.parent||(b.setVariable("header_highlight",q),b.addExport("header_highlight")),h+="\n    "),h+="\n";if(h+="\n\n",!r){h+="\n    ";var s;s="explore",c.set("explore_button_class",s),c.parent||(b.setVariable("explore_button_class",s),b.addExport("explore_button_class")),h+="\n    ","explore"==q&&(h+="\n        ",s+=" highlight",c.set("explore_button_class",s),c.parent||(b.setVariable("explore_button_class",s),b.addExport("explore_button_class")),h+="\n    "),h+="\n    ",h+=d.suppressValue((f=41,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["NavigateButton",d.makeKeywordArgs({id:"explore",options:{class_name:s,size:j,element_type:i,has_icon:m,rounded:k,show_text:l,url:"/categories/"}})])),a.autoesc),h+="\n"}h+="\n\n";var t;if(t="logo",c.set("logo_class",t),c.parent||(b.setVariable("logo_class",t),b.addExport("logo_class")),h+="\n","logo"==q&&(h+="\n    ",t+=" highlight",c.set("logo_class",t),c.parent||(b.setVariable("logo_class",t),b.addExport("logo_class")),h+="\n"),h+='\n<a href="/" class="',h+=d.suppressValue(t,a.autoesc),h+='">\n    <h1>Pinterest</h1>\n</a>\n\n',!r){if(h+="\n    ",d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc)&&(f=63,g=41,d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"get",a.autoesc),'context["user"]["get"]',["username"]))){h+="\n        ";var u;u="/"+(f=64,g=41,d.callWrap(d.memberLookup(d.memberLookup(d.contextOrFrameLookup(b,c,"context"),"user",a.autoesc),"get",a.autoesc),'context["user"]["get"]',["username"]))+"/",c.set("url",u),c.parent||(b.setVariable("url",u),b.addExport("url")),h+="\n    "}else h+="\n        ",u="/join/",c.set("url",u),c.parent||(b.setVariable("url",u),b.addExport("url")),h+="\n    ";h+="\n\n    ";var v;v="userProfile",c.set("profile_button_class",v),c.parent||(b.setVariable("profile_button_class",v),b.addExport("profile_button_class")),h+="\n    ","profile"==q&&(h+="\n        ",v+=" highlight",c.set("profile_button_class",v),c.parent||(b.setVariable("profile_button_class",v),b.addExport("profile_button_class")),h+="\n    "),h+="\n    ",h+=d.suppressValue((f=73,g=11,d.callWrap(d.contextOrFrameLookup(b,c,"module"),"module",["NavigateButton",d.makeKeywordArgs({id:"userProfile",options:{class_name:v,size:j,element_type:i,has_icon:m,rounded:k,show_text:l,url:u}})])),a.autoesc),h+="\n"}e(null,h)}catch(w){e(d.handleError(w,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["app/mobile/modules/NavigateButton/NavigateButton.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{"a"==(f=0,g=15,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["element_type"]))&&(h+=d.suppressValue((f=1,g=9,d.callWrap(d.contextOrFrameLookup(b,c,"attr"),"attr",[d.makeKeywordArgs({href:(f=1,g=26,d.callWrap(d.memberLookup(d.contextOrFrameLookup(b,c,"options"),"get",a.autoesc),'options["get"]',["url"]))})])),a.autoesc)),h+=d.suppressValue((f=4,g=1,d.callWrap(d.contextOrFrameLookup(b,c,"base"),"base",["Button"])),a.autoesc),a.getTemplate("app/desktop/modules/Button/Button.nunjucks",!0,function(f,g){if(f)return void e(f);for(var i in g.blocks)b.addBlock(i,g.blocks[i]);h+="\n",g.rootRenderFunc(a,b,c,d,e)})}catch(i){e(d.handleError(i,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/macros/boardpicker.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=d.makeMacro(["is_secret","is_collaborative","is_place","show_arrow"],[],function(a,b,e,f,g){c=c.push(),g=g||{},c.set("is_secret",a),c.set("is_collaborative",b),c.set("is_place",e),c.set("show_arrow",f);var h="";return h+='\n    <div class="iconWrapper">\n        <span class="placeIcon ',e||(h+="hidden"),h+='"></span>\n        <span class="secretIcon ',a||(h+="hidden"),h+='"></span>\n        <span class="collaborativeIcon ',b||(h+="hidden"),h+='"></span>\n        ',f&&(h+='\n            <span class="downArrow"></span>\n        '),h+="\n    </div>\n",c=c.pop(),new d.SafeString(h)});b.addExport("icon_wrapper"),b.setVariable("icon_wrapper",i),h+="\n",e(null,h)}catch(j){e(d.handleError(j,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/macros/image.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n";var i=d.makeMacro([],["src","class_name","width","height","style","add_class_on_load","alt"],function(e){c=c.push(),e=e||{},c.set("src",e.hasOwnProperty("src")?e.src:""),c.set("class_name",e.hasOwnProperty("class_name")?e.class_name:""),c.set("width",e.hasOwnProperty("width")?e.width:-1),c.set("height",e.hasOwnProperty("height")?e.height:-1),c.set("style",e.hasOwnProperty("style")?e.style:{}),c.set("add_class_on_load",e.hasOwnProperty("add_class_on_load")?e.add_class_on_load:!1),c.set("alt",e.hasOwnProperty("alt")?e.alt:"");
var f="";f+="\n    ",f+='\n    \n\n    <img src="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"src"),a.autoesc),f+='"',d.contextOrFrameLookup(b,c,"class_name")&&(f+='\n        class="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"class_name"),a.autoesc),f+='"\n    '),f+='style="',-1!=d.contextOrFrameLookup(b,c,"height")&&(f+="height:",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"height"),a.autoesc),f+="px;"),-1!=d.contextOrFrameLookup(b,c,"width")&&(f+="width:",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"width"),a.autoesc),f+="px;"),c=c.push();var g=a.getFilter("dictsort").call(b,d.contextOrFrameLookup(b,c,"style"));if(g){var h;if(d.isArray(g))for(h=0;h<g.length;h++){var i=g[h][0];c.set("name",g[h][0]);var j=g[h][1];c.set("value",g[h][1]),f+=d.suppressValue(i,a.autoesc),f+=":",f+=d.suppressValue(j,a.autoesc),f+=";"}else{h=-1;for(var k in g){h++;var l=g[k];c.set("name",k),c.set("value",l),f+=d.suppressValue(k,a.autoesc),f+=":",f+=d.suppressValue(l,a.autoesc),f+=";"}}}return c=c.pop(),f+='"',d.contextOrFrameLookup(b,c,"add_class_on_load")&&(f+='\n        onload="P.lazy.onImageLoad(this)"\n    '),d.contextOrFrameLookup(b,c,"alt")&&(f+='\n        alt="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"alt"),a.autoesc),f+='"\n    '),f+=">\n",c=c.pop(),new d.SafeString(f)});b.addExport("image_tag"),b.setVariable("image_tag",i),h+="\n",e(null,h)}catch(j){e(d.handleError(j,f,g))}}return{root:a}}()}(),function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["templates/macros/link.nunjucks"]=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{h+="\n";var i=d.makeMacro(["url","text"],["no_follow","new_window"],function(e,f,g){c=c.push(),g=g||{},c.set("url",e),c.set("text",f),c.set("no_follow",g.hasOwnProperty("no_follow")?g.no_follow:!1),c.set("new_window",g.hasOwnProperty("new_window")?g.new_window:!1);var h="";return h+='<a href="',h+=d.suppressValue(e,a.autoesc),h+='"\n\n        ',d.contextOrFrameLookup(b,c,"no_follow")&&(h+='rel="nofollow"'),h+="\n        ",d.contextOrFrameLookup(b,c,"new_window")&&(h+='target="_blank"'),h+="\n\n    >",h+=d.suppressValue(f,a.autoesc),h+="</a>",c=c.pop(),new d.SafeString(h)});b.addExport("link_markup"),b.setVariable("link_markup",i),h+="\n",e(null,h)}catch(j){e(d.handleError(j,f,g))}}return{root:a}}()}();